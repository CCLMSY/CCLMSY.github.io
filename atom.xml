<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>CCLMSYğŸ’«</title>
  
  
  <link href="https://www.cclmsy.cc/atom.xml" rel="self"/>
  
  <link href="https://www.cclmsy.cc/"/>
  <updated>2025-11-05T08:18:03.447Z</updated>
  <id>https://www.cclmsy.cc/</id>
  
  <author>
    <name>æ·±ç¿¼ğŸ’«</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ã€Šè®¡ç®—æœºä¸“ä¸šè‹±è¯­ã€‹è¯¾ç¨‹ç¬”è®°</title>
    <link href="https://www.cclmsy.cc/posts/csenglish.html"/>
    <id>https://www.cclmsy.cc/posts/csenglish.html</id>
    <published>2025-11-04T16:00:00.000Z</published>
    <updated>2025-11-05T08:18:03.447Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç¼©å†™è¡¨"><a href="#ç¼©å†™è¡¨" class="headerlink" title="ç¼©å†™è¡¨"></a>ç¼©å†™è¡¨</h2><div class="table-container"><table><thead><tr><th style="text-align:center">ç¼©å†™</th><th style="text-align:center">å…¨ç§°</th><th style="text-align:center">é‡Šä¹‰</th></tr></thead><tbody><tr><td style="text-align:center">ALU</td><td style="text-align:center">Arithmetic and Logic Unit</td><td style="text-align:center">ç®—æœ¯é€»è¾‘å•å…ƒ</td></tr><tr><td style="text-align:center">CPU</td><td style="text-align:center">Central Processing Unit</td><td style="text-align:center">ä¸­å¤®å¤„ç†å™¨</td></tr><tr><td style="text-align:center">SIMD</td><td style="text-align:center">Single Instruction Multiple Data</td><td style="text-align:center">å•æŒ‡ä»¤å¤šæ•°æ®</td></tr><tr><td style="text-align:center">MIMD</td><td style="text-align:center">Multiple Instruction Multiple Data</td><td style="text-align:center">å¤šæŒ‡ä»¤å¤šæ•°æ®</td></tr><tr><td style="text-align:center">RAM</td><td style="text-align:center">Random Access Memory</td><td style="text-align:center">éšæœºå­˜å–å­˜å‚¨å™¨</td></tr><tr><td style="text-align:center">ROM</td><td style="text-align:center">Read-Only Memory</td><td style="text-align:center">åªè¯»å­˜å‚¨å™¨</td></tr><tr><td style="text-align:center">BIOS</td><td style="text-align:center">Basic Input/Output System</td><td style="text-align:center">åŸºæœ¬è¾“å…¥è¾“å‡ºç³»ç»Ÿ</td></tr><tr><td style="text-align:center">CRT</td><td style="text-align:center">Cathode Ray Tube</td><td style="text-align:center">é˜´æå°„çº¿ç®¡</td></tr><tr><td style="text-align:center">FPD</td><td style="text-align:center">Flat Panel Display</td><td style="text-align:center">å¹³æ¿æ˜¾ç¤ºå™¨</td></tr><tr><td style="text-align:center">LCD</td><td style="text-align:center">Liquid Crystal Display</td><td style="text-align:center">æ¶²æ™¶æ˜¾ç¤ºå™¨</td></tr><tr><td style="text-align:center">OLED</td><td style="text-align:center">Organic Light Emitting Display</td><td style="text-align:center">æœ‰æœºå‘å…‰æ˜¾ç¤ºå™¨</td></tr><tr><td style="text-align:center">DPI</td><td style="text-align:center">Dots Per Inch</td><td style="text-align:center">æ¯è‹±å¯¸ç‚¹æ•°</td></tr><tr><td style="text-align:center">DSP</td><td style="text-align:center">Digital Signal Processor</td><td style="text-align:center">æ•°å­—ä¿¡å·å¤„ç†å™¨</td></tr><tr><td style="text-align:center">NIC</td><td style="text-align:center">Network Interface Card</td><td style="text-align:center">ç½‘ç»œæ¥å£å¡</td></tr><tr><td style="text-align:center">MAC</td><td style="text-align:center">Media Access Control</td><td style="text-align:center">åª’ä½“è®¿é—®æ§åˆ¶</td></tr><tr><td style="text-align:center">LAN</td><td style="text-align:center">Local Area Network</td><td style="text-align:center">å±€åŸŸç½‘</td></tr><tr><td style="text-align:center">IP</td><td style="text-align:center">Internet Protocol</td><td style="text-align:center">äº’è”ç½‘åè®®</td></tr><tr><td style="text-align:center">CLI</td><td style="text-align:center">Command Line Interface</td><td style="text-align:center">å‘½ä»¤è¡Œç•Œé¢</td></tr><tr><td style="text-align:center">GUI</td><td style="text-align:center">Graphical User Interface</td><td style="text-align:center">å›¾å½¢ç”¨æˆ·ç•Œé¢</td></tr><tr><td style="text-align:center">IDE</td><td style="text-align:center">Integrated Development Environment</td><td style="text-align:center">é›†æˆå¼€å‘ç¯å¢ƒ</td></tr><tr><td style="text-align:center">CD</td><td style="text-align:center">Compact Disc</td><td style="text-align:center">å…‰ç›˜</td></tr><tr><td style="text-align:center">PDA</td><td style="text-align:center">Personal Digital Assistant</td><td style="text-align:center">ä¸ªäººæ•°å­—åŠ©ç†</td></tr><tr><td style="text-align:center">OS</td><td style="text-align:center">Operating System</td><td style="text-align:center">æ“ä½œç³»ç»Ÿ</td></tr><tr><td style="text-align:center">ID</td><td style="text-align:center">Identity</td><td style="text-align:center">èº«ä»½æ ‡è¯†</td></tr><tr><td style="text-align:center">DOS</td><td style="text-align:center">Disk Operating System</td><td style="text-align:center">ç£ç›˜æ“ä½œç³»ç»Ÿ</td></tr><tr><td style="text-align:center">DDOS</td><td style="text-align:center">Distributed Denial of Service</td><td style="text-align:center">åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡</td></tr><tr><td style="text-align:center">DBMS</td><td style="text-align:center">DataBase Management System</td><td style="text-align:center">æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ</td></tr><tr><td style="text-align:center">SQL</td><td style="text-align:center">Structured Query Language</td><td style="text-align:center">ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€</td></tr><tr><td style="text-align:center">OOP</td><td style="text-align:center">Object-Oriented Programming</td><td style="text-align:center">é¢å‘å¯¹è±¡ç¼–ç¨‹</td></tr><tr><td style="text-align:center">HTML</td><td style="text-align:center">HyperText Markup Language</td><td style="text-align:center">è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€</td></tr><tr><td style="text-align:center">OSI</td><td style="text-align:center">Open Systems Interconnection</td><td style="text-align:center">å¼€æ”¾å¼ç³»ç»Ÿäº’è”</td></tr><tr><td style="text-align:center">TCP</td><td style="text-align:center">Transmission Control Protocol</td><td style="text-align:center">ä¼ è¾“æ§åˆ¶åè®®</td></tr><tr><td style="text-align:center">USB</td><td style="text-align:center">Universal Serial Bus</td><td style="text-align:center">é€šç”¨ä¸²è¡Œæ€»çº¿</td></tr><tr><td style="text-align:center">WWW</td><td style="text-align:center">World Wide Web</td><td style="text-align:center">ä¸‡ç»´ç½‘</td></tr><tr><td style="text-align:center">ISP</td><td style="text-align:center">Internet Service Provider</td><td style="text-align:center">äº’è”ç½‘æœåŠ¡æä¾›å•†</td></tr><tr><td style="text-align:center">DSL</td><td style="text-align:center">Digital Subscriber Line</td><td style="text-align:center">æ•°å­—ç”¨æˆ·çº¿è·¯</td></tr></tbody></table></div><h2 id="Unit1"><a href="#Unit1" class="headerlink" title="Unit1"></a>Unit1</h2><h3 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h3><ol><li>A key component common to all CPUs is the program counter, a special memory cell that keeps track of which location in memory the next instruction is to be read from.<ul><li>æ‰€æœ‰CPUå…±æœ‰çš„å…³é”®ç»„ä»¶æ˜¯ç¨‹åºè®¡æ•°å™¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å­˜å‚¨å•å…ƒï¼Œç”¨äºè®°å½•å†…å­˜ä¸­ä¸‹ä¸€æ¡æŒ‡ä»¤çš„è¯»å–ä½ç½®ã€‚</li></ul></li><li>It is noticeable that the sequence of operations that the control unit goes through to process an instruction is in itself like a short computer program.<ul><li>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ§åˆ¶å•å…ƒå¤„ç†ä¸€æ¡æŒ‡ä»¤æ—¶æ‰€ç»å†çš„æ“ä½œåºåˆ—æœ¬èº«å°±åƒä¸€ä¸ªç®€çŸ­çš„è®¡ç®—æœºç¨‹åºã€‚</li></ul></li><li>And indeed, in some more complex CPU designs, there is another yet smaller computer called a microsequencer that runs a microcode program that causes all of these events to happen.<ul><li>äº‹å®ä¸Šï¼Œåœ¨æŸäº›æ›´å¤æ‚çš„CPUè®¾è®¡ä¸­ï¼Œè¿˜å­˜åœ¨å¦ä¸€å°æ›´å°çš„è®¡ç®—æœºï¼Œç§°ä¸ºå¾®ç¨‹åºæ§åˆ¶å™¨ï¼Œå®ƒè¿è¡Œç€å¾®ç¨‹åºï¼Œè¿™äº›å¾®ç¨‹åºä¿ƒä½¿æ‰€æœ‰è¿™äº›äº‹ä»¶å‘ç”Ÿã€‚</li></ul></li><li>Therefore, any computer can be programmed to perform any arithmetic operation, although it will take more time to do so if its ALU does not directly support the operation.<ul><li>å› æ­¤ï¼Œä»»ä½•è®¡ç®—æœºéƒ½å¯ä»¥è¢«ç¼–ç¨‹æ‰§è¡Œä»»ä½•ç®—æœ¯è¿ç®—ï¼Œå°½ç®¡å¦‚æœå…¶ç®—æœ¯é€»è¾‘å•å…ƒï¼ˆALUï¼‰ä¸ç›´æ¥æ”¯æŒè¯¥æ“ä½œï¼Œåˆ™æ‰§è¡Œè¯¥æ“ä½œå°†éœ€è¦æ›´é•¿æ—¶é—´ã€‚ </li></ul></li><li>Since the CPU does not differentiate between different types of information, it is up to the software to give significance to what the memory sees as nothing but a series of numbers.<ul><li>ç”±äºCPUä¸ä¼šåŒºåˆ†ä¸åŒç±»å‹çš„ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦è½¯ä»¶ä¸ºå†…å­˜ä¸­ä»…è¢«è§†ä¸ºä¸€ç³»åˆ—æ•°å­—çš„ä¿¡æ¯èµ‹äºˆæ„ä¹‰ã€‚</li></ul></li></ol><h3 id="Ex-2"><a href="#Ex-2" class="headerlink" title="Ex.2"></a>Ex.2</h3><ol><li><strong>input</strong>: Information put into a communications system for transmission or into a computer system for processing.</li><li><strong>microprocessor</strong>: An integrated circuit that contains the entire central processing unit of a computer on a single chip.</li><li><strong>program</strong>(1): An instruction sequence in programmed instruction.</li><li><strong>bus</strong>: A parallel circuit that connects the various components of a computer, allowing the transfer of electric impulses from one connected component to any other.</li><li><strong>hardware</strong>: A computer and the associated physical equipment directly involved in the performance of data-processing or communications functions.</li><li><strong>memory</strong>: A unit of a computer that preserves data for retrieval.</li><li><strong>output</strong>: The information produced by a computer from a specific input.</li><li><strong>cell</strong>: A basic unit of storage in a computer memory that can hold one unit of information, such as a character or word.</li><li><strong>register</strong>: A part of the central processing unit where groups of binary digits are stored as the computer is processing them.</li><li><strong>address</strong>: A number used in information storage or retrieval that is assigned to a specific memory location.</li></ol><hr><ol><li><strong>è¾“å…¥</strong>ï¼šè¾“å…¥é€šä¿¡ç³»ç»Ÿè¿›è¡Œä¼ è¾“æˆ–è¾“å…¥è®¡ç®—æœºç³»ç»Ÿè¿›è¡Œå¤„ç†çš„ä¿¡æ¯ã€‚</li><li><strong>å¾®å¤„ç†å™¨</strong>ï¼šå°†è®¡ç®—æœºæ•´ä¸ªä¸­å¤®å¤„ç†å•å…ƒé›†æˆäºå•ä¸€èŠ¯ç‰‡çš„é›†æˆç”µè·¯ã€‚</li><li><strong>ç¨‹åº</strong>ï¼šç¼–ç¨‹æŒ‡ä»¤ä¸­çš„æŒ‡ä»¤åºåˆ—ã€‚</li><li><strong>æ€»çº¿</strong>ï¼š è¿æ¥è®¡ç®—æœºå„ç»„ä»¶çš„å¹¶è¡Œç”µè·¯ï¼Œå¯å®ç°ç”µä¿¡å·åœ¨ç›¸é‚»ç»„ä»¶é—´çš„ä¼ è¾“ã€‚</li><li><strong>ç¡¬ä»¶</strong>ï¼šç›´æ¥å‚ä¸æ•°æ®å¤„ç†æˆ–é€šä¿¡åŠŸèƒ½çš„è®¡ç®—æœºåŠç›¸å…³ç‰©ç†è®¾å¤‡ã€‚</li><li><strong>å­˜å‚¨å™¨</strong>ï¼šç”¨äºä¿å­˜æ•°æ®ä»¥ä¾¿æ£€ç´¢çš„è®¡ç®—æœºå•å…ƒã€‚</li><li><strong>è¾“å‡º</strong>ï¼šè®¡ç®—æœºæ ¹æ®ç‰¹å®šè¾“å…¥äº§ç”Ÿçš„ä¿¡æ¯ã€‚</li><li><strong>å•å…ƒ</strong>ï¼šè®¡ç®—æœºå­˜å‚¨å™¨ä¸­å¯å®¹çº³å•ä¸ªä¿¡æ¯å•ä½ï¼ˆå¦‚å­—ç¬¦æˆ–å•è¯ï¼‰çš„åŸºæœ¬å­˜å‚¨å•å…ƒã€‚</li><li><strong>å¯„å­˜å™¨</strong>ï¼šä¸­å¤®å¤„ç†å™¨ä¸­ç”¨äºå­˜å‚¨äºŒè¿›åˆ¶æ•°å­—ç»„çš„éƒ¨ä»¶ï¼Œè¿™äº›æ•°å­—ç»„åœ¨è®¡ç®—æœºå¤„ç†è¿‡ç¨‹ä¸­è¢«ä¸´æ—¶ä¿å­˜ã€‚</li><li><strong>åœ°å€</strong>ï¼šç”¨äºä¿¡æ¯å­˜å‚¨æˆ–æ£€ç´¢çš„ç¼–å·ï¼Œåˆ†é…ç»™ç‰¹å®šå­˜å‚¨ä½ç½®ã€‚</li></ol><h3 id="Ex-4"><a href="#Ex-4" class="headerlink" title="Ex.4"></a>Ex.4</h3><ol><li>A <u>processor</u> is a functional unit that interprets and carries out instructions.</li><li>A <u>programming language</u> consists of the symbols, characters, and usage rules that permit people to communicate with computers.</li><li><u>Application</u> software, also called end-user program, includes database programs, word processors, spreadsheets etc.</li><li>In <u>a stack</u>, the only element that can be deleted or removed is the one that was inserted most recently.</li><li>Most <u>security</u> measures involve data encryption and password.</li></ol><hr><ol><li>å¤„ç†å™¨æ˜¯ä¸€ç§èƒ½å¤Ÿè§£é‡Šå¹¶æ‰§è¡ŒæŒ‡ä»¤çš„åŠŸèƒ½å•å…ƒã€‚</li><li>ç¼–ç¨‹è¯­è¨€ç”±ç¬¦å·ã€å­—ç¬¦åŠä½¿ç”¨è§„åˆ™æ„æˆï¼Œä½¿äººç±»èƒ½å¤Ÿä¸è®¡ç®—æœºè¿›è¡Œäº¤äº’ã€‚</li><li>åº”ç”¨è½¯ä»¶ï¼ˆäº¦ç§°ç»ˆç«¯ç”¨æˆ·ç¨‹åºï¼‰åŒ…å«æ•°æ®åº“ç¨‹åºã€æ–‡å­—å¤„ç†å™¨ã€ç”µå­è¡¨æ ¼ç­‰ã€‚</li><li>åœ¨æ ˆä¸­ï¼Œå”¯ä¸€å¯åˆ é™¤æˆ–ç§»é™¤çš„å…ƒç´ æ˜¯æœ€è¿‘æ’å…¥çš„é‚£ä¸ªã€‚</li><li>å¤§å¤šæ•°å®‰å…¨æªæ–½æ¶‰åŠæ•°æ®åŠ å¯†å’Œå¯†ç ä¿æŠ¤ã€‚</li></ol><h3 id="Ex-5"><a href="#Ex-5" class="headerlink" title="Ex.5"></a>Ex.5</h3><p>A buffer is a data area shared by <u>hardware</u> devices or program processes that <u>operate</u> at different speeds or with different sets of priorities. The buffer allows each <u>device</u> or process to operate without being held up by the <u>other</u>. In order for a buffer to be <u>effective</u>, size of the buffer and the algorithms for <u>moving</u> data into and out of the buffer need to be <u>considered</u> by the buffer <u>designer</u>. Like a cache, a buffer is a â€œmidpoint holding placeâ€ but <u>exists</u> not so much to accelerate the <u>speed</u> of an activity as to support the coordination of separate activities.</p><p>ç¼“å†²åŒºæ˜¯ä¾›è¿è¡Œé€Ÿåº¦ä¸åŒæˆ–ä¼˜å…ˆçº§ä¸åŒçš„ç¡¬ä»¶è®¾å¤‡æˆ–ç¨‹åºè¿›ç¨‹å…±äº«çš„æ•°æ®åŒºåŸŸã€‚ç¼“å†²åŒºä½¿æ¯ä¸ªè®¾å¤‡æˆ–è¿›ç¨‹èƒ½å¤Ÿç‹¬ç«‹è¿è¡Œè€Œä¸å—å…¶ä»–è®¾å¤‡æˆ–è¿›ç¨‹çš„é˜»ç¢ã€‚è¦ä½¿ç¼“å†²åŒºæœ‰æ•ˆå·¥ä½œï¼Œè®¾è®¡è€…éœ€è€ƒè™‘ç¼“å†²åŒºå¤§å°ä»¥åŠæ•°æ®è¿›å‡ºç¼“å†²åŒºçš„ç®—æ³•ã€‚ä¸ç¼“å­˜ç±»ä¼¼ï¼Œç¼“å†²åŒºæ˜¯â€œä¸­é—´å­˜å‚¨ç‚¹â€ï¼Œä½†å…¶å­˜åœ¨æ„ä¹‰æ›´å¤šåœ¨äºåè°ƒç‹¬ç«‹æ´»åŠ¨ï¼Œè€ŒéåŠ é€Ÿå•ä¸€æ“ä½œçš„é€Ÿåº¦ã€‚</p><h2 id="Unit2"><a href="#Unit2" class="headerlink" title="Unit2"></a>Unit2</h2><h3 id="Notes-1"><a href="#Notes-1" class="headerlink" title="Notes"></a>Notes</h3><ol><li>A cathode ray tube (CRT) displays a picture by displaying a plurality of pixels on a screen using electric charges which are discharged from a cathode ray tube and impact a fluorescent plate.<ul><li>é˜´æå°„çº¿ç®¡ï¼ˆCRTï¼‰é€šè¿‡åœ¨å±å¹•ä¸Šæ˜¾ç¤ºå¤šä¸ªåƒç´ æ¥æ˜¾ç¤ºå›¾åƒï¼Œè¿™äº›åƒç´ æ˜¯é€šè¿‡ä»é˜´æå°„çº¿ç®¡é‡Šæ”¾çš„ç”µè·å†²å‡»è§å…‰æ¿å®ç°çš„ã€‚</li></ul></li><li>However, CRT monitors are large and bulky due to the large vacuum tubes that enclose the cathode and extend from the cathode to the faceplate of the display.<ul><li>ç„¶è€Œï¼Œç”±äºåŒ…è£¹é˜´æå¹¶å»¶ä¼¸åˆ°æ˜¾ç¤ºé¢æ¿çš„å¤§å‹çœŸç©ºç®¡ï¼ŒCRTæ˜¾ç¤ºå™¨ä½“ç§¯åºå¤§ä¸”ç¬¨é‡ã€‚ </li></ul></li><li>An inkjet printer is a printer in which an image is formed on a recording medium by jetting ink droplets onto the recording medium from at least one ink cartridge mounted in a carrier that reciprocates perpendicularly to the transfer direction of the recording medium.<ul><li>å–·å¢¨æ‰“å°æœºæ˜¯ä¸€ç§æ‰“å°æœºï¼Œå…¶é€šè¿‡å°†å¢¨æ»´ä»å®‰è£…åœ¨è½½ä½“ä¸Šçš„è‡³å°‘ä¸€ä¸ªå¢¨ç›’å–·å°„åˆ°è®°å½•ä»‹è´¨ä¸Šæ¥åœ¨è®°å½•ä»‹è´¨ä¸Šå½¢æˆå›¾åƒï¼Œè¯¥è½½ä½“æ²¿å‚ç›´äºè®°å½•ä»‹è´¨ä¼ è¾“æ–¹å‘çš„æ–¹å‘å¾€å¤è¿åŠ¨ã€‚</li></ul></li><li>Computer systems are generally designed to include an input/output (I/O) bus coupled to one or more connectors or slots to allow the computer system to be upgraded by adding optional capabilities.<ul><li>è®¡ç®—æœºç³»ç»Ÿé€šå¸¸è®¾è®¡ä¸ºåŒ…å«ä¸€æ ¹è¾“å…¥/è¾“å‡º (I/O) æ€»çº¿ï¼Œè¯¥æ€»çº¿è¿æ¥è‡³ä¸€ä¸ªæˆ–å¤šä¸ªè¿æ¥å™¨æˆ–æ’æ§½ï¼Œä»¥ä¾¿ç³»ç»Ÿå¯ä»¥é€šè¿‡æ·»åŠ å¯é€‰åŠŸèƒ½æ¥å‡çº§ã€‚</li></ul></li><li>The NIC accesses an Ethernet using a unique media access control (MAC) address allocated in a manufacturing stage while a host has its own Internet Protocol (IP) address corresponding to a hostname.<ul><li>ç½‘ç»œæ¥å£å¡ï¼ˆNICï¼‰é€šè¿‡åˆ¶é€ é˜¶æ®µåˆ†é…çš„å”¯ä¸€åª’ä½“è®¿é—®æ§åˆ¶ï¼ˆMACï¼‰åœ°å€è®¿é—®ä»¥å¤ªç½‘ï¼Œè€Œä¸»æœºåˆ™æ‹¥æœ‰ä¸ä¸»æœºåå¯¹åº”çš„äº’è”ç½‘åè®®ï¼ˆIPï¼‰åœ°å€ã€‚</li></ul></li></ol><h3 id="Ex-2-1"><a href="#Ex-2-1" class="headerlink" title="Ex.2"></a>Ex.2</h3><ol><li><strong>monitor</strong>: The phosphorescent surface on which an image is displayed, as on a television, computer monitor, or radar receiver.</li><li><strong>operating system</strong>: A program that observes, supervises, or controls the activities of other programs.</li><li><strong>pixel</strong>: The smallest image-forming unit of a video display.</li><li><strong>cathode</strong>(1): A negatively charged electrode, as of an electrolytic cell, a storage battery, or an electron tube.</li><li><strong>faceplate</strong>(1): The glass front of a cathode-ray tube upon which the image is displayed.</li><li><strong>voltage</strong>(1): Electromotive force or potential difference, usually expressed in volts.</li><li><strong>reciprocate</strong>(1): To move back and forth alternately.</li><li><strong>continuous</strong>: Uninterrupted in time, sequence, substance, or extent.</li><li><strong>resolution</strong>(1): The fineness of detail that can be distinguished in an image, as on a video display terminal.</li><li><strong>character</strong>: One of a set of symbols, such as letters or numbers, that are arranged to express information.</li></ol><hr><ol><li><strong>æ˜¾ç¤ºå™¨</strong>ï¼šç”¨äºæ˜¾ç¤ºå›¾åƒçš„å‘å…‰è¡¨é¢ï¼Œå¦‚ç”µè§†æœºã€è®¡ç®—æœºæ˜¾ç¤ºå™¨æˆ–é›·è¾¾æ¥æ”¶å™¨ä¸Šçš„å±å¹•ã€‚</li><li><strong>æ“ä½œç³»ç»Ÿ</strong>ï¼šç”¨äºè§‚å¯Ÿã€ç›‘ç£æˆ–æ§åˆ¶å…¶ä»–ç¨‹åºæ´»åŠ¨çš„ç¨‹åºã€‚</li><li><strong>åƒç´ </strong>ï¼šè§†é¢‘æ˜¾ç¤ºå™¨ä¸­æœ€å°çš„æˆåƒå•å…ƒã€‚</li><li><strong>é˜´æ</strong>ï¼šå¸¦è´Ÿç”µçš„ç”µæï¼Œå¦‚ç”µè§£æ± ã€è“„ç”µæ± æˆ–ç”µå­ç®¡ä¸­çš„ç”µæã€‚</li><li><strong>é¢æ¿</strong>ï¼šé˜´æå°„çº¿ç®¡ä¸Šç”¨äºæ˜¾ç¤ºå›¾åƒçš„ç»ç’ƒå‰æ¿ã€‚</li><li><strong>ç”µå‹</strong>ï¼šç”µåŠ¨åŠ¿æˆ–ç”µä½å·®ï¼Œé€šå¸¸ä»¥ä¼ç‰¹ä¸ºå•ä½è¡¨ç¤ºã€‚</li><li><strong>å¾€å¤è¿åŠ¨</strong>ï¼šäº¤æ›¿åœ°æ¥å›ç§»åŠ¨ã€‚</li><li><strong>è¿ç»­çš„</strong>ï¼šåœ¨æ—¶é—´ã€é¡ºåºã€å®è´¨æˆ–èŒƒå›´ä¸Šä¸é—´æ–­çš„ã€‚</li><li><strong>åˆ†è¾¨ç‡</strong>ï¼šå›¾åƒä¸­å¯è¾¨åˆ«çš„ç»†èŠ‚ç²¾ç»†ç¨‹åº¦ï¼Œå¦‚è§†é¢‘æ˜¾ç¤ºç»ˆç«¯çš„æ˜¾ç¤ºç²¾åº¦ã€‚</li><li><strong>å­—ç¬¦</strong>ï¼šç”¨äºè¡¨è¾¾ä¿¡æ¯çš„ç¬¦å·é›†åˆä¸­çš„å•ä¸ªå•ä½ï¼Œå¦‚å­—æ¯æˆ–æ•°å­—ã€‚</li></ol><h3 id="Ex-4-1"><a href="#Ex-4-1" class="headerlink" title="Ex.4"></a>Ex.4</h3><ol><li>Insufficient <u>memory</u> can cause a processor to work at 50% or even more below its performance potential.</li><li>The <u>virus</u> in E-mail messages has affected almost every computer around the world and has caused the damage of up to US$1 billion in North America.</li><li>One of the basic rules of computer security is to change your <u>password</u> regularly.</li><li>One of the greatest features of a home <u>network</u> is the ability to share one Internet connection simultaneously over two or more computers.</li><li>The usual address for a Web site is the page address, although you can enter <u>host</u>.</li></ol><hr><ol><li>å†…å­˜ä¸è¶³å¯èƒ½å¯¼è‡´å¤„ç†å™¨æ€§èƒ½å‘æŒ¥ä¸è¶³ï¼Œè¿è¡Œæ•ˆç‡ç”šè‡³å¯èƒ½ä½äºå…¶æ½œåœ¨æ€§èƒ½çš„50%ã€‚</li><li>ç”µå­é‚®ä»¶ä¸­çš„ç—…æ¯’å·²å½±å“å…¨çƒå‡ ä¹æ‰€æœ‰è®¡ç®—æœºï¼Œåœ¨åŒ—ç¾åœ°åŒºé€ æˆçš„æŸå¤±é«˜è¾¾10äº¿ç¾å…ƒã€‚</li><li>è®¡ç®—æœºå®‰å…¨çš„åŸºæœ¬è§„åˆ™ä¹‹ä¸€æ˜¯å®šæœŸæ›´æ”¹å¯†ç ã€‚</li><li>å®¶åº­ç½‘ç»œæœ€çªå‡ºçš„ä¼˜åŠ¿åœ¨äºèƒ½è®©ä¸¤å°æˆ–æ›´å¤šè®¡ç®—æœºå…±äº«åŒä¸€äº’è”ç½‘è¿æ¥ã€‚</li><li>ç½‘ç«™é€šå¸¸é€šè¿‡é¡µé¢åœ°å€è®¿é—®ï¼Œä½†ä¹Ÿå¯è¾“å…¥ä¸»æœºåã€‚</li></ol><h3 id="Ex-5-1"><a href="#Ex-5-1" class="headerlink" title="Ex.5"></a>Ex.5</h3><p>Similar to CD-R, the CD-RWâ€™s polycarbonate substrate is preformed with a spiral groove to guide  <u>laser</u>. The alloy phase-change recording layer, which is commonly a  <u>mix</u> of silver, indium, antimony, and tellurium, is sandwiched between two  <u>layers</u> of dielectric material that draw excess  <u>heat</u> from the recording layer.After heating to one particular temperature, the alloy will become crystalline when it is  <u>cooled</u>; after heating to a higher temperature it will  <u>become</u> amorphous (wonâ€™t hold its shape) when it is cooled. By  <u>controlling</u> the temperature of the laser, crystalline areas and non-crystalline areas are formed.The crystalline areas will  <u>reflect</u> the laser, while the other areas will  <u>absorb</u> it. The differences will register as  <u>digital</u> data that can be unencoded for playback.To erase or write over recorded data, the higher temperature laser is used, which  <u>results</u> in the non-crystalline form, which can then be  <u>reformed</u> by the lower temperature laser.</p><p>ä¸CD-Rç±»ä¼¼ï¼ŒCD-RWçš„èšç¢³é…¸é…¯åŸºæ¿é¢„å…ˆå‹åˆ¶æˆèºæ—‹æ²Ÿæ§½ä»¥å¼•å¯¼æ¿€å…‰ã€‚ç›¸å˜è®°å½•å±‚é€šå¸¸ç”±é“¶ã€é“Ÿã€é”‘å’Œç¢²çš„æ··åˆç‰©æ„æˆï¼Œè¢«å¤¹åœ¨ä¸¤å±‚ä»‹ç”µææ–™ä¹‹é—´ï¼Œè¿™äº›ä»‹ç”µææ–™èƒ½ä»è®°å½•å±‚ä¸­å¸æ”¶å¤šä½™çš„çƒ­é‡ã€‚å½“åŠ çƒ­è‡³ç‰¹å®šæ¸©åº¦åå†·å´æ—¶ï¼Œåˆé‡‘ä¼šå½¢æˆæ™¶æ€ï¼›è‹¥åŠ çƒ­è‡³æ›´é«˜æ¸©åº¦å†å†·å´ï¼Œåˆ™ä¼šå½¢æˆéæ™¶æ€ï¼ˆæ— æ³•ä¿æŒå½¢çŠ¶ï¼‰ã€‚é€šè¿‡æ§åˆ¶æ¿€å…‰æ¸©åº¦ï¼Œå¯å½¢æˆæ™¶æ€åŒºåŸŸä¸éæ™¶æ€åŒºåŸŸã€‚æ™¶ä½“åŒºåŸŸå°†åå°„æ¿€å…‰ï¼Œå…¶ä½™åŒºåŸŸåˆ™å¸æ”¶æ¿€å…‰ã€‚è¿™ç§å·®å¼‚å°†è½¬åŒ–ä¸ºæ•°å­—æ•°æ®ï¼Œå¯è§£ç åè¿›è¡Œæ’­æ”¾ã€‚è¦æ“¦é™¤æˆ–è¦†ç›–å·²è®°å½•æ•°æ®æ—¶ï¼Œéœ€ä½¿ç”¨é«˜æ¸©æ¿€å…‰ä½¿ææ–™è½¬å˜ä¸ºéæ™¶æ€ï¼Œéšåå†ç”¨ä½æ¸©æ¿€å…‰å°†å…¶é‡æ–°å¡‘é€ æˆæ™¶ä½“å½¢æ€ã€‚</p><h2 id="Unit3"><a href="#Unit3" class="headerlink" title="Unit3"></a>Unit3</h2><h3 id="Notes-2"><a href="#Notes-2" class="headerlink" title="Notes"></a>Notes</h3><ol><li>Computer software, consisting of programs, enables a computer to perform specific tasks, as opposed to its physical components (hardware) which can only do the tasks they are machanically designed for.<ul><li>è®¡ç®—æœºè½¯ä»¶ç”±ç¨‹åºç»„æˆï¼Œä½¿è®¡ç®—æœºèƒ½å¤Ÿæ‰§è¡Œç‰¹å®šä»»åŠ¡ï¼Œè€Œå…¶ç‰©ç†ç»„ä»¶ï¼ˆç¡¬ä»¶ï¼‰åªèƒ½æ‰§è¡Œå…¶æœºæ¢°è®¾è®¡æ‰€èƒ½å®Œæˆçš„ä»»åŠ¡ã€‚</li></ul></li><li>Computer software is so called in contrast to computer hardware, which encompasses the physical interconnections and devices required to store and run the software.<ul><li>è®¡ç®—æœºè½¯ä»¶ä¹‹æ‰€ä»¥è¢«ç§°ä¸ºè½¯ä»¶ï¼Œæ˜¯ä¸ºäº†ä¸è®¡ç®—æœºç¡¬ä»¶å½¢æˆå¯¹æ¯”ï¼Œåè€…åŒ…æ‹¬å­˜å‚¨å’Œè¿è¡Œè½¯ä»¶æ‰€éœ€çš„ç‰©ç†äº’è¿å’Œè®¾å¤‡ã€‚</li></ul></li><li>People who use modern general-purpose computers (as opposed to embedded systems, analog computers, supercomputers, etc.) usually see three layers of software performing a variety of tasks: platform, application, and user software.<ul><li>ä½¿ç”¨ç°ä»£é€šç”¨è®¡ç®—æœºï¼ˆä¸åµŒå…¥å¼ç³»ç»Ÿã€æ¨¡æ‹Ÿè®¡ç®—æœºã€è¶…çº§è®¡ç®—æœºç­‰ç›¸å¯¹ï¼‰çš„äººä»¬é€šå¸¸ä¼šçœ‹åˆ°ä¸‰å±‚è½¯ä»¶æ‰§è¡Œå„ç§ä»»åŠ¡ï¼šå¹³å°è½¯ä»¶ã€åº”ç”¨è½¯ä»¶å’Œç”¨æˆ·è½¯ä»¶ã€‚</li></ul></li><li>Depending on how competently the user-written software has been integrated into purchased application packages, many users may not be aware of the distinction between the purchased packages, and what has been added by fellow co-workers.<ul><li>æ ¹æ®ç”¨æˆ·ç¼–å†™çš„è½¯ä»¶ä¸è´­ä¹°çš„åº”ç”¨ç¨‹åºåŒ…é›†æˆçš„å®Œå–„ç¨‹åº¦ï¼Œè®¸å¤šç”¨æˆ·å¯èƒ½å¹¶ä¸æ¸…æ¥šè´­ä¹°çš„è½¯ä»¶åŒ…ä¸åŒäº‹æ·»åŠ çš„è½¯ä»¶ä¹‹é—´çš„å·®å¼‚ã€‚</li></ul></li><li>In this case, a conditional instruction is executed to copy text from data in a â€œdocumentâ€ area residing in memory, perhaps to an intermediate storage area known as a â€œclipboardâ€ area.<ul><li>åœ¨æ­¤æƒ…å†µä¸‹ï¼Œå°†æ‰§è¡Œä¸€æ¡æ¡ä»¶æŒ‡ä»¤ï¼Œç”¨äºå°†å­˜å‚¨åœ¨å†…å­˜ä¸­â€œæ–‡æ¡£â€åŒºåŸŸçš„æ•°æ®æ–‡æœ¬å¤åˆ¶åˆ°ä¸€ä¸ªç§°ä¸ºâ€œå‰ªè´´æ¿â€çš„ä¸­é—´å­˜å‚¨åŒºåŸŸã€‚</li></ul></li></ol><h3 id="Ex-2-2"><a href="#Ex-2-2" class="headerlink" title="Ex.2"></a>Ex.2</h3><ol><li><strong>load</strong>: To transfer (data) from a storage device into a computerâ€™s memory.</li><li><strong>compile</strong>: To translate (a program) into machine language.</li><li><strong>value</strong>: An assigned or calculated numerical quantity.</li><li><strong>instruction</strong>: A machine code telling a computer to perform a particular operation</li><li><strong>interpret</strong>: To translate a statement or instruction into executable form and then execute it.</li><li><strong>alphabet</strong>: The letters of a language, arranged in the order fixed by custom.</li><li><strong>compiler</strong>(1): A program operating on symbolic input data to produce the equivalent executable machine code.</li><li><strong>utility</strong>(1): A program designed to perform a particular function; the term usually refers to software that solves narrowly focused problems or those related to computer system management.</li><li><strong>communication</strong>: The technology employed in transmitting messages.</li><li><strong>programmer</strong>: One who writes computer programs.</li></ol><hr><ol><li><strong>åŠ è½½</strong>ï¼šå°†ï¼ˆæ•°æ®ï¼‰ä»å­˜å‚¨è®¾å¤‡ä¼ è¾“åˆ°è®¡ç®—æœºå†…å­˜ä¸­ã€‚</li><li><strong>ç¼–è¯‘</strong>ï¼šå°†ï¼ˆç¨‹åºï¼‰è½¬æ¢ä¸ºæœºå™¨è¯­è¨€ã€‚</li><li><strong>å€¼</strong>ï¼šè¢«èµ‹å€¼æˆ–è®¡ç®—å¾—å‡ºçš„æ•°å€¼ã€‚</li><li><strong>æŒ‡ä»¤</strong>ï¼šæŒ‡ç¤ºè®¡ç®—æœºæ‰§è¡Œç‰¹å®šæ“ä½œçš„æœºå™¨ä»£ç ã€‚</li><li><strong>è§£é‡Š</strong>ï¼šå°†è¯­å¥æˆ–æŒ‡ä»¤è½¬æ¢ä¸ºå¯æ‰§è¡Œå½¢å¼åæ‰§è¡Œã€‚</li><li><strong>å­—æ¯è¡¨</strong>ï¼šæŒ‰çº¦å®šé¡ºåºæ’åˆ—çš„è¯­è¨€å­—æ¯ã€‚</li><li><strong>ç¼–è¯‘å™¨</strong>ï¼šå¤„ç†ç¬¦å·åŒ–è¾“å…¥æ•°æ®ä»¥ç”Ÿæˆç­‰æ•ˆå¯æ‰§è¡Œæœºå™¨ç çš„ç¨‹åºã€‚</li><li><strong>å®ç”¨ç¨‹åº</strong>ï¼šä¸“ä¸ºç‰¹å®šåŠŸèƒ½è®¾è®¡çš„ç¨‹åºï¼›é€šå¸¸æŒ‡è§£å†³çª„é¢†åŸŸé—®é¢˜æˆ–è®¡ç®—æœºç³»ç»Ÿç®¡ç†ç›¸å…³é—®é¢˜çš„è½¯ä»¶ã€‚</li><li><strong>é€šä¿¡</strong>ï¼šç”¨äºä¼ è¾“ä¿¡æ¯çš„ç§‘æŠ€æ‰‹æ®µã€‚</li><li><strong>ç¨‹åºå‘˜</strong>ï¼šç¼–å†™è®¡ç®—æœºç¨‹åºçš„äººå‘˜ã€‚</li></ol><h3 id="Ex-4-2"><a href="#Ex-4-2" class="headerlink" title="Ex.4"></a>Ex.4</h3><ol><li><strong>overflow</strong>: An error can be caused by attempting to divide by 0.</li><li><strong>debug</strong>: The process of identifying and correcting errors in a program.</li><li><strong>database</strong>: A collection of related information, organized for easy retrieval.</li><li><strong>buffer</strong>: A location where data can be temporarily stored.</li><li><strong>tool bar</strong>: A graphical bar with buttons that perform some of the most common commands.</li><li>Every valid character in a computer that uses even <strong>parity</strong> must always have an even number of 1 bits.</li><li>The maximum number of data that can be expressed by 8 bits is <strong>255</strong>.</li><li>Integration <strong>testing</strong> is the process of verifying that the components of a system work together as described in the program design and system design specifications.</li><li>GIF files are limited to a maximum of 8 bits/pixel, it simply means that no more than 256 colors are allowed in <strong>an image</strong>.</li><li>Computer <strong>network</strong> is a complex consisting of two or more connected computing units, it is used for the purpose of data communication and resource sharing.</li></ol><hr><ol><li><strong>æº¢å‡º</strong>ï¼šå°è¯•é™¤ä»¥é›¶å¯èƒ½å¯¼è‡´é”™è¯¯ã€‚</li><li><strong>è°ƒè¯•</strong>ï¼šè¯†åˆ«å¹¶ä¿®æ­£ç¨‹åºä¸­é”™è¯¯çš„è¿‡ç¨‹ã€‚</li><li><strong>æ•°æ®åº“</strong>ï¼šä¸ºä¾¿äºæ£€ç´¢è€Œç»„ç»‡çš„ç›¸å…³ä¿¡æ¯é›†åˆã€‚</li><li><strong>ç¼“å†²åŒº</strong>ï¼šå¯ä¸´æ—¶å­˜å‚¨æ•°æ®çš„ä½ç½®ã€‚</li><li><strong>å·¥å…·æ </strong>ï¼šå¸¦æœ‰æŒ‰é’®çš„å›¾å½¢åŒ–å·¥å…·æ¡ï¼Œç”¨äºæ‰§è¡Œå¸¸ç”¨å‘½ä»¤ã€‚</li><li>åœ¨é‡‡ç”¨å¶æ ¡éªŒçš„è®¡ç®—æœºä¸­ï¼Œæ¯ä¸ªæœ‰æ•ˆå­—ç¬¦å¿…é¡»åŒ…å«å¶æ•°ä¸ª1ä½ã€‚</li><li>8ä½æ•°æ®èƒ½è¡¨ç¤ºçš„æœ€å¤§å€¼ä¸º<strong>255</strong>ã€‚</li><li>é›†æˆ<strong>æµ‹è¯•</strong>æ˜¯éªŒè¯ç³»ç»Ÿå„ç»„ä»¶èƒ½å¦æŒ‰ç¨‹åºè®¾è®¡ä¸ç³»ç»Ÿè®¾è®¡è§„èŒƒååŒå·¥ä½œçš„è¿‡ç¨‹ã€‚</li><li>GIFæ–‡ä»¶æ¯åƒç´ æœ€å¤šæ”¯æŒ8ä½ï¼Œè¿™æ„å‘³ç€<strong>å›¾åƒ</strong>ä¸­å…è®¸ä½¿ç”¨çš„é¢œè‰²ä¸è¶…è¿‡256ç§ã€‚</li><li>è®¡ç®—æœº<strong>ç½‘ç»œ</strong>æ˜¯ç”±ä¸¤ä¸ªæˆ–å¤šä¸ªäº’è”è®¡ç®—å•å…ƒç»„æˆçš„å¤æ‚ç³»ç»Ÿï¼Œç”¨äºæ•°æ®é€šä¿¡å’Œèµ„æºå…±äº«ã€‚</li></ol><h3 id="Ex-5-2"><a href="#Ex-5-2" class="headerlink" title="Ex.5"></a>Ex.5</h3><p>In data processing, using an office metaphor, a file is a  <u>related</u> collection of records. For example, you might put the records you have on each of your  <u>customers</u> in a file. In turn, each record would consist of  <u>fields</u> for individual data items, such as customer name, customer number, customer address, and so forth. By providing the same  <u>information</u> in the same fields in each record (so that all records are consistent), your file will be easily  <u>accessible</u> for analysis and manipulation by a computer program. This use of the term has become somewhat less important with the advent of the database and its  <u>emphasis</u> on the table as a way of collecting record and field data. In  <u>main</u> frame systems, the term data set is generally synonymous with file but  <u>implies</u> a specific form of organization recognized by a particular access  <u>method</u>. Depending on the operating system, files (and data sets) are contained within a catalog,  <u>directory</u>, or folder.</p><p>åœ¨æ•°æ®å¤„ç†ä¸­ï¼Œå¦‚æœä½¿ç”¨åŠå…¬å®¤çš„æ¯”å–»ï¼Œä¸€ä¸ªæ–‡ä»¶ (file) å°±æ˜¯ä¸€ç»„ç›¸å…³çš„ (related) è®°å½•çš„é›†åˆã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æŠŠä½ å…³äºæ¯ä¸ªå®¢æˆ· (customers) çš„è®°å½•éƒ½æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚åè¿‡æ¥ï¼Œæ¯æ¡è®°å½• (record) éƒ½å°†ç”±ç”¨äºå•ä¸ªæ•°æ®é¡¹çš„å­—æ®µ (fields) ç»„æˆï¼Œæ¯”å¦‚å®¢æˆ·å§“åã€å®¢æˆ·ç¼–å·ã€å®¢æˆ·åœ°å€ç­‰ç­‰ã€‚é€šè¿‡åœ¨æ¯æ¡è®°å½•çš„ç›¸åŒå­—æ®µä¸­æä¾›ç›¸åŒçš„ä¿¡æ¯ (information)ï¼ˆä»¥ä¾¿æ‰€æœ‰è®°å½•ä¿æŒä¸€è‡´ï¼‰ï¼Œä½ çš„æ–‡ä»¶å°†å¾ˆå®¹æ˜“è¢«è®¡ç®—æœºç¨‹åºè®¿é—® (accessible) è¿›è¡Œåˆ†æå’Œæ“ä½œã€‚éšç€æ•°æ®åº“çš„å‡ºç°ï¼Œè¿™ç§æœ¯è¯­çš„ç”¨æ³•å·²ç»å˜å¾—ä¸é‚£ä¹ˆé‡è¦äº†ï¼Œå› ä¸ºæ•°æ®åº“ä¾§é‡ (emphasis) äºå°†â€œè¡¨â€ä½œä¸ºæ”¶é›†è®°å½•å’Œå­—æ®µæ•°æ®çš„æ–¹å¼ã€‚åœ¨å¤§å‹æœº (main frame) ç³»ç»Ÿä¸­ï¼Œâ€œæ•°æ®é›† (data set)â€ä¸€è¯é€šå¸¸ä¸â€œæ–‡ä»¶â€åŒä¹‰ï¼Œä½†å®ƒæš—ç¤º (implies) ç€ç”±ç‰¹å®šçš„è®¿é—®æ–¹æ³• (method) æ‰€è¯†åˆ«çš„ç‰¹å®šç»„ç»‡å½¢å¼ã€‚æ ¹æ®æ“ä½œç³»ç»Ÿçš„ä¸åŒï¼Œæ–‡ä»¶ï¼ˆå’Œæ•°æ®é›†ï¼‰é€šå¸¸åŒ…å«åœ¨ä¸€ä¸ªç›®å½•ï¼ˆcatalogï¼‰ã€ç›®å½• (directory) æˆ–æ–‡ä»¶å¤¹ï¼ˆfolderï¼‰ä¸­ã€‚</p><h2 id="Unit4"><a href="#Unit4" class="headerlink" title="Unit4"></a>Unit4</h2><h3 id="Notes-3"><a href="#Notes-3" class="headerlink" title="Notes"></a>Notes</h3><ol><li>It(driver) translates commands from the operating system or user into commands understood by the component part it interfaces with.<ul><li>å®ƒå°†æ¥è‡ªæ“ä½œç³»ç»Ÿæˆ–ç”¨æˆ·çš„å‘½ä»¤è½¬æ¢ä¸ºä¸å…¶æ¥å£çš„ç»„ä»¶éƒ¨åˆ†æ‰€ç†è§£çš„å‘½ä»¤ã€‚</li></ul></li><li>The operating system makes these interfacing functions along with its other functions operate smoothly and these functions are mostly transparent to the user.<ul><li>æ“ä½œç³»ç»Ÿä½¿è¿™äº›æ¥å£åŠŸèƒ½ä¸å…¶å…¶ä»–åŠŸèƒ½é¡ºåˆ©è¿è¡Œï¼Œè¿™äº›åŠŸèƒ½å¯¹ç”¨æˆ·æ¥è¯´å¤§å¤šæ˜¯é€æ˜çš„ã€‚</li></ul></li><li>These can happen due to a software bug tipically in the operating system, although computer programs being run on the operating system can make the system unstable or may even crash the system by themselves.<ul><li>è¿™äº›é—®é¢˜é€šå¸¸æ˜¯ç”±äºæ“ä½œç³»ç»Ÿä¸­çš„è½¯ä»¶æ¼æ´å¼•èµ·çš„ï¼Œå°½ç®¡åœ¨æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œçš„è®¡ç®—æœºç¨‹åºä¹Ÿå¯èƒ½ä½¿ç³»ç»Ÿä¸ç¨³å®šï¼Œç”šè‡³å¯¼è‡´ç³»ç»Ÿå´©æºƒã€‚</li></ul></li><li>When a single program is allowed to run at a time, the system is grouped under the single-tasking system category, while in case the operating system allows for execution of multiple tasks at a time, it is classified as a multi-tasking operating system.<ul><li>å½“ç³»ç»Ÿä»…å…è®¸å•ä¸ªç¨‹åºåŒæ—¶è¿è¡Œæ—¶ï¼Œè¯¥ç³»ç»Ÿè¢«å½’ç±»ä¸ºå•ä»»åŠ¡ç³»ç»Ÿï¼›è€Œå½“æ“ä½œç³»ç»Ÿå…è®¸åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡æ—¶ï¼Œåˆ™è¢«å½’ç±»ä¸ºå¤šä»»åŠ¡æ“ä½œç³»ç»Ÿã€‚</li></ul></li><li>An operating system that manages a group of independent computers and makes them appear to be a single computer is known as a distributed operating system.<ul><li>èƒ½å¤Ÿç®¡ç†ä¸€ç»„ç‹¬ç«‹è®¡ç®—æœºå¹¶ä½¿å®ƒä»¬å‘ˆç°ä¸ºå•ä¸€è®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿç§°ä¸ºåˆ†å¸ƒå¼æ“ä½œç³»ç»Ÿã€‚</li></ul></li></ol><h3 id="Ex-2-3"><a href="#Ex-2-3" class="headerlink" title="Ex.2"></a>Ex.2</h3><ol><li><strong>install</strong>: To set in place and prepare for operation.</li><li><strong>command</strong>: A signal that initiates an operation defined by an instruction.</li><li><strong>translate</strong>: In programming, to convert program from one language to another.</li><li><strong>mistake</strong>: An error or a fault resulting from defective judgement, deficient knowledge, or carelessness.</li><li><strong>release</strong>: A particular version of a piece of software, most commonly associated with the most recent version.</li><li><strong>control</strong>(1): The management of a computer and its processing abilities so as to maintain order as tasks and activities are carried out.</li><li><strong>crash</strong>(1): For a system or program, to fail to function correctly resulting in the suspension of operation.</li><li><strong>instability</strong>(1): The quality or condition of being erratic or undependable.</li><li><strong>reboot</strong>: To turn a computer off and then on again; restart the operating system.</li><li><strong>workstation</strong>: A combination of input, output, and computing hardware that can be used for work by an individual.</li></ol><hr><ol><li><strong>å®‰è£…</strong>ï¼šå°†è®¾å¤‡å®‰ç½®åˆ°ä½å¹¶å‡†å¤‡æŠ•å…¥è¿è¡Œã€‚</li><li><strong>æŒ‡ä»¤</strong>ï¼šè§¦å‘ç‰¹å®šæ“ä½œçš„ä¿¡å·ï¼Œç”±ç¨‹åºæŒ‡ä»¤å®šä¹‰ã€‚</li><li><strong>ç¼–è¯‘</strong>ï¼šåœ¨ç¼–ç¨‹ä¸­ï¼Œå°†ç¨‹åºä»ä¸€ç§è¯­è¨€è½¬æ¢ä¸ºå¦ä¸€ç§è¯­è¨€çš„è¿‡ç¨‹ã€‚</li><li><strong>é”™è¯¯</strong>ï¼šå› åˆ¤æ–­å¤±è¯¯ã€çŸ¥è¯†ä¸è¶³æˆ–ç–å¿½å¤§æ„å¯¼è‡´çš„å¤±è¯¯æˆ–æ•…éšœã€‚</li><li><strong>å‘å¸ƒ</strong>ï¼šè½¯ä»¶çš„ç‰¹å®šç‰ˆæœ¬ï¼Œé€šå¸¸æŒ‡æœ€æ–°ç‰ˆæœ¬ã€‚</li><li><strong>æ§åˆ¶</strong>ï¼šç®¡ç†è®¡ç®—æœºåŠå…¶å¤„ç†èƒ½åŠ›ï¼Œä»¥ç¡®ä¿ä»»åŠ¡å’Œæ´»åŠ¨æœ‰åºæ‰§è¡Œã€‚</li><li><strong>å´©æºƒ</strong>ï¼šç³»ç»Ÿæˆ–ç¨‹åºè¿è¡Œå¼‚å¸¸å¯¼è‡´åŠŸèƒ½å¤±æ•ˆï¼Œæ“ä½œè¢«è¿«ä¸­æ–­ã€‚</li><li><strong>ä¸ç¨³å®šæ€§</strong>ï¼šè¡¨ç°ä¸ºåå¤æ— å¸¸æˆ–ä¸å¯é çš„ç‰¹æ€§æˆ–çŠ¶æ€ã€‚</li><li><strong>é‡å¯</strong>ï¼šå…³é—­è®¡ç®—æœºåé‡æ–°å¯åŠ¨ï¼›é‡æ–°è¿è¡Œæ“ä½œç³»ç»Ÿã€‚</li><li><strong>å·¥ä½œç«™</strong>ï¼šé›†è¾“å…¥ã€è¾“å‡ºåŠè®¡ç®—ç¡¬ä»¶äºä¸€ä½“ï¼Œä¾›ä¸ªäººå¼€å±•å·¥ä½œçš„è®¾å¤‡ç»„åˆã€‚</li></ol><h3 id="Ex-4-3"><a href="#Ex-4-3" class="headerlink" title="Ex.4"></a>Ex.4</h3><ol><li><strong>Scanner</strong> is a device that converts images to digital format.</li><li>In C language, a <strong>string</strong> is a series of characters enclosed in double quotes.</li><li><strong>Search Engines</strong> are those programs that help find the information you are trying to locate on the WWW.</li><li>In C language, <strong>declarations</strong> are used to create variables and are grouped at the top of a program block.</li><li>An <strong>assignment</strong> statement can perform a calculation and store the result in a variable so that it can be used later.</li><li>Each program module is compiled separately and the resulting <strong>object</strong> files are linked together to make an executable application.</li><li><strong>Standardization</strong> is the conscious effort to make all jobs similar, routine, and interchangeable.</li><li>A Web <strong>browser</strong> is one of many software applications that function as the interface between a user and the Internet.</li><li>Firewall is a <strong>security</strong> mechanism used by organizations to protect their LANs from the Internet.</li><li>A query is used to search through the database to locate a particular record or records, which conform to specifed <strong>criteria</strong>.</li></ol><hr><ol><li><strong>æ‰«æä»ª</strong>æ˜¯ä¸€ç§å°†å›¾åƒè½¬æ¢ä¸ºæ•°å­—æ ¼å¼çš„è®¾å¤‡ã€‚</li><li>åœ¨Cè¯­è¨€ä¸­ï¼Œ<strong>å­—ç¬¦ä¸²</strong>æ˜¯ç”±åŒå¼•å·æ‹¬èµ·çš„å­—ç¬¦åºåˆ—ã€‚</li><li><strong>æœç´¢å¼•æ“</strong>æ˜¯å¸®åŠ©ç”¨æˆ·åœ¨ä¸‡ç»´ç½‘ä¸Šå®šä½æ‰€éœ€ä¿¡æ¯çš„ç¨‹åºã€‚</li><li>åœ¨Cè¯­è¨€ä¸­ï¼Œ<strong>å£°æ˜</strong>ç”¨äºåˆ›å»ºå˜é‡ï¼Œé€šå¸¸é›†ä¸­åœ¨ç¨‹åºå—çš„é¡¶éƒ¨ã€‚</li><li>èµ‹å€¼è¯­å¥å¯æ‰§è¡Œè®¡ç®—å¹¶å°†ç»“æœå­˜å‚¨äºå˜é‡ä¸­ä»¥ä¾¿åç»­ä½¿ç”¨ã€‚</li><li>æ¯ä¸ªç¨‹åºæ¨¡å—ç‹¬ç«‹ç¼–è¯‘åï¼Œç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶ç»é“¾æ¥æ•´åˆå½¢æˆå¯æ‰§è¡Œåº”ç”¨ç¨‹åºã€‚</li><li>æ ‡å‡†åŒ–æ˜¯ä½¿æ‰€æœ‰å·¥ä½œè¶‹äºç›¸ä¼¼ã€å¸¸è§„åŒ–ä¸”å¯äº’æ¢çš„æœ‰æ„è¯†åŠªåŠ›ã€‚</li><li>ç½‘ç»œ<strong>æµè§ˆå™¨</strong>æ˜¯ä¼—å¤šè½¯ä»¶åº”ç”¨ä¹‹ä¸€ï¼Œä½œä¸ºç”¨æˆ·ä¸äº’è”ç½‘ä¹‹é—´çš„äº¤äº’ç•Œé¢ã€‚</li><li>é˜²ç«å¢™æ˜¯ç»„ç»‡ç”¨äºä¿æŠ¤å±€åŸŸç½‘å…å—äº’è”ç½‘å¨èƒçš„<strong>å®‰å…¨</strong>æœºåˆ¶ã€‚</li><li>æŸ¥è¯¢ç”¨äºæœç´¢æ•°æ®åº“ä»¥å®šä½ç¬¦åˆç‰¹å®š<strong>æ¡ä»¶</strong>çš„è®°å½•ã€‚</li></ol><h3 id="Ex-5-3"><a href="#Ex-5-3" class="headerlink" title="Ex.5"></a>Ex.5</h3><p>An operating system (sometimes abbreviated as â€œOSâ€) is the program that, after being initially <u>loaded</u> into the computer by a <u>boot</u> program, manages all the other programs in a computer. The other programs are called <u>applications</u> or application programs. The application programs make <u>use</u> of the operating system by making <u>requests</u> for services through a <u>defined</u> application program interface (API). In addition, users can <u>interact</u> directly with the operating system <u>through</u> a user interface such as a <u>command</u> language or a <u>graphical</u> user interface (GUI).</p><p>æ“ä½œç³»ç»Ÿï¼ˆæœ‰æ—¶ç®€ç§°ä¸ºâ€œOSâ€ï¼‰æ˜¯æŒ‡åœ¨å¯åŠ¨ç¨‹åºå°†å®ƒåˆå§‹åŠ è½½åˆ°è®¡ç®—æœºåï¼Œè´Ÿè´£ç®¡ç†è®¡ç®—æœºä¸­æ‰€æœ‰å…¶ä»–ç¨‹åºçš„ç¨‹åºã€‚è¿™äº›å…¶ä»–ç¨‹åºè¢«ç§°ä¸ºåº”ç”¨æˆ–åº”ç”¨ç¨‹åºã€‚åº”ç”¨ç¨‹åºé€šè¿‡é¢„å®šä¹‰çš„åº”ç”¨ç¨‹åºæ¥å£ï¼ˆAPIï¼‰å‘æ“ä½œç³»ç»Ÿå‘å‡ºæœåŠ¡è¯·æ±‚æ¥åˆ©ç”¨æ“ä½œç³»ç»Ÿã€‚æ­¤å¤–ï¼Œç”¨æˆ·å¯é€šè¿‡å‘½ä»¤è¡Œæˆ–å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰ç­‰ç”¨æˆ·ç•Œé¢ç›´æ¥ä¸æ“ä½œç³»ç»Ÿäº¤äº’ã€‚</p><h2 id="Unit5"><a href="#Unit5" class="headerlink" title="Unit5"></a>Unit5</h2><h3 id="Notes-4"><a href="#Notes-4" class="headerlink" title="Notes"></a>Notes</h3><ol><li>Any data structure is designed to organize data to suit a specific purpose so that it can be accessed and worked with in appropriate ways.<ul><li>è®¾è®¡ä»»ä½•æ•°æ®ç»“æ„çš„ç›®çš„æ˜¯ä¸ºäº†æ»¡è¶³ç‰¹å®šéœ€æ±‚ï¼Œä»è€Œèƒ½å¤Ÿä»¥é€‚å½“çš„æ–¹å¼è®¿é—®å’Œå¤„ç†æ•°æ®ã€‚</li></ul></li><li>In computer programming languages, an array is a group of objects with the same attributes that can be addressed individually, using such techniques as subscripting.<ul><li>åœ¨è®¡ç®—æœºç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæ•°ç»„æ˜¯ä¸€ç»„å…·æœ‰ç›¸åŒå±æ€§çš„å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡ä¸‹æ ‡ç­‰æŠ€æœ¯å•ç‹¬å¯»å€ã€‚</li></ul></li><li>By providing the same information in the same fields in each record so that all records are consistent, your file will be easily accessible for analysis and manipulation by a computer program.<ul><li>é€šè¿‡åœ¨æ¯æ¡è®°å½•çš„ç›¸åŒå­—æ®µä¸­æä¾›ç›¸åŒçš„ä¿¡æ¯ï¼ˆä»¥ä¾¿æ‰€æœ‰è®°å½•ä¿æŒä¸€è‡´ï¼‰ï¼Œä½ çš„æ–‡ä»¶å°†å¾ˆå®¹æ˜“è¢«è®¡ç®—æœºç¨‹åºè®¿é—®è¿›è¡Œåˆ†æå’Œæ“ä½œã€‚</li></ul></li><li>In any computer system but especially in personal computers, a file is an entity of data available to system users (including the system itself and its application programs) that is capable of being manipulated as an entity (for example, moved from one file directory to another).<ul><li>åœ¨ä»»ä½•è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œå°¤å…¶æ˜¯åœ¨ä¸ªäººè®¡ç®—æœºä¸­ï¼Œæ–‡ä»¶æ˜¯ç³»ç»Ÿç”¨æˆ·ï¼ˆåŒ…æ‹¬ç³»ç»Ÿæœ¬èº«åŠå…¶åº”ç”¨ç¨‹åºï¼‰å¯ç”¨çš„æ•°æ®å®ä½“ï¼Œèƒ½å¤Ÿä½œä¸ºä¸€ä¸ªæ•´ä½“è¿›è¡Œæ“ä½œï¼ˆä¾‹å¦‚ï¼Œä»ä¸€ä¸ªæ–‡ä»¶ç›®å½•ç§»åŠ¨åˆ°å¦ä¸€ä¸ªç›®å½•ï¼‰ã€‚</li></ul></li><li>The organization of data in the record is usually prescribed by the programming language that defines the recordâ€™s organization and/or by the application program that processes it.<ul><li>è®°å½•ä¸­æ•°æ®çš„ç»„ç»‡é€šå¸¸ç”±å®šä¹‰è®°å½•ç»„ç»‡çš„ç¼–ç¨‹è¯­è¨€å’Œ/æˆ–å¤„ç†è®°å½•çš„åº”ç”¨ç¨‹åºè§„å®šã€‚</li></ul></li><li>For example, a database for a business would typically contain a table for customer information, which would store customersâ€™ account numbers, addresses, phone numbers, and so on as a series of columns.<ul><li>ä¾‹å¦‚ï¼Œä¼ä¸šæ•°æ®åº“é€šå¸¸åŒ…å«ä¸€ä¸ªå®¢æˆ·ä¿¡æ¯è¡¨ï¼Œè¯¥è¡¨å°†å®¢æˆ·çš„è´¦å·ã€åœ°å€ã€ç”µè¯å·ç ç­‰ä½œä¸ºä¸€ç³»åˆ—çš„åˆ—è¿›è¡Œå­˜å‚¨ã€‚</li></ul></li><li>Fields, in turn, are organized as records, which are complete sets of information about a particular customer, each of which comprises a row.<ul><li>å­—æ®µç»„ç»‡ä¸ºè®°å½•ï¼Œè¿™äº›è®°å½•æ„æˆå…³äºç‰¹å®šå®¢æˆ·çš„å®Œæ•´ä¿¡æ¯é›†ï¼Œæ¯æ¡è®°å½•å¯¹åº”ä¸€è¡Œã€‚</li></ul></li></ol><h3 id="Ex-2-4"><a href="#Ex-2-4" class="headerlink" title="Ex.2"></a>Ex.2</h3><ol><li><strong>interrupt</strong>: a signal to a computer that stops the execution of a running program so that another action can be performed.</li><li><strong>record</strong>: a collection of related, often adjacent items of data, treated as a unit.</li><li><strong>table</strong>: In word processing, a block of text formatted in aligned rows and columns.</li><li><strong>list</strong>: A multi-element data structure that has a linear organization but that allows elements to be added or removed in any order.</li><li><strong>subscript</strong>: A distinguishing character or symbol written directly beneath or next to and slightly below a letter or number.</li><li><strong>suffix</strong>: An affix added to the end of a word or stem.</li><li><strong>define</strong>: To make or write a definition.</li><li><strong>array</strong>: A series of objects placed next to each other, usually in a straight line.</li><li><strong>sector</strong>(1): A bit or a set of bits on a magnetic storage device making up the smallest addressable unit of information.</li><li><strong>sort</strong>: To organize data, typically a set of records, in a particular order.</li></ol><hr><ol><li><strong>ä¸­æ–­</strong>ï¼šå‘è®¡ç®—æœºå‘é€çš„ä¿¡å·ï¼Œç”¨äºåœæ­¢æ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼Œä»¥ä¾¿æ‰§è¡Œå…¶ä»–æ“ä½œã€‚</li><li><strong>è®°å½•</strong>ï¼šä¸€ç»„ç›¸å…³ä¸”é€šå¸¸ç›¸é‚»çš„æ•°æ®é¡¹ï¼Œä½œä¸ºæ•´ä½“å¤„ç†ã€‚</li><li><strong>è¡¨æ ¼</strong>ï¼šåœ¨æ–‡å­—å¤„ç†ä¸­ï¼Œä»¥å¯¹é½çš„è¡Œå’Œåˆ—æ ¼å¼åŒ–çš„æ–‡æœ¬å—ã€‚</li><li><strong>åˆ—è¡¨</strong>ï¼šå…·æœ‰çº¿æ€§ç»„ç»‡ç»“æ„çš„å¤šå…ƒç´ æ•°æ®ç»“æ„ï¼Œå…è®¸æŒ‰ä»»æ„é¡ºåºæ·»åŠ æˆ–åˆ é™¤å…ƒç´ ã€‚</li><li><strong>ä¸‹æ ‡</strong>ï¼šç›´æ¥ä¹¦å†™åœ¨å­—æ¯æˆ–æ•°å­—ä¸‹æ–¹æˆ–ä¾§é¢ç¨ä½ä½ç½®çš„åŒºåˆ†æ€§å­—ç¬¦æˆ–ç¬¦å·ã€‚</li><li><strong>åç¼€</strong>ï¼šé™„åŠ åœ¨è¯å°¾æˆ–è¯å¹²æœ«ç«¯çš„è¯ç¼€ã€‚</li><li><strong>å®šä¹‰</strong>ï¼šåˆ¶å®šæˆ–æ’°å†™å®šä¹‰çš„è¿‡ç¨‹ã€‚</li><li><strong>æ•°ç»„</strong>ï¼šå¹¶åˆ—æ’åˆ—çš„å¯¹è±¡ç³»åˆ—ï¼Œé€šå¸¸å‘ˆç›´çº¿æ’åˆ—ã€‚</li><li><strong>æ‰‡åŒº</strong>ï¼šç£å­˜å‚¨è®¾å¤‡ä¸Šæ„æˆæœ€å°å¯å¯»å€ä¿¡æ¯å•å…ƒçš„ä½æˆ–ä½é›†åˆã€‚</li><li><strong>æ’åº</strong>ï¼šå°†æ•°æ®ï¼ˆé€šå¸¸ä¸ºè®°å½•é›†ï¼‰æŒ‰ç‰¹å®šé¡ºåºç»„ç»‡çš„è¿‡ç¨‹ã€‚</li></ol><h3 id="Ex-4-4"><a href="#Ex-4-4" class="headerlink" title="Ex.4"></a>Ex.4</h3><ol><li>A sequence of any number of characters enclosed in the double quotes â€œ â€œ is called a <strong>string</strong>.</li><li>In C language, when an array name is passed to a function, what is passed is the <strong>location</strong> of the beginning of the array.</li><li>In C language, the result of the logical <strong>NOT</strong> operator is 1 if the value of its operand is 0, and is 0 if the value of its operand is non-zero.</li><li>A floating constant consists of an integer part, a decimal point, a fraction part, an e or E, and an optionally signed integer <strong>exponent</strong>.</li><li>The <strong>clipboard</strong> is a temporary storage area that you can use to copy or move selected text or object among applications.</li><li>The <strong>source</strong> program means a program written in a high-level language. It is generally translated to an <strong>object</strong> program, which is in a form directly understandable by the computer. The translation is usually done by a program called <strong>compiler</strong>.</li><li><strong>Word</strong> processing offers many ways to edit text and establish document formats. You can easily insert, delete, change, move and copy words or blocks of text.</li><li>â€œScrollingâ€ is a technique most commonly associated with <strong>display</strong>.</li></ol><hr><ol><li>ç”¨åŒå¼•å· â€œ â€ æ‹¬èµ·çš„ä»»æ„æ•°é‡å­—ç¬¦åºåˆ—ç§°ä¸ºå­—ç¬¦ä¸²ã€‚</li><li>åœ¨ C è¯­è¨€ä¸­ï¼Œå½“æ•°ç»„åä¼ é€’ç»™å‡½æ•°æ—¶ï¼Œä¼ é€’çš„æ˜¯æ•°ç»„èµ·å§‹ä½ç½®çš„åœ°å€ã€‚</li><li>åœ¨ C è¯­è¨€ä¸­ï¼Œé€»è¾‘éè¿ç®—ç¬¦çš„ç»“æœä¸ºï¼šå½“æ“ä½œæ•°å€¼ä¸º 0 æ—¶è¿”å› 1ï¼Œå½“æ“ä½œæ•°å€¼éé›¶æ—¶è¿”å› 0ã€‚</li><li>æµ®ç‚¹å¸¸é‡ç”±æ•´æ•°éƒ¨åˆ†ã€å°æ•°ç‚¹ã€å°æ•°éƒ¨åˆ†ã€å­—æ¯eæˆ–Eï¼Œä»¥åŠå¯é€‰çš„å¸¦ç¬¦å·æ•´æ•°æŒ‡æ•°æ„æˆã€‚</li><li>å‰ªè´´æ¿æ˜¯ç”¨äºåœ¨åº”ç”¨ç¨‹åºé—´å¤åˆ¶æˆ–ç§»åŠ¨é€‰å®šæ–‡æœ¬/å¯¹è±¡çš„ä¸´æ—¶å­˜å‚¨åŒºã€‚</li><li>æºç¨‹åºæŒ‡ç”¨é«˜çº§è¯­è¨€ç¼–å†™çš„ç¨‹åºã€‚å®ƒé€šå¸¸ä¼šè¢«ç¼–è¯‘æˆè®¡ç®—æœºå¯ç›´æ¥è¯†åˆ«çš„ç›®æ ‡ç¨‹åºï¼Œæ­¤è¿‡ç¨‹é€šå¸¸ç”±ç¼–è¯‘å™¨å®Œæˆã€‚</li><li>æ–‡å­—å¤„ç†æä¾›å¤šç§ç¼–è¾‘æ–‡æœ¬å’Œè®¾ç½®æ–‡æ¡£æ ¼å¼çš„åŠŸèƒ½ï¼Œå¯è½»æ¾æ’å…¥ã€åˆ é™¤ã€ä¿®æ”¹ã€ç§»åŠ¨åŠå¤åˆ¶å•è¯æˆ–æ–‡æœ¬å—ã€‚</li><li>â€œæ»šåŠ¨â€æ˜¯ä¸æ˜¾ç¤ºæœ€å¯†åˆ‡ç›¸å…³çš„æŠ€æœ¯ã€‚</li></ol><h3 id="Ex-5-4"><a href="#Ex-5-4" class="headerlink" title="Ex.5"></a>Ex.5</h3><p>A binary tree is a method of placing and locating files (called records or keys) in a <u>database</u>, especially when all the data is known to be in <u>random</u> access memory (RAM). The algorithm finds data by repeatedly dividing the number of ultimately accessible <u>records</u> in half until only one remains.In a tree, records are stored in locations called <u>leaves</u>. This name derives from the fact that records always exist at <u>end</u> points; there is nothing <u>beyond</u> them. Branch points are called <u>nodes</u>. The order of a tree is the number of branches (called children) per node. In a binary tree, there are always <u>two</u> children per node, so the order is 2. The number of leaves in a binary tree is always a <u>power</u> of 2. The number of access operations required to reach the desired record is called the <u>depth</u> of the tree.</p><p>äºŒå‰æ ‘æ˜¯ä¸€ç§åœ¨<u>æ•°æ®åº“</u>ä¸­å­˜æ”¾å’Œå®šä½æ–‡ä»¶ï¼ˆç§°ä¸ºè®°å½•æˆ–é”®ï¼‰çš„æ–¹æ³•ï¼Œå°¤å…¶é€‚ç”¨äºæ‰€æœ‰æ•°æ®å‡å­˜å‚¨äº<u>éšæœº</u>å­˜å–å­˜å‚¨å™¨ï¼ˆRAMï¼‰çš„æƒ…å†µã€‚è¯¥ç®—æ³•é€šè¿‡åå¤å°†æœ€ç»ˆå¯è®¿é—®çš„<u>è®°å½•</u>æ•°é‡å‡åŠï¼Œç›´è‡³ä»…å‰©ä¸€æ¡è®°å½•ï¼Œä»è€Œå®ç°æ•°æ®æ£€ç´¢ã€‚åœ¨æ ‘ç»“æ„ä¸­ï¼Œè®°å½•å­˜å‚¨äºç§°ä¸º<u>å¶èŠ‚ç‚¹</u>çš„ä½ç½®ã€‚æ­¤åç§°æºäºè®°å½•å§‹ç»ˆå­˜åœ¨äº<u>æœ«ç«¯</u>ç‚¹çš„äº‹å®â€”â€”å…¶<u>åæ–¹</u>ä¸å­˜åœ¨ä»»ä½•èŠ‚ç‚¹ã€‚åˆ†æ”¯ç‚¹ç§°ä¸º<u>èŠ‚ç‚¹</u>ã€‚æ ‘çš„é˜¶æ•°æŒ‡æ¯ä¸ªèŠ‚ç‚¹æ‹¥æœ‰çš„åˆ†æ”¯ï¼ˆç§°ä¸ºå­èŠ‚ç‚¹ï¼‰æ•°é‡ã€‚åœ¨äºŒå‰æ ‘ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹å§‹ç»ˆæ‹¥æœ‰<u>ä¸¤ä¸ª</u>å­èŠ‚ç‚¹ï¼Œæ•…å…¶é˜¶æ•°ä¸º2ã€‚äºŒå‰æ ‘çš„å¶å­èŠ‚ç‚¹æ•°é‡æ°¸è¿œæ˜¯2çš„<u>å¹‚æ¬¡æ–¹</u>ã€‚åˆ°è¾¾ç›®æ ‡è®°å½•æ‰€éœ€çš„è®¿é—®æ“ä½œæ¬¡æ•°ç§°ä¸ºæ ‘çš„<u>æ·±åº¦</u>ã€‚</p><h2 id="Unit6"><a href="#Unit6" class="headerlink" title="Unit6"></a>Unit6</h2><h3 id="Ex-2-5"><a href="#Ex-2-5" class="headerlink" title="Ex.2"></a>Ex.2</h3><ol><li><strong>string</strong>: A set of consecutive characters treated by a computer as a single item.</li><li><strong>prompt</strong>: A symbol that appears on a monitor to indicate that the computer is ready to receive input.</li><li><strong>template</strong>: A document with blanks for the insertion of details or information.</li><li><strong>compilation</strong>: Something, such as a set of data, a report, or an anthology, that is compiled.</li><li><strong>exit</strong>(1): To execute the normal shutdown of a program and return control to the operating system.</li><li><strong>symbol</strong>(1): In programming, a name that represents a register, an absolute value, or a memory address (relative or absolute).</li><li><strong>block</strong>: A group of statements in a program that are treated as a unit.</li><li><strong>variable</strong>: In programming, a named storage location capable of containing data that can be modified during program execution.</li><li><strong>return</strong>: To go or come back, as to an earlier condition or place.</li><li><strong>microcomputer</strong>: A very small computer, such as a laptop or personal computer, built around a microprocessor and designed to be used by one person at a time.</li></ol><hr><ol><li><strong>å­—ç¬¦ä¸²</strong>ï¼šè®¡ç®—æœºè§†ä¸ºå•ä¸€å®ä½“çš„ä¸€ç»„è¿ç»­å­—ç¬¦ã€‚</li><li><strong>æç¤ºç¬¦</strong>ï¼šæ˜¾ç¤ºåœ¨ç›‘è§†å™¨ä¸Šã€æŒ‡ç¤ºè®¡ç®—æœºå·²å‡†å¤‡å¥½æ¥æ”¶è¾“å…¥çš„ç¬¦å·ã€‚</li><li><strong>æ¨¡æ¿</strong>ï¼šé¢„ç•™ç©ºç™½ç”¨äºå¡«å…¥å…·ä½“ç»†èŠ‚æˆ–ä¿¡æ¯çš„æ–‡æ¡£ã€‚</li><li><strong>æ±‡ç¼–</strong>ï¼šç»ç¼–çº‚æ•´ç†çš„æˆæœï¼Œå¦‚æ•°æ®é›†ã€æŠ¥å‘Šæˆ–æ–‡é›†ã€‚</li><li><strong>é€€å‡º</strong>ï¼šæ‰§è¡Œç¨‹åºæ­£å¸¸å…³é—­æ“ä½œï¼Œå¹¶å°†æ§åˆ¶æƒäº¤è¿˜æ“ä½œç³»ç»Ÿã€‚</li><li><strong>ç¬¦å·</strong>ï¼šåœ¨ç¼–ç¨‹ä¸­ï¼Œä»£è¡¨å¯„å­˜å™¨ã€ç»å¯¹å€¼æˆ–å†…å­˜åœ°å€ï¼ˆç›¸å¯¹æˆ–ç»å¯¹ï¼‰çš„åç§°ã€‚</li><li><strong>ä»£ç å—</strong>ï¼šç¨‹åºä¸­ä½œä¸ºæ•´ä½“å¤„ç†çš„è¯­å¥é›†åˆã€‚</li><li><strong>å˜é‡</strong>ï¼šåœ¨ç¼–ç¨‹ä¸­ï¼Œå¯å­˜å‚¨æ•°æ®çš„å‘½åå­˜å‚¨ä½ç½®ï¼Œå…¶å€¼å¯åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´ä¿®æ”¹ã€‚</li><li><strong>è¿”å›</strong>ï¼šæŒ‡å›åˆ°å…ˆå‰çŠ¶æ€æˆ–ä½ç½®çš„è¡Œä¸ºã€‚</li><li><strong>å¾®å‹è®¡ç®—æœº</strong>ï¼šåŸºäºå¾®å¤„ç†å™¨æ„å»ºã€ä¸“ä¾›å•äººä½¿ç”¨çš„å¾®å‹è®¡ç®—æœºï¼Œå¦‚ç¬”è®°æœ¬ç”µè„‘æˆ–ä¸ªäººç”µè„‘ã€‚</li></ol><h3 id="Ex-4-5"><a href="#Ex-4-5" class="headerlink" title="Ex.4"></a>Ex.4</h3><ol><li>A <strong>multimedia</strong> computer is a personal computer whose hardware is capable of using any or all of the following media in a program: audio, text, graphics, video and animation.</li><li>The <strong>mouse</strong> controls the cursor or pointer on the screen and allows the user to access commands by pointing and clicking.</li><li>A <strong>scanner</strong> copies a photograph, drawing or page of text into the computer.</li><li><strong>Operating system</strong> is permanently stored in the computer and provides a link between the hardware and other programs that run on the PC.</li><li><strong>Graph</strong> is not a linear structure.</li><li><strong>E-mail</strong> is the sending and receiving of the messages by computer. It is a fast, low-cost way of communicating worldwide.</li><li>The <strong>WWW</strong> is a collection of computers connected together by phone lines that allows for the global sharing of information.</li><li><strong>Search engines</strong> are Web sites that search the Web for occurrences of a specified word or phrase.</li><li>Files can be lost or destroyed accidentally. Keep <strong>backup</strong> copies of all data on removable storage media.</li><li>In <strong>event-driven</strong> programming, the user determines the sequence of instructions to be executed, not the programmer.</li></ol><hr><ol><li><strong>å¤šåª’ä½“è®¡ç®—æœº</strong>æ˜¯æŒ‡å…¶ç¡¬ä»¶èƒ½å¤Ÿåœ¨ç¨‹åºä¸­ä½¿ç”¨ä»¥ä¸‹ä¸€ç§æˆ–å¤šç§åª’ä»‹çš„ä¸ªäººè®¡ç®—æœºï¼šéŸ³é¢‘ã€æ–‡æœ¬ã€å›¾å½¢ã€è§†é¢‘å’ŒåŠ¨ç”»ã€‚</li><li><strong>é¼ æ ‡</strong>ç”¨äºæ§åˆ¶å±å¹•ä¸Šçš„å…‰æ ‡æˆ–æŒ‡é’ˆï¼Œç”¨æˆ·é€šè¿‡æŒ‡å‘å’Œç‚¹å‡»æ¥è®¿é—®å‘½ä»¤ã€‚</li><li><strong>æ‰«æä»ª</strong>å°†ç…§ç‰‡ã€ç»˜å›¾æˆ–æ–‡æœ¬é¡µé¢å¤åˆ¶åˆ°è®¡ç®—æœºä¸­ã€‚</li><li><strong>æ“ä½œç³»ç»Ÿ</strong>æ°¸ä¹…å­˜å‚¨äºè®¡ç®—æœºä¸­ï¼Œåœ¨ç¡¬ä»¶ä¸è¿è¡Œäºä¸ªäººç”µè„‘çš„å…¶ä»–ç¨‹åºä¹‹é—´å»ºç«‹è¿æ¥ã€‚</li><li><strong>å›¾å½¢</strong>å¹¶éçº¿æ€§ç»“æ„ã€‚</li><li><strong>ç”µå­é‚®ä»¶</strong>æ˜¯é€šè¿‡è®¡ç®—æœºæ”¶å‘æ¶ˆæ¯çš„æ–¹å¼ï¼Œå±äºå…¨çƒèŒƒå›´å†…å¿«é€Ÿã€ä½æˆæœ¬çš„é€šä¿¡æ‰‹æ®µã€‚</li><li><strong>ä¸‡ç»´ç½‘</strong>æ˜¯ç”±ç”µè¯çº¿è¿æ¥çš„è®¡ç®—æœºç½‘ç»œé›†åˆï¼Œå®ç°å…¨çƒä¿¡æ¯å…±äº«ã€‚</li><li><strong>æœç´¢å¼•æ“</strong>æ˜¯èƒ½åœ¨ç½‘ç»œä¸­æ£€ç´¢ç‰¹å®šè¯æ±‡æˆ–çŸ­è¯­å‡ºç°ä½ç½®çš„ç½‘ç«™ã€‚</li><li>æ–‡ä»¶å¯èƒ½æ„å¤–ä¸¢å¤±æˆ–æŸæ¯ã€‚è¯·å°†æ‰€æœ‰æ•°æ®çš„<strong>å¤‡ä»½</strong>å­˜å…¥å¯ç§»åŠ¨å­˜å‚¨ä»‹è´¨ã€‚</li><li>åœ¨<strong>äº‹ä»¶é©±åŠ¨</strong>ç¼–ç¨‹ä¸­ï¼ŒæŒ‡ä»¤æ‰§è¡Œé¡ºåºç”±ç”¨æˆ·è€Œéç¨‹åºå‘˜å†³å®šã€‚</li></ol><h3 id="Ex-5-5"><a href="#Ex-5-5" class="headerlink" title="Ex.5"></a>Ex.5</h3><p>C is a structured, procedural programming language that has been <u>widely</u> used both for operating systems and <u>applications</u> and that has had a wide following in the academic <u>community</u>. Many versions of UNlX-based operating systems are <u>written</u> in C. C has been <u>standardized</u> as part of the Portable Operating System Interface (POSIX).<br>With the increasing <u>popularity</u> of object oriented programming, C is being rapidly <u>replaced</u> as â€œtheâ€ programming language by C++, a <u>superset</u> of the C language that uses an entirely different set of programming <u>concepts</u>, and by Java, a language <u>similar</u> to but simpler than C++, that was designed for use in distributed networks.</p><p>Cæ˜¯ä¸€ç§ç»“æ„åŒ–ã€è¿‡ç¨‹åŒ–çš„ç¼–ç¨‹è¯­è¨€ï¼Œåœ¨æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºé¢†åŸŸå‡è¢«å¹¿æ³›åº”ç”¨ï¼Œå¹¶åœ¨å­¦æœ¯ç•Œæ‹¥æœ‰ä¼—å¤šè¿½éšè€…ã€‚è®¸å¤šåŸºäºUNIXçš„æ“ä½œç³»ç»Ÿç‰ˆæœ¬éƒ½æ˜¯ç”¨Cè¯­è¨€ç¼–å†™çš„ã€‚Cè¯­è¨€å·²è¢«æ ‡å‡†åŒ–ä¸ºå¯ç§»æ¤æ“ä½œç³»ç»Ÿæ¥å£ï¼ˆPOSIXï¼‰çš„ä¸€éƒ¨åˆ†ã€‚<br>éšç€é¢å‘å¯¹è±¡ç¼–ç¨‹æ—¥ç›Šæ™®åŠï¼ŒCè¯­è¨€æ­£è¿…é€Ÿè¢«å–ä»£â€”â€”å–ä»£å…¶â€œé¦–é€‰ç¼–ç¨‹è¯­è¨€â€åœ°ä½çš„æ—¢æœ‰C++ï¼ˆä½œä¸ºCè¯­è¨€çš„è¶…é›†ï¼Œé‡‡ç”¨å®Œå…¨ä¸åŒçš„ç¼–ç¨‹æ¦‚å¿µï¼‰ï¼Œä¹Ÿæœ‰Javaï¼ˆä¸€ç§ç±»ä¼¼ä½†æ¯”C++æ›´ç®€æ´çš„è¯­è¨€ï¼Œä¸“ä¸ºåˆ†å¸ƒå¼ç½‘ç»œè®¾è®¡ï¼‰ã€‚</p><h2 id="Unit7"><a href="#Unit7" class="headerlink" title="Unit7"></a>Unit7</h2><h3 id="Ex-2-6"><a href="#Ex-2-6" class="headerlink" title="Ex.2"></a>Ex.2</h3><ol><li><strong>loop</strong>: A sequence of instructions that repeats either a specified number of times or until a particular condition prevails.</li><li><strong>retrieval</strong>: The process of extracting data from a database and presenting it for use.</li><li><strong>attribute</strong>(1): A characteristic possessed by all members of a class.</li><li><strong>model</strong>: A mathematical or graphical representation of a real-world situation or object.</li><li><strong>failure</strong>(1): The inability of a computer system or related device to operate reliably or to operate at all.</li><li><strong>index</strong>(1): A listing of keywords and associated data that point to the location of more comprehensive information, such as files and records on a disk or record keys in a database.</li><li><strong>tag</strong>(1): An identifying term attached to an element in a system to facilitate connection to other identified elements.</li><li><strong>tuple</strong>(1): In a database record, the name or structure of a field.</li><li><strong>filter</strong>(1): A pattern or mask through which data is passed to weed out specified items.</li><li><strong>locate</strong>(1): To determine or specify the position or limits of.</li></ol><hr><ol><li><strong>å¾ªç¯</strong>ï¼šä¸€ç»„æŒ‡ä»¤åºåˆ—ï¼Œå¯é‡å¤æ‰§è¡ŒæŒ‡å®šæ¬¡æ•°æˆ–æŒç»­æ‰§è¡Œç›´è‡³ç‰¹å®šæ¡ä»¶æˆç«‹ã€‚</li><li><strong>æ£€ç´¢</strong>ï¼šä»æ•°æ®åº“ä¸­æå–æ•°æ®å¹¶å‘ˆç°ä¾›ä½¿ç”¨çš„è¿‡ç¨‹ã€‚</li><li><strong>å±æ€§</strong>ï¼šæŸç±»æ‰€æœ‰æˆå‘˜å…±æœ‰çš„ç‰¹å¾ã€‚</li><li><strong>æ¨¡å‹</strong>ï¼šå¯¹ç°å®ä¸–ç•Œæƒ…å¢ƒæˆ–å¯¹è±¡çš„æ•°å­¦æˆ–å›¾å½¢åŒ–è¡¨ç¤ºã€‚</li><li><strong>æ•…éšœ</strong>ï¼šè®¡ç®—æœºç³»ç»Ÿæˆ–ç›¸å…³è®¾å¤‡æ— æ³•å¯é è¿è¡Œæˆ–å®Œå…¨æ— æ³•è¿è¡Œçš„çŠ¶æ€ã€‚</li><li><strong>ç´¢å¼•</strong>ï¼šæŒ‡å‘æ›´å…¨é¢ä¿¡æ¯ä½ç½®çš„å…³é”®è¯åŠå…³è”æ•°æ®åˆ—è¡¨ï¼Œå¦‚ç£ç›˜ä¸Šçš„æ–‡ä»¶è®°å½•æˆ–æ•°æ®åº“ä¸­çš„è®°å½•é”®ã€‚</li><li><strong>æ ‡ç­¾</strong>ï¼šé™„åŠ äºç³»ç»Ÿå…ƒç´ çš„è¯†åˆ«æœ¯è¯­ï¼Œç”¨äºä¿ƒè¿›ä¸å…¶ä»–å·²è¯†åˆ«å…ƒç´ çš„å…³è”ã€‚</li><li><strong>å…ƒç»„</strong>ï¼šæ•°æ®åº“è®°å½•ä¸­å­—æ®µçš„åç§°æˆ–ç»“æ„ã€‚</li><li><strong>è¿‡æ»¤å™¨</strong>ï¼šç”¨äºç­›é€‰æ•°æ®ä»¥å‰”é™¤ç‰¹å®šé¡¹çš„æ¨¡å¼æˆ–æ©ç ã€‚</li><li><strong>å®šä½</strong>ï¼šç¡®å®šæˆ–æŒ‡å®šæŸç‰©çš„ä½ç½®æˆ–è¾¹ç•Œã€‚</li></ol><h3 id="Ex-4-6"><a href="#Ex-4-6" class="headerlink" title="Ex.4"></a>Ex.4</h3><ol><li><strong>Web page</strong> means â€œAny HTML document on a HTTP Serverâ€.</li><li>The term â€œ<strong>source</strong> programâ€ means a program written in high-level language.</li><li>Very long, complex expressions in program are difficult to write correctly and difficult to <strong>debug</strong>.</li><li>In C language, functions are important because they provide a way to <strong>modularize</strong> code so that a large complex program can be written by combining many smaller parts.</li><li>The standard <strong>libraries</strong> in C language contain many useful functions for input and output, string handling, mathematical computations, and system programming tasks.</li><li>In <strong>event-driven</strong> programming, the user determines the sequence of instructions to be executed, not the programmer.</li><li><strong>Hyperlink</strong> is a clickable string or graphic that points to another Web page or document.</li><li>One solution to major security problem is <strong>patches</strong>, which are frequently installed to fix known security holes.</li><li>A programmer must know about a functionâ€™s <strong>interface</strong> to call it correctly.</li><li>On a <strong>virtual</strong> memory system, the logical memory space available to the program is totally independent of the physical memory space.</li></ol><hr><ol><li><strong>ç½‘é¡µ</strong>æŒ‡â€œHTTPæœåŠ¡å™¨ä¸Šçš„ä»»ä½•HTMLæ–‡æ¡£â€ã€‚</li><li>â€œ<strong>æºä»£ç ç¨‹åº</strong>â€æŒ‡ç”¨é«˜çº§è¯­è¨€ç¼–å†™çš„ç¨‹åºã€‚</li><li>ç¨‹åºä¸­éå¸¸é•¿ä¸”å¤æ‚çš„è¡¨è¾¾å¼éš¾ä»¥æ­£ç¡®ç¼–å†™ä¸”éš¾ä»¥<strong>è°ƒè¯•</strong>ã€‚</li><li>åœ¨Cè¯­è¨€ä¸­ï¼Œå‡½æ•°è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒä»¬æä¾›äº†ä»£ç <strong>æ¨¡å—åŒ–</strong>çš„æ–¹æ³•ï¼Œä½¿å¤§å‹å¤æ‚ç¨‹åºèƒ½é€šè¿‡ç»„åˆå¤šä¸ªå°å‹éƒ¨ä»¶å®ç°ã€‚</li><li>Cè¯­è¨€çš„æ ‡å‡†<strong>åº“</strong>åŒ…å«å¤§é‡å®ç”¨å‡½æ•°ï¼Œæ¶µç›–è¾“å…¥è¾“å‡ºã€å­—ç¬¦ä¸²å¤„ç†ã€æ•°å­¦è¿ç®—åŠç³»ç»Ÿç¼–ç¨‹ä»»åŠ¡ã€‚</li><li>åœ¨<strong>äº‹ä»¶é©±åŠ¨</strong>ç¼–ç¨‹ä¸­ï¼ŒæŒ‡ä»¤æ‰§è¡Œé¡ºåºç”±ç”¨æˆ·è€Œéç¨‹åºå‘˜å†³å®šã€‚</li><li><strong>è¶…é“¾æ¥</strong>æ˜¯å¯ç‚¹å‡»çš„å­—ç¬¦ä¸²æˆ–å›¾å½¢ï¼ŒæŒ‡å‘å…¶ä»–ç½‘é¡µæˆ–æ–‡æ¡£ã€‚</li><li>è§£å†³é‡å¤§å®‰å…¨é—®é¢˜çš„æ–¹æ¡ˆä¹‹ä¸€æ˜¯<strong>è¡¥ä¸</strong>ï¼Œéœ€å®šæœŸå®‰è£…ä»¥ä¿®å¤å·²çŸ¥å®‰å…¨æ¼æ´ã€‚</li><li>ç¨‹åºå‘˜å¿…é¡»äº†è§£å‡½æ•°çš„<strong>æ¥å£</strong>æ‰èƒ½æ­£ç¡®è°ƒç”¨ã€‚</li><li>åœ¨<strong>è™šæ‹Ÿå†…å­˜ç³»ç»Ÿ</strong>ä¸­ï¼Œç¨‹åºå¯ç”¨çš„é€»è¾‘å†…å­˜ç©ºé—´ä¸ç‰©ç†å†…å­˜ç©ºé—´å®Œå…¨ç‹¬ç«‹ã€‚</li></ol><h3 id="Ex-5-6"><a href="#Ex-5-6" class="headerlink" title="Ex.5"></a>Ex.5</h3><p>A database is a <u>collection</u> of information that is organized so that it can easily be <u>accessed</u>, managed, and <u>updated</u>. In one view, databases can be classified according to <u>types</u> of content: bibliographic, full-text, numeric, and images.<br>In computing, databases are sometimes classified according to their <u>organizational</u> approach. The most prevalent approach is the <u>relational</u> database, a tabular database in which data is defined so that it can be <u>reorganized</u> and accessed in a number of different ways. A <u>distributed</u> database is one that can be dispersed or replicated among different points in a <u>network</u>. An object-oriented programming database is one that is congruent with the data defined in object <u>classes</u> and subclasses.</p><p>æ•°æ®åº“æ˜¯ç»è¿‡ç»„ç»‡çš„ä¿¡æ¯é›†åˆï¼Œä»¥ä¾¿äºè®¿é—®ã€ç®¡ç†å’Œæ›´æ–°ã€‚ä»æŸç§è§’åº¦çœ‹ï¼Œæ•°æ®åº“å¯æŒ‰å†…å®¹ç±»å‹åˆ†ä¸ºå››ç±»ï¼šä¹¦ç›®å‹ã€å…¨æ–‡å‹ã€æ•°å€¼å‹å’Œå›¾åƒå‹ã€‚<br>åœ¨è®¡ç®—æœºé¢†åŸŸï¼Œæ•°æ®åº“æœ‰æ—¶æ ¹æ®å…¶ç»„ç»‡æ–¹å¼è¿›è¡Œåˆ†ç±»ã€‚æœ€æ™®éçš„æ–¹æ³•æ˜¯å…³ç³»å‹æ•°æ®åº“ï¼Œè¿™æ˜¯ä¸€ç§è¡¨æ ¼å¼æ•°æ®åº“ï¼Œå…¶æ•°æ®å®šä¹‰æ–¹å¼æ”¯æŒå¤šç§é‡ç»„å’Œè®¿é—®æ¨¡å¼ã€‚åˆ†å¸ƒå¼æ•°æ®åº“å¯åˆ†æ•£æˆ–å¤åˆ¶åˆ°ç½‘ç»œä¸­çš„ä¸åŒèŠ‚ç‚¹ã€‚é¢å‘å¯¹è±¡ç¼–ç¨‹æ•°æ®åº“åˆ™ä¸å¯¹è±¡ç±»åŠå…¶å­ç±»ä¸­å®šä¹‰çš„æ•°æ®ç›¸åŒ¹é…ã€‚</p><h2 id="Unit8"><a href="#Unit8" class="headerlink" title="Unit8"></a>Unit8</h2><h3 id="Ex-2-7"><a href="#Ex-2-7" class="headerlink" title="Ex.2"></a>Ex.2</h3><ol><li><strong>object</strong>: In object oriented programming, a variable comprising both routines and data that is treated as a discrete entity.</li><li><strong>class</strong>: A descriptive tool used in a program to define a set of attributes or a set of services (actions available to other parts of the program) that characterize any member (object) of the class.</li><li><strong>procedure</strong>(1): A series of steps taken to accomplish an end.</li><li><strong>prototype</strong>(1): An original type, form, or instance that serves as a model on which later stages are based or judged.</li><li><strong>characteristic</strong>: A feature that helps to identify, tell apart, or describe recognizably, a distinguishing mark or trait.</li><li><strong>inherit</strong>(2): To receive from an ancestor by legal succession or will.</li><li><strong>hierarchy</strong>(2): A series in which each element is graded or ranked.</li><li><strong>bookmark</strong>(1): A marker inserted at a specific point in a document to which the user may wish to return for later reference.</li><li><strong>manipulate</strong>(1): To operate or control by skilled use of the hands; handle.</li><li><strong>packet</strong>(1): In communications, a unit of information transmitted electronically from one device to another.</li></ol><hr><ol><li><strong>å¯¹è±¡</strong>ï¼šåœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼ŒåŒ…å«ç¨‹åºå’Œæ•°æ®çš„å˜é‡ï¼Œè¢«è§†ä¸ºç‹¬ç«‹å®ä½“ã€‚</li><li><strong>ç±»</strong>ï¼šç¨‹åºä¸­ç”¨äºå®šä¹‰å±æ€§é›†æˆ–æœåŠ¡é›†ï¼ˆå¯ä¾›ç¨‹åºå…¶ä»–éƒ¨åˆ†è°ƒç”¨çš„æ“ä½œï¼‰çš„æè¿°å·¥å…·ï¼Œè¿™äº›å±æ€§æˆ–æœåŠ¡ç‰¹å¾åŒ–è¯¥ç±»çš„ä»»ä½•æˆå‘˜ï¼ˆå¯¹è±¡ï¼‰ã€‚</li><li><strong>è¿‡ç¨‹</strong>ï¼šä¸ºè¾¾æˆç›®æ ‡è€Œæ‰§è¡Œçš„æ­¥éª¤åºåˆ—ã€‚</li><li><strong>åŸå‹</strong>ï¼šä½œä¸ºåç»­é˜¶æ®µåŸºå‡†æˆ–è¯„åˆ¤æ ‡å‡†çš„åŸå§‹ç±»å‹ã€å½¢å¼æˆ–å®ä¾‹ã€‚</li><li><strong>ç‰¹å¾</strong>ï¼šæŸç±»æ‰€æœ‰æˆå‘˜å…±æœ‰çš„ç‰¹æ€§å±æ€§ã€‚</li><li><strong>ç»§æ‰¿</strong>ï¼šé€šè¿‡æ³•å®šç»§æ‰¿æˆ–é—å˜±ä»ç¥–å…ˆå¤„è·å¾—ã€‚</li><li><strong>å±‚æ¬¡ç»“æ„</strong>ï¼šå„å…ƒç´ æŒ‰ç­‰çº§æˆ–æ’åæ’åˆ—çš„åºåˆ—ã€‚</li><li><strong>ä¹¦ç­¾</strong>ï¼šæ’å…¥æ–‡æ¡£ç‰¹å®šä½ç½®çš„æ ‡è®°ï¼Œä¾›ç”¨æˆ·åç»­æŸ¥é˜…æ—¶å®šä½ã€‚</li><li><strong>æ“ä½œ</strong>ï¼šé€šè¿‡ç†Ÿç»ƒçš„æ‰‹éƒ¨åŠ¨ä½œè¿›è¡Œæ§åˆ¶æˆ–å¤„ç†ï¼›æ“æ§ã€‚</li><li><strong>æ•°æ®åŒ…</strong>ï¼šé€šä¿¡ä¸­ç”µå­ä¼ è¾“çš„ä¿¡æ¯å•å…ƒï¼Œç”±è®¾å¤‡é—´ä¼ é€’ã€‚</li></ol><h3 id="Ex-4-7"><a href="#Ex-4-7" class="headerlink" title="Ex.4"></a>Ex.4</h3><ol><li>One use of networks is to let several computers share <strong>resources</strong> such as file system, printers, and tape drives.</li><li>A firewall is a <strong>security</strong> system designed to <strong>protect</strong> an organizationâ€™s network against threats.</li><li>The <strong>operating</strong> system has several major components, including the system kernel, a memory management system, the file system manager, device drivers, and the system libraries.</li><li><strong>Pointer</strong> is the address of a variable or a variable in which the address of another variable is stored.</li><li>C++ is used with proper <strong>object oriented</strong> design techniques.</li><li><strong>Array</strong> is a contiguous, numbered set of variables of a given base type, which can be used and passed to functions as a unit.</li><li><strong>UML</strong> is not a programming language.</li><li><strong>Comment</strong> is non-program text embedded in a program to explain its form and function to human readers.</li><li>When the result of an operation becomes larger than the limits of the representation, <strong>overflow</strong> occurs.</li></ol><hr><ol><li>ç½‘ç»œçš„ä¸€ä¸ªç”¨é€”æ˜¯è®©å¤šå°è®¡ç®—æœºå…±äº«<strong>èµ„æº</strong>ï¼Œä¾‹å¦‚æ–‡ä»¶ç³»ç»Ÿã€æ‰“å°æœºå’Œç£å¸¦é©±åŠ¨å™¨ã€‚</li><li>é˜²ç«å¢™æ˜¯ä¸€ç§æ—¨åœ¨<strong>ä¿æŠ¤</strong>ç»„ç»‡ç½‘ç»œå…å—å¨èƒçš„<strong>å®‰å…¨</strong>ç³»ç»Ÿã€‚</li><li>æ“ä½œç³»ç»ŸåŒ…å«å¤šä¸ªä¸»è¦ç»„ä»¶ï¼ŒåŒ…æ‹¬ç³»ç»Ÿå†…æ ¸ã€å†…å­˜ç®¡ç†ç³»ç»Ÿã€æ–‡ä»¶ç³»ç»Ÿç®¡ç†å™¨ã€è®¾å¤‡é©±åŠ¨ç¨‹åºå’Œç³»ç»Ÿåº“ã€‚</li><li><strong>æŒ‡é’ˆ</strong>æ˜¯å˜é‡çš„åœ°å€ï¼Œæˆ–å­˜å‚¨å…¶ä»–å˜é‡åœ°å€çš„å˜é‡ã€‚</li><li>C++éœ€é…åˆæ­£ç¡®çš„<strong>é¢å‘å¯¹è±¡</strong>è®¾è®¡æŠ€æœ¯ä½¿ç”¨ã€‚</li><li><strong>æ•°ç»„</strong>æ˜¯ç”±ç‰¹å®šåŸºç±»å˜é‡ç»„æˆçš„è¿ç»­ç¼–å·é›†åˆï¼Œå¯ä½œä¸ºæ•´ä½“ä½¿ç”¨å¹¶ä¼ é€’ç»™å‡½æ•°ã€‚</li><li><strong>UML</strong>å¹¶éç¼–ç¨‹è¯­è¨€ã€‚</li><li><strong>æ³¨é‡Š</strong>æ˜¯åµŒå…¥ç¨‹åºä¸­çš„éç¨‹åºæ–‡æœ¬ï¼Œç”¨äºå‘äººç±»è¯»è€…è§£é‡Šç¨‹åºçš„ç»“æ„ä¸åŠŸèƒ½ã€‚</li><li>å½“è¿ç®—ç»“æœè¶…å‡ºè¡¨ç¤ºèŒƒå›´æ—¶ï¼Œå³å‘ç”Ÿ<strong>æº¢å‡º</strong>ã€‚</li></ol><h3 id="Ex-5-7"><a href="#Ex-5-7" class="headerlink" title="Ex.5"></a>Ex.5</h3><p>Java is a programming language expressly designed for use in the distributed <u>environment</u> of the Internet. It was designed to have the â€œlook and feelâ€ of the C++ language, but it is simpler to use than C++ and <u>enforces</u> an object oriented programming model. Java can be used to create complete applications that may run on a <u>single</u> computer or be distributed among <u>servers</u> and clients in a network. It can also be used to build a small application module or <u>applet</u> for use as part of a Web page. Applets make it possible for a Web page user to <u>interact</u> with the page. The Java virtual machine includes an optional just-in-time <u>compiler</u> that dynamically compiles bytecode into <u>executable</u> code as an alternative to interpreting one bytecode instruction at a time. In many cases, the <u>dynamic</u> JIT compilation is faster than the virtual machine <u>interpretation</u>.</p><p>Javaæ˜¯ä¸€ç§ä¸“ä¸ºäº’è”ç½‘åˆ†å¸ƒå¼ç¯å¢ƒè®¾è®¡çš„ç¼–ç¨‹è¯­è¨€ã€‚å®ƒåœ¨è®¾è®¡ä¸Šä¿ç•™äº†C++è¯­è¨€çš„â€œå¤–è§‚å’Œæ„Ÿè§‰â€ï¼Œä½†æ¯”C++æ›´æ˜“äºä½¿ç”¨ï¼Œå¹¶å¼ºåˆ¶é‡‡ç”¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ¨¡å‹ã€‚Javaå¯ç”¨äºåˆ›å»ºå®Œæ•´åº”ç”¨ç¨‹åºï¼Œæ—¢å¯åœ¨å•å°è®¡ç®—æœºä¸Šè¿è¡Œï¼Œä¹Ÿå¯åœ¨ç½‘ç»œä¸­çš„æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯é—´åˆ†å¸ƒå¼è¿è¡Œã€‚å®ƒè¿˜èƒ½æ„å»ºå°å‹åº”ç”¨æ¨¡å—æˆ–å°ç¨‹åºï¼Œä½œä¸ºç½‘é¡µç»„ä»¶ä½¿ç”¨ã€‚å°ç¨‹åºä½¿ç½‘é¡µç”¨æˆ·èƒ½å¤Ÿä¸é¡µé¢è¿›è¡Œäº¤äº’ã€‚Javaè™šæ‹ŸæœºåŒ…å«å¯é€‰çš„å³æ—¶ç¼–è¯‘å™¨ï¼Œè¯¥ç¼–è¯‘å™¨èƒ½åŠ¨æ€å°†å­—èŠ‚ç ç¼–è¯‘ä¸ºå¯æ‰§è¡Œä»£ç ï¼Œä»è€Œæ›¿ä»£é€æ¡è§£é‡Šå­—èŠ‚ç æŒ‡ä»¤çš„æ–¹å¼ã€‚åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼ŒåŠ¨æ€å³æ—¶ç¼–è¯‘çš„é€Ÿåº¦ä¼˜äºè™šæ‹Ÿæœºçš„è§£é‡Šæ‰§è¡Œã€‚</p><h2 id="Unit9"><a href="#Unit9" class="headerlink" title="Unit9"></a>Unit9</h2><h3 id="Ex-2-8"><a href="#Ex-2-8" class="headerlink" title="Ex.2"></a>Ex.2</h3><ol><li><strong>network</strong>: A system of computers interconnected by telephone wires or other means in order to share information.</li><li><strong>telecommunication</strong>: The science and technology of communication at a distance by electronic transmission of impulses, as by telegraph, cable, telephone, radio, or television.</li><li><strong>protocol</strong>: A standard procedure for regulating data transmission between computers.</li><li><strong>workgroup</strong>: A group of users working on a common project and sharing computer files, often over a local area network.</li><li><strong>hub</strong>: A device joining communication lines at a central location, providing a common connection to all devices on the network.</li><li><strong>channel</strong>: A transmission path by which radio or other signals are sent to an aircraft or a communications satellite.</li><li><strong>intranet</strong>: A network designed for information processing within a company or organization. Its uses include such services as document distribution, software distribution, access to databases, and training.</li><li><strong>authentication</strong>: In reference to computing, especially remote computers on a network, the right granted an individual to use the system and the data stored on it.</li><li><strong>adapter</strong>: A printed circuit board that enables a personal computer to use a peripheral device, such as a CD-ROM drive, modem, or joystick, for which it does not already have the necessary connections, ports, or circuit boards.</li><li><strong>packet</strong>: A short block of data transmitted in a packet switching network.</li></ol>]]></content>
    
    
    <summary type="html">é€Ÿé€šä¸“ä¸šè‹±è¯­</summary>
    
    
    
    <category term="è¯¾ç¨‹ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="è¯¾ç¨‹ç¬”è®°" scheme="https://www.cclmsy.cc/tags/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>è®ºæ–‡ç¬”è®°|PSCC-Netï¼šProgressive Spatio-Channel Correlation Network for Image Manipulation Detection and Localization</title>
    <link href="https://www.cclmsy.cc/posts/2103.10596.html"/>
    <id>https://www.cclmsy.cc/posts/2103.10596.html</id>
    <published>2025-10-27T16:00:00.000Z</published>
    <updated>2025-12-07T05:59:09.438Z</updated>
    
    <content type="html"><![CDATA[<p>è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/2103.10596">PSCC-Net: Progressive Spatio-Channel Correlation Network for Image Manipulation Detection and Localization</a></p><div class="table-container"><table><thead><tr><th style="text-align:center">ç¼©å†™</th><th style="text-align:center">å…¨ç§°</th><th style="text-align:center">ç¿»è¯‘</th></tr></thead><tbody><tr><td style="text-align:center">IMDL</td><td style="text-align:center">Image Manipulation Detection and Localization</td><td style="text-align:center">å›¾åƒç¯¡æ”¹æ£€æµ‹ä¸å®šä½</td></tr></tbody></table></div><h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1 Introduction"></a>1 Introduction</h2><p>å›¾åƒç¯¡æ”¹ç±»å‹ï¼š</p><ul><li>å†…å®¹ç›¸å…³ï¼š<ul><li>æ‹¼æ¥ï¼ˆSplicingï¼‰ï¼šæ¥è‡ªä¸åŒå›¾åƒ</li><li>å¤åˆ¶-ç§»åŠ¨ï¼ˆCopy-Moveï¼‰ï¼šå›¾åƒå†…éƒ¨</li><li>åˆ é™¤ï¼ˆRemovalï¼‰ï¼šç§»é™¤å¯¹è±¡å¹¶å¡«å……</li></ul></li><li>å†…å®¹æ— å…³ï¼šå…¨å±€ä¿®æ”¹ï¼ˆäº®åº¦ã€å¯¹æ¯”åº¦ã€æ¨¡ç³Šç­‰ï¼‰</li></ul><p>ç°æœ‰IMDLé—®é¢˜ï¼š</p><ol><li>å°ºåº¦å˜åŒ–ï¼ˆScale Variationï¼‰ï¼šç¯¡æ”¹åŒºåŸŸå¤§å°ä¸ä¸€ï¼Œç°æœ‰éš¾ä»¥åŒæ—¶åˆ©ç”¨å±€éƒ¨å’Œå…¨å±€ç‰¹å¾ï¼Œåªèƒ½å¤„ç†æœ‰é™çš„å°ºåº¦å˜åŒ–</li><li>å›¾åƒç›¸å…³æ€§ï¼ˆImage Correlationï¼‰ï¼šè€ƒè™‘å›¾åƒç©ºé—´ç›¸å…³æ€§å¯è·å¾—æ›´å…·æ™®é€‚æ€§çš„å®šä½æ–¹æ¡ˆ</li><li>æ£€æµ‹ï¼ˆDetectionï¼‰ï¼šç¯¡æ”¹æ£€æµ‹å’Œå®šä½æ˜¯é«˜åº¦ç›¸å…³çš„ä»»åŠ¡ï¼Œæ£€æµ‹åˆ†æ•°å¯ç›´æ¥ä»é¢„æµ‹ç¯¡æ”¹æ©ç ä¸­æ¨å¯¼</li></ol><p>æœ¬æ–‡è´¡çŒ®ï¼š</p><ol><li>æå‡ºäº†PSCC-Netï¼Œç¯¡æ”¹æ£€æµ‹è¡¨ç°è‰¯å¥½ï¼Œèƒ½å¤Ÿä»¥ç²—åˆ°ç»†çš„æ–¹å¼é€æ­¥æ”¹è¿›ç¯¡æ”¹å®šä½</li><li>è®¾è®¡äº†ä¸€ä¸ªæ–°é¢–çš„SCCMæ¨¡å—æ¥æ•è·ç©ºé—´å’Œé€šé“ç›¸å…³æ€§ï¼Œå®ç°æ›´å¥½çš„æ³›åŒ–</li><li>æ£€æµ‹å’Œå®šä½å‡è¾¾åˆ°SOTAæ°´å¹³</li></ol><h2 id="2-Related-Work"><a href="#2-Related-Work" class="headerlink" title="2 Related Work"></a>2 Related Work</h2><h3 id="2-1-Image-Manipulation-Detection-å›¾åƒç¯¡æ”¹æ£€æµ‹"><a href="#2-1-Image-Manipulation-Detection-å›¾åƒç¯¡æ”¹æ£€æµ‹" class="headerlink" title="2.1 Image Manipulation Detection å›¾åƒç¯¡æ”¹æ£€æµ‹"></a>2.1 Image Manipulation Detection å›¾åƒç¯¡æ”¹æ£€æµ‹</h3><ul><li>éšå¼æ–¹æ³•ï¼šé¢„æµ‹ç¯¡æ”¹æ©ç çš„ç»Ÿè®¡æ•°æ®è·å¾—æ£€æµ‹åˆ†æ•°</li><li>æ˜¾å¼æ–¹æ³•ï¼šé€šè¿‡ä¸“ç”¨åˆ†ç±»æ¨¡å—æ˜¾å¼è¾“å‡ºåˆ†æ•°</li></ul><p>è¿‘æœŸç ”ç©¶ä¾§é‡äºåƒç´ çº§ç¯¡æ”¹å®šä½ï¼Œè€Œå¿½ç•¥äº†å›¾åƒçº§æ£€æµ‹çš„é‡è¦æ€§ã€‚</p><p>æœ¬ç ”ç©¶åˆ™åœ¨è®­ç»ƒä¸­åŒæ—¶åˆ©ç”¨ç¯¡æ”¹å›¾åƒå’ŒåŸå§‹å›¾åƒï¼Œå¹¶åŒæ—¶è€ƒè™‘å›¾åƒç¯¡æ”¹çš„æ£€æµ‹å’Œå®šä½ã€‚</p><h3 id="2-2-Image-Manipulation-Localization-å›¾åƒç¯¡æ”¹å®šä½"><a href="#2-2-Image-Manipulation-Localization-å›¾åƒç¯¡æ”¹å®šä½" class="headerlink" title="2.2 Image Manipulation Localization å›¾åƒç¯¡æ”¹å®šä½"></a>2.2 Image Manipulation Localization å›¾åƒç¯¡æ”¹å®šä½</h3><p>å¤šæ•°æ–¹æ³•åœ¨æ£€æµ‹<strong>ç‰¹å®š</strong>ä¼ªé€ ç±»å‹æ—¶è¡¨ç°è‰¯å¥½ï¼Œä½†ç°å®ä¸­ä¼ªé€ ç±»å‹é€šå¸¸æ— æ³•é¢„çŸ¥ä¸”åŒæ—¶å­˜åœ¨å¤šç§ä¼ªé€ æ‰‹æ®µã€‚</p><p>J-LSTMå’ŒH-LSTMé›†æˆäº†LSTMå’ŒCNNæ¥æ•è·è¾¹ç•Œåˆ¤åˆ«ç‰¹å¾ï¼Œç”±äºåŸºäºå—çš„è®¾è®¡ï¼Œè¿™ä¸¤ç§æ–¹æ³•éƒ½å¾ˆè€—æ—¶ï¼Œå¹¶ä¸”å¯æ£€æµ‹åŒºåŸŸçš„å¤§å°å—åˆ°é¢„è®¾å—å¤§å°çš„é™åˆ¶ã€‚</p><p>RGB-Né‡‡ç”¨éšå†™åˆ†æä¸°å¯Œæ¨¡å‹ä¸Faster R-CNNï¼Œä½†ä»…èƒ½æä¾›è¾¹ç•Œæ¡†è€Œéåˆ†å‰²æ©ç ã€‚</p><p>ManTra-Neté€šè¿‡ç‰¹å¾å­¦ä¹ è¯†åˆ«385ç§å·²çŸ¥ç¯¡æ”¹ç±»å‹ï¼Œå¹¶å°†é—®é¢˜è½¬åŒ–ä¸ºå¼‚å¸¸æ£€æµ‹ï¼›SPANåœ¨ManTra-NetåŸºç¡€ä¸Šï¼Œé€šè¿‡å±€éƒ¨è‡ªæ³¨æ„åŠ›æ¨¡å—ä¸é‡‘å­—å¡”ä¼ æ’­è¿›ä¸€æ­¥å»ºæ¨¡ç©ºé—´ç›¸å…³æ€§ã€‚ä½†ç”±äºä»…è€ƒè™‘å±€éƒ¨åŒºåŸŸç›¸å…³æ€§ï¼ŒManTra-Netå’ŒSPANæœªèƒ½å……åˆ†åˆ©ç”¨ç©ºé—´ç›¸å…³æ€§ï¼Œå¯¼è‡´æ³›åŒ–èƒ½åŠ›å—é™ã€‚</p><h3 id="2-3-Progressive-Mechanism-æ¸è¿›æœºåˆ¶"><a href="#2-3-Progressive-Mechanism-æ¸è¿›æœºåˆ¶" class="headerlink" title="2.3 Progressive Mechanism æ¸è¿›æœºåˆ¶"></a>2.3 Progressive Mechanism æ¸è¿›æœºåˆ¶</h3><p>ä»¥ç”±ç²—åˆ°ç²¾çš„æ–¹å¼å¤„ç†å…·æœ‰æŒ‘æˆ˜æ€§çš„ä»»åŠ¡ã€‚</p><p>æœ¬æ–‡æå‡ºä¸€ç§å¯†é›†è¿æ¥çš„é‡‘å­—å¡”ç»“æ„ï¼Œé€šè¿‡è‡ªä¸‹è€Œä¸Šé€æ­¥ç²¾ç‚¼å¤„ç†æ©ç ï¼Œæ¯ä¸ªé¢„æµ‹æ©ç æˆä¸ºä¸‹ä¸€å°ºåº¦ä¼°è®¡çš„å…ˆéªŒä¿¡æ¯ã€‚</p><h3 id="2-4-Attention-Mechanism-æ³¨æ„åŠ›æœºåˆ¶"><a href="#2-4-Attention-Mechanism-æ³¨æ„åŠ›æœºåˆ¶" class="headerlink" title="2.4 Attention Mechanism æ³¨æ„åŠ›æœºåˆ¶"></a>2.4 Attention Mechanism æ³¨æ„åŠ›æœºåˆ¶</h3><p>æ³¨æ„åŠ›æœºåˆ¶å¯åˆ†ä¸ºä¸¤ç±»ï¼šç©ºé—´æ³¨æ„åŠ›å’Œé€šé“æ³¨æ„åŠ›ã€‚</p><p>æœ¬ç ”ç©¶æå‡ºçš„ç»Ÿä¸€SCCMæ¨¡å‹ï¼Œèƒ½åœ¨åŒä¸€ç‰¹å¾ä¸ŠåŒæ—¶æ¢ç´¢ç©ºé—´åŸŸä¸ç‰¹å¾é€šé“ä¸­çš„å›¾åƒç›¸å…³æ€§ä¸å·®å¼‚æ€§ã€‚<br>æ­¤å¤–ï¼ŒåŸºäºç»´åº¦ç¼©å‡è®¾è®¡ï¼ŒSCCMå¯é€‚é…ä»»æ„å°ºå¯¸çš„ä½çº§ä¸é«˜çº§ç‰¹å¾ã€‚</p><h2 id="3-Methodology"><a href="#3-Methodology" class="headerlink" title="3 Methodology"></a>3 Methodology</h2><p><img src="image.png" alt="alt text"></p><h3 id="3-1-Network-Architecture-ç½‘ç»œæ¶æ„"><a href="#3-1-Network-Architecture-ç½‘ç»œæ¶æ„" class="headerlink" title="3.1 Network Architecture ç½‘ç»œæ¶æ„"></a>3.1 Network Architecture ç½‘ç»œæ¶æ„</h3><p>Top-Down Path</p><ul><li>è½»é‡çº§éª¨å¹²ç½‘ç»œHRNetV2p-W18ï¼Œé»˜è®¤è®¾ç½®</li><li>ä¸åŒå°ºåº¦ç‰¹å¾å¹¶è¡Œè®¡ç®—ï¼Œå¯†é›†çš„å°ºåº¦é—´è¿æ¥å®ç°é«˜æ•ˆä¿¡æ¯äº¤æ¢ï¼Œæœ‰åˆ©äºå¤„ç†å°ºåº¦å˜åŒ–</li><li>å› æ¯ä¸ªå°ºåº¦å‡æ‰§è¡Œå±€éƒ¨ä¸å…¨å±€ç‰¹å¾èåˆï¼Œæ¯ç»„ç‰¹å¾å‡åŒ…å«è¶³å¤Ÿä¿¡æ¯ä»¥é¢„æµ‹å¯¹åº”å°ºåº¦çš„æ“ä½œæ©ç </li></ul><p>æ¯ä¸ªæ©ç çš„é¢„æµ‹éƒ½åº”åŸºäºå…¨éƒ¨å±€éƒ¨ä¸å…¨å±€ç‰¹å¾ä»¥æå‡ç²¾åº¦ã€‚<br>é™¤æœ«çº§é¢„æµ‹æ©ç å¤–ï¼Œå…¶ä½™æ©ç å‡ä½œä¸ºä¸‹ä¸€çº§é¢„æµ‹çš„å…ˆéªŒä¿¡æ¯ã€‚<br>è‡ªé¡¶å‘ä¸‹è·¯å¾„å®Œæˆåï¼Œå°†æå–å››ä¸ªå°ºåº¦çš„æ“çºµç‰¹å¾ï¼Œéšåé€šè¿‡è‡ªåº•å‘ä¸Šè·¯å¾„æ‰§è¡Œæ“çºµæ£€æµ‹ä¸å®šä½ã€‚</p><p>Bottom-Up Path</p><ul><li>æ£€æµ‹åˆ†æ•°åŸºäºè‡ªé¡¶å‘ä¸‹è·¯å¾„æå–çš„ç‰¹å¾</li><li>é€šè¿‡æ£€æµ‹å¤´è¿›è¡Œé¢„æµ‹ï¼Œéšåé€šè¿‡å…¨ç›‘ç£çš„æ¸è¿›æœºåˆ¶ç”Ÿæˆæ“çºµæ©è†œ</li><li>è¯¥ç²—åˆ°ç»†çš„æ¸è¿›æœºåˆ¶æ¨¡æ‹Ÿäº†äººç±»å¤„ç†æ—¥å¸¸å¤æ‚é—®é¢˜çš„æ–¹å¼</li></ul><script type="math/tex; mode=display">M_{n-1} = f_{n-1}(\tau(M_n) \cdot F_{n-1}) , n=2,3,4</script><ul><li>$f_i$ï¼šç¬¬$i$å±‚çš„SCCM</li><li>$F_i$ï¼šè‡ªé¡¶å‘ä¸‹è·¯å¾„æå–çš„ç‰¹å¾</li><li>$M_i$ï¼šè‡ªåº•å‘ä¸Šè·¯å¾„ç”Ÿæˆçš„æ“çºµæ©ç </li><li>$F_i$å’Œ$M_i$çš„å°ºå¯¸ï¼š$H/s^{i-1} \times W/s^{i-1}$ï¼Œ$s=2$ä¸ºä¸‹é‡‡æ ·å› å­</li><li>$\tau(\cdot)$ï¼šä¸Šé‡‡æ ·æ“ä½œï¼ŒåŒçº¿æ€§æ’å€¼</li></ul><p>é¦–å…ˆé¢„æµ‹æœ€ç²—å°ºåº¦ä¸Šçš„æ©ç ï¼Œä»¥æ ¹æ®å½“å‰å¯ç”¨ä¿¡æ¯å®šä½å¯èƒ½è¢«ä¼ªé€ çš„åŒºåŸŸã€‚<br>éšååœ¨æ›´ç»†å°ºåº¦ä¸Šçš„é¢„æµ‹å¯ä»¥åˆ©ç”¨å…ˆå‰çš„æ©ç ï¼Œå¹¶æ›´åŠ å…³æ³¨è¿™äº›é€‰å®šçš„åŒºåŸŸã€‚</p><p>åœ¨æ‰€æœ‰å°ºåº¦ä¸Šåº”ç”¨å…¨ç›‘ç£æ¥æŒ‡å¯¼æ©ç ä¼°è®¡ã€‚</p><h3 id="3-2-Spatio-Channel-Correlation-Module-ç©ºé—´-é€šé“ç›¸å…³æ¨¡å—"><a href="#3-2-Spatio-Channel-Correlation-Module-ç©ºé—´-é€šé“ç›¸å…³æ¨¡å—" class="headerlink" title="3.2 Spatio-Channel Correlation Module ç©ºé—´-é€šé“ç›¸å…³æ¨¡å—"></a>3.2 Spatio-Channel Correlation Module ç©ºé—´-é€šé“ç›¸å…³æ¨¡å—</h3><p><img src="image-1.png" alt="alt text"></p><p>é€šè¿‡ç©ºé—´æ³¨æ„åŠ›æœºåˆ¶ï¼ŒåŸºäºåƒç´ é—´ä¸Šä¸‹æ–‡å…³è”æ€§èšåˆåƒç´ çº§ç‰¹å¾ï¼›<br>åŒæ—¶è¿ç”¨é€šé“æ³¨æ„åŠ›æœºåˆ¶ï¼ŒåŸºäºé€šé“é—´å…³è”æ€§æ•´åˆç‰¹å¾å›¾ã€‚</p>]]></content>
    
    
    <summary type="html">é˜…è¯»è®ºæ–‡ã€ŠPSCC-Netï¼šProgressive Spatio-Channel Correlation Network for Image Manipulation Detection and Localizationã€‹</summary>
    
    
    
    <category term="è®ºæ–‡ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="è®ºæ–‡ç¬”è®°" scheme="https://www.cclmsy.cc/tags/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/"/>
    
    <category term="å›¾åƒä¼ªé€ /ç¯¡æ”¹æ£€æµ‹" scheme="https://www.cclmsy.cc/tags/%E5%9B%BE%E5%83%8F%E4%BC%AA%E9%80%A0-%E7%AF%A1%E6%94%B9%E6%A3%80%E6%B5%8B/"/>
    
  </entry>
  
  <entry>
    <title>è®ºæ–‡ç¬”è®°|FakeShieldï¼šExplainable Image Forgery Detection and Localization via Multi-modal Large Language Models</title>
    <link href="https://www.cclmsy.cc/posts/2410.02761.html"/>
    <id>https://www.cclmsy.cc/posts/2410.02761.html</id>
    <published>2025-10-21T16:00:00.000Z</published>
    <updated>2025-10-28T08:18:05.438Z</updated>
    
    <content type="html"><![CDATA[<p>è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/2410.02761">FakeShield: Explainable Image Forgery Detection and Localization via Multi-modal Large Language Models</a></p><div class="table-container"><table><thead><tr><th style="text-align:center">ç¼©å†™</th><th style="text-align:center">å…¨ç§°</th><th style="text-align:center">ç¿»è¯‘</th></tr></thead><tbody><tr><td style="text-align:center">IFDL</td><td style="text-align:center">Image Forgery Detection and Localization</td><td style="text-align:center">å›¾åƒä¼ªé€ æ£€æµ‹ä¸å®šä½</td></tr></tbody></table></div><h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1 Introduction"></a>1 Introduction</h2><p><img src="https://source.cclmsy.cc/posts/papers/2410.02761/image.png" alt="alt text"></p><p>ç°æœ‰å›¾åƒä¼ªé€ æ£€æµ‹æ–¹æ³•çš„å±€é™æ€§ï¼š</p><ol><li>é»‘ç®±ç‰¹æ€§ï¼Œæ£€æµ‹åŸç†ä¸é€æ˜</li><li>å¯¹å¤šæ ·åŒ–ç¯¡æ”¹æ‰‹æ®µï¼ˆPSã€Deepfakeã€AIGC-Editingï¼‰çš„æ³›åŒ–èƒ½åŠ›ä¸è¶³</li></ol><p>FakeShieldæ¡†æ¶èƒ½åŠ›ï¼š</p><ol><li>è¯„ä¼°å›¾åƒçœŸå®æ€§</li><li>ç”Ÿæˆç¯¡æ”¹åŒºåŸŸï¼ˆå¯è§†åŒ–ï¼‰æ©ç </li><li>åŸºäºåƒç´ çº§ï¼ˆéƒ¨åˆ†ï¼‰ä¸å›¾åƒçº§ï¼ˆå…¨å›¾ï¼‰çš„ç¯¡æ”¹çº¿ç´¢æä¾›åˆ¤æ–­ä¾æ®</li></ol><p>æœ¬æ–‡è´¡çŒ®ï¼š</p><ol><li>æå‡ºFakeShieldï¼ŒåŸºäºå¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹ï¼ˆMLLMï¼‰å®ç°å¯è§£é‡Šå›¾åƒä¼ªé€ æ£€æµ‹ä¸å®šä½</li><li>åˆ©ç”¨GPT-4oä¸ºç°æœ‰çš„IFDLæ•°æ®é›†è¡¥å……æ–‡æœ¬ä¿¡æ¯ï¼ˆæ„å»ºâ€å›¾åƒ-æ©ç -æè¿°â€ä¸‰å…ƒç»„ï¼‰ï¼Œæ„å»ºäº†MMTD-Setæ•°æ®é›†</li><li>å¼€å‘äº†â€œåŸºäºåŸŸæ ‡ç­¾çš„å¯è§£é‡Šä¼ªé€ æ£€æµ‹æ¨¡å—ï¼ˆDTE-FDMï¼‰â€ï¼Œç»Ÿä¸€æ¨¡å‹ä¸­è¯†åˆ«ä¸åŒç±»å‹çš„ä¼ªé€ å›¾åƒ</li><li>æ€§èƒ½è¶…è¶Šå¤§å¤šæ•°ç°æœ‰çš„IFDLæ–¹æ³•</li></ol><h2 id="2-Related-Works"><a href="#2-Related-Works" class="headerlink" title="2 Related Works"></a>2 Related Works</h2><ol><li>é’ˆå¯¹ç‰¹å®šæ“ä½œç±»å‹å®šä½ã€é€šç”¨ç¯¡æ”¹å®šä½æ–¹æ³•ï¼ˆMVSS-Net, OSN, HiFi-Net, IML-ViT, DiffForensics, etc.ï¼‰</li><li>LLM &amp; MLLMï¼Œåˆ©ç”¨MLLMså®ç°é€šç”¨ç¯¡æ”¹å®šä½ä¸æ£€æµ‹ä»å±æœªå¼€å‘é¢†åŸŸ</li></ol><h2 id="3-Methodology"><a href="#3-Methodology" class="headerlink" title="3 Methodology"></a>3 Methodology</h2><h3 id="3-1-Construction-of-the-Proposed-MMTD-Set-MMTD-Setæ•°æ®é›†æ„å»º"><a href="#3-1-Construction-of-the-Proposed-MMTD-Set-MMTD-Setæ•°æ®é›†æ„å»º" class="headerlink" title="3.1 Construction of the Proposed MMTD-Set MMTD-Setæ•°æ®é›†æ„å»º"></a>3.1 Construction of the Proposed MMTD-Set MMTD-Setæ•°æ®é›†æ„å»º</h3><p><img src="https://source.cclmsy.cc/posts/papers/2410.02761/image-1.png" alt="alt text"></p><ul><li>åŠ¨æœºï¼šç°æœ‰çš„IFDLæ•°æ®é›†ç¼ºä¹æ–‡æœ¬æè¿°ä¿¡æ¯<ul><li>æŒ‘æˆ˜ï¼šå¦‚ä½•å°†ç°æœ‰IFDLæ•°æ®é›†ä¸­çš„è§†è§‰ç¯¡æ”¹ä¿¡æ¯å‡†ç¡®è½¬åŒ–ä¸ºç²¾ç¡®çš„æ–‡æœ¬æè¿°</li><li>è´¡çŒ®ï¼š<ul><li>åˆ©ç”¨GPT-4oç”Ÿæˆæ–‡æœ¬æè¿°ï¼Œå¹¶å‘å…¶æä¾›ç¯¡æ”¹å›¾åƒåŠå…¶å¯¹åº”çš„æ©ç ï¼Œä½¿å…¶èƒ½å¤Ÿç²¾ç¡®è¯†åˆ«ç¯¡æ”¹ä½ç½®</li><li>é’ˆå¯¹æ¯ç§ç¯¡æ”¹ç±»å‹ï¼Œæˆ‘ä»¬æ ¹æ®å…¶ç‹¬ç‰¹ç‰¹å¾è®¾è®¡ç‰¹å®šæç¤ºï¼Œå¼•å¯¼GPT-4oèšç„¦äºä¸åŒçš„ç¯¡æ”¹ç—•è¿¹ï¼Œå¹¶æä¾›æ›´è¯¦ç»†çš„è§†è§‰çº¿ç´¢</li></ul></li></ul></li><li>æ•°æ®æ”¶é›†ï¼š<ul><li>Au-Sceneï¼šçœŸå®åœºæ™¯ï¼Œæœªç¯¡æ”¹ï¼Œæ¥è‡ªï¼šFR, CASIAv2, COCO</li><li>Au-Face: çœŸå®äººè„¸ï¼Œæ¥è‡ªï¼šFFHQ</li><li>PhotoShop Tp-Sceneï¼šç»è¿‡PSç¯¡æ”¹çš„åœºæ™¯å›¾åƒï¼Œæ¥è‡ªï¼šFR, CASIAv2</li><li>Deepfake Tp-Faceï¼šç»è¿‡Deepfakeç¯¡æ”¹çš„äººè„¸å›¾åƒï¼Œæ¥è‡ªï¼šFaceAPP</li><li>AIGC-Editing Tp-Sceneï¼šç»è¿‡AIGCç¼–è¾‘çš„åœºæ™¯å›¾åƒ</li></ul></li><li>GPTè¾…åŠ©ç”Ÿæˆæè¿°<ul><li>è¾“å‡ºåˆ†æéœ€éµå¾ªæ ¼å¼ï¼šæ£€æµ‹ç»“æœã€å®šä½æè¿°ã€åˆ¤æ–­ä¾æ®ã€‚</li></ul></li><li>å¯¹äºç¯¡æ”¹è¿‡çš„å›¾åƒï¼š<ul><li>è¾“å…¥ï¼šç¯¡æ”¹å›¾åƒ + å¯¹åº”æ©ç  + ç±»å‹ä¸“ç”¨æç¤ºè¯</li><li>ç›®æ ‡ï¼š<ul><li>ç¯¡æ”¹ä½ç½®ï¼šåŒæ—¶é‡‡ç”¨ç»å¯¹åæ ‡ï¼ˆå¦‚é¡¶éƒ¨ã€å³ä¸‹è§’ï¼‰å’Œç›¸å¯¹ä½ç½®ï¼ˆå¦‚äººç¾¤ä¸Šæ–¹ã€æ¡Œé¢ï¼‰è¿›è¡Œæè¿°</li><li>ç¯¡æ”¹å†…å®¹ï¼šè¯¦ç»†è¯´æ˜ç¯¡æ”¹åŒºåŸŸå†…ç‰©ä½“çš„ç±»å‹ã€æ•°é‡ã€åŠ¨ä½œåŠå±æ€§ï¼Œé’ˆå¯¹ä¸åŒç¯¡æ”¹ç±»å‹ï¼Œå¼ºè°ƒç‰¹å®šè§†è§‰çº¿ç´¢ï¼š<ul><li>PSï¼šå…‰ç…§ (Lighting)ã€å¸¸è¯† (Common Sense)ã€åˆ†è¾¨ç‡ (Resolution)ã€è¾¹ç¼˜ (Edge)ã€å¤åˆ¶ç²˜è´´ (Copy Paste)ã€ç‰©ç†å®šå¾‹ (Physical Laws)ã€é€è§† (Perspective)ã€æ–‡æœ¬ (Text)</li><li>Deepfakeï¼šå¯¹ç§°æ€§ (Symmetry)ã€è¡¨æƒ… (Expressions)ã€å‘å‹ (Hairstyle)ã€æ–‡æœ¬ (Text)ã€åŒ–å¦† (Makeup)ã€é…é¥° (Accessories)ã€å¸¸è¯† (Common Sense)ã€æ¨¡ç³Š (Blur)</li><li>AIGC-Editingï¼šçº¹ç† (Texture)ã€è¾¹ç¼˜ (Edge)ã€å¸¸è¯† (Common Sense)ã€å…‰ç…§ (Lighting)ã€ç»†èŠ‚ä¸¢å¤± (Detail Loss)ã€æ¨¡ç³Š (Blur)ã€è§£å‰–é”™è¯¯ (Anatomy Error)ã€é‡å¤ (Repetition)</li></ul></li></ul></li></ul></li><li>å¯¹äºçœŸå®å›¾åƒï¼š<ul><li>è¾“å…¥ï¼šçœŸå®å›¾åƒ + ç±»å‹ä¸“ç”¨æç¤º</li><li>ç›®æ ‡ï¼šå¼•å¯¼GPTç¡®è®¤å›¾åƒçœŸå®æ€§ï¼Œå¹¶æä¾›æ”¯æŒåˆ¤æ–­çš„è§†è§‰çº¿ç´¢</li></ul></li></ul><h3 id="3-2-Overall-Framework-of-FakeShield-FakeShieldæ•´ä½“æ¡†æ¶"><a href="#3-2-Overall-Framework-of-FakeShield-FakeShieldæ•´ä½“æ¡†æ¶" class="headerlink" title="3.2 Overall Framework of FakeShield FakeShieldæ•´ä½“æ¡†æ¶"></a>3.2 Overall Framework of FakeShield FakeShieldæ•´ä½“æ¡†æ¶</h3><p>ç›®æ ‡ï¼š</p><ol><li>åˆ©ç”¨MLLMçš„æ–‡æœ¬ç†è§£èƒ½åŠ›å’Œä¸–ç•ŒçŸ¥è¯†æ¥åˆ†æå’Œåˆ¤æ–­å›¾åƒçš„çœŸå®æ€§</li><li>é‡‡ç”¨å¯¹ç¯¡æ”¹å›¾åƒçš„åˆ†æå’Œè§£è¯»æ¥è¾…åŠ©åˆ†å‰²æ¨¡å‹ç²¾ç¡®å®šä½ç¯¡æ”¹åŒºåŸŸ</li></ol><p><img src="https://source.cclmsy.cc/posts/papers/2410.02761/image-2.png" alt="alt text"></p><p>FakeShieldæ¨¡å‹åŒ…å«ä¸¤ä¸ªå…³é”®è§£è€¦éƒ¨åˆ†ï¼š</p><ul><li>DTE-FDMï¼šDomain Tag-guided Explainable Forgery Detection Moduleï¼ŒåŸºäºåŸŸæ ‡ç­¾çš„å¯è§£é‡Šä¼ªé€ æ£€æµ‹æ¨¡å—</li><li>MFLMï¼šMulti-modal Forgery Localization Moduleï¼Œå¤šæ¨¡æ€ä¼ªé€ å®šä½æ¨¡å—</li></ul><blockquote><p>å°†åŸå§‹ç–‘ä¼¼å›¾åƒ$I<em>{ori}$ä¸æŒ‡ä»¤æ–‡æœ¬$T</em>{ins}$ï¼ˆä¾‹å¦‚â€œèƒ½å¦è¯†åˆ«ç…§ç‰‡ä¸­çš„ç¯¡æ”¹åŒºåŸŸï¼Ÿâ€ï¼‰è¾“å…¥DTE-FDMæ¨¡å—ï¼Œä»¥é¢„æµ‹æ£€æµ‹ç»“æœåŠåˆ¤æ–­ä¾æ®$O<em>{det}$ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨å¯å­¦ä¹ ç”Ÿæˆå™¨ç”ŸæˆåŸŸæ ‡ç­¾$T</em>{tag}$ï¼Œä»è€Œè§„é¿ç¯¡æ”¹æ•°æ®çš„åŸŸå†²çªé—®é¢˜ã€‚</p><p>æ­¤å¤–ï¼Œæˆ‘ä»¬å°†è§£é‡Šç»“æœ$O<em>{det}$ä¸å›¾åƒ$I</em>{ori}$è¾“å…¥å¤šæ¨¡æ€å®šä½æ¨¡å‹ï¼ˆMFLMï¼‰ï¼Œç²¾å‡†æå–ç¯¡æ”¹åŒºåŸŸæ©è†œ$M_{loc}$ã€‚ä¸ºä¿ƒè¿›è·¨æ¨¡æ€äº¤äº’å®ç°ç¯¡æ”¹å®šä½ï¼Œæˆ‘ä»¬å¼•å…¥ç¯¡æ”¹ç†è§£æ¨¡å—ï¼Œé€šè¿‡è§†è§‰ä¸æ–‡æœ¬ç‰¹å¾å¯¹é½å¢å¼ºè§†è§‰åŸºç¡€æ¨¡å‹å¯¹é•¿æè¿°çš„ç†è§£èƒ½åŠ›ã€‚</p></blockquote><h3 id="3-3-Domain-Tag-guided-Explainable-Forgery-Detection-Module-DTE-FDM-åŸºäºåŸŸæ ‡ç­¾çš„å¯è§£é‡Šä¼ªé€ æ£€æµ‹æ¨¡å—"><a href="#3-3-Domain-Tag-guided-Explainable-Forgery-Detection-Module-DTE-FDM-åŸºäºåŸŸæ ‡ç­¾çš„å¯è§£é‡Šä¼ªé€ æ£€æµ‹æ¨¡å—" class="headerlink" title="3.3 Domain Tag-guided Explainable Forgery Detection Module (DTE-FDM) åŸºäºåŸŸæ ‡ç­¾çš„å¯è§£é‡Šä¼ªé€ æ£€æµ‹æ¨¡å—"></a>3.3 Domain Tag-guided Explainable Forgery Detection Module (DTE-FDM) åŸºäºåŸŸæ ‡ç­¾çš„å¯è§£é‡Šä¼ªé€ æ£€æµ‹æ¨¡å—</h3><ul><li>åŠ¨æœºï¼šç¯¡æ”¹æ–¹å¼å¤šæ ·ï¼Œå…·æœ‰ä¸åŒç‰¹å¾ï¼Œå•ä¸€IFDLæ–¹æ³•éš¾ä»¥å…¼é¡¾</li><li>æå‡ºï¼šDTG(Domain Tag Generatorï¼ŒåŸŸæ ‡ç­¾ç”Ÿæˆå™¨)<ul><li>ä½œç”¨ï¼šä¸ºæ¯ä¸ªè¾“å…¥å›¾åƒç”ŸæˆåŸŸæ ‡ç­¾ï¼ŒæŒ‡å¯¼æ¨¡å‹è¯†åˆ«ä¸åŒç¯¡æ”¹ç±»å‹</li></ul></li></ul><p>æ­¥éª¤ï¼š</p><ol><li>åŸå§‹å›¾åƒ $I<em>{ori}$ è¾“å…¥åˆ†ç±»å™¨ $G</em>{dt}$ï¼Œç”ŸæˆåŸŸæ ‡ç­¾ $T_{tag}$ ã€‚<ul><li>$T<em>{tag}=G</em>{dt}(I_{ori})$</li><li>$T_{tag}$: â€œThis is a suspected {data domain}-tampered picture.â€</li></ul></li><li>åŸå§‹å›¾åƒ $I<em>{ori}$ ç»è¿‡ç¼–ç å™¨ $F</em>{enc}$ å’Œçº¿æ€§æŠ•å½±å±‚ $F<em>{proj}$ï¼Œå¾—åˆ°å›¾åƒToken $T</em>{img}$ã€‚<ul><li>$T<em>{img}=F</em>{proj}(F<em>{enc}(I</em>{ori}))$</li></ul></li><li>æ‹¼æ¥è¾“å…¥ï¼š$T<em>{ins}+T</em>{tag}+T_{img}$<ul><li>$T_{ins}$ï¼šè¦æ±‚æ¨¡å‹æ£€æµ‹ç¯¡æ”¹å¹¶æè¿°ç¯¡æ”¹ä½ç½®çš„æç¤ºè¯</li></ul></li><li>è¾“å…¥LLMï¼Œè¾“å‡ºç»“æœ $O<em>{det}=LLM(T</em>{ins}+T<em>{tag}+T</em>{img})$<ul><li>$O<em>{det}=LLM(T</em>{ins}+T<em>{tag}+T</em>{img})$</li><li>$O_{det}$ï¼šåŒ…å«æ£€æµ‹ç»“æœã€ç¯¡æ”¹åŒºåŸŸä½ç½®æè¿°ã€è§£é‡Šæ£€æµ‹ä¾æ®</li></ul></li></ol><h3 id="3-4-Multi-modal-Forgery-Localization-Module-MFLM-å¤šæ¨¡æ€ä¼ªé€ å®šä½æ¨¡å—"><a href="#3-4-Multi-modal-Forgery-Localization-Module-MFLM-å¤šæ¨¡æ€ä¼ªé€ å®šä½æ¨¡å—" class="headerlink" title="3.4 Multi-modal Forgery Localization Module (MFLM) å¤šæ¨¡æ€ä¼ªé€ å®šä½æ¨¡å—"></a>3.4 Multi-modal Forgery Localization Module (MFLM) å¤šæ¨¡æ€ä¼ªé€ å®šä½æ¨¡å—</h3><ul><li>åŠ¨æœºï¼š$O_{det}$æä¾›çš„â€œç¯¡æ”¹åŒºåŸŸä½ç½®æè¿°â€ç¼ºä¹ç²¾ç¡®æ€§å’Œç›´è§‚æ€§</li><li>ç›®æ ‡ï¼šå°†$O_{det}$è½¬åŒ–ä¸ºç²¾ç¡®çš„äºŒè¿›åˆ¶æ©ç </li><li>æå‡ºï¼šTCMï¼ˆTampering Comprehension Moduleï¼Œç¯¡æ”¹ç†è§£æ¨¡å—ï¼‰<ul><li>ä½œç”¨ï¼šå°†é•¿æ–‡æœ¬ç‰¹å¾ä¸è§†è§‰æ¨¡æ€å¯¹é½ï¼Œæå‡SAM(Segment Anything Model)å®šä½ä¼ªé€ åŒºåŸŸçš„ç²¾åº¦</li></ul></li></ul><p>æ­¥éª¤ï¼š</p><ol><li>å°†$T<em>{img}$ä¸$O</em>{det}$è¾“å…¥TCM $C<em>t$ï¼Œæå–æœ€åä¸€å±‚åµŒå…¥ï¼Œé€šè¿‡å¤šå±‚æ„ŸçŸ¥å™¨æŠ•å½±å±‚å°†å…¶è½¬æ¢ä¸º$h</em>{\text{SEG}}$ã€‚<ul><li>$h<em>{\text{SEG}}=\text{Extract}(C_t(T</em>{img},O_{det}))$</li><li>$\text{Extract}$ ï¼šæå–TCMçš„æœ€åä¸€å±‚åµŒå…¥</li></ul></li><li>$h<em>{\text{SEG}}$ ä½œä¸º $SAM(S)$ çš„ä¸­é—´æç¤ºä¿¡æ¯ï¼Œä¸å›¾åƒ $I</em>{ori}$ çš„è§†è§‰ç‰¹å¾ $F<em>{img}$ ç»“åˆï¼Œç”Ÿæˆæœ€ç»ˆæ©ç  $M</em>{loc}$ ã€‚<ul><li>$M<em>{loc}=S</em>{dec}(S<em>{enc}(I</em>{ori}),h_{\text{SEG}})$</li></ul></li></ol><h3 id="3-5-Training-Objectives-è®­ç»ƒç›®æ ‡"><a href="#3-5-Training-Objectives-è®­ç»ƒç›®æ ‡" class="headerlink" title="3.5 Training Objectives è®­ç»ƒç›®æ ‡"></a>3.5 Training Objectives è®­ç»ƒç›®æ ‡</h3><p>DTE-FDMè®­ç»ƒç›®æ ‡ï¼š</p><script type="math/tex; mode=display">\ell_{det} = \ell_{ce}(\hat O_{det}, O_{det}) + \lambda \cdot \ell_{ce}(\hat T_{tag}, T_{tag})</script><ul><li>$\ell_{ce}$ï¼šäº¤å‰ç†µæŸå¤±å‡½æ•°</li><li>$T_{tag}$ï¼šDTGç”Ÿæˆçš„åŸŸæ ‡ç­¾</li><li>$O_{det}$ï¼šLLMçš„é¢„æµ‹ç»“æœ</li><li>$\lambda$ï¼šå¹³è¡¡ç³»æ•°</li></ul><p>MFLMè®­ç»ƒç›®æ ‡ï¼š</p><script type="math/tex; mode=display">\ell_{loc} = \ell_{ce}(\hat y_{txt}, y_{txt}) + \alpha \cdot \ell_{bce}(\hat M_{loc}, M_{loc}) + \beta \cdot \ell_{dice}(\hat M_{loc}, M_{loc})</script><ul><li>$\ell_{bce}$ï¼šäºŒè¿›åˆ¶äº¤å‰ç†µæŸå¤±</li><li>$\ell_{dice}$ï¼šDiceæŸå¤±</li><li>$y_{txt}$ï¼šç”±TCMç”Ÿæˆçš„åŒ…å«$\text{<SEG>}$æ ‡è®°çš„é«˜è´¨é‡æç¤ºæ–‡æœ¬</li></ul>]]></content>
    
    
    <summary type="html">é˜…è¯»è®ºæ–‡ã€ŠFakeShieldï¼šExplainable Image Forgery Detection and Localization via Multi-modal Large Language Modelsã€‹</summary>
    
    
    
    <category term="è®ºæ–‡ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="è®ºæ–‡ç¬”è®°" scheme="https://www.cclmsy.cc/tags/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/"/>
    
    <category term="å›¾åƒä¼ªé€ æ£€æµ‹" scheme="https://www.cclmsy.cc/tags/%E5%9B%BE%E5%83%8F%E4%BC%AA%E9%80%A0%E6%A3%80%E6%B5%8B/"/>
    
  </entry>
  
  <entry>
    <title>è®ºæ–‡ç¬”è®°|Towards a Universal Synthetic Video Detectorï¼š From Face or Background Manipulations to Fully AI-Generated Content</title>
    <link href="https://www.cclmsy.cc/posts/2412.12278.html"/>
    <id>https://www.cclmsy.cc/posts/2412.12278.html</id>
    <published>2025-10-14T16:00:00.000Z</published>
    <updated>2025-10-16T11:48:04.843Z</updated>
    
    <content type="html"><![CDATA[<p>è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/2412.12278">Towards a Universal Synthetic Video Detector: From Face or Background Manipulations to Fully AI-Generated Content(CVPR2025)</a></p><h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h2><p>DeepFakeå’Œç›¸å…³æ£€æµ‹æŠ€æœ¯ä¸»è¦ä¸ºé¢éƒ¨ä¿®æ”¹ï¼Œä½†ç°æœ‰çš„æ–‡æœ¬åˆ°è§†é¢‘ï¼ˆT2Vï¼‰å’Œå›¾åƒåˆ°è§†é¢‘ï¼ˆI2Vï¼‰ç”Ÿæˆæ¨¡å‹ï¼ˆAVIDã€GTA-Vã€T2V/I2Vï¼‰æ”¯æŒä»»æ„å†…å®¹çš„æ›´æ”¹ã€åˆæˆï¼Œå› æ­¤éœ€è¦é€šç”¨çš„AIGVCæ£€æµ‹å™¨ã€‚</p><div class="table-container"><table><thead><tr><th style="text-align:center">æ–¹æ³•</th><th style="text-align:center">é¢éƒ¨æ“çºµ</th><th style="text-align:center">èƒŒæ™¯æ“çºµ</th><th style="text-align:center">T2V/I2V</th></tr></thead><tbody><tr><td style="text-align:center">ç°æœ‰æ–¹æ³•</td><td style="text-align:center">âˆš</td><td style="text-align:center">Ã—</td><td style="text-align:center">Ã—</td></tr><tr><td style="text-align:center">ä½¿ç”¨äº¤å‰ç†µæŸå¤±çš„å…¨å¸§æ£€æµ‹</td><td style="text-align:center">âˆš</td><td style="text-align:center">Ã—</td><td style="text-align:center">â‰ˆ</td></tr><tr><td style="text-align:center">UNITE</td><td style="text-align:center">âˆš</td><td style="text-align:center">âˆš</td><td style="text-align:center">âˆš</td></tr></tbody></table></div><p><img src="https://source.cclmsy.cc/posts/papers/2412.12278/image.png" alt="alt text"></p><p>æœ¬æ–‡æå‡ºï¼šthe Universal Network for Identifying Tampered and synthEtic videosï¼ˆUNITEï¼Œç”¨äºè¯†åˆ«ç¯¡æ”¹å’Œåˆæˆè§†é¢‘çš„é€šç”¨ç½‘ç»œï¼‰</p><ol><li>å¯ä»¥æ•è·å…¨å¸§æ“çºµï¼ˆFull-frame Manipulationï¼‰ï¼Œæ— è®ºæ˜¯å¦æœ‰äººè„¸</li><li>å°†æ£€æµ‹åŠŸèƒ½æ‰©å±•åˆ°æ²¡æœ‰äººè„¸ã€éäººç±»ä¸»ä½“å’Œå¤æ‚èƒŒæ™¯ä¿®æ”¹çš„åœºæ™¯</li><li>å¼•å…¥â€œAttention Diversityâ€ Lossï¼Œç›¸æ¯”äº¤å‰ç†µæŸå¤±ï¼Œé¼“åŠ±å…³æ³¨è§†é¢‘çš„ä¸åŒåŒºåŸŸ</li><li>é‡‡ç”¨åˆ›æ–°çš„è®­ç»ƒç­–ç•¥</li></ol><h2 id="2-Related-Work"><a href="#2-Related-Work" class="headerlink" title="2. Related Work"></a>2. Related Work</h2><h3 id="2-1-Face-centric-DeepFake-Detection-ä¸“æ³¨äºäººè„¸çš„DeepFakeæ£€æµ‹"><a href="#2-1-Face-centric-DeepFake-Detection-ä¸“æ³¨äºäººè„¸çš„DeepFakeæ£€æµ‹" class="headerlink" title="2.1 Face-centric DeepFake Detection ä¸“æ³¨äºäººè„¸çš„DeepFakeæ£€æµ‹"></a>2.1 Face-centric DeepFake Detection ä¸“æ³¨äºäººè„¸çš„DeepFakeæ£€æµ‹</h3><p>ç©ºé—´ä¸ä¸€è‡´æ€§ï¼ˆå›¾åƒå†…ï¼‰ï¼š</p><ol><li>Concasâ€™ï¼šåœ¨é«˜é¢‘åŸŸè¿½è¸ªç‰¹å®šé¢éƒ¨ç‰¹å¾ï¼Œç¼ºä¹æ™®é€‚æ€§</li><li>PUDDï¼šçœŸå®è§†é¢‘ä¸­å­¦ä¹ ç‰¹å®šäººç‰©çš„åŸå‹ï¼Œå¯¹çœŸå®çš„ç”Ÿç‰©ç‰¹å¾å’Œè¡Œä¸ºæ¨¡å¼è¿›è¡Œå»ºæ¨¡ï¼Œåœ¨å®é™…åœºæ™¯ä¸­æ•ˆæœæœ‰é™</li><li>LAA-Netï¼šé€šè¿‡ä¸€ä¸ªå¤šä»»åŠ¡æ³¨æ„åŠ›æ¨¡å—æ¥æå‡æ³›åŒ–èƒ½åŠ›ï¼Œä½¿ç”¨çƒ­åŠ›å›¾å’Œè‡ªä¸€è‡´æ€§å›å½’æ£€æµ‹ä¼ªå½±ç‰¹å¾ã€‚éœ€è¦é€å¸§åˆ†æè§†é¢‘é™æ€ç”»é¢ï¼Œäº§ç”Ÿå·¨å¤§çš„è®¡ç®—å¼€é”€ï¼Œé™åˆ¶äº†æ‰©å±•æ€§</li></ol><p>ç”Ÿç‰©ç‰¹å¾ä¸€è‡´æ€§ï¼ˆé’ˆå¯¹ä¸ªä½“ï¼‰ï¼š</p><ol><li>DPNetï¼šé€šè¿‡åŠ¨æ€ç‰¹å¾è¡¨ç¤ºå®ç°å¯è§£é‡Šçš„ã€åŸºäºåŸå‹çš„éè‡ªç„¶è¿åŠ¨æ£€æµ‹</li><li>IDRevealï¼šåœ¨çœŸå®æ•°æ®ä¸Šè¿›è¡Œçš„åº¦é‡å­¦ä¹ </li><li>PUDDä¹Ÿå±äºæ­¤ç±»</li></ol><ul><li>ä¾èµ–çœŸå®å‚è€ƒè§†é¢‘ä½œä¸ºå‰ææ¡ä»¶ï¼Œå¯¼è‡´å…¶éš¾ä»¥åº”å¯¹ç°å®åœºæ™¯ä¸­çš„æ·±åº¦ä¼ªé€ æ£€æµ‹ã€‚</li></ul><p>æ—¶åºä¸è¿ç»­æ€§ï¼ˆå›¾åƒå˜åŒ–ï¼‰ï¼š</p><ol><li>TI2Netï¼šå‡å»è¿ç»­å¸§çš„ç‰¹å¾</li><li>TALLï¼šä»éšæœºæ—¶é—´æˆ³è·å–çš„å››ä¸ªè¿ç»­å¸§æ„å»ºå¤åˆâ€œç¼©ç•¥å›¾â€å›¾åƒ</li><li>StyleGRUï¼šæ—¶åºç‰¹å¾ç›®æ ‡åŒ–ï¼Œä¸¥æ ¼é™åˆ¶äºè£å‰ªçš„é¢éƒ¨åŒºåŸŸï¼Œä»…é€‚ç”¨äºé¢éƒ¨æ“çºµ</li></ol><h3 id="2-2-Synthetic-Video-Detection-åˆæˆè§†é¢‘æ£€æµ‹"><a href="#2-2-Synthetic-Video-Detection-åˆæˆè§†é¢‘æ£€æµ‹" class="headerlink" title="2.2 Synthetic Video Detection åˆæˆè§†é¢‘æ£€æµ‹"></a>2.2 Synthetic Video Detection åˆæˆè§†é¢‘æ£€æµ‹</h3><p>åˆæˆè§†é¢‘æ£€æµ‹ä»æ˜¯ä¸€ä¸ªå¾ˆå°‘è¢«æ¢ç´¢çš„é¢†åŸŸã€‚</p><p>DeMambaè¿ç»­æ‰«ææ–¹æ³•ï¼š</p><ul><li>åˆ†æè§†é¢‘å¸§çš„å°èŒƒå›´åŒºåŸŸï¼Œæ•æ‰åƒç´ åœ¨æ—¶ç©ºç»´åº¦ä¸Šçš„å˜åŒ–è§„å¾‹ã€‚</li><li>å…¶è¿ç»­æ‰«ææŠ€æœ¯èƒ½æ›´ç²¾å‡†è¿½è¸ªç»†å¾®å˜åŒ–å’Œæ¨¡å¼ç‰¹å¾ï¼Œä»è€Œæ›´æ˜“è¯†åˆ«ç»è¿‡å¤„ç†æˆ–ä¼ªé€ çš„å†…å®¹ã€‚</li></ul><p>ç¼ºç‚¹ï¼šæœªç»ä¸»æµDeepFakeæ•°æ®é›†ä¸Šçš„éªŒè¯</p><p>ï¼ˆæ–¹æ³•é™„ä¸€ä¸ªç™¾ä¸‡çº§T2V/I2Væ•°æ®é›†ï¼‰</p><h2 id="3-Method"><a href="#3-Method" class="headerlink" title="3. Method"></a>3. Method</h2><p><img src="https://source.cclmsy.cc/posts/papers/2412.12278/image-1.png" alt="alt text"></p><p>å°†è¡¨å¾å­¦ä¹ ï¼ˆç”±SigLIPè´Ÿè´£ï¼‰ä¸æ³•è¯å­¦ä¹ ï¼ˆç”±å¯è®­ç»ƒçš„Transformerè´Ÿè´£ï¼‰æ˜ç¡®åˆ†ç¦»ã€‚</p><p>æ³¨æ„åŠ›å›¾æºè‡ªç¼–ç å™¨æ¨¡å—çš„è¾“å‡ºï¼Œä¸»è¦ç”¨äºè®¡ç®—AD Lossï¼ˆ3.4ï¼‰ï¼Œå¹¶ç›´è§‚å±•ç¤ºæ¨¡å‹åœ¨åˆ†ç±»è¿‡ç¨‹ä¸­å¯¹è§†é¢‘å¸§ä¸­ä¸åŒç©ºé—´åŒºåŸŸçš„ä¼˜å…ˆçº§åˆ†é…ï¼ˆå›¾3ï¼‰ã€‚</p><h3 id="3-1-Problem-Setup-é—®é¢˜å»ºæ¨¡"><a href="#3-1-Problem-Setup-é—®é¢˜å»ºæ¨¡" class="headerlink" title="3.1 Problem Setup é—®é¢˜å»ºæ¨¡"></a>3.1 Problem Setup é—®é¢˜å»ºæ¨¡</h3><p>é‡‡æ ·ç­–ç•¥ï¼š</p><ul><li>éš”1å¸§æŠ½å–ï¼Œ$n_f=64$ä¸ªè¿ç»­å¸§åˆæˆä¸€ä¸ªç‰‡æ®µï¼ˆä¸è¶³å¡«å……ï¼‰ï¼Œè®°ä¸ºä¸€ä¸ªæ•°æ®å•å…ƒ$v$</li><li>åŸå§‹è§†é¢‘æ ‡ç­¾å·²çŸ¥ï¼Œæ¯ä¸ªæ•°æ®å•å…ƒçš„æ ‡ç­¾$l$ä¸æºè§†é¢‘ç›¸åŒ</li><li>æœ€ç»ˆå¾—åˆ°è§†é¢‘æ•°æ®é›†$V={(v_i,l_i)|i=1,2,â€¦,N}$</li></ul><p>è¯¥ç­–ç•¥åŒæ—¶ä½œä¸ºæ•°æ®å¢å¼ºæ–¹æ³•ï¼Œåœ¨ä¸é¢å¤–æ”¶é›†æ•°æ®çš„æƒ…å†µä¸‹å¢åŠ è®­ç»ƒæ ·æœ¬çš„æ•°é‡ã€‚</p><h3 id="3-2-Domain-Agnostic-Feature-Extraction-åŸŸæ— å…³ç‰¹å¾æå–"><a href="#3-2-Domain-Agnostic-Feature-Extraction-åŸŸæ— å…³ç‰¹å¾æå–" class="headerlink" title="3.2 Domain-Agnostic Feature Extraction åŸŸæ— å…³ç‰¹å¾æå–"></a>3.2 Domain-Agnostic Feature Extraction åŸŸæ— å…³ç‰¹å¾æå–</h3><p>é‡‡ç”¨å†»ç»“çš„SigLIP-So400mæ¨¡å‹ï¼ˆâ€œshape-optimizedâ€VITï¼‰ä½œä¸ºç‰¹å¾æå–å™¨ã€‚</p><blockquote><p>ä½¿ç”¨30äº¿ä¸ªå¤šæ ·åŒ–æ ·æœ¬å’ŒsigmoidæŸå¤±å‡½æ•°è¿›è¡Œå¯¹æ¯”è®­ç»ƒã€‚<br>æ—¢ä¿æŒäº†ç´§å‡‘çš„å‚æ•°è§„æ¨¡ï¼ˆ4äº¿å‚æ•°ï¼‰ï¼Œåˆèƒ½å¤Ÿæ•æ‰ç¨³å¥ä¸”é€šç”¨çš„ç‰¹å¾ã€‚<br>æ·±åº¦é¢„è®­ç»ƒä½¿SigLIPç‰¹åˆ«æ“…é•¿æå–é¢†åŸŸæ— å…³è¡¨ç¤ºï¼Œè¿™å¯¹äºåº”å¯¹DeepFakeæ•°æ®é›†å’ŒçœŸå®åœºæ™¯ä¸­é‡åˆ°çš„æ˜¾è‘—å·®å¼‚è‡³å…³é‡è¦ã€‚</p></blockquote><p>å¯¹äºæ ·æœ¬$v_i\in V$çš„æ¯ä¸€å¸§ï¼ˆResize to 384Ã—384Ã—3ï¼‰ï¼Œæå–å…¶ç‰¹å¾ï¼š</p><script type="math/tex; mode=display">e_j=SigLIP(f_j)\in \mathbb{R}^{t_s\times d_s}, j=1,2,...,n_f</script><ul><li>ç¼–ç é•¿åº¦$t_s=729$ï¼Œç‰¹å¾ç»´åº¦$d_s=1152$</li></ul><p>æŒ‰ç…§åŸå§‹é¡ºåºæ‹¼æ¥å¾—åˆ°è§†é¢‘ç‰‡æ®µç¼–ç $\xi<em>i\in \mathbb{R}^{nf\times ts\times ds}$ï¼Œæœ€ç»ˆå¾—åˆ°ç¼–ç è§†é¢‘æ•°æ®é›†$V</em>{\xi}={(\xi_i,l_i)|i=1,2,â€¦,N}$ï¼Œä½œä¸ºTransformerçš„è¾“å…¥ã€‚</p><h3 id="3-3-Learnable-Transformer-Architecture-å¯å­¦ä¹ çš„Transformeræ¶æ„"><a href="#3-3-Learnable-Transformer-Architecture-å¯å­¦ä¹ çš„Transformeræ¶æ„" class="headerlink" title="3.3 Learnable Transformer Architecture å¯å­¦ä¹ çš„Transformeræ¶æ„"></a>3.3 Learnable Transformer Architecture å¯å­¦ä¹ çš„Transformeræ¶æ„</h3><p>UNITEæ¶æ„æ˜¯åŸºäºMHSAï¼ˆMulti-Head Self-Attentionï¼‰æœºåˆ¶çš„Transformerï¼Œä¸“ä¸ºè§†é¢‘åˆ†ç±»ä»»åŠ¡è®¾è®¡ï¼Œæ”¯æŒæ·±åº¦ï¼ˆå†…éƒ¨å †å çš„ç¼–ç å™¨å—æ•°é‡ï¼‰è°ƒèŠ‚ã€‚</p><p>æ·±åº¦æ›´å¤§çš„æ¶æ„èƒ½æ•æ‰æ›´å¤æ‚çš„ç‰¹å¾ï¼Œä½†ä¼šå¢åŠ è®¡ç®—å¤æ‚åº¦ï¼Œæœ€ç»ˆé€‰æ‹©äº†æ·±åº¦ä¸º4çš„æ¶æ„ï¼ˆé€šè¿‡æ¶ˆèå®éªŒç¡®å®šï¼Œå®éªŒä½äº4.4ï¼‰</p><h4 id="3-3-1-Encoder-Block-ç¼–ç å™¨å—"><a href="#3-3-1-Encoder-Block-ç¼–ç å™¨å—" class="headerlink" title="3.3.1 Encoder Block ç¼–ç å™¨å—"></a>3.3.1 Encoder Block ç¼–ç å™¨å—</h4><ol><li>MHSAï¼šæ¶æ„ä½¿ç”¨$n_h=12$ä¸ªæ³¨æ„åŠ›å¤´<ul><li>èƒ½æ•æ‰å¸§é—´å¤šæ ·åŒ–çš„äº¤äº’å…³ç³»ä¸ä¾èµ–æ€§</li><li>å½’ä¸€åŒ–ç‚¹ç§¯æ³¨æ„åŠ›æœºåˆ¶ï¼šæœ‰æ•ˆç¯èŠ‚æ¢¯åº¦çˆ†ç‚¸</li></ul></li><li>Add&amp;Normï¼šæ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–<ul><li>æ®‹å·®è¿æ¥ï¼šå°†è¾“å…¥ç›´æ¥æ·»åŠ åˆ°è¾“å‡ºï¼Œç¼“è§£æ·±å±‚ç½‘ç»œä¸­çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜</li><li>å±‚å½’ä¸€åŒ–ï¼šå½’ä¸€åŒ–åˆ°æ­£æ€åˆ†å¸ƒï¼Œç¨³å®šè®­ç»ƒè¿‡ç¨‹ï¼ŒåŠ é€Ÿæ”¶æ•›</li><li>Dropoutï¼šåœ¨æ³¨æ„åŠ›æœºåˆ¶åéƒ¨åˆ†åº”ç”¨ï¼ŒæŠ‘åˆ¶è¿‡æ‹Ÿåˆ</li></ul></li><li>MLPï¼šå‰é¦ˆç½‘ç»œï¼Œç”¨äºå¯¹ç‰¹å¾è¿›è¡Œéçº¿æ€§å˜æ¢<ul><li>ä¸­é—´ç”¨GELUæ¿€æ´»å‡½æ•°ï¼Œé€šè¿‡éçº¿æ€§ç‰¹å¾å˜æ¢æ˜¾è‘—æå‡æ¨¡å‹è¡¨è¾¾èƒ½åŠ›</li></ul></li></ol><p><img src="https://source.cclmsy.cc/posts/papers/2412.12278/image-2.png" alt="alt text"></p><p>è¯¥éƒ¨åˆ†å‚è€ƒTransformerçš„æ ‡å‡†æ¶æ„è®¾è®¡ï¼Œé€‚å½“è°ƒæ•´ä»¥é€‚åº”è§†é¢‘åˆ†ç±»ä»»åŠ¡ã€‚</p><h4 id="3-3-2-Positional-Encoding-ä½ç½®ç¼–ç "><a href="#3-3-2-Positional-Encoding-ä½ç½®ç¼–ç " class="headerlink" title="3.3.2 Positional Encoding ä½ç½®ç¼–ç "></a>3.3.2 Positional Encoding ä½ç½®ç¼–ç </h4><p>é‡‡ç”¨ä¸åŸå§‹transformerç›¸åŒçš„æ­£å¼¦ä½™å¼¦ä½ç½®ç¼–ç æ–¹æ¡ˆã€‚</p><p><img src="https://source.cclmsy.cc/posts/papers/2412.12278/image-3.png" alt="alt text"></p><h4 id="3-4-Attention-Diversity-Loss-æ³¨æ„åŠ›å¤šæ ·æ€§æŸå¤±"><a href="#3-4-Attention-Diversity-Loss-æ³¨æ„åŠ›å¤šæ ·æ€§æŸå¤±" class="headerlink" title="3.4 Attention-Diversity Loss æ³¨æ„åŠ›å¤šæ ·æ€§æŸå¤±"></a>3.4 Attention-Diversity Loss æ³¨æ„åŠ›å¤šæ ·æ€§æŸå¤±</h4><p><img src="https://source.cclmsy.cc/posts/papers/2412.12278/image-4.png" alt="alt text"></p><p>ä»…ä½¿ç”¨CE Lossè®­ç»ƒMHSA Transformeræ—¶ï¼Œå…¶æ³¨æ„åŠ›å›¾ä¼šè‡ªç„¶è¿‡åº¦èšç„¦äºç”»é¢ä¸­çš„äººè„¸åŒºåŸŸã€‚<br>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ¬æ–‡å¼•å…¥äº†Attention-Diversity Lossï¼ˆAD Lossï¼‰ï¼Œè®©æ³¨æ„åŠ›å¤´å…³æ³¨è§†é¢‘çš„ä¸åŒåŒºåŸŸã€‚</p><p>æ± åŒ–ç‰¹å¾å‘é‡ï¼ˆæ ·æœ¬çº§ï¼‰ä»£è¡¨äº†æ¯ä¸ªæ³¨æ„åŠ›å¤´å’Œæ¯å¸§çš„å‹ç¼©ã€åŠ æƒç‰¹å¾å‘é‡ï¼š</p><script type="math/tex; mode=display">\mathcal{P} = \sum_{j=1}^{l_a} \sum_{k=1}^{d_a} \mathcal{A}_{h,j,k} \cdot \xi_{f,j,k}</script><ul><li>æ± åŒ–ç‰¹å¾å‘é‡$\mathcal{P} \in \mathbb{R}^{n_h\times n_f}$</li><li>æ³¨æ„åŠ›è¾“å‡º$\mathcal{A} \in \mathbb{R}^{n_h\times t_s\times d_s}$</li><li>è§†é¢‘ç¼–ç $\xi \in \mathbb{R}^{n_f\times t_s\times d_s}$</li><li>$n_h$ï¼šæ³¨æ„åŠ›å¤´æ•°ï¼Œ$n_f$ï¼šå¸§æ•°ï¼Œ$t_s$ï¼šç¼–ç é•¿åº¦ï¼Œ$d_s$ï¼šç‰¹å¾ç»´åº¦</li><li>$f$ï¼šå¸§ç´¢å¼•ï¼Œ$j,k$ï¼šæ³¨æ„åŠ›å›¾çš„ç©ºé—´ä½ç½®</li></ul><p>åŠ¨æ€ç‰¹å¾ä¸­å¿ƒï¼ˆç±»åˆ«çº§ï¼‰å­¦ä¹ ï¼š</p><script type="math/tex; mode=display">C^{\tau} = C^{\tau-1} - \eta \left(C^{\tau-1} - \frac{1}{B} \sum_{b=1}^{B} \mathcal{P}_b \right)</script><ul><li>$C^{\tau} \in \mathbb{R}^{n_h\times n_f}$ï¼šç¬¬$\tau$æ¬¡è¿­ä»£çš„åŠ¨æ€ç‰¹å¾ä¸­å¿ƒï¼Œ$C^0=0$</li><li>$B$ï¼šå½“å‰æ‰¹æ¬¡å¤§å°</li><li>$\eta$ï¼šç‰¹å¾ä¸­å¿ƒæ›´æ–°çš„å­¦ä¹ ç‡ï¼Œ0.05</li></ul><p>ç±»å†…æŸå¤±ï¼Œä¿ƒä½¿ç›¸ä¼¼æ ·æœ¬èšé›†åœ¨ä¸€èµ·ï¼š</p><script type="math/tex; mode=display">L_{within} = \max(|| \mathcal{P} - C ||_2-\delta_{within},0)</script><ul><li>$||x||_2$ï¼šL2å½’ä¸€åŒ–</li><li>$\delta_{within}$ï¼šè¶…å‚æ•°ï¼Œé˜ˆå€¼å†…è§†ä¸º0ï¼Œé¼“åŠ±ç±»å†…æ ·æœ¬æ¥è¿‘ç‰¹å¾ä¸­å¿ƒ</li></ul><p>ç±»é—´æŸå¤±ï¼Œä¿ƒä½¿ä¸åŒç±»åˆ«çš„æ ·æœ¬åˆ†ç¦»ï¼š</p><script type="math/tex; mode=display">\mathcal{L}_{\text{between}} = \sum_{\substack{k \neq l \\\\ (k, l) \in (n_h, n_h)}} \max \left(\delta_{\text{between}} - \|C_k - C_l\|_2, 0 \right)</script><ul><li>$C_k,C_l$ï¼šä¸åŒç±»åˆ«çš„åŠ¨æ€ç‰¹å¾ä¸­å¿ƒ</li><li>$\delta_{between}$ï¼šè¶…å‚æ•°ï¼Œé¼“åŠ±ç±»é—´ç‰¹å¾ä¸­å¿ƒç›¸äº’è¿œç¦»</li></ul><p>æœ€ç»ˆçš„AD Lossï¼š</p><script type="math/tex; mode=display">\mathcal{L}_{AD} = \mathcal{L}_{within} + \mathcal{L}_{between}</script><p>æœ€ç»ˆçš„æ€»æŸå¤±å‡½æ•°ï¼š</p><script type="math/tex; mode=display">\mathcal{L}_{\text{UNITE}} = \lambda_1 \mathcal{L}_{CE} + \lambda_2 \mathcal{L}_{AD}</script><ul><li>$\lambda_1,\lambda_2$ï¼šæŸå¤±åŠ æƒè¶…å‚æ•°ï¼Œå‡è®¾ä¸º0.5</li></ul><h4 id="3-x-æ€è€ƒ"><a href="#3-x-æ€è€ƒ" class="headerlink" title="3.x æ€è€ƒ"></a>3.x æ€è€ƒ</h4><ol><li>ä¸ºä»€ä¹ˆUNITEä½¿æ³¨æ„åŠ›åˆ†å¸ƒå‡è¡¡ï¼Ÿ<ul><li>Transformerçš„MHSAæœºåˆ¶æœ¬èº«å…·æœ‰æ•æ‰å¤šæ ·åŒ–ç‰¹å¾çš„èƒ½åŠ›</li><li>AD Lossé€šè¿‡ç±»å†…å’Œç±»é—´æŸå¤±çš„è®¾è®¡ï¼Œæ˜ç¡®é¼“åŠ±æ¨¡å‹å…³æ³¨ä¸åŒåŒºåŸŸ</li></ul></li><li>ä¸ºä»€ä¹ˆAD Lossèƒ½ä½¿æ¨¡å‹å…³æ³¨æ›´å¤šåŒºåŸŸï¼Ÿ<ul><li>å¦‚æœæ‰€æœ‰æ³¨æ„åŠ›å¤´éƒ½é›†ä¸­åœ¨äººè„¸ï¼Œå®ƒä»¬æå–çš„ç‰¹å¾ $\mathcal{P}$ å°†é«˜åº¦ç›¸ä¼¼ä¸å†—ä½™ã€‚</li><li>ç±»å†…æŸå¤±ï¼šè¦æ±‚çœŸå®ç±»åˆ«çš„ç‰¹å¾ä¸­å¿ƒï¼ˆ$\mathcal{C}<em>{\text{real}}$ï¼‰å’Œä¼ªé€ ç±»åˆ«çš„ç‰¹å¾ä¸­å¿ƒï¼ˆ$\mathcal{C}</em>{\text{fake}}$ï¼‰åœ¨ç‰¹å¾ç©ºé—´ä¸­ä¿æŒè‡³å°‘ $\delta_{\text{between}}$ çš„æœ€å°è·ç¦»ã€‚<ul><li>ä¸¤ä¸ªç±»åˆ«ä¸­å¿ƒä¿æŒæ¸…æ™°çš„åˆ†ç¦»è£•åº¦ï¼Œæ¨¡å‹ä¸èƒ½åªä¾èµ–äººè„¸è¿™ç§å•ä¸€ã€å±€éƒ¨ä¸”å¯èƒ½è¯¯å¯¼æ€§çš„çº¿ç´¢ã€‚</li></ul></li><li>ç±»é—´æŸå¤±ï¼šå¼ºåˆ¶åŒä¸€ç±»åˆ«çš„æ± åŒ–ç‰¹å¾å‘é‡ï¼ˆ$\mathcal{P}$ï¼‰å¿…é¡»ç´§å¯†åœ°èšé›†åœ¨å…¶ç±»åˆ«ä¸­å¿ƒ ($\mathcal{C}$) é™„è¿‘ã€‚<ul><li>è¿™ä¿ƒä½¿æ¨¡å‹å­¦ä¹ åˆ°æ›´å…·åŒºåˆ†åŠ›çš„ç‰¹å¾ï¼Œé¿å…è¿‡åº¦ä¾èµ–å•ä¸€åŒºåŸŸã€‚</li></ul></li></ul></li><li>æ–¹æ³•æ¦‚è¿°<ul><li>æå–åŸŸæ— å…³ç‰¹å¾ã€ä½¿ç”¨å¯å­¦ä¹ çš„Transformerè¿›è¡Œåˆ†ç±»ã€å¼•å…¥AD Lossä¿ƒè¿›æ³¨æ„åŠ›å¤šæ ·åŒ– </li></ul></li></ol><h2 id="4-Experiments"><a href="#4-Experiments" class="headerlink" title="4. Experiments"></a>4. Experiments</h2><h3 id="4-1-Datasets-æ•°æ®é›†"><a href="#4-1-Datasets-æ•°æ®é›†" class="headerlink" title="4.1 Datasets æ•°æ®é›†"></a>4.1 Datasets æ•°æ®é›†</h3><div class="table-container"><table><thead><tr><th style="text-align:center">æ•°æ®é›†</th><th style="text-align:center">ç”¨é€”</th><th style="text-align:center">ç±»å‹</th><th style="text-align:center">è¯´æ˜/å¤‡æ³¨</th></tr></thead><tbody><tr><td style="text-align:center">FaceForensics++ï¼ˆFF++ï¼‰</td><td style="text-align:center">è®­ç»ƒã€æµ‹è¯•</td><td style="text-align:center">é¢éƒ¨æ“çºµ</td><td style="text-align:center">c23i.e.,medium-quality</td></tr><tr><td style="text-align:center">SAIL-VOS-3D</td><td style="text-align:center">è®­ç»ƒ</td><td style="text-align:center">GTA-Væ¸¸æˆ</td><td style="text-align:center">åŒ…å«åˆæˆçš„ï¼ˆéAIç”Ÿæˆçš„ï¼‰GTA-Væ¸¸æˆè§†é¢‘<br>ä»¥çœŸäººä¸ºä¸»ä½“ï¼Œé€‚ç”¨äºDeepFakeæ£€æµ‹</td></tr><tr><td style="text-align:center">CelebDF</td><td style="text-align:center">æµ‹è¯•</td><td style="text-align:center">é¢éƒ¨æ“çºµ</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">DeeperForensics</td><td style="text-align:center">æµ‹è¯•</td><td style="text-align:center">é¢éƒ¨æ“çºµ</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">DeepfakeTIMIT</td><td style="text-align:center">æµ‹è¯•</td><td style="text-align:center">é¢éƒ¨æ“çºµ</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">Hififace</td><td style="text-align:center">æµ‹è¯•</td><td style="text-align:center">é¢éƒ¨æ“çºµ</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">UADFV</td><td style="text-align:center">æµ‹è¯•</td><td style="text-align:center">é¢éƒ¨æ“çºµ</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">AVID</td><td style="text-align:center">æµ‹è¯•</td><td style="text-align:center">èƒŒæ™¯æ“çºµ</td><td style="text-align:center">AVIDæ¨¡å‹çš„å…¬å¼€æ ·æœ¬è§†é¢‘</td></tr><tr><td style="text-align:center">GTA-V</td><td style="text-align:center">æµ‹è¯•</td><td style="text-align:center">åˆæˆè§†é¢‘</td><td style="text-align:center">GTA-Væ¸¸æˆè§†é¢‘</td></tr><tr><td style="text-align:center">Demamba</td><td style="text-align:center">æµ‹è¯•</td><td style="text-align:center">åˆæˆè§†é¢‘</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">NYTimes</td><td style="text-align:center">æµ‹è¯•</td><td style="text-align:center">é‡å¤–è§†é¢‘</td><td style="text-align:center">çº½çº¦æ—¶æŠ¥DeepFakeæµ‹è¯•çš„å…¬å¼€è§†é¢‘</td></tr></tbody></table></div><h3 id="4-2-Results-amp-Discussion-ç»“æœä¸è®¨è®º"><a href="#4-2-Results-amp-Discussion-ç»“æœä¸è®¨è®º" class="headerlink" title="4.2 Results &amp; Discussion ç»“æœä¸è®¨è®º"></a>4.2 Results &amp; Discussion ç»“æœä¸è®¨è®º</h3><div class="table-container"><table><thead><tr><th style="text-align:center">è¯„ä¼°æŒ‡æ ‡</th><th style="text-align:center">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center">AUC</td><td style="text-align:center">ç²¾ç¡®å¬å›æ›²çº¿ï¼ˆPrecision-Recall Curveï¼‰ä¸‹çš„é¢ç§¯</td></tr><tr><td style="text-align:center">Precision@0.5</td><td style="text-align:center">ç²¾ç¡®ç‡ï¼Œé¢„æµ‹ä¸ºæ­£æ ·æœ¬ä¸­å®é™…ä¸ºæ­£æ ·æœ¬çš„æ¯”ä¾‹ï¼Œç½®ä¿¡åº¦0.5</td></tr><tr><td style="text-align:center">Recall@0.5</td><td style="text-align:center">å¬å›ç‡ï¼Œå®é™…ä¸ºæ­£æ ·æœ¬ä¸­è¢«æ­£ç¡®é¢„æµ‹ä¸ºæ­£æ ·æœ¬çš„æ¯”ä¾‹ï¼Œç½®ä¿¡åº¦0.5</td></tr><tr><td style="text-align:center">Precs@Rec=0.8</td><td style="text-align:center">åœ¨å¬å›ç‡ä¸º0.8æ—¶çš„ç²¾ç¡®ç‡</td></tr><tr><td style="text-align:center">Rec@Prec=0.8</td><td style="text-align:center">åœ¨ç²¾ç¡®ç‡ä¸º0.8æ—¶çš„å¬å›ç‡</td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th style="text-align:center">è®­ç»ƒå‚æ•°</th><th style="text-align:center">å€¼</th><th style="text-align:center">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center">optimizer</td><td style="text-align:center">AdamW</td><td style="text-align:center">ç»“åˆäº†Adamçš„è‡ªé€‚åº”å­¦ä¹ ç‡å’Œæƒé‡è¡°å‡çš„ä¼˜åŒ–å™¨</td></tr><tr><td style="text-align:center">learning rate</td><td style="text-align:center">1e-4</td><td style="text-align:center">åˆå§‹å­¦ä¹ ç‡ï¼Œæ¯1000æ­¥è¡°å‡ç‡0.5</td></tr><tr><td style="text-align:center">$\delta_{between}$</td><td style="text-align:center">1.0</td><td style="text-align:center">AD Lossçš„ç±»é—´è·ç¦»é˜ˆå€¼</td></tr><tr><td style="text-align:center">$\delta_{within}$</td><td style="text-align:center">[0.01, -2, 1(å¤šåˆ†ç±»)]</td><td style="text-align:center">AD Lossçš„ç±»å†…è·ç¦»é˜ˆå€¼</td></tr><tr><td style="text-align:center">batch size</td><td style="text-align:center">32</td><td style="text-align:center">æ¯æ¬¡è¿­ä»£å¤„ç†çš„æ ·æœ¬æ•°é‡</td></tr><tr><td style="text-align:center">epochs</td><td style="text-align:center">25</td><td style="text-align:center">è®­ç»ƒæ•°æ®é›†çš„å®Œæ•´è¿­ä»£æ¬¡æ•°</td></tr></tbody></table></div><p><img src="https://source.cclmsy.cc/posts/papers/2412.12278/image-5.png" alt="alt text"></p><p>æ¦‚è¿°ï¼š</p><ol><li>åŠ ä¸ŠGTA-Vè®­ç»ƒç›¸æ¯”åªæœ‰FF++è®­ç»ƒï¼Œæµ‹è¯•æ€§èƒ½æå‡æ˜¾è‘—ï¼ˆç‰¹åˆ«åœ¨éäººè„¸ä»»åŠ¡ï¼‰ã€‚</li><li>åŒæ ·ä½¿ç”¨FF++å’ŒGTA-Vè®­ç»ƒï¼ŒåŠ ä¸ŠAD Lossåï¼Œæ³¨æ„åŠ›çƒ­åŠ›å›¾åˆ†å¸ƒæ›´å‡åŒ€ï¼Œè¡¨æ˜æ¨¡å‹èƒ½å…³æ³¨è§†é¢‘çš„æ›´å¤šåŒºåŸŸï¼Œæå‡äº†æ£€æµ‹æ€§èƒ½ã€‚</li><li>å³ä½¿åœ¨é¢éƒ¨æ“çºµä»»åŠ¡ä¸­ï¼ŒUNITEä¹Ÿä¼˜äºç°æœ‰çš„SOTAæ–¹æ³•</li><li>è™½ç„¶æœªç»å…¨AIç”Ÿæˆçš„å…¶ä»–ç±»å‹è§†é¢‘è®­ç»ƒï¼Œä½†åœ¨æœªè§çš„æ•°æ®é›†ä¸Šè¡¨ç°è‰¯å¥½</li></ol><h3 id="4-3-Fingrained-Evaluation-ç»†ç²’åº¦è¯„ä¼°"><a href="#4-3-Fingrained-Evaluation-ç»†ç²’åº¦è¯„ä¼°" class="headerlink" title="4.3 Fingrained Evaluation ç»†ç²’åº¦è¯„ä¼°"></a>4.3 Fingrained Evaluation ç»†ç²’åº¦è¯„ä¼°</h3><p>å°†æ•°æ®åˆ†ä¸ºä¸‰ç±»ï¼šçœŸå®è§†é¢‘ã€éƒ¨åˆ†æ“çºµè§†é¢‘ã€å®Œå…¨AIç”Ÿæˆè§†é¢‘ã€‚</p><p>ä½¿ç”¨UNITEè¿›è¡Œä¸‰åˆ†ç±»ï¼Œåœ¨åŠ ä¸ŠGTA-Vè®­ç»ƒæ—¶è¡¨ç°è‰¯å¥½</p><p><img src="https://source.cclmsy.cc/posts/papers/2412.12278/image-6.png" alt="alt text"></p><h3 id="4-4-Ablation-Study-æ¶ˆèå®éªŒ"><a href="#4-4-Ablation-Study-æ¶ˆèå®éªŒ" class="headerlink" title="4.4 Ablation Study æ¶ˆèå®éªŒ"></a>4.4 Ablation Study æ¶ˆèå®éªŒ</h3><p>è¯„ä¼°AD Losså¯¹æ€§èƒ½çš„å½±å“ï¼š</p><p><img src="https://source.cclmsy.cc/posts/papers/2412.12278/image-7.png" alt="alt text"></p><ol><li>å¯¹æ¯”ä»…CE Lossã€ä»…AD Lossã€è”åˆä½¿ç”¨CEå’ŒAD Lossçš„æ•ˆæœï¼Œè”åˆä½¿ç”¨æ•ˆæœæœ€ä½³</li><li>åˆæˆè§†é¢‘æ•°æ®ï¼šåœ¨DeMambaæ•°æ®é›†ä¸Šï¼Œæ— è®ºæ˜¯å¦åŠ ä¸ŠGTA-Vè®­ç»ƒï¼Œä»…CE Lossçš„æ€§èƒ½æ— æ˜æ˜¾å˜åŒ–ï¼Œä½¿ç”¨AD Lossåæ€§èƒ½æå‡æ˜æ˜¾</li><li>èƒŒæ™¯æ“çºµæ•°æ®ï¼šåœ¨AVIDæ•°æ®é›†ä¸Šï¼Œä»…ä½¿ç”¨FF++è®­ç»ƒï¼Œä»…CE Lossæ€§èƒ½ä¸º0ï¼ˆå› ä¸ºè®­ç»ƒæ²¡æœ‰èƒŒæ™¯æ“çºµæ ·æœ¬ï¼‰ï¼Œä½¿ç”¨AD Lossåæ€§èƒ½æå‡æ˜æ˜¾</li><li>äººè„¸æ“çºµæ•°æ®ï¼šåœ¨CelebDFã€UADFVç­‰æ•°æ®é›†ä¸Šï¼Œä½¿ç”¨AD Lossåæ€§èƒ½æœ‰æ‰€æå‡ï¼Œè¯´æ˜æ¨¡å‹å­¦ä¹ åˆ°æ›´å…·åŒºåˆ†åº¦çš„æ³¨æ„åŠ›å›¾ç‰¹å¾</li></ol><p><img src="https://source.cclmsy.cc/posts/papers/2412.12278/image-8.png" alt="alt text"></p><ul><li>å¸§æ•°ä¸æ€§èƒ½å…³ç³»ï¼šéšç€åŒ…å«æ›´å¤šå¸§æ•°ï¼Œæ¨¡å‹æ€§èƒ½é€æ­¥æå‡ï¼Œå‡¸æ˜¾äº†æ¨¡å‹é€šè¿‡åˆ©ç”¨æ—¶é—´çº¿ç´¢æ˜¾è‘—æå‡æ£€æµ‹ç²¾åº¦çš„èƒ½åŠ›</li><li>Transformeræ·±åº¦ä¸æ€§èƒ½å…³ç³»ï¼šæ·±åº¦ä¸º4æ—¶æ€§èƒ½æœ€ä½³ï¼Œè¿‡æµ…æˆ–è¿‡æ·±å‡å¯¼è‡´æ€§èƒ½ä¸‹é™</li></ul><h2 id="Ex-Fisher-åˆ¤åˆ«åˆ†æåŸç†"><a href="#Ex-Fisher-åˆ¤åˆ«åˆ†æåŸç†" class="headerlink" title="Ex. Fisher åˆ¤åˆ«åˆ†æåŸç†"></a>Ex. Fisher åˆ¤åˆ«åˆ†æåŸç†</h2><p>ç»å…¸FLDAï¼ˆFisher Linear Discriminant Analysisï¼‰æ˜¯ä¸€ç§çº¿æ€§åˆ†ç±»æ–¹æ³•ï¼Œæ—¨åœ¨æ‰¾åˆ°ä¸€ä¸ªæŠ•å½±æ–¹å‘ï¼Œä½¿å¾—æŠ•å½±åçš„ç±»é—´è·ç¦»æœ€å¤§åŒ–ï¼Œç±»å†…è·ç¦»æœ€å°åŒ–ã€‚</p><script type="math/tex; mode=display">J(w) = \frac{w^T S_B w}{w^T S_W w}</script><ul><li>$S_B$ï¼šç±»é—´æ•£å¸ƒçŸ©é˜µï¼Œè¡¡é‡ä¸åŒç±»åˆ«ä¹‹é—´çš„åˆ†å¸ƒå·®å¼‚</li><li>$S_W$ï¼šç±»å†…æ•£å¸ƒçŸ©é˜µï¼Œè¡¡é‡åŒä¸€ç±»åˆ«å†…éƒ¨çš„åˆ†å¸ƒå·®å¼‚</li><li>$w$ï¼šæŠ•å½±å‘é‡</li></ul><p>ç»å…¸ LDA åªèƒ½è¿›è¡Œçº¿æ€§åˆ¤åˆ«ï¼Œæ— æ³•å¤„ç†é«˜ç»´æ•°æ®ä¸­çš„å¤æ‚éçº¿æ€§å…³ç³»ã€‚</p><p>æ·±åº¦ç½‘ç»œçš„ Fisher åˆ¤åˆ«åˆ†æï¼ˆDFDAï¼‰çš„åŸºæœ¬åŸç†ï¼šä½¿ç”¨æ·±åº¦ç¥ç»ç½‘ç»œï¼ˆDNNï¼‰ä½œä¸ºç‰¹å¾æå–å™¨ï¼Œå°†åŸå§‹çš„é«˜ç»´éçº¿æ€§æ•°æ®æ˜ å°„åˆ°ä¸€ä¸ªä½ç»´çš„ã€æ›´å®¹æ˜“çº¿æ€§å¯åˆ†çš„ç©ºé—´ï¼Œåœ¨è¿™ä¸ªç©ºé—´ä¸­æœ€å¤§åŒ– Fisher åˆ¤åˆ«å‡†åˆ™ã€‚</p><ol><li>ç‰¹å¾æå–å±‚ï¼š ç”±ä¸€ä¸ªå¤šå±‚çš„æ·±åº¦ç¥ç»ç½‘ç»œï¼ˆå¦‚ CNNã€MLP ç­‰ï¼‰ç»„æˆï¼Œè´Ÿè´£å°†è¾“å…¥æ•°æ®$X$è½¬åŒ–ä¸ºç‰¹å¾è¡¨ç¤º$Z=f(X)$</li><li>åˆ¤åˆ«æŸå¤±å±‚ï¼šåœ¨ç‰¹å¾è¡¨ç¤º$Z$ä¸Šè®¡ç®— Fisher åˆ¤åˆ«å‡†åˆ™ï¼ˆä½œä¸ºæŸå¤±å‡½æ•°çš„ä¸€éƒ¨åˆ†ï¼‰ï¼Œå¹¶ä¸å…¶ä»–ä»»åŠ¡ç›¸å…³çš„æŸå¤±ï¼ˆå¦‚äº¤å‰ç†µæŸå¤±ï¼‰ç»“åˆè¿›è¡Œè”åˆä¼˜åŒ–</li><li>åˆ†ç±»å±‚ï¼šé€šå¸¸æ˜¯ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œä½œä¸ºçº¿æ€§åˆ†ç±»å™¨</li></ol><p>æŸå¤±å‡½æ•°ï¼š</p><script type="math/tex; mode=display">L = L_{task} + \lambda L_{Fisher}</script>]]></content>
    
    
    <summary type="html">é˜…è¯»è®ºæ–‡ã€ŠTowards a Universal Synthetic Video Detectorï¼šFrom Face or Background Manipulations to Fully AI-Generated Contentã€‹</summary>
    
    
    
    <category term="è®ºæ–‡ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="è®ºæ–‡å®ç°" scheme="https://www.cclmsy.cc/tags/%E8%AE%BA%E6%96%87%E5%AE%9E%E7%8E%B0/"/>
    
    <category term="AIGVCæ£€æµ‹" scheme="https://www.cclmsy.cc/tags/AIGVC%E6%A3%80%E6%B5%8B/"/>
    
  </entry>
  
  <entry>
    <title>æ¨å…å›å¿†å½•</title>
    <link href="https://www.cclmsy.cc/posts/tm.html"/>
    <id>https://www.cclmsy.cc/posts/tm.html</id>
    <published>2025-09-23T16:00:00.000Z</published>
    <updated>2025-09-30T05:26:36.003Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è°¨ä»¥æœ¬ç¯‡ï¼Œè®°å½•æˆ‘åœ¨å¤ä»¤è¥å’Œé¢„æ¨å…æœŸé—´ï¼Œåœ¨éƒ¨åˆ†é™¢æ ¡çš„ç»å†ã€æƒ³æ³•å’Œæ„Ÿå—ã€‚</p><ul><li>ç¼©å†™/æœ¯è¯­å‚è€ƒï¼š<a href="https://csbaoyan.top/%E4%BF%9D%E7%A0%94%E6%8C%87%E5%8D%97/%E4%BF%9D%E7%A0%94%E9%BB%91%E8%AF%9D">ä¿ç ”é»‘è¯|CSWiki</a></li><li>ç”±äºéƒ¨åˆ†é™¢æ ¡ç­¾ç½²äº†ä¿å¯†åè®®ï¼Œæ‰€æœ‰å†…å®¹å‡ä¸æ¶‰åŠå…·ä½“è€ƒæ ¸è¯•é¢˜ã€é¢è¯•é—®é¢˜ç­‰ã€‚</li><li>æ‰€æœ‰è¯„ä»·ä»…ä¸ªäººçœ‹æ³•ï¼Œä¸ä»£è¡¨å®é™…æƒ…å†µï¼Œä¸ä¾›å‚è€ƒã€‚</li></ul><h3 id="å½•å–"><a href="#å½•å–" class="headerlink" title="å½•å–"></a>å½•å–</h3><p>923ä¸Šåˆæ¥è¡¥å½•ï¼Œä¸Šå²¸æ¢¦æ ¡ï¼</p><p>å¤ä»¤è¥å§‹äºBUAA SEï¼Œæ‹Ÿå½•å–ç»ˆäºBUAA SEã€‚<br>æœ‰å§‹ï¼Œæœ‰ç»ˆã€‚</p><p><img src="https://source.cclmsy.cc/posts/others/buaase_offer.png" alt="å½•å–"></p><h3 id="BG"><a href="#BG" class="headerlink" title="BG"></a>BG</h3><ul><li>æœ¬ç§‘ï¼šå››éé«˜rkï¼ŒCET6&lt;480</li><li>ç«èµ›ï¼šACMçœé“¶ã€ICPCåŒºåŸŸé“œã€ICPCé‚€è¯·é“œ</li><li>ç§‘ç ”ï¼šæ— ä¸“åˆ©è®ºæ–‡ï¼Œæ·±åº¦å­¦ä¹ å…¥é—¨ï¼Œè®ºæ–‡å¤ç°</li><li>é¡¹ç›®ï¼šä¸€ä¸ªUnityæ¸¸æˆã€ä¸€ä¸ªæ’ä»¶ã€4ä¸ªæ ¡åˆ›</li><li>å…´è¶£æ–¹å‘ï¼šäººå·¥æ™ºèƒ½ï¼ˆç”Ÿæˆå¼äººå·¥æ™ºèƒ½ï¼Œå¤šæ¨¡æ€å¤§æ¨¡å‹/CVï¼Œetc.ï¼‰ &gt; è½¯ä»¶å·¥ç¨‹ã€å…·èº«æ™ºèƒ½ &gt; Others</li><li>æ„æ„¿ï¼šè®¡ç§‘&gt;è½¯å·¥â‰ˆAIï¼›å­¦ç¡•=ä¸“ç¡•&gt;å·¥ç¨‹ç¡•&gt;ç›´åš</li></ul><p>ä¸è€ƒè™‘ç›´åšä¸€æ–¹é¢æ˜¯å› ä¸ºç§‘ç ”ç»å†å¤ªå°‘ï¼Œé£é™©å¤ªå¤§ï¼›å¦ä¸€æ–¹é¢ä¹Ÿæ˜¯æƒ³æ—©ç‚¹å‡ºå»èµšé’±ã€‚</p><p>ä¸€å¼€å§‹åªæƒ³åšAI+è½¯ä»¶å·¥ç¨‹/CVç›¸å…³çš„æ–¹å‘ã€‚<br>ä¹æœˆä¸­å‚åŠ äº†ä¸€ä¸ªå…·èº«æ™ºèƒ½æ–¹é¢çš„ä¼šè®®ï¼Œå¼•èµ·äº†æˆ‘å¯¹è¿™ä¸ªæ–¹å‘çš„å…´è¶£ï¼Œå†åŠ ä¸Šé«˜ä¸­æ—¶å€™å°±å‚åŠ è¿‡æœºå™¨äººçš„åˆ›å®¢ç«èµ›ï¼Œè§‰å¾—è¿™ä¸ªæ–¹å‘ä¹Ÿä¸é”™ï¼ˆè™½ç„¶æœ€ç»ˆä¹Ÿä¸æ˜¯ï¼‰ã€‚</p><h2 id="å¤ä»¤è¥"><a href="#å¤ä»¤è¥" class="headerlink" title="å¤ä»¤è¥"></a>å¤ä»¤è¥</h2><p>ä»Šå¹´è¯¸å¤šé™¢æ ¡å¼€å§‹è°ƒæ•´å¤ä»¤è¥ï¼ŒåŒ…æ‹¬å–æ¶ˆå¤ä»¤è¥ã€çº¿ä¸Šå¤ä»¤è¥ã€ä¸å‘offerä¹‹ç±»ã€‚<br>å¥½åœ¨å¤§éƒ¨åˆ†è¿˜æ˜¯æœ‰è¿™ä¹ˆä¸ªå½¢å¼ï¼Œå¯ä»¥å¤šäº†è§£ä¸€äº›é™¢æ ¡å’Œå¯¼å¸ˆï¼Œæˆ–ä½“éªŒä¸€ä¸‹è€ƒæ ¸ã€‚</p><p>æµ·æŠ•985å’Œç¡¬æ ¸211ï¼Œè€ƒè™‘åˆ°ç«äº‰å‹åŠ›ï¼ŒåŸºæœ¬ä¸ŠæŠ•çš„éƒ½æ˜¯ä¸“ç¡•ã€‚</p><div class="table-container"><table><thead><tr><th style="text-align:center">å­¦æ ¡/é™¢ç³»</th><th style="text-align:center">ç»“æœ</th></tr></thead><tbody><tr><td style="text-align:center">åŒ—äº¬èˆªç©ºèˆªå¤©å¤§å­¦ è½¯ä»¶å­¦é™¢</td><td style="text-align:center">ä¸å‘offer</td></tr><tr><td style="text-align:center">æµ™æ±Ÿå¤§å­¦ è½¯ä»¶å­¦é™¢</td><td style="text-align:center">æ™®è¥</td></tr><tr><td style="text-align:center">åŒ—äº¬é‚®ç”µå¤§å­¦ è®¡ç®—æœºå­¦é™¢</td><td style="text-align:center">æ¬¢è¿æŠ¥è€ƒ</td></tr><tr><td style="text-align:center">åŒ—äº¬äº¤é€šå¤§å­¦ è®¡ç®—æœºå­¦é™¢</td><td style="text-align:center">æ”¾å¼ƒå…¥è¥</td></tr><tr><td style="text-align:center">ä¸­å±±å¤§å­¦ è½¯ä»¶å­¦é™¢</td><td style="text-align:center">é»˜æ‹’</td></tr></tbody></table></div><h3 id="åŒ—äº¬èˆªç©ºèˆªå¤©å¤§å­¦-è½¯ä»¶å­¦é™¢"><a href="#åŒ—äº¬èˆªç©ºèˆªå¤©å¤§å­¦-è½¯ä»¶å­¦é™¢" class="headerlink" title="åŒ—äº¬èˆªç©ºèˆªå¤©å¤§å­¦ è½¯ä»¶å­¦é™¢"></a>åŒ—äº¬èˆªç©ºèˆªå¤©å¤§å­¦ è½¯ä»¶å­¦é™¢</h3><blockquote><p>ä½äºé¦–éƒ½çš„æ¢¦æ ¡ï¼Œè½¯ä»¶å·¥ç¨‹ç¬¬äº”è½®è¯„ä¼°A+ï¼Œå’Œæ¸…åŒ—åä¸€æ¡Œã€‚</p></blockquote><p>æš‘æœŸå­¦æ ¡æ´»åŠ¨ï¼Œä¸å‘offerï¼Œæç¨€æœ‰çš„çº¿ä¸Šæœºè€ƒå…¥è¥ã€‚<br>æœºè€ƒä¸ç­›äººï¼Œ1000+äººåŒå°ç«æŠ€ï¼ˆæœ€ç»ˆæœ‰ACçš„å¤§æ¦‚600+ï¼‰ï¼Œä¸€å…±7é¢˜ï¼Œå‰42åå‚åŠ çº¿ä¸‹è¥ã€‚<br>æˆ‘5é¢˜+æ‰‹å¿«ï¼Œé¡ºåˆ©å…¥è¥ï¼Œä¹Ÿæ˜¯ç¬¬ä¸€ä¸ªè¥ã€‚</p><p>çº¿ä¸‹è¥7/3~7/4ï¼Œå…¥è¥å¤§ç¤¼åŒ…ç»™äº†ä¸€ä»¶ANTAçš„Tæ¤ã€åŒ—èˆªæ‰‹æåŒ…ã€æµä½“ç†Šé’¥åŒ™æ‰£å’Œé£æœºå¾½ç« ã€‚<br>ç¬¬1å¤©ä¸­åˆæŠ¥é“é¢†å–å¤§ç¤¼åŒ…ï¼Œä¸‹åˆå‚è§‚æ ¡å²é¦†ã€åšç‰©é¦†ã€å®éªŒå®¤ï¼›<br>ç¬¬2å¤©ä¸Šåˆå¬å„ä½è€å¸ˆçš„å­¦æœ¯æŠ¥å‘Šï¼Œä¸‹åˆåˆ†ç»„è®¨è®ºã€‚</p><p><img src="https://source.cclmsy.cc/posts/others/buaase_xly1.jpg" alt="BUAAæµä½“ç†Šé’¥åŒ™æ‰£"></p><p>æœ€ç»ˆæ ¹æ®åˆ†ç»„è®¨è®ºçš„è¡¨ç°ï¼Œæ¯ä¸ªç»„ä¼šè¯„5ä¸ªå¥–ã€‚<br>æ•´ä¸ªå‚ä¸è¿‡ç¨‹çš„ä½“éªŒå¾ˆå¥½ï¼Œè€å¸ˆä»¬éƒ½å¾ˆå‹å–„ã€‚<br>ä¹Ÿæ˜¯æˆ‘æ¨å…è¿‡ç¨‹ä¸­å”¯ä¸€æœ‰ä¼´æ‰‹ç¤¼çš„é™¢æ ¡ï¼ˆäººæ–‡å…³æ€€è¿™ä¸€å—ï¼‰ã€‚</p><h3 id="æµ™æ±Ÿå¤§å­¦-è½¯ä»¶å­¦é™¢"><a href="#æµ™æ±Ÿå¤§å­¦-è½¯ä»¶å­¦é™¢" class="headerlink" title="æµ™æ±Ÿå¤§å­¦ è½¯ä»¶å­¦é™¢"></a>æµ™æ±Ÿå¤§å­¦ è½¯ä»¶å­¦é™¢</h3><blockquote><p>åè½äºå®¶ä¹¡çš„æ¢¦æ ¡ï¼Œæ–°æ ¡åŒºå»ºæˆï¼Œé™„åŠ æµ™å¤§Titleï¼Œä¸€ä¸¾æˆä¸ºä»Šå¹´æ¨å…æœ€çƒ­é™¢æ ¡ä¹‹ä¸€ã€‚</p></blockquote><p>ä»Šå¹´å¤ªçƒ­é—¨äº†ï¼Œè€å¸ˆçš„é€‰æ‹©ä¹Ÿå¾ˆå¤šï¼Œå››éå¾ˆéš¾å¥—åˆ°è€å¸ˆã€‚<br>å¤ä»¤è¥å…¥è¥åï¼Œç»™å‡ ä¸ªè€å¸ˆè‡´é‚®å‡æœªè·å›å¤ã€‚</p><p>å¤§æ¨¡å‹ä¸å·¥ä¸šæ™ºèƒ½è¥ï¼ˆå…±8ä¸ªè¥ï¼‰é’‰é’‰ç¾¤é‡Œæœ‰680+ä¸ªäººï¼Œå¯è§è§„æ¨¡ä¹‹å¤§ã€‚<br>ä»Šå¹´å½¢å¼ä¸Šæ²¡å˜ï¼Œ7/1~7/10çº¿ä¸Šè¥ï¼Œåœ¨è‹¥å¹²é¢˜ç›®ä¸­é€‰åšä¸€ä¸ªé¡¹ç›®ï¼Œé¢˜ç›®å¯èƒ½è®¾ç½®1~3é˜¶æ®µï¼ˆä¸è¿‡ç›®æµ‹è¦ä¼˜è¥å¾—å®Œæ•´å®Œæˆï¼‰ã€‚<br>ä¸è¯„å“è¶Šè¥å‘˜ï¼ˆofferï¼‰äº†ï¼Œå®£ç§°ä¼˜è¥ç‡10%å·¦å³ã€‚<br>å››éé¼ é¼ å¿…é¡»è¦å–å¾—ä¼˜è¥æ‰èƒ½æ‹¿åˆ°é¢„æ¨å…å…¥åœºåˆ¸ã€‚</p><p>BUAA SEå¤ä»¤è¥å›æ¥æ‰å¼€å§‹ç€æ‰‹è¯¾é¢˜ï¼Œä¸€åŠçš„æ—¶é—´è¿˜æ˜¯æ¯”è¾ƒç´§å¼ ã€‚<br>æœ€åå®Œæˆäº†æŸé¢˜çš„å…¨éƒ¨é˜¶æ®µï¼Œä½†æ˜¯å¹¶æ²¡æœ‰åšå¾—å¾ˆå¥½ï¼Œæœ€åä¹Ÿæ²¡èƒ½æ‹¿åˆ°ä¼˜è¥ã€‚</p><h3 id="åŒ—äº¬é‚®ç”µå¤§å­¦-è®¡ç®—æœºå­¦é™¢"><a href="#åŒ—äº¬é‚®ç”µå¤§å­¦-è®¡ç®—æœºå­¦é™¢" class="headerlink" title="åŒ—äº¬é‚®ç”µå¤§å­¦ è®¡ç®—æœºå­¦é™¢"></a>åŒ—äº¬é‚®ç”µå¤§å­¦ è®¡ç®—æœºå­¦é™¢</h3><blockquote><p>ä¸¤ç”µä¸€é‚®çš„é‚®ï¼Œè®¡ç®—æœºé€šä¿¡å®åŠ›ä¸ä¿—ï¼Œä¸­9æ°´å¹³ï¼Œå†²ã€‚</p></blockquote><p>å¤ä»¤è¥æ˜¯ç»„é¢ï¼Œå¡«æŠ¥3ä¸ªç»„ï¼Œå…¥äº†æŸç»„é¢è¯•ã€‚</p><p>é¢è¯•å°±æ˜¯æ­£å¸¸çš„BGé¢ã€è‹±è¯­é¢å’Œä¸“ä¸šé¢ï¼Œæ‹·æ‰“å¼ºåº¦ä¸é«˜ã€‚<br>ç”±äºå¤ä»¤è¥ä¸èƒ½å…¬å¸ƒä½æ¬¡ç­‰ï¼Œæœ€ç»ˆæ”¶è·äº†â€œæ¬¢è¿æŠ¥è€ƒâ€ï¼Œæ ¹æ®é¢„æ¨å…åé¦ˆåº”è¯¥æ˜¯ä¸­é«˜ä½æ¬¡ã€‚</p><h3 id="åŒ—äº¬äº¤é€šå¤§å­¦-è®¡ç®—æœºå­¦é™¢"><a href="#åŒ—äº¬äº¤é€šå¤§å­¦-è®¡ç®—æœºå­¦é™¢" class="headerlink" title="åŒ—äº¬äº¤é€šå¤§å­¦ è®¡ç®—æœºå­¦é™¢"></a>åŒ—äº¬äº¤é€šå¤§å­¦ è®¡ç®—æœºå­¦é™¢</h3><blockquote><p>æ¬¡9æ°´å¹³ï¼Œç¨³ã€‚</p></blockquote><p>æ®è¯´æ˜¯å‚è§‚äº¤æµè¥ï¼Œä¸å‘offerã€‚</p><p>å…¥è¥ï¼Œæ ¹æ®å°é“æ¶ˆæ¯ï¼Œç¡®å®å’Œå½•å–ä¸æŒ‚é’©ï¼›<br>å†åŠ ä¸Šå·²ç»è®¢å¥½æœºç¥¨äº†ï¼Œå› æ­¤æ”¾å¼ƒå‚è¥ã€‚</p><h3 id="ä¸­å±±å¤§å­¦-è½¯ä»¶å­¦é™¢"><a href="#ä¸­å±±å¤§å­¦-è½¯ä»¶å­¦é™¢" class="headerlink" title="ä¸­å±±å¤§å­¦ è½¯ä»¶å­¦é™¢"></a>ä¸­å±±å¤§å­¦ è½¯ä»¶å­¦é™¢</h3><blockquote><p>åæ ¡ï¼Œä½†æ˜¯è½¯å·¥ç¬¬äº”è½®è¯„ä¼°Bï¼Œä½†æ˜¯åæ ¡ï¼Œå†²äº†ã€‚<br>æˆ‘å°å­¦é˜¶æ®µæœ€å¥½çš„å¤©æ‰æœ‹å‹åœ¨è¿™é‡Œå°±è¯»ã€‚</p></blockquote><p>æŠ¥åå¤ä»¤è¥åä¼šæ”¶åˆ°ä¸€å°è®ºæ–‡ç ”è¯»çš„é‚®ä»¶ï¼Œè¦æ±‚nç¯‡è®ºæ–‡ä¸­é€‰æ‹©1ç¯‡ç ”è¯»å®Œï¼Œä»¥ç»„ä¼šåˆ†äº«çš„å½¢å¼å½•åˆ¶è§†é¢‘å‘é‚®ä»¶åé¦ˆã€‚<br>æ®è¯´â€œä½œä¸ºç­›é€‰å…¥è¥åå•çš„å‚è€ƒææ–™ä¹‹ä¸€ï¼Œä¸è®¡å…¥è€ƒæ ¸â€ã€‚</p><p>é€‰äº†ï¼Œè¯»äº†ï¼Œåšäº†PPTï¼Œå½•äº†è§†é¢‘ï¼Œå‘äº†é‚®ä»¶ï¼Œå¡«äº†é—®å·ï¼Œæ”¶åˆ°äº†è‡ªåŠ¨å›å¤é‚®ä»¶â€¦â€¦<br>â€¦â€¦<br>è§†é¢‘é‚®ä»¶è‡³ä»Šéƒ½æ˜¯æœªè¯»çŠ¶æ€ï¼Œä¹Ÿæ²¡æœ‰æ˜ç¡®çš„æ‹’ç»å…¥è¥ã€‚</p><p>æœ€å¯’å¿ƒçš„ä¸€é›†ã€‚</p><p><img src="https://source.cclmsy.cc/posts/others/sysuse_unread.png" alt="ä¸­å±±å¤§å­¦è½¯ä»¶å­¦é™¢é‚®ä»¶æœªè¯»"></p><h3 id="çº¿ä¸Šè¥"><a href="#çº¿ä¸Šè¥" class="headerlink" title="çº¿ä¸Šè¥"></a>çº¿ä¸Šè¥</h3><blockquote><p>æœ‰äººå¤©çœŸçš„ä»¥ä¸ºè¿™æ˜¯ä¸€åœºå·¨å¤§çš„æœä»æ€§æµ‹è¯•ï¼Œåªè¦å…¨ç¨‹å¬ä¸‹æ¥å°±èƒ½æå‡é¢„æ¨å…å…¥é¢æ¦‚ç‡ã€‚<br>æœ€åå…¥çº¿ä¸Šå®£è®²è¥çš„é™¢æ ¡ï¼Œé¢„æ¨å…éƒ½æ²¡å…¥é¢â€¦â€¦</p></blockquote><p>è¿™éƒ¨åˆ†æ²¡ä»€ä¹ˆå¥½è®²çš„ï¼Œéƒ½æ˜¯ç‚¹å‡»å°±é€ä¸ç­›äººï¼Œä¹Ÿå°±æ˜¯å¼€ä¸ªå®£ä¼ è®²åº§æˆ–è€…å­¦æœ¯æŠ¥å‘Šä¹‹ç±»çš„è®©ä½ å‚åŠ ã€‚</p><p>åŒ…æ‹¬ï¼šSYSU AIã€SDU CS/SEã€SCUTç­‰</p><h2 id="é¢„æ¨å…"><a href="#é¢„æ¨å…" class="headerlink" title="é¢„æ¨å…"></a>é¢„æ¨å…</h2><blockquote><p>å¤ä»¤è¥æ˜¯ç¼©æ°´çš„ï¼Œæ¨å…åé¢æ˜¯å¢åŠ çš„ï¼Œæ‹›ç”ŸæŒ‡æ ‡æ˜¯ä¸å˜çš„ï¼Œä¿ç ”æ˜¯è¶Šæ¥è¶Šå·çš„ï¼Œå››éé¼ é¼ æ˜¯è¶Šæ¥è¶Šéš¾å…¥é¢çš„ã€‚</p></blockquote><p>ç”±äºå¤ä»¤è¥å¤§å¹…ç¼©æ°´ã€æ¨å…åé¢å¢åŠ ï¼Œå¤§é‡92å¤§ä½¬æ¶Œå…¥é¢„æ¨å…ï¼Œå‹ç¼©äº†æ™®é€šé™¢æ ¡çš„é¼ é¼ ä»¬çš„ç”Ÿå­˜ç©ºé—´ã€‚<br>åŒç­‰BGä¸‹ï¼Œä»¥å¾€çš„å¯ç¨³é™¢æ ¡å˜å¾—ä¸ç¨³äº†ï¼Œå¯å†²é™¢æ ¡å˜å¾—æ›´éš¾å†²äº†ã€‚</p><p>é¢„æ¨å…ä¹Ÿä¸»æ‰“ä¸€ä¸ªæµ·æŠ•ï¼Œå‡ ä¹æŠŠä¸­ç­‰211ä»¥ä¸Šçš„é™¢æ ¡éƒ½æŠ•äº†ä¸€è½®ã€‚</p><div class="table-container"><table><thead><tr><th style="text-align:center">å­¦æ ¡/é™¢ç³»</th><th style="text-align:center">ç»“æœ</th></tr></thead><tbody><tr><td style="text-align:center">è‹å·å¤§å­¦ è®¡ç®—æœºå­¦é™¢</td><td style="text-align:center">æ”¾å¼ƒoffer</td></tr><tr><td style="text-align:center">åˆè‚¥å·¥ä¸šå¤§å­¦ è®¡ç®—æœºå­¦é™¢</td><td style="text-align:center">æ”¾å¼ƒwl</td></tr><tr><td style="text-align:center">åä¸œå¸ˆèŒƒå¤§å­¦ å“è¶Šå·¥ç¨‹å¸ˆå­¦é™¢</td><td style="text-align:center">æ”¾å¼ƒå…¥é¢</td></tr><tr><td style="text-align:center">ä¸œåŒ—å¤§å­¦ è½¯ä»¶å­¦é™¢</td><td style="text-align:center">æ”¾å¼ƒå…¥é¢</td></tr><tr><td style="text-align:center">åŒ—äº¬é‚®ç”µå¤§å­¦ è®¡ç®—æœºå­¦é™¢</td><td style="text-align:center">è¢«ç­‰é¢æ¨èåˆ›æ­»</td></tr><tr><td style="text-align:center">å¤©æ´¥å¤§å­¦ æ™ºèƒ½ä¸è®¡ç®—å­¦éƒ¨ï¼ˆè½¯ä»¶å­¦é™¢ï¼‰</td><td style="text-align:center">ç¬¬ä¸‰æ‰¹wl</td></tr><tr><td style="text-align:center">åŒ—äº¬èˆªç©ºèˆªå¤©å¤§å­¦ è½¯ä»¶å­¦é™¢</td><td style="text-align:center">é«˜ä½wlä¸Šå²¸</td></tr></tbody></table></div><h3 id="è‹å·å¤§å­¦-è®¡ç®—æœºå­¦é™¢"><a href="#è‹å·å¤§å­¦-è®¡ç®—æœºå­¦é™¢" class="headerlink" title="è‹å·å¤§å­¦ è®¡ç®—æœºå­¦é™¢"></a>è‹å·å¤§å­¦ è®¡ç®—æœºå­¦é™¢</h3><blockquote><p>211ï¼Œè®¡ç®—æœºç¬¬äº”è½®è¯„ä¼°Aï¼Œç¨³ã€‚</p></blockquote><p>Barä¸é«˜ï¼Œä¸¤æ‰¹çº¿ä¸‹æœºè¯•å¯é€‰ã€‚<br>æœºè¯•3å°æ—¶10é¢˜ï¼ŒLeetcodeé£æ ¼ï¼Œåœ¨ä¸€ä¸ªcppæ–‡ä»¶é‡Œè¡¥å…¨å‡½æ•°ï¼Œæ¡†æ¶éƒ½ç»™å‡ºäº†ã€‚<br>C++å­¦çš„æ‰å®çš„è¯éšä¾¿è¿‡ï¼Œæˆ‘ç¬¬ä¸€æ‰¹ä¸Šåˆåœº100åˆ†é’ŸAKæå‰å‡ºåœºã€‚</p><p>å¼±comï¼Œè¿‡äº†æœºè¯•å°±å¯ä»¥è”ç³»å¯¼å¸ˆï¼Œå…·ä½“è€ƒæ ¸çœ‹å¯¼å¸ˆï¼ŒNLPç»„è‚¯å®šæ˜¯è¦ç¡¬æ ¸é¢è¯•çš„ã€‚<br>AKå‡ºåœºåï¼Œè”ç³»äº†éNLPç»„çš„è€å¸ˆï¼ŒåšNLPå’Œå¤šæ¨¡æ€å¤§æ¨¡å‹çš„ï¼Œæ–¹å‘90+%matchï¼Œæ°´å¹³å¾ˆå¥½ï¼Œå¾ˆå¹´è½»å¾ˆèŠå¾—æ¥ã€‚<br>å½“æ—¶è¿˜æ€€æ£ç€å†²å‡»æ¢¦æ ¡çš„æƒ³æ³•ï¼Œé¦–æ¬¡é€šè¯å°±å’Œè€å¸ˆæ˜ç¡®è¯´æ˜äº†è‡ªå·±çš„æƒ³æ³•å’Œå…¥è¥æƒ…å†µï¼Œè€å¸ˆè¿˜æ˜¯ç»™æˆ‘å‘äº†offerã€‚</p><p>ç»å¸¸ä¿ç ”çš„åŒå­¦è‚¯å®šçŸ¥é“ï¼Œæ‰‹ä¸Šæœ‰offerå’Œæ²¡æœ‰offerï¼Œå¿ƒæ€æ˜¯æˆªç„¶ä¸åŒçš„ï¼Œè¿™ä»½offerä¹Ÿæˆä¸ºäº†æˆ‘å†²å‡»å¼ºæ ¡çš„åº•æ°”ã€‚<br>è™½ç„¶æœ€ç»ˆæ²¡æœ‰å»è‹å¤§ï¼Œä¹Ÿå› ä¸ºå€™è¡¥ä¸Šå²¸æ™šï¼Œ23å·æ‰é¸½ï¼Œä½†æ˜¯çœŸçš„å¾ˆæ„Ÿè°¢è€å¸ˆçš„è®¤å¯å’Œæ”¯æŒï¼ï¼ï¼</p><p>ï¼ˆä¹Ÿå¬è¯´è‹å¤§è¶…å‘äº†offerï¼Œå¸Œæœ›æ²¡æœ‰å½±å“è€å¸ˆæ‹›ç”ŸQwQï¼‰</p><h3 id="åˆè‚¥å·¥ä¸šå¤§å­¦-è®¡ç®—æœºå­¦é™¢"><a href="#åˆè‚¥å·¥ä¸šå¤§å­¦-è®¡ç®—æœºå­¦é™¢" class="headerlink" title="åˆè‚¥å·¥ä¸šå¤§å­¦ è®¡ç®—æœºå­¦é™¢"></a>åˆè‚¥å·¥ä¸šå¤§å­¦ è®¡ç®—æœºå­¦é™¢</h3><blockquote><p>211ï¼Œè®¡ç®—æœºå¼ºæ ¡ï¼Œä¸è¾“985ï¼Œç¨³ã€‚</p></blockquote><p>çº¿ä¸Šé¢è¯•ï¼Œçº¯BGé¢ï¼Œæ‹·æ‰“å¼ºåº¦ä¸é«˜ã€‚<br>å› ä¸ºå·²ç»æœ‰è‹å¤§å¯¼å¸ˆçš„offerï¼Œé¢è¯•å°±é‡åœ¨å‚ä¸äº†ã€‚<br>åæ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œæ¥å—äº†å¤è¯•é€šçŸ¥ä¹‹åè¿˜è¦è¿›è¡Œ2è½®é¢è¯•â€¦</p><p>é¢è¯•åˆ†ç»„æ˜¯ä¸é€æ˜çš„ï¼Œæˆç»©/æ’åæ˜¯ä¸å…¬å¸ƒçš„ï¼Œå‘çŸ­ä¿¡é€šçŸ¥æ˜¯å…»é±¼çš„ï¼Œç”µè¯æ˜¯åªæ‰“ç»™å°éƒ¨åˆ†äººçš„ã€‚</p><p>ä¹Ÿæ²¡è”ç³»å¯¼å¸ˆï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œè·‘è·¯ï¼</p><h3 id="ä¸œåŒ—å¤§å­¦"><a href="#ä¸œåŒ—å¤§å­¦" class="headerlink" title="ä¸œåŒ—å¤§å­¦"></a>ä¸œåŒ—å¤§å­¦</h3><blockquote><p>ä½äºæ²ˆé˜³çš„985ï¼Œæ›¾ç»æ‰“è¿‡é“çš„åœ°æ–¹ã€‚</p></blockquote><p>FCFSï¼Œç”±äºæŠ•é€’å¾ˆæ™šï¼Œç¬¬å››æ‰¹æ‰å…¥é¢ã€‚</p><p>ç”±äºå’ŒBUAA SEå†²çªï¼Œä¹Ÿæ²¡è”ç³»å¯¼å¸ˆï¼Œé‚è·‘è·¯ã€‚</p><h3 id="åŒ—äº¬é‚®ç”µå¤§å­¦-è®¡ç®—æœºå­¦é™¢-1"><a href="#åŒ—äº¬é‚®ç”µå¤§å­¦-è®¡ç®—æœºå­¦é™¢-1" class="headerlink" title="åŒ—äº¬é‚®ç”µå¤§å­¦ è®¡ç®—æœºå­¦é™¢"></a>åŒ—äº¬é‚®ç”µå¤§å­¦ è®¡ç®—æœºå­¦é™¢</h3><blockquote><p>ä¸¤ç”µä¸€é‚®çš„é‚®ï¼Œè®¡ç®—æœºé€šä¿¡å®åŠ›ä¸ä¿—ï¼Œä¸­9æ°´å¹³ï¼Œé€šä¿¡å®åŠ›å¾ˆå¼ºï¼Œä½†ä¸æ˜¯æˆ‘çš„å…´è¶£æ–¹å‘ã€‚</p></blockquote><p>çº¯å¼±comï¼Œç”±äºå·²ç»ç»è¿‡å¤ä»¤è¥é¢è¯•ï¼Œæ²¡æœ‰è¿›ä¸€æ­¥çš„è€ƒæ ¸äº†ã€‚</p><p>9æœˆ18æ—¥å‡Œæ™¨æ¥åˆ°é€šçŸ¥ï¼Œä»Šå¹´æ‹›ç”Ÿåé¢å¤§å¹…å‡å°‘ï¼Œä¸”å¯¼å¸ˆç­‰é¢æ¨èï¼Œå¦‚æœè¢«æ¨èè¿˜é¸½ä¼šç›´æ¥å¯¼è‡´è€å¸ˆå°‘ä¸€ä¸ªæ‹›ç”ŸæŒ‡æ ‡ã€‚<br>æˆ‘çš„ä½æ¬¡åº”è¯¥æ¯”è¾ƒé«˜ï¼Œè¯´æ˜¯å¯èƒ½å¯ä»¥äº‰å–åˆ°ä¸€ä¸ªåé¢æ¥æ¨èæˆ‘ï¼Œè®©æˆ‘9ç‚¹ä¹‹å‰åšå‡ºå†³å®šã€‚<br>è™½ç„¶æµ·æŠ•ï¼Œä½†æ˜¯æˆ‘ç¡®å®ä¸æ˜¯é‚£ç§ä¸ºäº†offerå°±éšæ„å…»é±¼ï¼Œç‰¹åˆ«æ˜¯è¿™ç§å½±å“å¯¼å¸ˆæ‹›ç”Ÿçš„æƒ…å†µã€‚</p><p>ç”±äºæ‰‹ä¸Šæ²¡æœ‰985offerï¼Œbuptçš„Titleä¹Ÿç¡®å®èƒ½æ‰“ï¼Œé‚£ä¸€æ™šæˆ‘å°±ä¸å¾—ä¸é¢ä¸´2ä¸ªé€‰æ‹©ï¼š</p><ol><li>æ¥å—æ¨èï¼Œè®©è€å¸ˆå»äº‰å–ï¼Œå¦‚æœäº‰å–åˆ°å°±ä¼šï¼š<ul><li>æ”¾å¼ƒå†²å‡»985çš„æœºä¼š</li><li>ä¸ºäº†Titleå»è¯»ä¸€ä¸ªè‡ªå·±ä¸æ„Ÿå…´è¶£çš„æ–¹å‘ </li></ul></li><li>å®Œå…¨æ”¾å¼ƒï¼Œå»èµŒæ‰‹ä¸Šè¿˜æ”¥ç€çš„ä¸€ä¸ªæœ«ä½wlã€ç¬¬ä¸‰æ‰¹å¤©å¤§æ™ºç®—å’ŒBUAA SEã€‚</li></ol><p>ä¸€å¤œæœªçœ ï¼Œè¿˜æ˜¯é€‰æ‹©äº†æ¥å—ï¼Œåªæ˜¯åæ¥ç¡®å®ä¹Ÿæ²¡æœ‰äº‰å–åˆ°ã€‚<br>å‡ å¤©ååˆå‘Šè¯‰æˆ‘æœ‰ç›´åšçš„æœºä¼šï¼Œä½†è€ƒè™‘åˆ°æ–¹å‘ä¸matchï¼Œä¸”è‡ªå·±æ²¡æœ‰ç›´åšæ„æ„¿ï¼Œé‚æ”¾å¼ƒã€‚</p><p>å¡ç¿å¤±é©¬ç„‰çŸ¥éç¦ã€‚<br>å¦‚æœçœŸçš„æœ‰æœºä¼šï¼Œæˆ‘å½“å¤©å°±é€€äº†æœºç¥¨ç»“æŸä¿ç ”ï¼Œå»è¯»ä¸€ä¸ªä¸æ„Ÿå…´è¶£çš„æ–¹å‘åæ‚”3å¹´ï¼Œä¹Ÿæ²¡æœ‰è¢«BUAA SEå½•å–çš„å¯èƒ½äº†ã€‚</p><h3 id="åä¸œå¸ˆèŒƒå¤§å­¦-è½¯ä»¶å­¦é™¢-å“è¶Šå·¥ç¨‹å¸ˆå­¦é™¢"><a href="#åä¸œå¸ˆèŒƒå¤§å­¦-è½¯ä»¶å­¦é™¢-å“è¶Šå·¥ç¨‹å¸ˆå­¦é™¢" class="headerlink" title="åä¸œå¸ˆèŒƒå¤§å­¦ è½¯ä»¶å­¦é™¢/å“è¶Šå·¥ç¨‹å¸ˆå­¦é™¢"></a>åä¸œå¸ˆèŒƒå¤§å­¦ è½¯ä»¶å­¦é™¢/å“è¶Šå·¥ç¨‹å¸ˆå­¦é™¢</h3><blockquote><p>985ï¼Œè½¯ä»¶å·¥ç¨‹ç¬¬äº”è½®è¯„ä¼°A+ï¼Œå“å·¥çš„ç¡•æ˜¯å·¥ç¨‹ç¡•ï¼ˆè”åŸ¹ï¼‰</p></blockquote><p>åœ¨åå¸ˆè¯»ç¡•å£«çš„å¤§ä½¬å­¦é•¿æ¨èäº†ä¸€ä¸ªå¯¼å¸ˆï¼Œåšä»£ç å¤§æ¨¡å‹çš„ã€‚<br>ä½†å‘é‚®ä»¶æ—¶å†™äº†â€œå¤šæ¨¡æ€å¤§æ¨¡å‹â€ï¼Œå¯¼å¸ˆç¬¬ä¸€æ¬¡è¡¨ç¤ºæ–¹å‘ä¸matchï¼ˆå…¶å®æˆ‘æ˜¯æƒ³åšå¤§æ¨¡å‹çš„ï¼Œå…·ä½“æ–¹å‘ä¸é‡è¦ï¼‰ã€‚<br>ç»è¿‡äºŒæ¬¡é‚®ä»¶è¯šæŒšè§£é‡Šåï¼Œè€å¸ˆæœªè®¡å‰å«Œï¼Œç»™æˆ‘æ‰“äº†ç”µè¯ã€‚<br>è€å¸ˆäººå¾ˆå¥½äº¤æµï¼Œæ²Ÿé€šäº¤æµåè¡¨ç¤ºæ¬¢è¿æŠ¥åã€‚<br>srdsï¼Œæœ€ç»ˆå› ä¸ºBGå¤ªå¼±æ²¡æœ‰å…¥é¢//</p><p>å“å·¥16å·æ¥åˆ°å…¥é¢é€šçŸ¥ï¼Œè™½ç„¶æˆ‘æ²¡æœ‰é€‰â€œå·¥ç¨‹ç¡•åšä¸“é¡¹â€ï¼Œä½†å®é™…ä¸Šè¿˜æ˜¯è”åŸ¹ã€‚<br>é‰´äºå½“æ—¶æ²¡æœ‰985offerï¼Œå°±æ‰“ç®—å»è¯•è¯•ã€‚<br>é€šçŸ¥19~20å·é¢è¯•ï¼Œå½“å¤©å°±æŠŠç«è½¦ç¥¨è®¢äº†ï¼Œåé¢åˆè®¢äº†é£å»åŒ—äº¬é¢è¯•çš„æœºç¥¨ã€‚</p><p>ç»“æœå‡ºå‘çš„å‰ä¸€æ™š18å·ï¼Œæ¥åˆ°å¤©å¤§æ™ºç®—çš„é¢è¯•é€šçŸ¥ã€‚<br>è€ƒè™‘åˆ°ä¸æƒ³å»è”åŸ¹ï¼Œé‚æ”¾å¼ƒï¼Œè¿½æ¢¦å¤©å¤§ã€‚</p><h3 id="å¤©æ´¥å¤§å­¦-æ™ºèƒ½ä¸è®¡ç®—å­¦éƒ¨ï¼ˆè½¯ä»¶å­¦é™¢ï¼‰"><a href="#å¤©æ´¥å¤§å­¦-æ™ºèƒ½ä¸è®¡ç®—å­¦éƒ¨ï¼ˆè½¯ä»¶å­¦é™¢ï¼‰" class="headerlink" title="å¤©æ´¥å¤§å­¦ æ™ºèƒ½ä¸è®¡ç®—å­¦éƒ¨ï¼ˆè½¯ä»¶å­¦é™¢ï¼‰"></a>å¤©æ´¥å¤§å­¦ æ™ºèƒ½ä¸è®¡ç®—å­¦éƒ¨ï¼ˆè½¯ä»¶å­¦é™¢ï¼‰</h3><blockquote><p>985ï¼Œè½¯ä»¶å·¥ç¨‹ç¬¬äº”è½®è¯„ä¼°A-ï¼Œå†²ã€‚</p></blockquote><p>æœ¬æ¥ç¬¬äºŒæ‰¹è®¡ç®—æœºè¿‡åˆç­›äº†ï¼Œç»“æœå‘å…¥ç¾¤é€šçŸ¥çš„é‚£æ™šå®Œå…¨æ²¡çœ‹Googleé‚®ç®±ã€‚<br>ç¬¬äºŒå¤©çœ‹åˆ°ä¹‹åï¼Œè¿›ç¾¤å¡«è¡¨æ™šäº†åŠå°æ—¶ï¼ŒæˆåŠŸæŠŠè‡ªå·±å‘æ­»äº†â€¦â€¦</p><p>å¥½åœ¨è¿½åŠ äº†å¿—æ„¿ï¼ŒæŠ¥äº†æ™ºç®—çš„è½¯å·¥ï¼Œç¬¬ä¸‰æ‰¹ä¹Ÿè¿‡äº†åˆç­›ï¼Œè¿›å…¥çº¿ä¸Šæœºè¯•ã€‚<br>æœºè¯•2å°æ—¶5é“é¢˜ï¼Œå‰4é¢˜å¾ˆå¸¸è§„ï¼Œç¬¬5é¢˜ç¨å¾®ç”¨åˆ°ç‚¹ç®—æ³•ï¼Œä¹Ÿæ˜¯1å°æ—¶AKã€‚<br>18å·æ”¶åˆ°å…¥é¢é€šçŸ¥ï¼Œç´§æ€¥é€€ç¥¨æ”¹ç­¾ï¼Œ19å·é£å¤©æ´¥ï¼Œä¸­é€”ä¸­è½¬å¤§è¿è¿˜åƒäº†é¡¿æµ·é²œ//</p><p>é¢„æ¨å…20å·å…¨å¤©ã€‚<br>ä¸Šåˆçº¿ä¸‹æœºè¯•ï¼Œå’Œçº¿ä¸Šä¸€æ ·2å°æ—¶5é¢˜ï¼Œä¹Ÿæ˜¯1å°æ—¶AKã€‚<br>ä¸‹åˆé¢è¯•çº¯BGé¢ï¼Œ</p><p>æœ€ç»ˆç¬¬ä¸‰æ‰¹é«˜ä½wlï¼Œä¸è¿‡æ®è¯´å¤©å¤§è¶…å‘offerï¼Œè¡¥å½•ä¹Ÿåº”è¯¥ä»ç¬¬ä¸€æ‰¹å¼€å§‹ï¼Œå› æ­¤åŸºæœ¬å¯„äº†ã€‚</p><h3 id="åŒ—äº¬èˆªç©ºèˆªå¤©å¤§å­¦-è½¯ä»¶å­¦é™¢-1"><a href="#åŒ—äº¬èˆªç©ºèˆªå¤©å¤§å­¦-è½¯ä»¶å­¦é™¢-1" class="headerlink" title="åŒ—äº¬èˆªç©ºèˆªå¤©å¤§å­¦ è½¯ä»¶å­¦é™¢"></a>åŒ—äº¬èˆªç©ºèˆªå¤©å¤§å­¦ è½¯ä»¶å­¦é™¢</h3><blockquote><p>ä½äºé¦–éƒ½çš„æ¢¦æ ¡ï¼Œè½¯ä»¶å·¥ç¨‹ç¬¬äº”è½®è¯„ä¼°A+ï¼Œå’Œæ¸…åŒ—åä¸€æ¡Œã€‚<br>æˆ‘æ˜¯BUAA SEçš„åšå®šæ‹¥æŠ¤è€…ã€‚</p></blockquote><p>å…¨å›½ç‹¬ä¸€ä»½ï¼Œä¸ºåƒæˆ‘è¿™ç§å¼±BGçš„ACMeræä¾›æœºä¼šçš„é™¢æ ¡ã€‚</p><p>é¢„æ¨å…å®˜ç½‘12å·æ‰å‘é€šçŸ¥ï¼Œä¹Ÿæ²¡æœ‰ä¸Š<a href="https://ddl.csbaoyan.top/">è®¡ç®—æœºä¿ç ”DDL</a>ï¼Œå¾—è‡ªå·±å…³æ³¨ã€‚<br>åŒ—èˆªè½¯é™¢çš„æ•™åŠ¡æ•ˆç‡æé«˜ï¼Œé—®ç­”æ–‡æ¡£å’Œå®¡æ ¸æ–‡æ¡£æ›´æ–°éå¸¸åŠæ—¶ï¼Œä¹Ÿè¶³å¤Ÿäººæ€§åŒ–ï¼ˆä¸ä¼šå› ä¸ºå·®å‡ åˆ†é’Ÿå°±æ‹’ç»å®¡æ ¸ï¼‰ã€‚</p><p>å¤è¯•ä¸ç­›äººï¼ˆç‚¹å‡»æŠ¥åå°±é€ï¼‰ï¼Œå…¥é¢ä¾é çº¿ä¸‹æœºè¯•ç­›äººï¼Œæœºè¯•å»äº†200äººå·¦å³ï¼ˆç¡•+åšï¼‰ã€‚</p><p>çº¿ä¸‹æœºè¯•ä¸€å…±8é¢˜ï¼Œ20Ã—3+10Ã—3+5Ã—2åˆ†å€¼ï¼Œ1.5ä¸ªå°æ—¶ï¼Œçº¯Cè¯­è¨€ç¼–ç¨‹ã€‚<br>æˆ‘å¤§æ¦‚1å°æ—¶å¤šä¸€ç‚¹ï¼Œå†™äº†6é¢˜ï¼Œ90åˆ†ï¼Œæœ€ç»ˆä¹Ÿæ˜¯è¢«æœºè¯•å¸¦é£äº†ã€‚<br>T7T8ç”¨çº¯Cå†™ç¡®å®ç¡¬æ ¸ï¼ŒT7å…¨åœºåªè¿‡äº†2ä¸ªï¼ŒT8é˜²AKã€‚<br>æ–©æ€çº¿åº”è¯¥åœ¨70åˆ†å·¦å³ï¼Œå…¥é¢120äººå·¦å³ã€‚</p><p>åˆ†åˆ°ç¬¬äºŒå¤©ä¸Šåˆé¢è¯•ï¼Œé¢è¯•å‰é€šå®µå¤ä¹ äº†ã€‚<br>åŒ—èˆªè½¯é™¢çš„é¢è¯•æ˜¯æˆ‘å‚åŠ è¿‡æœ€ç¡¬æ ¸çš„é¢è¯•ï¼Œè‹±è¯­+æ•°å­¦+ä¸“ä¸š+BGï¼Œ360Â°å…¨æ–¹ä½æ— æ­»è§’æ‹·æ‰“ã€‚</p><ul><li>è‹±è¯­é¢é—®äº†2ä¸ªé—®é¢˜ï¼Œæœ‰ä¸€ä¸ªå‰ä¸€å¤©å‡†å¤‡äº†æ–‡ç¨¿ä½†æ˜¯æ²¡èƒŒï¼Œè¢«é—®åˆ°çš„æ—¶å€™è´¼æ‚”ï¼›</li><li>æ•°å­¦é¢é—®äº†2ä¸ªé—®é¢˜ï¼Œæ¯”è¾ƒåŸºç¡€ï¼Œæ²¡æœ‰è€ƒç‰¹åˆ«æ·±å…¥çš„å†…å®¹ï¼ˆæ¯•ç«Ÿä¸æ˜¯æ•°å­¦ä¸“ä¸šï¼‰ï¼›</li><li>ä¸“ä¸šé¢é—®äº†4ä¸ªç§‘ç›®ï¼Œæœ€æ“…é•¿çš„ç§‘ç›®æ²¡é—®ï¼Œå‡ ä¹æ‰“åœ¨ç›²ç‚¹ä¸Šï¼Œè¢«é—®ç©¿äº†ï¼›</li><li>BGé¢ä¸»è¦é™ˆè¿°ç«èµ›ã€ç§‘ç ”ç»å†å’Œé¡¹ç›®ç»å†ï¼Œä¸è¿‡è€å¸ˆä»¬ä¼¼ä¹æ›´å…³æ³¨ç§‘ç ”å’Œé¡¹ç›®ï¼ˆæ‰“Aç¡®å®ä¹Ÿæ²¡ä»€ä¹ˆå¥½é—®çš„ï¼‰ã€‚</li></ul><p>æ€æ”¿å’Œè‹±è¯­æ˜¯åŒä¸€ä¸ªè€å¸ˆé—®çš„ï¼Œè€å¸ˆå¾ˆæ¸©æŸ”ï¼Œæé†’æˆ‘ä¸è¦ç´§å¼ ï¼ˆä½†æ˜¯é¼ é¼ å‹åŠ›çœŸçš„å¾ˆå¤§ï¼‰ã€‚<br>æ•°å­¦é¢æé—®çš„è€å¸ˆä¹Ÿå¾ˆå¥½ï¼Œå›ç­”å®Œä¹‹åä¼šé¼“åŠ±è¯´â€œç­”å¾—å¾ˆå¥½â€ï¼Œåœ¨ä¸“ä¸šé¢é—®é¢˜çš„æ—¶å€™ä¹Ÿæœ‰æç¤ºã€‚<br>è¿™ä¸¤ä½è€å¸ˆçœŸçš„éƒ½å¾ˆå¥½ï¼Œæ˜¯é‚£ç§ä¼šè®©æˆ‘æ„Ÿè§‰ä¸æ¥å¥½å¯æƒœçš„QwQã€‚</p><p>é¢è¯•ç¡®å®å¯„å®Œäº†ï¼Œä½†æ˜¯è¢«æœºè¯•å¸¦é£äº†ï¼Œä¸“ç¡•é«˜ä½å€™è¡¥ã€‚<br>ä»Šå¹´å­¦ç¡•42å½•23ï¼Œå½•å–çº¿åˆ’åˆ°231.2ï¼›ä¸“ç¡•64å½•23ï¼Œå½•å–çº¿åˆ’åˆ°240.4ï¼Œæ¯”ä¸“ç¡•è¿˜é«˜10åˆ†QwQã€‚</p><p>çœ‹åˆ°åå•çš„æ—¶å€™æ‚”æ­»ï¼Œå¦‚æœæŠ¥å­¦ç¡•å·²ç»ä¸Šå²¸äº†ï¼Œä¸“ç¡•æŒ‰ç…§å»å¹´æƒ…å†µï¼ˆåªé¸½1ä¸ªï¼‰æ˜¯å€™è¡¥ä¸åˆ°æˆ‘çš„ã€‚<br>å¦‚æœå› ä¸ºè‡ªå·±çŠ¯è ¢æŠŠè‡ªå·±å®³æ­»çœŸçš„ä¼šT^Tã€‚</p><p>923ä¸Šåˆæ¥è¡¥å½•ï¼Œä¸Šå²¸æ¢¦æ ¡ï¼</p><p>å¤ä»¤è¥å§‹äºBUAA SEï¼Œæ‹Ÿå½•å–ç»ˆäºBUAA SEã€‚<br>æœ‰å§‹ï¼Œæœ‰ç»ˆã€‚</p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><h3 id="å…³äºæ„Ÿå—"><a href="#å…³äºæ„Ÿå—" class="headerlink" title="å…³äºæ„Ÿå—"></a>å…³äºæ„Ÿå—</h3><p>å¤ä»¤è¥ç»“æŸä¹‹åè¿˜æ²¡æœ‰ç‰¹åˆ«ç€æ€¥ï¼Œè§‰å¾—è‡ªå·±åˆ°äº†é¢„æ¨å…æœºä¼šè¿˜å¾ˆå¤šï¼Œ7~8æœˆç©ºæ¡£æœŸè¿˜é¡ºä¾¿å»å®äº†ä¸ªä¹ ã€‚<br>ç»“æœé¢„æ¨å…å¡«æŠ¥å®Œï¼Œæ…¢æ…¢å¼€å§‹å‘ç°äº‹æƒ…ä¸å¯¹åŠ²èµ·æ¥äº†ã€‚</p><p>ä»Šå¹´å½¢åŠ¿å·¨å˜ï¼Œå¤ä»¤è¥ç¼©æ°´ï¼Œæ¨å…åé¢å¢åŠ ï¼Œå¤§é‡92å¤§ä½¬æ¶Œå…¥é¢„æ¨å…ã€‚<br>æ ¹æ®ä»¥å¾€çš„ç»éªŒï¼Œæˆ‘èƒ½æ‹¿åˆ°offerçš„é™¢æ ¡ï¼Œå¾ˆå¤šæŠ•é€’ä¹‹åç”šè‡³éƒ½æ²¡æœ‰å…¥è¥å…¥é¢ã€‚</p><p>9æœˆï¼Œ9å·-16å·ï¼Œè¿™ä¸€å‘¨æ˜¯æˆ‘æœ€ç…ç†¬çš„æ—¥å­ã€‚<br>å¤§éƒ¨åˆ†é™¢æ ¡é¢„æ¨å…æŠ¥åæˆªæ­¢æ—¶é—´åˆ°äº†ï¼Œå¯æ˜¯æˆ‘çš„æ”¶ä»¶ç®±å§‹ç»ˆéƒ½æ˜¯ç©ºç©ºå¦‚ä¹Ÿã€‚</p><p>å½“æ—¶ä¹Ÿä¸çŸ¥é“BUAA SEèƒ½å…¥å¤è¯•ã€‚<br>æˆ‘æ¯ä¸€å¤©éƒ½åœ¨ä¸åœçš„ç¡®è®¤æŠ¥åæ˜¯å¦å®¡æ ¸é€šè¿‡ã€å…¶ä»–åŒå­¦æœ‰æ²¡æœ‰æ”¶åˆ°å…¥é¢é‚®ä»¶ã€‚<br>è‹å¤§å¾ˆå¥½ï¼Œè‹å¤§çš„è€å¸ˆä¹Ÿå¾ˆå¥½ï¼Œå¯æ˜¯æˆ‘å§‹ç»ˆæŠ±ç€å»å¾€985çš„æœŸæœ›ï¼ŒçœŸçš„ä¸ç”˜å¿ƒæ­¢æ­¥äºæ­¤ã€‚<br>æ¯å½“å¤œé‡Œæƒ³èµ·ï¼Œè§‰å¾—å¾ˆéš¾ç»™è‡ªå·±è¿™ä¸‰å¹´çš„åŠªåŠ›ä¸€ä¸ªæ»¡æ„äº¤å¾…ï¼Œå°±ä¼šæ•´æ™šç¡ä¸ç€è§‰ã€‚<br>ä½†å¥½åœ¨17å·å¼€å§‹é™†ç»­æ”¶åˆ°é™¢æ ¡çš„å…¥é¢é€šçŸ¥ï¼Œæ‰ç¼“è§£ç„¦è™‘çš„æƒ…ç»ªï¼Œé€æ¸è°ƒæ•´å¥½çŠ¶æ€ã€‚</p><p>æ²¡æŠ¥ä¿ç ”è¾…å¯¼æœºæ„ï¼Œç»¿ç¾¤ä»5æœˆè¢«lruåå°±æ²¡è¿›è¿‡ï¼Œå…¨ç¨‹å°±åªèƒ½è‡ªå·±çç¢ç£¨ã€‚</p><p>æˆ‘é™¶ç“·å¯¼å¸ˆå¾ˆå°‘ï¼Œæ›´å°‘åœ¨å…¥è¥/å…¥å¤è¯•ä¹‹å‰è”ç³»å¯¼å¸ˆã€‚<br>è”ç³»åˆ°çš„æ¯ä¸ªå¯¼å¸ˆï¼Œæˆ‘ä¹Ÿå¾ˆæ…é‡çš„ç»™è€å¸ˆæ‰¿è¯ºï¼Œåªå’Œä¸€ä¸ªè€å¸ˆè¯´äº†â€œæˆ‘ä¸€å®šä¼šæ¥â€ï¼Œè™½ç„¶æ²¡æœ‰å€™è¡¥ä¸Šã€‚<br>æˆ‘ä¹Ÿä¼šåœ¨ç¬¬ä¸€æ¬¡æ²Ÿé€šæ—¶ï¼Œè¡¨æ˜æˆ‘æ‰‹ä¸Šçš„offerä»¥åŠå…¥é¢å’Œå¤ä»¤è¥æƒ…å†µã€‚<br>è¿™å°±å¯¼è‡´æˆ‘æ— æ³•è¡·å¿ƒé€‰æ‹©è¯¸å¦‚HUSTè¿™æ ·çš„çº¯å¼±comé™¢æ ¡ï¼Œé¢å¯¹BUPTçš„ç­‰é¢æ¨èæœºä¼šæ—¶ä¹Ÿçº ç»“äº†ä¸€é€šå®µã€‚<br>è¿™ç§æ–¹å¼æ— ç–‘æ˜¯ä¼šè®©æˆ‘å¤±å»ä¸€äº›æœºä¼šçš„ï¼Œä½†ä¹Ÿè®©æˆ‘é¿å…äº†å¾ˆå¤šä¸å¿…è¦çš„éº»çƒ¦ã€‚</p><p>æœŸé—´ä¹ŸçŠ¯äº†å¾ˆå¤šæ¬¡æ„šè ¢çš„ä½çº§é”™è¯¯ï¼Œç–¯ç‹‚è¸©é›·ï¼Œæœ‰è¢«è‡ªå·±ç‹ ç‹ è ¢åˆ°ï¼š</p><ol><li>é™¶ç“·å¯¼å¸ˆï¼Œå§“æ°æœªæ”¹/æ–¹å‘ä¸è´´åˆ‡</li><li>ç»™Aæ ¡å‘çš„ææ–™é‡ŒåŒ…å«äº†æŠ¥è€ƒBæ ¡çš„æ ¡å</li><li>é¢è¯•æœªå‡†å¤‡å¤šä»½ææ–™</li><li>ç¼ºä¹é¢è¯•ç»éªŒï¼Œè¡¨ç°æå…¶ç´§å¼ </li><li>æœªåŠæ—¶æŸ¥çœ‹é‚®ä»¶ï¼Œé”™è¿‡é‡è¦é€šçŸ¥</li><li>é”™è¿‡äº†å›½å®¶å¥–å­¦é‡‘ç”³è¯·</li><li>etc.</li></ol><p>æœ€ç»ˆè¿˜æ˜¯åœ¨ç£•ç£•ç»Šç»Šè·Œè·Œæ’æ’ä¸­ï¼Œå¹¸è¿çš„ä¸Šå²¸äº†æ¢¦æ ¡ã€‚</p><h3 id="å…³äºæ¥ä¸‹æ¥æƒ³åšçš„äº‹æƒ…"><a href="#å…³äºæ¥ä¸‹æ¥æƒ³åšçš„äº‹æƒ…" class="headerlink" title="å…³äºæ¥ä¸‹æ¥æƒ³åšçš„äº‹æƒ…"></a>å…³äºæ¥ä¸‹æ¥æƒ³åšçš„äº‹æƒ…</h3><ul><li>gapåˆ°å›½åº†ç»“æŸï¼Œå¥½å¥½æ”¾æ¾ä¸€æ®µæ—¶é—´ï¼Œè°ƒæ•´ä¸€ä¸‹çŠ¶æ€</li><li>å¼€å§‹ç€æ‰‹æ¯•ä¸šè®¾è®¡ï¼Œäº‰å–èƒ½æ—©ç‚¹å®Œæˆ</li><li>ç©ºä½™æ—¶é—´åˆ·CET6&gt;=550ï¼Œäº‰å–å…¥å­¦ä¹‹åå…ä¿®è‹±è¯­</li><li>æå‰ç ”è¯»ä¸€ä¸‹ç»„å†…è®ºæ–‡ï¼Œå­¦ä¹ ä¸€äº›ç›¸å…³æŠ€æœ¯</li><li>å¥èº«ï¼æœ¬ç§‘æœŸé—´ç¡®å®ç¼ºä¹è¿åŠ¨ï¼Œèƒ–äº†xxæ–¤</li><li>æ›´æ–°<a href="https://cclmsy.cc/handwritten">æ‰‹å†™ä¿¡</a>ï¼Œè®°å½•ä¸€äº›é‡è¦çš„äººå’Œäº‹</li><li>fix/optimizeï¼šåšå®¢å’Œå°é¡¹ç›®</li></ul><h3 id="ç¥æ„¿"><a href="#ç¥æ„¿" class="headerlink" title="ç¥æ„¿"></a>ç¥æ„¿</h3><p>è°¢è°¢ä½ çœ‹åˆ°è¿™é‡Œï¼Œä¹Ÿç¥æ„¿ä½ å‰ç¨‹ä¼¼é”¦ï¼</p><!-- ## æ¨æ–‡### ä¿ç ”å¿ƒå¾—> åœ¨ç»„ç»‡åŸºæœ¬é¢è‰¯å¥½çš„å‰æä¸‹ï¼Œé€šè¿‡å¼ºåŒ–æ ¸å¿ƒä¼˜åŠ¿å½¢æˆç«äº‰åŠ›ã€‚â€”â€”åæœ¨æ¡¶åŸç†å°½ç®¡ä¿ç ”æ˜¯ä¸€åœºè€ƒéªŒç»¼åˆç´ è´¨çš„é€‰æ‹”ï¼Œéœ€è¦å…¼é¡¾å­¦ä¸šï¼ˆGPAæ’åï¼‰ã€ç«èµ›ã€ç§‘ç ”/é¡¹ç›®/å®ä¹ ã€è‹±è¯­å…­çº§å’Œè½¯å®åŠ›ç­‰æ–¹é¢ã€‚ä½†åœ¨å…¶ä»–æ–¹é¢éƒ½è¿˜è¿‡çš„å»çš„æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯éœ€è¦è¦æ‰¾å‡†è‡ªå·±çš„æ ¸å¿ƒç«äº‰åŠ›ã€‚ç§‘ç ”åŸºç¡€ï¼Œç«èµ›å°±ä¸åŸºç¡€ï¼›æ’ååŸºç¡€ï¼Œå…­çº§å°±ä¸åŸºç¡€ã€‚æ‰¾åˆ°è‡ªå·±çš„æ ¸å¿ƒç«äº‰åŠ›åï¼Œéœ€è¦é‡ç‚¹å…³æ³¨è€ƒå¯Ÿè¿™æ–¹é¢çš„é™¢æ ¡ï¼Œäº†è§£é™¢æ ¡çš„å…¥å›´æ ‡å‡†ä½œä¸ºåŠªåŠ›ç›®æ ‡ï¼Œé’ˆå¯¹æ€§å‡†å¤‡ï¼Œå½¢æˆå·®å¼‚åŒ–ä¼˜åŠ¿ã€‚ä¸¤å¹´å¤šçš„ACMè®­ç»ƒç»å†ï¼Œä½¿æˆ‘åœ¨å„ä¸ªé™¢æ ¡çš„æœºè¯•ä¸­æ¸¸åˆƒæœ‰ä½™ï¼Œä¹Ÿæˆä¸ºäº†æˆ‘è¿›å…¥é¢è¯•ã€æ–©è·offerçš„å…³é”®ã€‚ä½†ç”±äºåœ¨ç§‘ç ”æ–¹é¢çš„ç§¯ç´¯è¾ƒå°‘ï¼Œæˆ‘å°±éš¾ä»¥å–å¾—æ³¨é‡ç§‘ç ”ç»å†çš„é™¢æ ¡çš„é’çã€‚### ä¿ç ”æœŸé—´å°è±¡æœ€æ·±åˆ»çš„äº‹æƒ…> äººä»¬å¯¹äº‹ç‰©çš„è®°å¿†ä¾èµ–äºç¬¬ä¸€å°è±¡ã€å³°å€¼æƒ…ç»ªä¸æœ€ç»ˆæ„Ÿå—ã€‚â€”â€”é¦–å› æ•ˆåº”&å³°ç»ˆæ•ˆåº”åŒ—èˆªè½¯é™¢æš‘æœŸå­¦æ ¡æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªå¤ä»¤è¥ã€‚1000+äººçº¿ä¸ŠåŒå°ç«æŠ€ï¼ˆæœ€ç»ˆæœ‰è¿‡é¢˜çš„å¤§æ¦‚600+ï¼‰ï¼Œä¸€å…±7é¢˜ï¼Œå‰42åå‚åŠ çº¿ä¸‹è¥ï¼Œæˆ‘æœ‰å¹¸å…¥å›´ã€‚æ•´ä¸ªæ¨å…è¿‡ç¨‹ä¸­å”¯ä¸€æœ‰ä¼´æ‰‹ç¤¼çš„é™¢æ ¡ï¼ˆäººæ–‡å…³æ€€è¿™ä¸€å—ï¼‰ã€‚åŒ—èˆªè½¯é™¢é¢„æ¨å…ä¹Ÿæ˜¯æˆ‘çš„æœ€åä¸€ä¸ªé¢„æ¨å…ã€‚æå°‘æ•°æŠ¥åä¸å¡BGçš„é™¢æ ¡ï¼Œçªå‡ºçš„æœºè¯•æ‹¯æ•‘äº†æˆ‘ç¨€çƒ‚çš„é¢è¯•ï¼Œåœ¨å¯¹é¢è¯•è¡¨ç°çš„æåº¦æ‡Šæ‚”ä¸­è·çŸ¥è‡ªå·±ä½åˆ—å€™è¡¥ç¬¬2ã€‚æœ€é¡¶å³°çš„æ—¶åˆ»è«è¿‡äº923æ¥åˆ°å€™è¡¥å½•å–ç”µè¯ï¼Œä¸Šå²¸çš„é‚£ä¸€åˆ»ã€‚æ¨å…å§‹äºBUAA SEå¤ä»¤è¥ï¼Œç»ˆäºBUAA SEé¢„æ¨å…ã€‚æœ‰å§‹ï¼Œæœ‰ç»ˆã€‚### å­¦é•¿å¯„è¯­> ç«¹å­ç”¨äº†4å¹´çš„æ—¶é—´ï¼Œç«¹èŠ½ä»…ä»…é•¿äº†3cmï¼›ç¬¬5å¹´ç ´åœŸè€Œå‡ºï¼Œ6å‘¨å°±èƒ½è¾¾åˆ°15ç±³ã€‚â€”â€”ç«¹å­å®šå¾‹ä¸ä»…ä»…æ˜¯ä¿ç ”ï¼Œè€ƒç ”ã€å°±ä¸šã€åˆ›ä¸šäº¦æ˜¯å¦‚æ­¤ã€‚æˆ–è®¸æœ‰æ—¶ä½ å·²ç»åšå‡ºäº†å¾ˆå¤šåŠªåŠ›å´çœ‹ä¸åˆ°æˆæ•ˆï¼Œä½†å­¦åˆ°çš„çŸ¥è¯†ã€ç§¯ç´¯çš„ç»éªŒå¹¶ä¸ä¼šå› ä¸ºçŸ­æ—¶é—´å†…æ²¡æœ‰è¢«å…·è±¡åŒ–è€Œæ¶ˆå¤±ã€‚ä¸è¦å› ä¸ºä¸€æ—¶çš„æ²‰å¯‚è€ŒåŠ¨æ‘‡ï¼Œä½ æ‰€æœ‰çš„ç§¯ç´¯éƒ½æ˜¯åœ¨åœ°ä¸‹æ·±å¤„æ‰æ ¹ã€‚ -->]]></content>
    
    
    <summary type="html">å››éé¼ é¼ ä¸Šå²¸æ¢¦æ ¡BUAA</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>è®ºæ–‡ç¬”è®°|Video-LLaMAï¼šAn Instruction-tuned Audio-Visual Language Model for Video Understanding</title>
    <link href="https://www.cclmsy.cc/posts/2306.02858.html"/>
    <id>https://www.cclmsy.cc/posts/2306.02858.html</id>
    <published>2025-07-16T16:00:00.000Z</published>
    <updated>2025-10-15T08:44:04.297Z</updated>
    
    <content type="html"><![CDATA[<p>è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/2306.02858">Video-LLaMA: An Instruction-tuned Audio-Visual Language Model for Video Understanding</a></p><p>é˜¿é‡Œè¾¾æ‘©é™¢çš„ä¸€ä¸ªå¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹äº§å“Video-LLaMAï¼Œå®ƒé’ˆå¯¹çš„ä»»åŠ¡æ˜¯å¤šæ¨¡æ€è§†é¢‘ç†è§£ã€‚</p><h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><p>è¦ä½¿LLMsç†è§£è§†é¢‘ï¼Œéœ€è¦å…¨é¢å¤„ç†åŒ…æ‹¬è§†è§‰è¾“å…¥ã€å¬è§‰è¾“å…¥å’Œæ–‡æœ¬è¾“å‡ºåœ¨å†…çš„ä¸åŒæ¨¡æ€ï¼Œè¿™æ¯”ä»…ç†è§£å›¾åƒæˆ–ä»…ç†è§£éŸ³é¢‘ä»»åŠ¡æ›´å…·æŒ‘æˆ˜æ€§</p><ul><li>Multi-modal Large Language Models (MLLMs) </li><li>ç°æœ‰æ–¹æ³•ï¼šåªæœ‰ä¸€ç§é¢å¤–æ¨¡æ€è¾“å…¥å’Œæ–‡æœ¬å¯¹é½</li><li>é’ˆå¯¹è§†é¢‘ç†è§£çš„workï¼šä¸ä½¿ç”¨éŸ³é¢‘éƒ¨åˆ†</li></ul><p>Video-LLaMAå¯ä»¥ç†è§£è§†é¢‘ä¸­è§†è§‰å’Œå¬è§‰å†…å®¹ã€‚</p><p>ä¸åŒäºé‡‡ç”¨å¤–éƒ¨æ„ŸçŸ¥å°†è§†å¬ä¿¡å·è½¬åŒ–ä¸ºæ–‡æœ¬ä¿¡å·ï¼Œä½œè€…æ„å»ºäº†ä¸€ä¸ªç«¯åˆ°ç«¯æ¨¡å‹ï¼Œå¯ä»¥åœ¨å•ä¸ªæ¡†æ¶å†…å¤„ç†æ¥è‡ªå¤šç§æ¨¡æ€çš„æ•°æ®</p><h1 id="Related-Work"><a href="#Related-Work" class="headerlink" title="Related Work"></a>Related Work</h1><ol><li>LLMs<ul><li>æœ¬æ–‡åŸºç¡€</li><li>Video-LLaMAèµ‹äºˆLLMè§†é¢‘ã€éŸ³é¢‘ç†è§£èƒ½åŠ›</li></ul></li><li>MLLMs<ol><li>å°†LLMä½œä¸ºæ§åˆ¶å™¨ï¼Œè¯†åˆ«ç”¨æˆ·æ„å›¾å¹¶å†³å®šè°ƒç”¨ç°æœ‰çš„å¤šæ¨¡æ€å·¥å…·ï¼Œæ•´åˆç»“æœå…¨é¢å“åº”</li><li>è®­ç»ƒåŸºç¡€å¤šæ¨¡æ€å¤§æ¨¡å‹ï¼Œæ ¸å¿ƒæ˜¯å°†å…¶ä»–æ¨¡æ€çš„é¢„è®­ç»ƒåŸºç¡€æ¨¡å‹ä¸æ–‡æœ¬å‹å¤§å‹è¯­è¨€æ¨¡å‹å¯¹é½</li></ol><ul><li>Video-LLaMAå±äºç¬¬äºŒç±»ï¼Œè®­ç»ƒæ¨¡å‹ä»¥æä¾›è§†è§‰ã€éŸ³é¢‘ç†è§£èƒ½åŠ›</li></ul></li></ol><h1 id="Architecture"><a href="#Architecture" class="headerlink" title="Architecture"></a>Architecture</h1><p>Video-LLaMAå°†è§†é¢‘å¸§å’ŒéŸ³é¢‘åˆ†åˆ«å¤„ç†ï¼Œæ•´ä¸ªæ¶æ„åˆ†æˆä¸¤ä¸ªåˆ†æ”¯ï¼šè§†è§‰è¯­è¨€åˆ†æ”¯å’ŒéŸ³é¢‘è¯­è¨€åˆ†æ”¯</p><p>åˆ†åˆ«å°†è§†é¢‘å¸§å’ŒéŸ³é¢‘ä¿¡å·è½¬æ¢ä¸ºä¸LLMæ–‡æœ¬è¾“å…¥å…¼å®¹çš„æŸ¥è¯¢è¡¨ç¤º</p><h2 id="Vision-Language-Branch"><a href="#Vision-Language-Branch" class="headerlink" title="Vision-Language Branch"></a>Vision-Language Branch</h2><h3 id="1-Frozen-pre-trained-image-encoder"><a href="#1-Frozen-pre-trained-image-encoder" class="headerlink" title="1. Frozen pre-trained image encoder"></a>1. Frozen pre-trained image encoder</h3><p>å†»ç»“çš„é¢„è®­ç»ƒå›¾åƒç¼–ç å™¨ï¼Œä»è§†é¢‘å¸§æå–å‡ºè§†è§‰ç‰¹å¾ã€‚</p><script type="math/tex; mode=display">V = [v_1, v_2, ..., v_N] , v_i \in \R^{K_f\times d_f}</script><p>v_iè¡¨ç¤ºç¬¬iå¸§ç”¨K_fä¸ªpatchè¡¨ç¤ºçš„è§†è§‰ç‰¹å¾ï¼Œd_fæ˜¯æ¯ä¸ªpatchçš„ç»´åº¦ã€‚</p><h3 id="2-PE-layer"><a href="#2-PE-layer" class="headerlink" title="2. PE layer"></a>2. PE layer</h3><p>ä¸Šä¸€å±‚äº§å‡ºçš„presentationsæœªè€ƒè™‘æ—¶åºä¿¡æ¯ï¼ŒPEå±‚ä¸ºæ¯ä¸ªv_iæ·»åŠ ä½ç½®åµŒå…¥ï¼ˆæ—¶é—´ä¿¡æ¯ï¼‰</p><h3 id="3-Video-Q-Former"><a href="#3-Video-Q-Former" class="headerlink" title="3. Video Q-Former"></a>3. Video Q-Former</h3><p>Video Query-Transformerï¼ˆQ-Formerï¼‰ä½¿ç”¨å’ŒBLIP2çš„Q-Formerçš„åŒæ¬¾æ¶æ„ï¼Œå°†ä½ç½®ç¼–ç åçš„å¸§è¡¨å¾èšåˆä¸ºè§†é¢‘çº§åˆ«çš„åµŒå…¥è¡¨ç¤ºã€‚</p><script type="math/tex; mode=display">\hat V \in \R^{K_v \times d_v}</script><h3 id="4-Linear"><a href="#4-Linear" class="headerlink" title="4. Linear"></a>4. Linear</h3><p>ä½¿è§†é¢‘è¡¨å¾é€‚åº” LLM çš„è¾“å…¥ï¼Œå°†è§†é¢‘åµŒå…¥å‘é‡è½¬æ¢ä¸ºè§†é¢‘æŸ¥è¯¢å‘é‡ï¼Œä¸ LLM çš„æ–‡æœ¬åµŒå…¥å¯¹é½</p><p>ä¸€ä¸ªçº¿æ€§å±‚å°†è§†é¢‘åµŒå…¥è½¬æ¢ä¸ºè§†é¢‘æŸ¥è¯¢å‘é‡ï¼Œä¸æ–‡æœ¬åµŒå…¥çš„ç»´åº¦å¯¹é½ã€‚</p><h3 id="Implementation"><a href="#Implementation" class="headerlink" title="Implementation"></a>Implementation</h3><p>å®ç°éƒ¨åˆ†ï¼Œå†»ç»“çš„é¢„è®­ç»ƒå›¾åƒç¼–ç å™¨ä½¿ç”¨Blip2çš„é¢„è®­ç»ƒè§†è§‰ç»„ä»¶ï¼ˆåŒ…å«æ¥è‡ª EVA-CLIP çš„ ViTG/14 å’Œä¸€ä¸ªé¢„è®­ç»ƒçš„ Q-formerï¼‰</p><p>å…¶ä½™ç»„ä»¶ï¼ŒåŒ…æ‹¬ä½ç½®åµŒå…¥å±‚ã€è§†é¢‘ Q-former å’Œçº¿æ€§å±‚ï¼Œå‡ç»è¿‡éšæœºåˆå§‹åŒ–å’Œä¼˜åŒ–ï¼Œä»¥ä¾¿å°†å†»ç»“è§†è§‰ç¼–ç å™¨çš„è¾“å‡ºä¸å†»ç»“çš„ LLM è‰¯å¥½åœ°è¿æ¥èµ·æ¥ã€‚</p><h2 id="Audio-Language-Branch"><a href="#Audio-Language-Branch" class="headerlink" title="Audio-Language Branch"></a>Audio-Language Branch</h2><p>æ•´ä½“ç»“æ„å’Œè§†è§‰è¯­è¨€åˆ†æ”¯åŸºæœ¬ç›¸åŒï¼Œå¤„ç†éŸ³é¢‘ä¿¡å·ã€‚</p><h3 id="1-Frozen-pre-trained-audio-encoder"><a href="#1-Frozen-pre-trained-audio-encoder" class="headerlink" title="1. Frozen pre-trained audio encoder"></a>1. Frozen pre-trained audio encoder</h3><p>å†»ç»“çš„é¢„è®­ç»ƒéŸ³é¢‘ç¼–ç å™¨ï¼Œè®¡ç®—çŸ­ç‰‡æ®µåŸå§‹éŸ³é¢‘çš„ç‰¹å¾ã€‚</p><script type="math/tex; mode=display">A = [a_1, a_2, ..., a_M]</script><h3 id="2-PE-layer-1"><a href="#2-PE-layer-1" class="headerlink" title="2. PE layer"></a>2. PE layer</h3><p>å‘éŸ³é¢‘ç‰‡æ®µæ³¨å…¥æ—¶é—´ä¿¡æ¯</p><h3 id="3-Audio-Q-Former"><a href="#3-Audio-Q-Former" class="headerlink" title="3. Audio Q-Former"></a>3. Audio Q-Former</h3><p>Audio Q-Former ä¹Ÿä½¿ç”¨Q-Formerçš„åŒæ¬¾æ¶æ„</p><p>åˆ©ç”¨å¸¦æœ‰ä½ç½®ä¿¡æ¯çš„éŸ³é¢‘ç‰‡æ®µä¹‹é—´çš„äº¤äº’ï¼Œæ¥ç”Ÿæˆå›ºå®šé•¿åº¦çš„éŸ³é¢‘ç‰¹å¾ã€‚</p><script type="math/tex; mode=display">\hat A \in \R^{K_a \times d_a}</script><h3 id="4-Linear-1"><a href="#4-Linear-1" class="headerlink" title="4. Linear"></a>4. Linear</h3><p>å°†éŸ³é¢‘åµŒå…¥å‘é‡è½¬æ¢ä¸ºéŸ³é¢‘æŸ¥è¯¢å‘é‡ï¼Œä¸æ–‡æœ¬åµŒå…¥çš„ç»´åº¦å¯¹é½ã€‚</p><h3 id="Implementation-1"><a href="#Implementation-1" class="headerlink" title="Implementation"></a>Implementation</h3><p>å®ç°éƒ¨åˆ†ï¼Œå†»ç»“çš„é¢„è®­ç»ƒéŸ³é¢‘ç¼–ç å™¨ä½¿ç”¨ Pre-trained ImageBind</p><p>çŸ­ç‰‡æ®µåŸå§‹éŸ³é¢‘ï¼šå‡åŒ€é‡‡æ ·Mä¸ª2ç§’çŸ­éŸ³é¢‘ç‰‡æ®µï¼Œä½¿ç”¨128ä¸ªmelé¢‘è°±å›¾åƒå°†æ¯ä¸ª2ç§’éŸ³é¢‘å‰ªè¾‘è½¬æ¢ä¸ºé¢‘è°±å›¾</p><p>å…¶ä»–éƒ¨åˆ†çš„å¤„ç†å’Œè§†è§‰è¯­è¨€åˆ†æ”¯ç›¸åŒã€‚</p><h1 id="Training"><a href="#Training" class="headerlink" title="Training"></a>Training</h1><h2 id="Video-Language"><a href="#Video-Language" class="headerlink" title="Video-Language"></a>Video-Language</h2><p>é¢„è®­ç»ƒä½¿ç”¨çš„æ•°æ®é›†ï¼š</p><ul><li>Webvid-2Mï¼šå¤§è§„æ¨¡çŸ­è§†é¢‘æ•°æ®é›†ï¼ŒåŒ…å«æ¥è‡ªç´ æç½‘ç«™çš„æ–‡æœ¬æè¿°</li><li>CC595k: ç»è¿‡è¿‡æ»¤çš„å›¾åƒ-æ–‡æœ¬æ•°æ®é›†</li></ul><p>é—®é¢˜ï¼šç›¸å½“ä¸€éƒ¨åˆ†æ–‡æœ¬æè¿°ä¸è¶³ä»¥åæ˜ è§†é¢‘çš„å…¨éƒ¨å†…å®¹ï¼Œè§†é¢‘çš„è§†è§‰è¯­ä¹‰ä¸æè¿°çš„æ–‡æœ¬è¯­ä¹‰å¹¶éå®Œå…¨ä¸€è‡´ã€‚</p><p>é¢„è®­ç»ƒé˜¶æ®µçš„ç›®æ ‡æ˜¯åˆ©ç”¨æµ·é‡æ•°æ®ä½¿è§†é¢‘ç‰¹å¾å°½å¯èƒ½åœ°åŒ…å«è§†è§‰çŸ¥è¯†</p><p>å°†è§†è§‰æ–‡æœ¬å¯¹é½å’ŒæŒ‡ä»¤éµå¾ªèƒ½åŠ›ç•™å¾…ä¸‹ä¸€é˜¶æ®µå®Œæˆ</p><p>ä½¿ç”¨é«˜è´¨é‡çš„æŒ‡ç¤ºæ•°æ®å¯¹æ¨¡å‹è¿›è¡Œå¾®è°ƒï¼š</p><ul><li>å›¾åƒç»†èŠ‚æè¿° from MiniGPT-4</li><li>å›¾åƒæŒ‡ä»¤ from LLaVA</li><li>è§†é¢‘æŒ‡ä»¤ from Video-Chat</li></ul><p>ç»†èŠ‚æè¿°ï¼šè®­ç»ƒæ¨¡å‹èƒ½å¤Ÿå¯¹å›¾åƒæˆ–è§†é¢‘ç”Ÿæˆè¯¦å°½ã€å…¨é¢ã€äº‹å®æ€§çš„æ–‡æœ¬æè¿°ï¼Œå°½å¯èƒ½å¤šåœ°æ•æ‰å’Œæè¿°å›¾åƒ/è§†é¢‘ä¸­çš„æ‰€æœ‰å¯è§å…ƒç´ ã€å®ƒä»¬çš„å±æ€§ã€ç©ºé—´å…³ç³»ã€å‘ç”Ÿçš„åŠ¨ä½œä»¥åŠä¸Šä¸‹æ–‡</p><p>æŒ‡ä»¤ï¼šç†è§£å¹¶éµå¾ªç”¨æˆ·çš„ç‰¹å®šæŒ‡ä»¤æˆ–å›ç­”ç”¨æˆ·æå‡ºçš„å…·ä½“é—®é¢˜ï¼Œé’ˆå¯¹è¯¥æŒ‡ä»¤æˆ–é—®é¢˜çš„ç®€æ˜ã€å‡†ç¡®çš„å›ç­”æˆ–æ‰§è¡Œç»“æœ</p><h2 id="Audio-Language"><a href="#Audio-Language" class="headerlink" title="Audio-Language"></a>Audio-Language</h2><p>éŸ³é¢‘-è¯­è¨€åˆ†æ”¯ä¸­å¯å­¦ä¹ å‚æ•°çš„ç›®æ ‡æ˜¯å°†å†»ç»“çš„éŸ³é¢‘ç¼–ç å™¨çš„è¾“å‡ºåµŒå…¥ä¸LLMçš„åµŒå…¥ç©ºé—´å¯¹é½ã€‚</p><p>ç›´æ¥ä½¿ç”¨éŸ³é¢‘-æ–‡æœ¬æ•°æ®è®­ç»ƒéŸ³é¢‘-è¯­è¨€åˆ†æ”¯éå¸¸å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå› ä¸ºè¿™ç±»æ•°æ®éå¸¸ç¨€ç¼ºã€‚</p><p>å¤©æ‰çš„æƒ³æ³•ï¼šImageBindå…·å¤‡å°†ä¸åŒæ¨¡æ€çš„åµŒå…¥å¯¹é½åˆ°åŒä¸€å…±äº«ç©ºé—´çš„å“è¶Šèƒ½åŠ›</p><p>ç›´æ¥ç”¨è§†è§‰â€‘æ–‡æœ¬æ•°æ®æ¥è®­ç»ƒéŸ³é¢‘â€‘è¯­è¨€åˆ†æ”¯ï¼Œç”šè‡³å¤„ç†å’Œè®­ç»ƒæµç¨‹éƒ½ç›´æ¥ç…§æ¬//</p><p>è®­ç»ƒçš„ç»“æœï¼šè™½ç„¶è®­ç»ƒæ—¶æ²¡è§è¿‡éŸ³é¢‘æ•°æ®ï¼Œæ¨ç†è¿‡ç¨‹ä¸­å±•ç°å‡ºç†è§£éŸ³é¢‘çš„èƒ½åŠ›</p><h2 id="æ€è€ƒï¼šä¸ºä»€ä¹ˆå¯ä»¥ä½¿ç”¨è§†è§‰æ–‡æœ¬æ•°æ®è®­ç»ƒéŸ³é¢‘-è¯­è¨€åˆ†æ”¯ï¼Ÿ"><a href="#æ€è€ƒï¼šä¸ºä»€ä¹ˆå¯ä»¥ä½¿ç”¨è§†è§‰æ–‡æœ¬æ•°æ®è®­ç»ƒéŸ³é¢‘-è¯­è¨€åˆ†æ”¯ï¼Ÿ" class="headerlink" title="æ€è€ƒï¼šä¸ºä»€ä¹ˆå¯ä»¥ä½¿ç”¨è§†è§‰æ–‡æœ¬æ•°æ®è®­ç»ƒéŸ³é¢‘-è¯­è¨€åˆ†æ”¯ï¼Ÿ"></a>æ€è€ƒï¼šä¸ºä»€ä¹ˆå¯ä»¥ä½¿ç”¨è§†è§‰æ–‡æœ¬æ•°æ®è®­ç»ƒéŸ³é¢‘-è¯­è¨€åˆ†æ”¯ï¼Ÿ</h2><ul><li>ä¸€åˆ‡çš„åŸºç¡€ï¼šImageBindçš„å¤šæ¨¡æ€å¯¹é½èƒ½åŠ›<ul><li>è¯»åˆ°æ¶æ„éƒ¨åˆ†çš„æ—¶å€™è¿˜å¥‡æ€ªä¸ºä»€ä¹ˆéŸ³é¢‘-è¯­è¨€åˆ†æ”¯è¦ç”¨ImageBindè¿™æ ·ä¸€ä¸ªåå­—é•¿å¾—åƒè§†è§‰è¯­è¨€å¤„ç†å™¨ä½œä¸ºç¼–ç å™¨ï¼Œä¸€åˆ‡éƒ½æœ‰è¿¹å¯å¾ª</li></ul></li><li>è§†é¢‘çš„ç”»é¢é€šå¸¸å’Œè¯­éŸ³åŒæ­¥å¯¹åº”ï¼Œå¯ä»¥è¿‘ä¼¼æ›¿ä»£éŸ³é¢‘æ•°æ®ï¼Œè®­ç»ƒæ•ˆæœåº”è¯¥ä¼šæ¯”è¾ƒç›¸è¿‘</li></ul><h1 id="LLM"><a href="#LLM" class="headerlink" title="LLM"></a>LLM</h1><p>æœ€åï¼Œè§†é¢‘å’ŒéŸ³é¢‘ä¿¡æ¯ä¸æ–‡æœ¬åµŒå…¥è¿æ¥åœ¨ä¸€èµ·ï¼Œä½œä¸ºè§†é¢‘è½¯æç¤ºï¼Œå¼•å¯¼LLMsç”ŸæˆåŸºäºè§†é¢‘å†…å®¹çš„æ–‡æœ¬ã€‚</p><h1 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h1><h2 id="1-è§†å¬æ•´åˆæ„ŸçŸ¥èƒ½åŠ›"><a href="#1-è§†å¬æ•´åˆæ„ŸçŸ¥èƒ½åŠ›" class="headerlink" title="1. è§†å¬æ•´åˆæ„ŸçŸ¥èƒ½åŠ›"></a>1. è§†å¬æ•´åˆæ„ŸçŸ¥èƒ½åŠ›</h2><p>åœ¨åŒ…å«ä¸€ä¸ªè§†é¢‘çš„ä¸€ä¸ªå¯¹è¯ä¸­ï¼Œå„æå‡ºä¸€ä¸ªå…³äºéŸ³é¢‘å’Œè§†é¢‘çš„æŒ‡ä»¤ï¼ŒVideo-LLaMAéƒ½å¯ä»¥ç­”ä¸Šæ¥ï¼Œè¯´æ˜å…¶å…·å¤‡è‰¯å¥½çš„è§†å¬æ•´åˆæ„ŸçŸ¥èƒ½åŠ›ã€‚</p><h2 id="2-æ•æ‰è§†é¢‘å†…æ—¶é—´åŠ¨æ€çš„èƒ½åŠ›"><a href="#2-æ•æ‰è§†é¢‘å†…æ—¶é—´åŠ¨æ€çš„èƒ½åŠ›" class="headerlink" title="2. æ•æ‰è§†é¢‘å†…æ—¶é—´åŠ¨æ€çš„èƒ½åŠ›"></a>2. æ•æ‰è§†é¢‘å†…æ—¶é—´åŠ¨æ€çš„èƒ½åŠ›</h2><p>Video-LLaMAå¯ä»¥æ•æ‰åˆ°èˆ¹å‘å³è¡Œè¿›ã€å¥³å­©å°†æ‰‹æŒ‡æ”¾åœ¨å˜´å”‡ä¸Šç­‰æ—¶é—´åŠ¨æ€ã€‚</p><h2 id="3-ç†è§£é™æ€å›¾ç‰‡çš„èƒ½åŠ›"><a href="#3-ç†è§£é™æ€å›¾ç‰‡çš„èƒ½åŠ›" class="headerlink" title="3. ç†è§£é™æ€å›¾ç‰‡çš„èƒ½åŠ›"></a>3. ç†è§£é™æ€å›¾ç‰‡çš„èƒ½åŠ›</h2><p>èƒ½ç†è§£â€œç”·äººåœ¨è½¦é¡¶æ‹¿ç€ç†¨æ–—çƒ«è¡£æœâ€çš„éå¸¸è§„å†…å®¹ï¼›ç»†è‡´æå†™å°ç‹—åŠ¨ä½œï¼ŒåŒæ—¶å°†åŠ¨ä½œå’Œâ€œä¸äººç±»å‹å¥½äº’åŠ¨â€è”ç³»èµ·æ¥ã€‚</p><h2 id="4-å¸¸è¯†æ€§å†…å®¹"><a href="#4-å¸¸è¯†æ€§å†…å®¹" class="headerlink" title="4. å¸¸è¯†æ€§å†…å®¹"></a>4. å¸¸è¯†æ€§å†…å®¹</h2><p>èƒ½å¤Ÿè®¤å‡ºåœ°æ ‡æ€§å»ºç­‘â€œç¾å›½å›½ä¼šå¤§å¦â€</p><p>ç”šè‡³è®¤å‡ºå½±è§†ã€ŠæƒåŠ›çš„æ¸¸æˆã€‹ä¸­ç”±åŸºç‰¹-å“ˆçµé¡¿æ‰®æ¼”çš„ç¼æ©-é›ªè¯ºå’Œç”±è‰¾ç±³è‰äºš-å…‹æ‹‰å…‹æ‰®æ¼”çš„ä¸¹å¦®è‰ä¸-å¦æ ¼åˆ©å®‰ï¼Œç”šè‡³æ¸…æ¥šåœ¨å‰§ä¸­ï¼Œä»–ä»¬æœ‰ç€æµªæ¼«çš„å…³ç³»ã€‚ä»–ä»¬ç¬¬ä¸€æ¬¡è§é¢æ˜¯åœ¨ç¬¬ä¸ƒå­£ï¼Œåœ¨ç¬¬å…«å­£ä¸­ï¼Œä»–ä»¬å¯¹å½¼æ­¤çš„å¸å¼•åŠ›ä¸æ—¥ä¿±å¢ã€‚</p><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>æå‡ºVideo-LLaMAï¼Œä¸€ä¸ªä½¿LLMèƒ½å¤ŸåŒæ—¶å¤„ç†ç»™å®šè§†é¢‘çš„è§†è§‰å’Œå¬è§‰å†…å®¹ï¼Œå¹¶ä¸äººç±»è¿›è¡Œå¯¹è¯çš„å¤šæ¨¡æ€æ¡†æ¶</p><h1 id="Limitations"><a href="#Limitations" class="headerlink" title="Limitations"></a>Limitations</h1><ol><li>æ„ŸçŸ¥èƒ½åŠ›æœ‰é™ï¼šå½“å‰è®­ç»ƒæ•°æ®é›†çš„è´¨é‡å’Œè§„æ¨¡é™åˆ¶äº†Videoâ€‘LLaMAçš„è¡¨ç°ã€‚æˆ‘ä»¬æ­£åœ¨ç§¯ææ„å»ºé«˜è´¨é‡çš„éŸ³è§†é¢‘æ–‡æœ¬å¯¹é½æ•°æ®é›†ä»¥æå‡æ¨¡å‹çš„æ„ŸçŸ¥èƒ½åŠ›ã€‚</li><li>å¤„ç†é•¿è§†é¢‘èƒ½åŠ›æœ‰é™ã€‚é•¿è§†é¢‘ï¼ˆå¦‚ç”µå½±ã€ç”µè§†å‰§ï¼‰åŒ…å«å¤§é‡ä¿¡æ¯ï¼Œå¯¹è®¡ç®—èµ„æºè¦æ±‚æ›´é«˜ã€‚è¿™ä¸€æŒ‘æˆ˜ä»æ˜¯ç ”ç©¶ç•Œç§¯ææ”»å…‹çš„å…³é”®é—®é¢˜ã€‚</li><li>å¹»è§‰é—®é¢˜ã€‚Videoâ€‘LLaMAç»§æ‰¿äº†å†»ç»“çš„å¤§è¯­è¨€æ¨¡å‹çš„å¹»è§‰é—®é¢˜ã€‚</li><li>æ•´ä¸ªworkå†…å®¹ç®€å•ï¼Œç¼ºä¹ç§‘å­¦çš„è¯„ä¼°å’Œä¸SOTA/baselineçš„å¯¹æ¯”</li><li>Webvid-2Mç´ ææ¥è‡ªç½‘ç»œã€çŸ­è§†é¢‘æ–‡æœ¬æè¿°æŠ½è±¡ä¸åˆ‡é¢˜ï¼Œæ•°æ®è´¨é‡ä½ï¼Œä¸”å¯èƒ½å«æœ‰æœ‰å®³å†…å®¹ã€‚<ul><li>å°½ç®¡æŒ‡ä»¤å¾®è°ƒä½¿ç”¨äº†â€œæ›´é«˜è´¨é‡â€çš„æ•°æ® ï¼Œä½†åˆå§‹é¢„è®­ç»ƒåœ¨ WebVid-2Mï¼ˆ200 ä¸‡è§†é¢‘ ï¼‰ä¸Šåºå¤§</li></ul></li><li>ä½¿ç”¨è§†è§‰-è¯­è¨€æ•°æ®è®­ç»ƒImageBindçš„éŸ³é¢‘-è¯­è¨€åˆ†æ”¯è¿™ç§åšæ³•è™½ç„¶åœ¨ç»“æœä¸Šçœ‹åˆ°æˆæ•ˆï¼Œä½†ä»ç„¶ç¼ºä¹å……åˆ†çš„ç†è®ºæ”¯æŒå’Œå®éªŒéªŒè¯ã€‚</li></ol>]]></content>
    
    
    <summary type="html">é˜…è¯»è®ºæ–‡ã€ŠVideo-LLaMAï¼šAn Instruction-tuned Audio-Visual Language Model for Video Understandingã€‹</summary>
    
    
    
    <category term="è®ºæ–‡ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="è®ºæ–‡ç¬”è®°" scheme="https://www.cclmsy.cc/tags/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/"/>
    
    <category term="å¤šæ¨¡æ€è§†é¢‘ç†è§£" scheme="https://www.cclmsy.cc/tags/%E5%A4%9A%E6%A8%A1%E6%80%81%E8%A7%86%E9%A2%91%E7%90%86%E8%A7%A3/"/>
    
  </entry>
  
  <entry>
    <title>è®ºæ–‡ç¬”è®°|è§†å¹»è§‰è¯„ä¼°æ•°æ®é›†PhDï¼šA ChatGPT-Prompted Visual hallucination Evaluation Dataset</title>
    <link href="https://www.cclmsy.cc/posts/2403.11116.html"/>
    <id>https://www.cclmsy.cc/posts/2403.11116.html</id>
    <published>2025-06-24T16:00:00.000Z</published>
    <updated>2025-10-15T08:41:29.616Z</updated>
    
    <content type="html"><![CDATA[<p>è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/2403.11116">PhD: A ChatGPT-Prompted Visual hallucination Evaluation Dataset</a></p><div class="table-container"><table><thead><tr><th style="text-align:center">ç¼©å†™</th><th style="text-align:center">å…¨ç§°</th><th style="text-align:center">ç›´è¯‘</th></tr></thead><tbody><tr><td style="text-align:center">VHE</td><td style="text-align:center">Visual Hallucination Evaluation</td><td style="text-align:center">è§†è§‰å¹»è§‰è¯„ä¼°</td></tr><tr><td style="text-align:center">hitem</td><td style="text-align:center">Hallucination item</td><td style="text-align:center">å¹»è§‰é¡¹</td></tr><tr><td style="text-align:center">CS</td><td style="text-align:center">Commen-sense</td><td style="text-align:center">åå¸¸è¯†</td></tr><tr><td style="text-align:center">CCS</td><td style="text-align:center">Counter-commen-sense</td><td style="text-align:center">åå¸¸è¯†</td></tr><tr><td style="text-align:center">VQA</td><td style="text-align:center">Visual Question Answering</td><td style="text-align:center">è§†è§‰é—®ç­”</td></tr><tr><td style="text-align:center">GT</td><td style="text-align:center">ground-truth</td><td style="text-align:center">æ­£ç¡®ç­”æ¡ˆ/çœŸå®ä¿¡æ¯</td></tr></tbody></table></div><h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h2><p>MLLMä»¥LLMä¸ºå†…æ ¸ï¼Œç”±äºLLMå…·æœ‰å¹»è§‰é—®é¢˜ï¼ŒMLLMä¹Ÿä¼šå‡ºç°å¹»è§‰é—®é¢˜ã€‚</p><p>VHEä¸»è¦å‘MLLMæå‡ºè§†è§‰é—®é¢˜ï¼Œä»¥ç‰¹å®šå•è¯æˆ–çŸ­è¯­è¯±å¯¼MLLMäº§ç”Ÿå’Œè§†è§‰å†…å®¹ä¸ä¸€è‡´çš„ååº”ã€‚</p><p>æœ¬æ–‡ä¸ºVHEå¼€å‘äº†ä¸€ä¸ªæ–°çš„æ•°æ®é›†ï¼Œç›®æ ‡ä¸ºä½çº§ï¼ˆå¯¹è±¡ã€å±æ€§ï¼‰åˆ°ä¸­çº§ï¼ˆæƒ…æ„Ÿã€ä½ç½®ã€è®¡æ•°ï¼‰çš„å®¢è§‚VHEè¯„ä¼°ã€‚</p><p>MLLMè§†è§‰å¹»è§‰ä¸»è¦åŸå› ï¼š</p><ol><li>Visual Ambiguity(è§†è§‰æ¨¡ç³Šæ€§)ï¼šMLLMä½¿ç”¨åŸºäºViTçš„ç¼–ç å™¨ï¼Œä»ç»™å®šå›¾åƒä¸­æå–<strong>é«˜å±‚æ¬¡ç‰¹å¾</strong>ï¼Œç¼ºä¹è¶³å¤Ÿçš„ç»†èŠ‚æ¥æ‰§è¡Œç²¾ç»†ä»»åŠ¡ï¼ˆç²¾ç¡®è®¡æ•°ï¼‰</li><li>Inconsistency in muti-modal input(å¤šæ¨¡æ€è¾“å…¥ä¸ä¸€è‡´)ï¼šLLMå†…æ ¸<strong>åå‘</strong>å¤šæ¨¡æ€è¾“å…¥ä¸­çš„<strong>æ–‡æœ¬éƒ¨åˆ†</strong>ï¼Œè§†è§‰ä¿¡æ¯æ›´å¯èƒ½è¢«å¿½ç•¥ã€‚</li><li>Counter-commen-sense(åå¸¸è¯†å†…å®¹)ï¼šLLMå†…æ ¸ä¸¥é‡ä¾èµ–å…¶å†…éƒ¨çš„â€œå¸¸è¯†â€</li></ol><p>æ–°æ•°æ®é›†PhDé€šè¿‡æ”¹ç¼–æ•°æ®é›†<a href="https://arxiv.org/abs/1703.09684">TDIUC</a>å’Œåˆ©ç”¨ChatGPTè¾…åŠ©åŠè‡ªåŠ¨åŒ–ç®¡é“æ„å»º</p><p>è´¡çŒ®ï¼š</p><ol><li>PhDæ•°æ®é›†ï¼šæ ¹æ®äº§ç”Ÿå¹»è§‰çš„3ä¸ªåŸå› ï¼Œåˆ›å»ºçš„åŒ…å«5ç§ä»»åŠ¡ã€4ç§è¯„ä¼°æ¨¡å¼çš„æ•°æ®é›†<ul><li>åŒ…å«14648æ—¥å¸¸å›¾åƒã€750CCSå›¾åƒå’Œ102564ä¸ªVQAä¸‰å…ƒç»„ï¼ŒåŒç±»æ•°æ®é›†è§„æ¨¡æœ€å¤§</li><li>æ¯ä¸ªæ ·æœ¬æä¾›äº†hitemçš„ä¿¡æ¯</li></ul></li><li>æä¾›äº†ç”±ChatGPTè¾…åŠ©ï¼Œæå°‘äººå·¥å¹²é¢„çš„åŠè‡ªåŠ¨åŒ–æ•°æ®é›†æ„å»ºç®¡é“</li><li>åœ¨15ç§å¼€æºMLLMã€3ç§ç§æœ‰MLLMã€2ç§å¹»è§‰ç¼“è§£æ–¹æ³•ä¸Šè¿›è¡Œè¯„ä¼°ï¼Œæ•´ä½“å±•ç¤ºPhDæ•°æ®é›†åœ¨VHEä¸Šçš„æœ‰æ•ˆæ€§</li></ol><h2 id="2-Related-work"><a href="#2-Related-work" class="headerlink" title="2. Related work"></a>2. Related work</h2><p>ç°æœ‰æ•°æ®é›†åˆ†ç±»ï¼š</p><ol><li>çº§åˆ«<ul><li>ä½çº§ï¼ˆå¯¹è±¡ã€å±æ€§ï¼‰~ä¸­çº§ï¼ˆæƒ…æ„Ÿã€ä½ç½®ã€è®¡æ•°ï¼‰ï¼šè¯„ä»·MLLMçš„åŸºæœ¬è§†è§‰åŠŸèƒ½</li><li>é«˜çº§ï¼šçŸ¥è¯†å¯†é›†åº¦é«˜ï¼ŒåŒ…æ‹¬æ•°å­¦è§£é¢˜ã€åœ°ç†ä¿¡æ¯ç†è§£ã€å¤‡å¿˜å½•è§£è¯»ã€å†å²æ°‘ä¿—ç­‰</li></ul></li><li>è¯„ä»·æ–¹å¼<ul><li>å®¢è§‚è¯„ä»·ï¼šå°†æ¨¡å‹è¾“å‡ºå’ŒåŸºæœ¬äº‹å®å¯¹æ¯”ï¼Œä»¥YES/NOå½¢å¼è¿›è¡Œ</li><li>ä¸»è§‚è¯„ä»·ï¼šéœ€è¦äººæˆ–LLMæ¥è¯„ä¼°æ¨¡å‹è¾“å‡º </li></ul></li></ol><p>PhDå±äºä½çº§åˆ°ä¸­çº§çš„å®¢è§‚è¯„ä»·æ•°æ®é›†ã€‚</p><p>è¯¥éƒ¨åˆ†ç°æœ‰æ•°æ®é›†çš„ä¸è¶³ï¼š</p><ol><li>POPEã€ROMEï¼šhitemé€‰æ‹©åŸºäºè®­ç»ƒæ•°æ®ä¸­çš„æ ‡ç­¾å…±ç°ç‡ï¼ˆè„±ç¦»å›¾åƒï¼‰</li><li>NOPEã€CIEMï¼šç¼ºä¹hitemé€‰æ‹©</li><li>AMBERï¼šäººå·¥æ ‡æ³¨</li></ol><h2 id="3-Method"><a href="#3-Method" class="headerlink" title="3. Method"></a>3. Method</h2><p><img src="https://source.cclmsy.cc/posts/papers/2403.11116/image-1.png" alt="alt text"></p><h3 id="3-1-Task-specific-Hitem-Selection-é’ˆå¯¹å…·ä½“ä»»åŠ¡çš„Hitemé€‰æ‹©"><a href="#3-1-Task-specific-Hitem-Selection-é’ˆå¯¹å…·ä½“ä»»åŠ¡çš„Hitemé€‰æ‹©" class="headerlink" title="3.1 Task-specific Hitem Selection é’ˆå¯¹å…·ä½“ä»»åŠ¡çš„Hitemé€‰æ‹©"></a>3.1 Task-specific Hitem Selection é’ˆå¯¹å…·ä½“ä»»åŠ¡çš„Hitemé€‰æ‹©</h3><p><img src="https://source.cclmsy.cc/posts/papers/2403.11116/image.png" alt="alt text"></p><ol><li>Subject-Attribute Extractionï¼šä½¿ç”¨ChatGPTä»TDIUCé—®ç­”å¯¹ä¸­æå–ä¸»ä½“å’Œå±æ€§</li><li>Candidate Hitem Generationï¼šæ ¹æ®å±æ€§ç”Ÿæˆè¯æ±‡è¡¨ï¼Œæ’é™¤GT</li><li>Visual-based Hitem Rankingï¼šä½¿ç”¨CLIPæ¨¡å‹å¯¹å€™é€‰hitemè¿›è¡Œæ’åºï¼Œé€‰æ‹©ä¸å›¾åƒç›¸å…³æ€§æœ€é«˜çš„hitem<ul><li>æ–‡æœ¬è¾“å…¥ï¼šhitem+ä¸»ä½“</li><li>æœªæ¥å¯ä½¿ç”¨æ€§èƒ½æ›´å¥½çš„æ¨¡å‹</li></ul></li><li>Manual Inspectionï¼šåŸå§‹TDIUCé—®ç­”å¯¹å¯èƒ½æœ‰è¯¯ï¼Œæ­¤æ—¶ä¸¢å¼ƒVQA</li></ol><p>æˆæœï¼šå–å¾—1452ä¸ªæ›´å…·å¤šæ ·åŒ–å’ŒæŒ‘æˆ˜æ€§çš„hitems</p><h3 id="3-2-Hitem-embedded-Qestion-Generation-åµŒå…¥Hitemçš„é—®ç­”ç”Ÿæˆ"><a href="#3-2-Hitem-embedded-Qestion-Generation-åµŒå…¥Hitemçš„é—®ç­”ç”Ÿæˆ" class="headerlink" title="3.2 Hitem-embedded Qestion Generation åµŒå…¥Hitemçš„é—®ç­”ç”Ÿæˆ"></a>3.2 Hitem-embedded Qestion Generation åµŒå…¥Hitemçš„é—®ç­”ç”Ÿæˆ</h3><p>ç»™å®šä¸»ä½“å’Œä¸€ä¸ªé€‰å®šçš„hitemï¼ŒChatGPTç”Ÿæˆä¸€ä¸ªé—®é¢˜ï¼Œç­”æ¡ˆä¸ºâ€œNoâ€</p><p>ä½¿ç”¨GTç”Ÿæˆçš„é—®é¢˜ï¼Œç­”æ¡ˆåˆ™ä¸ºâ€œYesâ€</p><h3 id="3-3-Specious-Incorrect-Context-Generation-ä¼¼æ˜¯è€Œéï¼ˆæˆ–é”™è¯¯ï¼‰çš„å†…å®¹ç”Ÿæˆ"><a href="#3-3-Specious-Incorrect-Context-Generation-ä¼¼æ˜¯è€Œéï¼ˆæˆ–é”™è¯¯ï¼‰çš„å†…å®¹ç”Ÿæˆ" class="headerlink" title="3.3 Specious(Incorrect) Context Generation ä¼¼æ˜¯è€Œéï¼ˆæˆ–é”™è¯¯ï¼‰çš„å†…å®¹ç”Ÿæˆ"></a>3.3 Specious(Incorrect) Context Generation ä¼¼æ˜¯è€Œéï¼ˆæˆ–é”™è¯¯ï¼‰çš„å†…å®¹ç”Ÿæˆ</h3><p>æè¿°å’Œå›¾ç‰‡ä¸çŸ›ç›¾æ—¶ï¼Œä¹Ÿå¯èƒ½ä¸å®Œå…¨ä¸€è‡´ï¼Œå¦‚æ‘©æ‰˜é™æ­¢ï¼ˆå›¾ä¸­ï¼‰å’Œç–¾é©°ï¼ˆæè¿°ï¼‰</p><p><img src="https://source.cclmsy.cc/posts/papers/2403.11116/image-2.png" alt="alt text"></p><ol><li>Specious Cont Generationï¼šä½¿ç”¨ChatGPTç”Ÿæˆä¸å›¾åƒå†…å®¹ä¸ä¸€è‡´çš„ä¸Šä¸‹æ–‡<ul><li>specious textï¼šä¼¼æ˜¯è€Œéï¼Œè½»å¾®ä¸ä¸€è‡´ï¼Œä½†ä¸ç›´æ¥çŸ›ç›¾ </li><li>Promptï¼šâ€œè¯·ä¸ºç»™å®šé—®é¢˜ç”Ÿæˆ[specious text]ï¼Œä½¿å…¶èƒ½å›ç­”é—®é¢˜ï¼Œä½†å¯èƒ½æ— æ³•åæ˜ å½“å‰çš„å®é™…æƒ…å†µï¼Œä»è€Œspeciousâ€</li></ul></li><li>Text Compositionï¼šå°†ç”Ÿæˆçš„specious textä¸åŸå§‹captionè¡”æ¥ï¼Œæ–°çš„ä¸Šä¸‹æ–‡åªæœ‰å°éƒ¨åˆ†ä¸å›¾åƒè½»å¾®ä¸ä¸€è‡´</li><li>Manual Inspectionï¼šäººå·¥æŠ½æŸ¥ï¼Œå¦‚æœè´¨é‡ä¸é«˜åˆ™ä¸¢å¼ƒæ ·æœ¬</li></ol><h3 id="3-4-CCS-Image-Generation-åå¸¸è¯†å›¾åƒç”Ÿæˆ"><a href="#3-4-CCS-Image-Generation-åå¸¸è¯†å›¾åƒç”Ÿæˆ" class="headerlink" title="3.4 CCS Image Generation åå¸¸è¯†å›¾åƒç”Ÿæˆ"></a>3.4 CCS Image Generation åå¸¸è¯†å›¾åƒç”Ÿæˆ</h3><p><img src="https://source.cclmsy.cc/posts/papers/2403.11116/image-3.png" alt="alt text"></p><ol><li>CCS Description Generationï¼šä½¿ç”¨ChatGPTç”ŸæˆCCSæè¿°ï¼ŒåŒæ—¶ç”ŸæˆCSæè¿°<ul><li>æ‰‹å†™ç‰¹å®šä»»åŠ¡æ ·ä¾‹ï¼Œä¸ºChatGPTç”Ÿæˆæä¾›å‚è€ƒ</li></ul></li><li>Text2Imageï¼šCCSæè¿°ç”Ÿæˆç›¸åº”å›¾åƒï¼Œäººå·¥è§£å†³æ•…éšœ</li><li>Question Generationï¼šä½¿ç”¨ChatGPTç”Ÿæˆï¼ŒCCSé—®é¢˜ç­”æ¡ˆä¸ºâ€œYesâ€ï¼ŒCSé—®é¢˜ç­”æ¡ˆä¸ºâ€œNoâ€</li></ol><h3 id="3-5-Dataset-Overview-amp-PhD-Index-æ•°æ®é›†æ¦‚è§ˆä¸ç´¢å¼•"><a href="#3-5-Dataset-Overview-amp-PhD-Index-æ•°æ®é›†æ¦‚è§ˆä¸ç´¢å¼•" class="headerlink" title="3.5 Dataset Overview &amp; PhD Index æ•°æ®é›†æ¦‚è§ˆä¸ç´¢å¼•"></a>3.5 Dataset Overview &amp; PhD Index æ•°æ®é›†æ¦‚è§ˆä¸ç´¢å¼•</h3><p><img src="https://source.cclmsy.cc/posts/papers/2403.11116/image-4.png" alt="alt text"></p><p>å››ç§è¯„ä¼°æ¨¡å¼ï¼š</p><ol><li>PhD-base: ä¸å«ä¸Šä¸‹æ–‡çš„æ—¥å¸¸å›¾åƒ</li><li>PhD-sec(specious): å«ä¼¼æ˜¯è€Œéä¸Šä¸‹æ–‡çš„æ—¥å¸¸å›¾åƒ</li><li>PhD-icc(incorrect): å«é”™è¯¯ä¸Šä¸‹æ–‡çš„æ—¥å¸¸å›¾åƒ</li><li>PhD-ccs: åå¸¸è¯†å›¾åƒé—®é¢˜</li></ol><p>4ç§è¯„ä¼°æ¨¡å¼Ã—5ç§ä»»åŠ¡=20ç§æ¨¡å¼-ä»»åŠ¡ç»„åˆ</p><p>PhDæŒ‡æ ‡ï¼šè°ƒå’Œå¹³å‡æ•°$\dfrac{2Recall<em>{yes}Recall</em>{no}}{Recall<em>{yes}+Recall</em>{no}}$</p><h2 id="4-Evaluating-MLLMs-on-PhD"><a href="#4-Evaluating-MLLMs-on-PhD" class="headerlink" title="4. Evaluating MLLMs on PhD"></a>4. Evaluating MLLMs on PhD</h2><h3 id="4-1-Setup"><a href="#4-1-Setup" class="headerlink" title="4.1 Setup"></a>4.1 Setup</h3><p>æµ‹è¯•æ¨¡å‹ï¼š</p><ul><li>15ç§å¼€æºMLLMï¼ˆå…¨é‡ï¼‰</li><li>3ç§ç§æœ‰MLLMï¼ˆ2kéšæœºé‡‡æ ·ï¼‰</li><li>æ”¯æŒLLaVa-1.6-Lã€Qwen-VLçš„2ç§å¹»è§‰ç¼“è§£æ–¹æ³•VCDã€Woodpeckerï¼ˆ2kéšæœºé‡‡æ ·ï¼‰</li></ul><p>ä½¿ç”¨MLLMæŒ‡å®šæç¤ºè¯å½¢å¼ï¼›å¯¹äºsecã€iccï¼Œé™„åŠ æŒ‡ä»¤â€œå›¾æ–‡ä¸ä¸€è‡´ï¼Œä»¥å›¾ç‰‡ä¸ºå‡†â€</p><h3 id="4-2-æ€»ä½“PhDè¯„ä¼°"><a href="#4-2-æ€»ä½“PhDè¯„ä¼°" class="headerlink" title="4.2 æ€»ä½“PhDè¯„ä¼°"></a>4.2 æ€»ä½“PhDè¯„ä¼°</h3><p>å…¨é¢äº†è§£å“ªç§MLLMäº§ç”Ÿçš„å¹»è§‰æœ€å°‘ã€‚</p><p><img src="https://source.cclmsy.cc/posts/papers/2403.11116/image-5.png" alt="alt text"></p><p>PhDè¾¨åˆ«èƒ½åŠ›å¼ºï¼Œä¾‹å¦‚å¯¹GPT-4oå’Œé¡¶çº§å¼€æºMLLMçš„æŒ‡æ ‡å·®è·æ¯”POPEå’ŒAMBERçš„è¯„ä¼°æ›´æ˜æ˜¾</p><p>PhDæ•°æ®é›†åœ¨ä»»åŠ¡å’Œè¯„ä¼°æ¨¡å¼æœ‰ç»†åˆ†ï¼Œæ”¯æŒé’ˆå¯¹æ€§åˆ†æ</p><h3 id="4-3-PhDé¢å‘æ¨¡å¼è¯„ä¼°"><a href="#4-3-PhDé¢å‘æ¨¡å¼è¯„ä¼°" class="headerlink" title="4.3 PhDé¢å‘æ¨¡å¼è¯„ä¼°"></a>4.3 PhDé¢å‘æ¨¡å¼è¯„ä¼°</h3><p><img src="https://source.cclmsy.cc/posts/papers/2403.11116/image-6.png" alt="alt text"></p><p>baseæ¨¡å¼ä¸‹ï¼Œå…·æœ‰æ›´å¼ºè§†è§‰è¾“å…¥çš„æ¨¡å‹è¡¨ç°æ›´å¥½ï¼Œå¯ä»¥é€šè¿‡2ç§æ–¹å¼å®ç°ï¼š</p><ol><li>æ›´å¼ºçš„è§†è§‰ç¼–ç å™¨</li><li>æ”¯æŒæ›´é«˜åˆ†è¾¨ç‡çš„è§†è§‰è¾“å…¥</li></ol><p>ä»…ä½¿ç”¨è¾ƒå¤§çš„LLMä¸ä¸€å®šèƒ½è·å¾—æ›´å¥½çš„MLLMï¼šè™½ç„¶å¤§å‹çš„LLMèƒ½æ›´å¥½åœ°ç†è§£ç”¨æˆ·æŒ‡ä»¤ï¼Œä½†åœ¨MLLMä¸­åº”ç”¨è¿˜éœ€è¦é’ˆå¯¹æ€§çš„VLå¯¹é½è®­ç»ƒã€‚</p><p>å¼€æºMLLMåœ¨PhD-iccå’ŒPhD-secä¸Šæ€§èƒ½æ™®éè¾ƒä½ï¼Œå› ä¸ºå¤šæ¨¡å¼è¾“å…¥ä¸‹ï¼ŒMLLMå†…æ ¸åå‘æ–‡æœ¬éƒ¨åˆ†ã€‚</p><p><img src="https://source.cclmsy.cc/posts/papers/2403.11116/image-7.png" alt="alt text"></p><p>ä½¿ç”¨æ›´å¤§çš„LLMå¯åœ¨PhD-iccå’ŒPhD-secä¸Šè·å¾—æ›´å¥½çš„ç»“æœï¼Œä½†æ›´ä¾èµ–å†…éƒ¨çŸ¥è¯†ï¼Œå¯¼è‡´åœ¨æ— ä¸Šä¸‹æ–‡çš„PhD-baseå’ŒPhD-ccsä¸Šæ€§èƒ½ä¸‹é™ã€‚</p><p>ï¼ˆWoodpeckerä½¿æ¨¡å‹è¡¨ç°æ›´å‡è¡¡ï¼‰</p><h3 id="4-4-PhDé¢å‘ä»»åŠ¡è¯„ä¼°"><a href="#4-4-PhDé¢å‘ä»»åŠ¡è¯„ä¼°" class="headerlink" title="4.4 PhDé¢å‘ä»»åŠ¡è¯„ä¼°"></a>4.4 PhDé¢å‘ä»»åŠ¡è¯„ä¼°</h3><p><img src="https://source.cclmsy.cc/posts/papers/2403.11116/image-8.png" alt="alt text"></p><p>MLLMå¹»è§‰ç¨‹åº¦å’Œä»»åŠ¡æ°´å¹³ç›¸å…³ï¼Œæ€»ä½“æŒ‡æ ‡ä»é«˜åˆ°ä½ï¼šæƒ…æ„Ÿ &gt; è®¡æ•° &gt; ä½ç½® &gt; å±æ€§ &gt; å¯¹è±¡</p><p>æƒ…æ„Ÿä»»åŠ¡å¤æ‚å¾®å¦™ã€è®¡æ•°ä»»åŠ¡è¦æ±‚ç²¾ç¡®ï¼Œéš¾åº¦è¾ƒé«˜ï¼›åœ¨æœ‰æ–‡æœ¬æˆ–CCSå¹²æ‰°æ—¶å°¤å…¶åƒåŠ›ã€‚</p><p>æ¨¡å‹åœ¨æ¯ç§æ¨¡å¼-ä»»åŠ¡ç»„åˆéƒ½æœ‰ä¸€ä¸ªå¾—åˆ†ï¼Œæœ‰åŠ©äºé’ˆå¯¹æ€§åˆ†æå®Œå–„ã€‚çƒ­åŠ›å›¾ï¼š</p><p><img src="https://source.cclmsy.cc/posts/papers/2403.11116/image-9.png" alt="alt text"></p><h3 id="4-5-MLLMç­”æ¡ˆå€¾å‘æ€§"><a href="#4-5-MLLMç­”æ¡ˆå€¾å‘æ€§" class="headerlink" title="4.5 MLLMç­”æ¡ˆå€¾å‘æ€§"></a>4.5 MLLMç­”æ¡ˆå€¾å‘æ€§</h3><p>MLLMçš„PhDåˆ†æ•°å’ŒYESç‡çš„æ–¯çš®å°”æ›¼ç›¸å…³æ€§ï¼š</p><p><img src="https://source.cclmsy.cc/posts/papers/2403.11116/image-10.png" alt="alt text"></p><p>ç»“æœè¡¨ç¤ºï¼ŒMLLMè¡¨ç°å’ŒYESç‡å­˜åœ¨è¾ƒå¼ºè´Ÿç›¸å…³ï¼ŒYESç‡è¶Šé«˜ï¼ŒPhDåˆ†æ•°è¶Šä½ã€‚</p><p>è§£å†³VHé—®é¢˜éœ€è¦æ³¨é‡å¹³è¡¡è¾“å‡ºå€¾å‘ï¼Œå¢å¼ºæ¨¡å‹è¾“å‡ºNOçš„èƒ½åŠ›ã€‚</p><h2 id="5-ç¬”è®°"><a href="#5-ç¬”è®°" class="headerlink" title="5. ç¬”è®°"></a>5. ç¬”è®°</h2><h3 id="5-1-PhDæ•°æ®é›†çš„ä¼˜ç‚¹"><a href="#5-1-PhDæ•°æ®é›†çš„ä¼˜ç‚¹" class="headerlink" title="5.1 PhDæ•°æ®é›†çš„ä¼˜ç‚¹"></a>5.1 PhDæ•°æ®é›†çš„ä¼˜ç‚¹</h3><ol><li>åŒç±»æ•°æ®é›†è§„æ¨¡æœ€å¤§</li><li>æ¶µç›–5ç§ä»»åŠ¡ã€4ç§è¯„ä¼°æ¨¡å¼ï¼Œæ”¯æŒé’ˆå¯¹æ€§åˆ†æ</li><li>AIè¾…åŠ©åŠè‡ªåŠ¨åŒ–æ•°æ®é›†æ„å»ºç®¡é“ï¼Œæå¤§åœ°å‡å°‘äººå·¥å¹²é¢„<ul><li>äººå·¥å¹²é¢„ç¯èŠ‚ä¸»è¦é›†ä¸­åœ¨è´¨é‡å®¡æŸ¥</li></ul></li><li>é’ˆå¯¹ç—›ç‚¹ï¼Œç›´é¢MLLMçš„å¹»è§‰æˆå› ï¼Œè¯„ä¼°æœ‰æ•ˆæ€§é«˜<ul><li>è”ç³»åˆ°CLUEä¸­æåˆ°çš„MLLMå…·æœ‰æ¥è‡ªè¯­è¨€å…ˆéªŒå’Œéå›¾åƒä¸­å¿ƒåŒºåŸŸçš„åå·®é—®é¢˜ï¼›æ­¤å¤–ï¼Œè€ƒè™‘åˆ°äº†å›¾ç‰‡å¯èƒ½åŒ…å«CCSå†…å®¹</li></ul></li></ol><h3 id="5-2-ç–‘é—®"><a href="#5-2-ç–‘é—®" class="headerlink" title="5.2 ç–‘é—®"></a>5.2 ç–‘é—®</h3><h4 id="åŸæ–‡-3-1"><a href="#åŸæ–‡-3-1" class="headerlink" title="åŸæ–‡ 3.1"></a>åŸæ–‡ 3.1</h4><p>Vocabulary Construction per taskï¼Œé¢œè‰²å±æ€§éœ€è¦äººå·¥æŒ‡å®šï¼ˆmanually specifyï¼‰ä¸€äº›ï¼Œç„¶åChatGPTè‡ªåŠ¨ç”Ÿæˆä¸€äº›æ—¥å¸¸è¯æ±‡ã€‚</p><p>ä¸åŒå¯¹è±¡ï¼ˆå®¶å…·ã€è½½å…·ï¼‰ã€å±æ€§ï¼ˆå¤§å°ã€é¢œè‰²ï¼‰ï¼Œæ¯ä¸€ä¸ªä»»åŠ¡çš„è¯æ±‡è¡¨ç”Ÿæˆéƒ½éœ€è¦äººå·¥æŒ‡å®šä¸€äº›å—ï¼Ÿ</p><p>å…³äºç¯èŠ‚é¡ºåºï¼Œä¸ªäººè®¤ä¸ºåº”è¯¥æ˜¯å…ˆè¿›è¡ŒSubject-Attribute Extractionï¼Œå†æ ¹æ®Subject/Attributeæ„å»ºè¯æ±‡è¡¨ï¼Ÿ</p>]]></content>
    
    
    <summary type="html">é˜…è¯»è®ºæ–‡ã€ŠPhDï¼šA ChatGPT-Prompted Visual hallucination Evaluation Datasetã€‹</summary>
    
    
    
    <category term="è®ºæ–‡ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="è®ºæ–‡ç¬”è®°" scheme="https://www.cclmsy.cc/tags/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/"/>
    
    <category term="VHEæ•°æ®é›†" scheme="https://www.cclmsy.cc/tags/VHE%E6%95%B0%E6%8D%AE%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šæ“ä½œç³»ç»Ÿã€‹è¯¾ç¨‹ç¬”è®°</title>
    <link href="https://www.cclmsy.cc/posts/operating_system.html"/>
    <id>https://www.cclmsy.cc/posts/operating_system.html</id>
    <published>2025-06-16T16:00:00.000Z</published>
    <updated>2025-07-20T12:46:18.896Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€å¯¼è®º"><a href="#ä¸€ã€å¯¼è®º" class="headerlink" title="ä¸€ã€å¯¼è®º"></a>ä¸€ã€å¯¼è®º</h2><h3 id="1-è®¡ç®—æœºç³»ç»Ÿçš„ç»„æˆéƒ¨åˆ†"><a href="#1-è®¡ç®—æœºç³»ç»Ÿçš„ç»„æˆéƒ¨åˆ†" class="headerlink" title="1. è®¡ç®—æœºç³»ç»Ÿçš„ç»„æˆéƒ¨åˆ†"></a>1. è®¡ç®—æœºç³»ç»Ÿçš„ç»„æˆéƒ¨åˆ†</h3><p><img src="https://source.cclmsy.cc/posts/notes/course/operating_system/image.png" alt="alt text"></p><h3 id="2-æ“ä½œç³»ç»Ÿçš„æ¦‚å¿µ"><a href="#2-æ“ä½œç³»ç»Ÿçš„æ¦‚å¿µ" class="headerlink" title="2. æ“ä½œç³»ç»Ÿçš„æ¦‚å¿µ"></a>2. æ“ä½œç³»ç»Ÿçš„æ¦‚å¿µ</h3><p>æ“ä½œç³»ç»Ÿ(OS)ä¹Ÿç§°å†…æ ¸(Kernel)ï¼Œæ˜¯ä¸€ç›´è¿è¡Œåœ¨è®¡ç®—æœºä¸Šçš„ç¨‹åºã€‚</p><p>å››å¤§ç‰¹å¾ï¼šå¹¶å‘ã€å…±äº«ã€è™šæ‹Ÿã€å¼‚æ­¥</p><p>ä½œç”¨(ç³»ç»Ÿè§†è§’)ï¼š</p><ul><li>èµ„æºåˆ†é…å™¨ï¼šä¸ºå„ç”¨æˆ·å’Œè¿›ç¨‹åˆ†é…èµ„æºï¼Œæé«˜èµ„æºåˆ©ç”¨ç‡</li><li>æ§åˆ¶ç¨‹åºï¼šæ§åˆ¶å„ä¸ªè¿›ç¨‹çš„æ‰§è¡Œï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œ</li></ul><p>åŠŸèƒ½ï¼š</p><ol><li>è¿›ç¨‹ç®¡ç†ï¼šåˆ›å»ºã€åˆ é™¤ã€æŒ‚èµ·ã€é‡å¯è¿›ç¨‹ï¼›æä¾›è¿›ç¨‹åŒæ­¥æœºåˆ¶ã€è¿›ç¨‹é€šä¿¡æœºåˆ¶ã€æ­»é”å¤„ç†æœºåˆ¶</li><li>å†…å­˜ç®¡ç†ï¼šè®°å½•å†…å­˜åˆ†é…æƒ…å†µï¼›å†³å®šå“ªäº›è¿›ç¨‹å¯ä»¥è¿›å…¥å†…å­˜ï¼›æä¾›å†…å­˜åˆ†é…å’Œå›æ”¶æœºåˆ¶</li><li>å­˜å‚¨ç®¡ç†</li></ol><h3 id="3-å­˜å‚¨å±‚æ¬¡"><a href="#3-å­˜å‚¨å±‚æ¬¡" class="headerlink" title="3. å­˜å‚¨å±‚æ¬¡"></a>3. å­˜å‚¨å±‚æ¬¡</h3><p>å¯„å­˜å™¨(Register)ã€<strong>é«˜é€Ÿç¼“å­˜(Cache)ã€å†…å­˜(Memory)</strong>ã€ç£ç›˜(Disk)ã€ç¡¬ç›˜ã€å…‰ç›˜ã€ç£å¸¦</p><ul><li>å†…å­˜ï¼šCPUå¯ç›´æ¥è®¿é—®çš„å”¯ä¸€å¤§å®¹é‡å­˜å‚¨åŒºåŸŸ</li><li>Cacheï¼šCPU-å†…å­˜å­˜å‚¨å±‚æ¬¡</li></ul><p>å±æ€§ï¼šå®¹é‡ã€é€Ÿåº¦ã€ä»·æ ¼ã€æ˜“å¤±æ€§</p><h3 id="4-å¤šé“ç¨‹åºè®¾è®¡"><a href="#4-å¤šé“ç¨‹åºè®¾è®¡" class="headerlink" title="4. å¤šé“ç¨‹åºè®¾è®¡"></a>4. å¤šé“ç¨‹åºè®¾è®¡</h3><p>å¤šé“ç¨‹åºè®¾è®¡(Multiprogramming)æ˜¯æ“ä½œç³»ç»Ÿ<strong>æœ€é‡è¦çš„ç‰¹ç‚¹</strong>ï¼Œé€šè¿‡ç»„ç»‡ä½œä¸šä½¿CPUæ€»æœ‰ä¸€ä¸ªä½œä¸šå¯ä»¥æ‰§è¡Œã€‚</p><p>åœ¨å†…å­˜ä¸­åŒæ—¶å­˜æ”¾å¤šä¸ªç¨‹åºï¼Œä½¿å¾—CPUå¯ä»¥åœ¨ä¸€ä¸ªç¨‹åºç­‰å¾…I/Oæ“ä½œæ—¶ï¼Œåˆ‡æ¢åˆ°å¦ä¸€ä¸ªç¨‹åºæ‰§è¡Œï¼Œä»è€Œæé«˜CPUçš„åˆ©ç”¨ç‡ã€‚</p><h3 id="5-åŒé‡æ¨¡å¼å’Œç‰¹æƒæŒ‡ä»¤"><a href="#5-åŒé‡æ¨¡å¼å’Œç‰¹æƒæŒ‡ä»¤" class="headerlink" title="5. åŒé‡æ¨¡å¼å’Œç‰¹æƒæŒ‡ä»¤"></a>5. åŒé‡æ¨¡å¼å’Œç‰¹æƒæŒ‡ä»¤</h3><p>åŒé‡æ¨¡å¼ï¼š</p><p>ä¸ºäº†åŒºåˆ†æ“ä½œç³»ç»Ÿä»£ç å’Œç”¨æˆ·ä»£ç æ‰§è¡Œï¼Œè‡³å°‘éœ€è¦ä¸¤ç§æ¨¡å¼ï¼š<strong>å†…æ ¸æ¨¡å¼</strong>ï¼ˆåˆç§°ç®¡ç†æ¨¡å¼ã€ç³»ç»Ÿæ¨¡å¼ã€ç‰¹æƒæ¨¡å¼ï¼‰å’Œ<strong>ç”¨æˆ·æ¨¡å¼</strong>ï¼Œé€šè¿‡æ¨¡å¼ä½ï¼ˆ0/1ï¼‰æ¥åŒºåˆ†ã€‚</p><p>å½“åº”ç”¨ç¨‹åºéœ€è¦æ“ä½œç³»ç»Ÿçš„æœåŠ¡æ—¶ï¼Œ<strong>å¿…é¡»</strong>ä»ç”¨æˆ·æ¨¡å¼åˆ‡æ¢åˆ°å†…æ ¸æ¨¡å¼ã€‚</p><p>ç‰¹æƒæŒ‡ä»¤(Privileged Instructions)ï¼š</p><p>åªæœ‰åœ¨å†…æ ¸æ¨¡å¼ä¸‹æ‰èƒ½æ‰§è¡Œçš„æŒ‡ä»¤ã€‚</p><p>ç‰¹æƒæŒ‡ä»¤ï¼šåˆ‡æ¢åˆ°ç”¨æˆ·æ¨¡å¼ã€I/Oæ§åˆ¶ç›¸å…³ã€è®¿é—®ç‰¹æ®Šå¯„å­˜å™¨çš„æŒ‡ä»¤ã€å®šæ—¶å™¨ç®¡ç†ã€ä¸­æ–­ç®¡ç†ã€å†…å­˜ç®¡ç†ï¼ˆå¦‚æ”¹å˜å†…å­˜åˆ†é…å›¾ï¼‰ã€è®¾ç½®æ—¶é’Ÿæ—¥æœŸç­‰</p><p>æ˜“æ··æ·†çš„éç‰¹æƒæŒ‡ä»¤ï¼š</p><ul><li>è®¿ç®¡æŒ‡ä»¤ï¼šç”±ç”¨æˆ·ç¨‹åºå‘èµ·çš„ä¸€ç§ç‰¹æ®ŠæŒ‡ä»¤ï¼Œç”¨äºè¯·æ±‚æ“ä½œç³»ç»Ÿæ‰§è¡ŒæŸäº›éœ€è¦ç‰¹æ®Šæƒé™æ‰èƒ½è®¿é—®çš„æ“ä½œï¼Œä¼šä»å†…æ ¸æ¨¡å¼åˆ‡æ¢åˆ°å†…æ ¸æ¨¡å¼ï¼Œå°†æ§åˆ¶æƒäº¤ç»™æ“ä½œç³»ç»Ÿå†…æ ¸æ‰§è¡Œç›¸åº”æ“ä½œï¼Œç„¶åå†è¿”å›ç”¨æˆ·æ¨¡å¼</li><li>ä¸»æœºå’Œç£ç›˜é—´é€šè¿‡DMAä¼ é€æ•°æ®çš„æŒ‡ä»¤</li><li>æ”¹å˜ç£ç›˜ç©ºé—´åˆ†é…å›¾ï¼ˆåŒºåˆ«äºæ”¹å˜å†…å­˜åˆ†é…å›¾ï¼‰</li><li>å†™ç¨‹åºè®¡æ•°å™¨PCã€å¯„å­˜å™¨æ¸…0ã€å–æŒ‡ä»¤ã€å–æ“ä½œæ•°ã€å†™å†…å­˜</li></ul><h3 id="6-å®šæ—¶å™¨"><a href="#6-å®šæ—¶å™¨" class="headerlink" title="6. å®šæ—¶å™¨"></a>6. å®šæ—¶å™¨</h3><p>å®šæ—¶å™¨(Timer)ç¡®ä¿æ“ä½œç³»ç»Ÿç»´æŒå¯¹CPUçš„æ§åˆ¶ï¼Œé˜²æ­¢ç”¨æˆ·ç¨‹åºï¼š</p><ol><li>é™·å…¥æ­»å¾ªç¯</li><li>ä¸è°ƒç”¨ç³»ç»ŸæœåŠ¡ï¼Œä½†ä¸å°†æ§åˆ¶è¿”è¿˜ç»™æ“ä½œç³»ç»Ÿ</li></ol><p>æ“ä½œç³»ç»Ÿåœ¨å°†æ§åˆ¶æƒäº¤ç»™ç”¨æˆ·ä¹‹å‰ï¼Œåº”ç¡®ä¿è®¾ç½®å¥½å®šæ—¶å™¨ä»¥ä¾¿äº§ç”Ÿä¸­æ–­ã€‚</p><h2 id="äºŒã€æ“ä½œç³»ç»Ÿç»“æ„"><a href="#äºŒã€æ“ä½œç³»ç»Ÿç»“æ„" class="headerlink" title="äºŒã€æ“ä½œç³»ç»Ÿç»“æ„"></a>äºŒã€æ“ä½œç³»ç»Ÿç»“æ„</h2><h3 id="1-æ“ä½œç³»ç»ŸæœåŠ¡"><a href="#1-æ“ä½œç³»ç»ŸæœåŠ¡" class="headerlink" title="1. æ“ä½œç³»ç»ŸæœåŠ¡"></a>1. æ“ä½œç³»ç»ŸæœåŠ¡</h3><p>1~6æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ï¼›7~9æé«˜ç³»ç»Ÿæ•ˆç‡ã€‚</p><ol><li>ç”¨æˆ·ç•Œé¢(User Interface)ï¼šæä¾›ç”¨æˆ·ä¸æ“ä½œç³»ç»Ÿäº¤äº’çš„æ–¹å¼ã€‚</li><li>ç¨‹åºæ‰§è¡Œï¼šåŠ è½½ç¨‹åºåˆ°å†…å­˜å¹¶è¿è¡Œï¼Œèƒ½ç»“æŸæ‰§è¡Œï¼ˆä¸è®ºæ˜¯æ­£å¸¸è¿˜æ˜¯å¼‚å¸¸ï¼‰</li><li>I/Oæ“ä½œï¼šæä¾›å¯¹I/Oè®¾å¤‡çš„è®¿é—®å’Œæ§åˆ¶</li><li>æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼šåˆ›å»ºã€åˆ é™¤ã€è¯»å†™æ–‡ä»¶å’Œç›®å½•</li><li>é€šä¿¡ï¼šæä¾›è¿›ç¨‹é—´é€šä¿¡æœºåˆ¶ï¼Œå¦‚ç®¡é“ã€æ¶ˆæ¯é˜Ÿåˆ—ã€å…±äº«å†…å­˜ç­‰<ul><li>æ–¹å¼ï¼šå…±äº«å†…å­˜ã€æ¶ˆæ¯äº¤æ¢</li></ul></li><li>é”™è¯¯æ£€æµ‹ï¼šæ£€æµ‹å’Œå¤„ç†é”™è¯¯ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œ</li><li>èµ„æºåˆ†é…ï¼šä¸ºå„ä¸ªè¿›ç¨‹åˆ†é…CPUæ—¶é—´ã€å†…å­˜ç©ºé—´ã€I/Oè®¾å¤‡ç­‰èµ„æº</li><li>è®°è´¦ï¼šè®°å½•èµ„æºä½¿ç”¨ç±»å‹å’Œæ•°é‡</li><li>ä¿æŠ¤ä¸å®‰å…¨ï¼šç¡®ä¿ç³»ç»Ÿèµ„æºçš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§ï¼Œé˜²æ­¢æœªæˆæƒè®¿é—®</li></ol><h3 id="2-å‘½ä»¤è§£é‡Šç¨‹åº"><a href="#2-å‘½ä»¤è§£é‡Šç¨‹åº" class="headerlink" title="2. å‘½ä»¤è§£é‡Šç¨‹åº"></a>2. å‘½ä»¤è§£é‡Šç¨‹åº</h3><p>å‘½ä»¤è§£é‡Šç¨‹åº(Command Interpreter)ä¹Ÿè¢«ç§°ä¸ºå¤–å£³(Shell)ï¼Œç”¨äºè·å–å¹¶æ‰§è¡Œç”¨æˆ·çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„ç¨‹åº/</p><ul><li>å‘½ä»¤è¡Œç•Œé¢(Command Line Interface, CLI)</li><li>å›¾å½¢ç”¨æˆ·ç•Œé¢(Graphical User Interface, GUI)</li><li>æ‰¹å¤„ç†(Batch)</li></ul><h3 id="3-ç³»ç»Ÿè°ƒç”¨ç±»å‹"><a href="#3-ç³»ç»Ÿè°ƒç”¨ç±»å‹" class="headerlink" title="3. ç³»ç»Ÿè°ƒç”¨ç±»å‹"></a>3. ç³»ç»Ÿè°ƒç”¨ç±»å‹</h3><p>ç³»ç»Ÿè°ƒç”¨æ˜¯æ“ä½œç³»ç»Ÿæä¾›ç»™åº”ç”¨ç¨‹åºçš„å”¯ä¸€ç¨‹åºæ¥å£</p><p>ç±»å‹ï¼šè¿›ç¨‹æ§åˆ¶;æ–‡ä»¶ç®¡ç†;è®¾å¤‡ç®¡ç†;ä¿¡æ¯ç»´æŠ¤;é€šä¿¡ã€‚</p><h2 id="ä¸‰ã€è¿›ç¨‹-Process"><a href="#ä¸‰ã€è¿›ç¨‹-Process" class="headerlink" title="ä¸‰ã€è¿›ç¨‹(Process)"></a>ä¸‰ã€è¿›ç¨‹(Process)</h2><h3 id="1-è¿›ç¨‹"><a href="#1-è¿›ç¨‹" class="headerlink" title="1. è¿›ç¨‹"></a>1. è¿›ç¨‹</h3><p>è¿›ç¨‹æ˜¯æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºçš„å®ä¾‹ï¼ŒåŒ…æ‹¬ï¼šä»£ç æ®µã€æ•°æ®æ®µã€å †æ ˆæ®µã€å †ã€è¿›ç¨‹æ§åˆ¶å—(PCB)ã€‚</p><h4 id="è¿›ç¨‹æ§åˆ¶å—-PCB"><a href="#è¿›ç¨‹æ§åˆ¶å—-PCB" class="headerlink" title="è¿›ç¨‹æ§åˆ¶å—(PCB)"></a>è¿›ç¨‹æ§åˆ¶å—(PCB)</h4><p>è¿›ç¨‹å­˜åœ¨çš„å”¯ä¸€æ ‡è¯†ï¼ŒåŒ…å«ï¼š</p><ul><li>è¿›ç¨‹çŠ¶æ€(State)ï¼šæ–°çš„ã€è¿è¡Œã€ç­‰å¾…ã€å°±ç»ªã€ç»ˆæ­¢</li><li>ç¨‹åºè®¡æ•°å™¨(Program Counter, PC)ï¼šæŒ‡å‘ä¸‹ä¸€æ¡è¦æ‰§è¡Œçš„æŒ‡ä»¤</li><li>CPUå¯„å­˜å™¨(Registers)ï¼šä¿å­˜è¿›ç¨‹æ‰§è¡Œæ—¶çš„å¯„å­˜å™¨çŠ¶æ€</li><li>CPUè°ƒåº¦ä¿¡æ¯ï¼šè¿›ç¨‹ä¼˜å…ˆçº§ï¼Œè°ƒåº¦é˜Ÿåˆ—æŒ‡é’ˆç­‰</li><li>å†…å­˜ç®¡ç†ä¿¡æ¯ï¼šé¡µè¡¨ã€æ®µè¡¨ã€åŸºåœ°å€ç­‰</li><li>è®°è´¦ä¿¡æ¯ã€I/Oä¿¡æ¯</li></ul><h4 id="ä¸Šä¸‹æ–‡åˆ‡æ¢"><a href="#ä¸Šä¸‹æ–‡åˆ‡æ¢" class="headerlink" title="ä¸Šä¸‹æ–‡åˆ‡æ¢"></a>ä¸Šä¸‹æ–‡åˆ‡æ¢</h4><p>ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼šè¿›ç¨‹é—´åˆ‡æ¢çš„è¿‡ç¨‹ï¼Œä¿å­˜å½“å‰è¿›ç¨‹çš„çŠ¶æ€åˆ°PCB1ä¸­ï¼Œå¹¶ä»PCB2ä¸­æ¢å¤ä¸‹ä¸€ä¸ªè¿›ç¨‹çš„çŠ¶æ€ã€‚</p><h3 id="2-è¿›ç¨‹çŠ¶æ€ä¸è½¬æ¢"><a href="#2-è¿›ç¨‹çŠ¶æ€ä¸è½¬æ¢" class="headerlink" title="2. è¿›ç¨‹çŠ¶æ€ä¸è½¬æ¢"></a>2. è¿›ç¨‹çŠ¶æ€ä¸è½¬æ¢</h3><ul><li>æ–°çš„(new)ï¼šè¿›ç¨‹æ­£åœ¨åˆ›å»ºä¸­</li><li>è¿è¡Œ(running)ï¼šæŒ‡ä»¤æ­£åœ¨æ‰§è¡Œï¼ˆä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªè¿›ç¨‹å¯åœ¨ä¸€ä¸ªCPUä¸Šè¿è¡Œï¼‰</li><li>ç­‰å¾…(waiting)ï¼šè¿›ç¨‹æ­£åœ¨ç­‰å¾…æŸä¸ªäº‹ä»¶å‘ç”Ÿï¼ˆå¦‚I/Oæ“ä½œå®Œæˆã€æ”¶åˆ°ä¿¡å·ç­‰ï¼‰</li><li>å°±ç»ª(ready)ï¼šè¿›ç¨‹å·²å‡†å¤‡å¥½è¿è¡Œï¼Œç­‰å¾…åˆ†é…å¤„ç†å™¨</li><li>ç»ˆæ­¢(terminated)ï¼šè¿›ç¨‹å·²å®Œæˆæ‰§è¡Œ</li></ul><p><img src="https://source.cclmsy.cc/posts/notes/course/operating_system/image-1.png" alt="alt text"></p><ul><li>å› æ—¶é—´ç‰‡ç”¨å®Œæš‚åœï¼šè¿è¡Œ-&gt;å°±ç»ª</li><li>å› I/Oæ“ä½œæš‚åœï¼šè¿è¡Œ-&gt;ç­‰å¾…</li><li>è¿›ç¨‹æ‰“å°ç»“æŸï¼šç­‰å¾…-&gt;å°±ç»ª</li></ul><h3 id="3-è¿›ç¨‹è°ƒåº¦"><a href="#3-è¿›ç¨‹è°ƒåº¦" class="headerlink" title="3. è¿›ç¨‹è°ƒåº¦"></a>3. è¿›ç¨‹è°ƒåº¦</h3><p>è°ƒåº¦é˜Ÿåˆ—ï¼š</p><ul><li>ä½œä¸šé˜Ÿåˆ—ï¼šç³»ç»Ÿä¸­çš„æ‰€æœ‰è¿›ç¨‹</li><li>å°±ç»ªé˜Ÿåˆ—ï¼šå¤„äºå°±ç»ªçŠ¶æ€ç­‰å¾…è¿è¡Œçš„è¿›ç¨‹</li><li>è®¾å¤‡é˜Ÿåˆ—ï¼šç­‰å¾…ç‰¹å®šI/Oè®¾å¤‡çš„è¿›ç¨‹</li></ul><p>è°ƒåº¦ç¨‹åºï¼š</p><ul><li>çŸ­æœŸè°ƒåº¦ï¼ˆCPUè°ƒåº¦ï¼‰ï¼šä»<strong>é˜Ÿåˆ—</strong>ä¸­é€‰æ‹©ä¸€ä¸ªè¿›ç¨‹å¹¶ä¸ºä¹‹åˆ†é…CPU<ul><li>å¿«é€Ÿæ‰§è¡Œï¼Œé¢‘ç¹å‘ç”Ÿï¼Œé€šå¸¸æ¯éš”å‡ æ¯«ç§’</li></ul></li><li>é•¿æœŸè°ƒåº¦ï¼ˆä½œä¸šè°ƒåº¦ï¼‰ï¼šä»<strong>ç£ç›˜ç¼“å†²æ± </strong>ä¸­é€‰æ‹©è¿›ç¨‹å¹¶å°†å…¶åŠ è½½åˆ°å†…å­˜ä»¥ä¾¿æ‰§è¡Œ<ul><li>æ§åˆ¶å¤šé“ç¨‹åºç¨‹åº¦ï¼ˆå†…å­˜ä¸­çš„è¿›ç¨‹æ•°ï¼‰</li><li>é€‰æ‹©è¿›ç¨‹ï¼šåˆç†æ­é…CPUå¯†é›†å‹å’ŒI/Oå¯†é›†å‹è¿›ç¨‹</li></ul></li><li>ä¸­æœŸè°ƒåº¦ï¼šå°†è¿›ç¨‹ä»<strong>å†…å­˜æˆ–CPUç«äº‰</strong>ä¸­ç§»å‡º<ul><li>é™ä½å¤šé“ç¨‹åºç¨‹åº¦</li></ul></li></ul><h3 id="4-è¿›ç¨‹åˆ›å»º-ç»ˆæ­¢"><a href="#4-è¿›ç¨‹åˆ›å»º-ç»ˆæ­¢" class="headerlink" title="4. è¿›ç¨‹åˆ›å»º/ç»ˆæ­¢"></a>4. è¿›ç¨‹åˆ›å»º/ç»ˆæ­¢</h3><p>è¿›ç¨‹åˆ›å»ºï¼š<code>fork()</code>ã€<code>vfork()</code>ã€<code>clone()</code>ç­‰ç³»ç»Ÿè°ƒç”¨</p><ul><li>åˆ›å»ºæ–°è¿›ç¨‹æ—¶ï¼Œçˆ¶è¿›ç¨‹çš„æ‰€æœ‰èµ„æºï¼ˆä»£ç ã€æ•°æ®ã€å †æ ˆï¼‰éƒ½è¢«å¤åˆ¶åˆ°å­è¿›ç¨‹ä¸­</li><li>å­è¿›ç¨‹fork()è¿”å›å€¼ä¸º0ï¼Œçˆ¶è¿›ç¨‹è¿”å›å­è¿›ç¨‹çš„PID</li><li>å­è¿›ç¨‹æ‹¥æœ‰è‡ªå·±çš„PCBå’Œç‹¬ç«‹çš„åœ°å€ç©ºé—´</li></ul><p>è¿›ç¨‹ç»ˆæ­¢ï¼šæ­£å¸¸ç»“æŸ<code>exit()</code>ï¼›å¼‚å¸¸ç»“æŸ<code>abort()</code></p><p>çº§è”ç»ˆæ­¢ï¼šå½“çˆ¶è¿›ç¨‹ç»ˆæ­¢æ—¶ï¼Œæ‰€æœ‰å­è¿›ç¨‹ä¹Ÿä¼šè¢«ç»ˆæ­¢</p><p>çˆ¶è¿›ç¨‹ç­‰å¾…ï¼š<code>wait()</code>ç³»ç»Ÿè°ƒç”¨</p><ul><li>æ³¨æ„ï¼šexec()ç³»åˆ—å‡½æ•°ä¼šç”¨æ–°ç¨‹åºæ›¿æ¢å½“å‰è¿›ç¨‹çš„ä»£ç æ®µã€æ•°æ®æ®µå’Œå †æ ˆæ®µï¼Œä½†ä¿ç•™PCBå’Œè¿›ç¨‹IDï¼Œä¸ä¼šåˆ›å»ºæ–°è¿›ç¨‹ã€‚</li></ul><h3 id="5-è¿›ç¨‹åä½œ-é€šä¿¡"><a href="#5-è¿›ç¨‹åä½œ-é€šä¿¡" class="headerlink" title="5. è¿›ç¨‹åä½œ/é€šä¿¡"></a>5. è¿›ç¨‹åä½œ/é€šä¿¡</h3><p>å¦‚æœä¸€ä¸ªè¿›ç¨‹èƒ½å½±å“å…¶ä»–è¿›ç¨‹æˆ–è¢«å…¶ä»–è¿›ç¨‹å½±å“ï¼Œé‚£ä¹ˆè¯¥è¿›ç¨‹å°±æ˜¯<strong>åä½œ</strong>çš„ï¼Œå¦åˆ™å°±æ˜¯<strong>ç‹¬ç«‹</strong>çš„ã€‚</p><p>åä½œè¿›ç¨‹éœ€è¦ä¸€ç§è¿›ç¨‹é—´é€šä¿¡æœºåˆ¶ï¼ˆInter-Process Communication, IPCï¼‰æ¥äº¤æ¢ä¿¡æ¯ï¼Œæœ‰2ç§åŸºæœ¬æ–¹å¼ï¼š</p><ul><li>å…±äº«å†…å­˜ï¼šå¤šä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®åŒä¸€å—å†…å­˜åŒºåŸŸ<ul><li>å¿«ï¼Œä»…åœ¨å»ºç«‹å…±äº«å†…å­˜æ—¶éœ€è¦ç³»ç»Ÿè°ƒç”¨</li></ul></li><li>æ¶ˆæ¯ä¼ é€’ï¼šé€šè¿‡å‘é€å’Œæ¥æ”¶æ¶ˆæ¯æ¥äº¤æ¢ä¿¡æ¯<ul><li>äº¤æ¢å°‘é‡æ•°æ®æ—¶æœ‰ç”¨ï¼Œæ— éœ€é¿å…å†²çª</li></ul></li></ul><p>ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç”Ÿäº§è€…</span></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">while</span>(((in+<span class="number">1</span>) % N) == out); <span class="comment">//ç­‰å¾…ç¼“å†²åŒºæœ‰ç©ºä½</span></span><br><span class="line">    buffer[in] = produce_item(); <span class="comment">//ç”Ÿäº§ä¸€ä¸ªé¡¹ç›®</span></span><br><span class="line">    in = (in + <span class="number">1</span>) % N; <span class="comment">//æ›´æ–°è¾“å…¥æŒ‡é’ˆ</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">while</span> (in == out); <span class="comment">//ç­‰å¾…ç¼“å†²åŒºæœ‰é¡¹ç›®</span></span><br><span class="line">    consume_item(buffer[out]); <span class="comment">//æ¶ˆè´¹ä¸€ä¸ªé¡¹ç›®</span></span><br><span class="line">    out = (out + <span class="number">1</span>) % N; <span class="comment">//æ›´æ–°è¾“å‡ºæŒ‡é’ˆ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å››ã€çº¿ç¨‹-Thread"><a href="#å››ã€çº¿ç¨‹-Thread" class="headerlink" title="å››ã€çº¿ç¨‹(Thread)"></a>å››ã€çº¿ç¨‹(Thread)</h2><h3 id="1-çº¿ç¨‹"><a href="#1-çº¿ç¨‹" class="headerlink" title="1. çº¿ç¨‹"></a>1. çº¿ç¨‹</h3><p>çº¿ç¨‹æ˜¯CPUå¤„ç†çš„åŸºæœ¬å•ä½ï¼Œç”±ï¼šçº¿ç¨‹IDã€ç¨‹åºè®¡æ•°å™¨ã€å¯„å­˜å™¨é›†åˆå’Œæ ˆç»„æˆ</p><h3 id="2-çº¿ç¨‹ä¸è¿›ç¨‹"><a href="#2-çº¿ç¨‹ä¸è¿›ç¨‹" class="headerlink" title="2. çº¿ç¨‹ä¸è¿›ç¨‹"></a>2. çº¿ç¨‹ä¸è¿›ç¨‹</h3><p>è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿåˆ†é…èµ„æºçš„åŸºæœ¬å•ä½ï¼Œè€Œçº¿ç¨‹æ˜¯CPUå¤„ç†çš„åŸºæœ¬å•ä½</p><p>åŒä¸€è¿›ç¨‹ çš„ ä¸åŒçº¿ç¨‹ ä¹‹é—´<strong>å…±äº«ä»£ç æ®µã€æ•°æ®æ®µã€æ–‡ä»¶</strong>ç­‰ï¼Œ<strong>ç§æœ‰å¯„å­˜å™¨å’Œæ ˆ</strong>ã€‚</p><h3 id="3-å¤šçº¿ç¨‹çš„ä¼˜ç‚¹"><a href="#3-å¤šçº¿ç¨‹çš„ä¼˜ç‚¹" class="headerlink" title="3. å¤šçº¿ç¨‹çš„ä¼˜ç‚¹"></a>3. å¤šçº¿ç¨‹çš„ä¼˜ç‚¹</h3><ol><li>å“åº”åº¦é«˜ï¼šå³ä½¿éƒ¨åˆ†é˜»å¡æˆ–æ‰§è¡Œå†—é•¿æ“ä½œï¼Œä»ç„¶å¯ä»¥ç»§ç»­æ‰§è¡Œï¼Œå¢åŠ å¯¹ç”¨æˆ·çš„å“åº”ç¨‹åº¦</li><li>èµ„æºå…±äº«ï¼šè¿›ç¨‹åªèƒ½é€šè¿‡ï¼ˆå…±äº«å†…å­˜ã€æ¶ˆæ¯ä¼ é€’ï¼‰ç­‰æ–¹å¼å…±äº«èµ„æºï¼Œè€Œçº¿ç¨‹é»˜è®¤å…è®¸å…±äº«å†…å­˜å’Œèµ„æº</li><li>ç»æµï¼šè¿›ç¨‹åˆ›å»ºæ‰€éœ€çš„å†…å­˜å’Œèµ„æºåˆ†é…é«˜ï¼Œçº¿ç¨‹å…±äº«èµ„æºï¼Œåˆ›å»ºå’Œåˆ‡æ¢å¼€é”€å°</li><li>å¯ä¼¸ç¼©æ€§ï¼šå¤šçº¿ç¨‹ç¨‹åºå¯ä»¥æ›´å¥½åœ°åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨çš„å¹¶è¡Œå¤„ç†èƒ½åŠ›</li></ol><h3 id="4-ç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çº¿ç¨‹"><a href="#4-ç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çº¿ç¨‹" class="headerlink" title="4. ç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çº¿ç¨‹"></a>4. ç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çº¿ç¨‹</h3><p>ç”¨æˆ·çº¿ç¨‹åœ¨å†…æ ¸ä¹‹ä¸Šæ”¯æŒï¼Œå¹¶é€šè¿‡ç”¨æˆ·çº§çº¿ç¨‹åº“æ¥å®ç°ã€‚<br>çº¿ç¨‹åº“æä¾›å¯¹ç”¨æˆ·çº¿ç¨‹çš„åˆ›å»ºã€è°ƒåº¦å’Œç®¡ç†çš„æ”¯æŒï¼Œè€Œæ— éœ€å†…æ ¸æ”¯æŒã€‚</p><p>ä¸‰ç§åŸºæœ¬çš„ç”¨æˆ·çº§çº¿ç¨‹åº“ï¼šPOSIX Pthreadsã€Win32 Threadsã€Java Threadsã€‚</p><p>å†…æ ¸ç”±æ“ä½œç³»ç»Ÿç›´æ¥æ”¯æŒï¼Œå†…æ ¸åœ¨å…¶ç©ºé—´å†…æ‰§è¡Œå†…æ ¸çº¿ç¨‹çš„åˆ›å»ºã€è°ƒåº¦å’Œç®¡ç†ã€‚</p><p>å®ä¾‹ï¼šWindows XP/2000ã€Solarisã€Linuxç­‰æ“ä½œç³»ç»Ÿéƒ½æ”¯æŒå†…æ ¸çº¿ç¨‹ã€‚</p><p>å¤šçº¿ç¨‹æ¨¡å‹ï¼šç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çº¿ç¨‹çš„æ˜ å°„å…³ç³»ï¼ˆ1:1ã€M:1ã€M:Nï¼‰</p><h2 id="äº”ã€è¿›ç¨‹è°ƒåº¦"><a href="#äº”ã€è¿›ç¨‹è°ƒåº¦" class="headerlink" title="äº”ã€è¿›ç¨‹è°ƒåº¦"></a>äº”ã€è¿›ç¨‹è°ƒåº¦</h2><h3 id="1-åŸºæœ¬æ¦‚å¿µ"><a href="#1-åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="1. åŸºæœ¬æ¦‚å¿µ"></a>1. åŸºæœ¬æ¦‚å¿µ</h3><h4 id="1-1-CPU-I-Oæ‰§è¡Œå‘¨æœŸ"><a href="#1-1-CPU-I-Oæ‰§è¡Œå‘¨æœŸ" class="headerlink" title="1.1 CPU-I/Oæ‰§è¡Œå‘¨æœŸ"></a>1.1 CPU-I/Oæ‰§è¡Œå‘¨æœŸ</h4><p>è¿›ç¨‹æ‰§è¡ŒåŒ…æ‹¬å‘¨æœŸåœ°äº¤æ›¿è¿›è¡Œï¼šCPUæ‰§è¡Œå’ŒI/Oç­‰å¾…</p><p>çŸ­CPUåŒºé—´å‡ºç°çš„é¢‘ç‡è¾ƒé«˜ï¼Œé•¿CPUåŒºé—´åˆ™å¾ˆå°‘ã€‚<br>I/Oä¸ºä¸»çš„ç¨‹åºé€šå¸¸çŸ­CPUåŒºé—´å¾ˆå¤šï¼Œè€ŒCPUä¸ºä¸»çš„ç¨‹åºå¯èƒ½æœ‰å°‘é‡çš„é•¿CPUåŒºé—´ã€‚</p><h4 id="1-2-CPUè°ƒåº¦ç¨‹åº"><a href="#1-2-CPUè°ƒåº¦ç¨‹åº" class="headerlink" title="1.2 CPUè°ƒåº¦ç¨‹åº"></a>1.2 CPUè°ƒåº¦ç¨‹åº</h4><p>å½“CPUå˜ä¸ºç©ºé—²æ—¶ï¼Œæ“ä½œç³»ç»Ÿå°±å¿…é¡»ä»å°±ç»ªé˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ªè¿›ç¨‹æ¥æ‰§è¡Œã€‚<br>è¿›ç¨‹çš„é€‰æ‹©ç”±çŸ­æœŸè°ƒåº¦ç¨‹åºï¼ˆShort-term scheduler,æˆ–CPUè°ƒåº¦ç¨‹åºï¼‰æ‰§è¡Œã€‚</p><p>å½“å‡ºç°ä¸‹é¢ä»»ä½•æƒ…å½¢ä¹‹ä¸€æ—¶ï¼Œéœ€è¦CPUè°ƒåº¦ï¼š</p><ol><li>è¿›ç¨‹ä»è¿è¡ŒçŠ¶æ€è½¬å…¥ç­‰å¾…çŠ¶æ€ï¼ˆI/Oè¯·æ±‚ï¼‰</li><li>è¿›ç¨‹ä»è¿è¡ŒçŠ¶æ€è½¬å…¥å°±ç»ªçŠ¶æ€ï¼ˆå‡ºç°ä¸­æ–­ï¼‰</li><li>è¿›ç¨‹ä»ç­‰å¾…çŠ¶æ€è½¬å…¥å°±ç»ªçŠ¶æ€ï¼ˆI/Oå®Œæˆï¼‰</li><li>è¿›ç¨‹ç»ˆæ­¢</li></ol><p>å¦‚æœè°ƒåº¦åªå‘ç”Ÿåœ¨1,4æƒ…å½¢ï¼Œåˆ™ç§°ä¸ºéæŠ¢å å¼è°ƒåº¦ï¼›<br>å¦‚æœåœ¨2,3æƒ…å½¢å‘ç”Ÿè°ƒåº¦ï¼Œåˆ™ç§°ä¸ºæŠ¢å å¼è°ƒåº¦ã€‚</p><h4 id="1-3-è°ƒåº¦ç¨‹åº-åˆ†æ´¾ç¨‹åº"><a href="#1-3-è°ƒåº¦ç¨‹åº-åˆ†æ´¾ç¨‹åº" class="headerlink" title="1.3 è°ƒåº¦ç¨‹åº/åˆ†æ´¾ç¨‹åº"></a>1.3 è°ƒåº¦ç¨‹åº/åˆ†æ´¾ç¨‹åº</h4><p>è°ƒåº¦ç¨‹åºï¼ˆDispatcherï¼Œåˆç§°åˆ†æ´¾ç¨‹åºï¼‰æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œç”¨æ¥å°†CPUæ§åˆ¶æƒäº¤ç»™çŸ­æœŸè°ƒåº¦ç¨‹åºé€‰æ‹©çš„è¿›ç¨‹ï¼ŒåŠŸèƒ½åŒ…æ‹¬ï¼š</p><ol><li>åˆ‡æ¢ä¸Šä¸‹æ–‡ï¼šä¿å­˜å½“å‰è¿›ç¨‹çš„çŠ¶æ€ï¼Œå¹¶åŠ è½½æ–°è¿›ç¨‹çš„çŠ¶æ€</li><li>åˆ‡æ¢åˆ°ç”¨æˆ·æ¨¡å¼</li><li>è·³è½¬åˆ°ç”¨æˆ·ç¨‹åºçš„åˆé€‚ä½ç½®ï¼Œä»¥ä¾¿é‡æ–°å¯åŠ¨ç¨‹åº</li></ol><p>æ¯æ¬¡è¿›ç¨‹åˆ‡æ¢éƒ½éœ€è¦ä½¿ç”¨è°ƒåº¦ç¨‹åºï¼Œé€Ÿåº¦åº”å°½å¯èƒ½å¿«ã€‚</p><p>è°ƒåº¦å»¶è¿Ÿ/åˆ†æ´¾å»¶è¿Ÿï¼šåœæ­¢ä¸€ä¸ªè¿›ç¨‹è€Œå¯åŠ¨å¦ä¸€ä¸ªè¿›ç¨‹æ‰€éœ€çš„æ—¶é—´ã€‚</p><h3 id="2-è°ƒåº¦å‡†åˆ™"><a href="#2-è°ƒåº¦å‡†åˆ™" class="headerlink" title="2. è°ƒåº¦å‡†åˆ™"></a>2. è°ƒåº¦å‡†åˆ™</h3><ul><li>æœ€å¤§åŒ–ï¼šCPUåˆ©ç”¨ç‡ã€ååé‡</li><li>æœ€å°åŒ–ï¼š<ul><li>å¹³å‡å‘¨è½¬æ—¶é—´ï¼šä»è¿›ç¨‹æäº¤åˆ°è¿›ç¨‹å®Œæˆçš„æ—¶é—´</li><li>å¹³å‡ç­‰å¾…æ—¶é—´ï¼šç¨‹åœ¨å°±ç»ªé˜Ÿåˆ—ä¸­ç­‰å¾…æ‰€èŠ±çš„æ—¶é—´ï¼Œå¹³å‡ç­‰å¾…æ—¶é—´=å¹³å‡å‘¨è½¬æ—¶é—´-å¹³å‡æ‰§è¡Œæ—¶é—´</li><li>å¹³å‡å“åº”æ—¶é—´ï¼šä»è¿›ç¨‹æäº¤åˆ°è¿›ç¨‹ç¬¬ä¸€æ¬¡å¼€å§‹æ‰§è¡Œçš„æ—¶é—´</li></ul></li></ul><h3 id="3-è°ƒåº¦ç®—æ³•"><a href="#3-è°ƒåº¦ç®—æ³•" class="headerlink" title="3. è°ƒåº¦ç®—æ³•"></a>3. è°ƒåº¦ç®—æ³•</h3><ul><li>éæŠ¢å å¼ï¼šä¸€æ—¦è¿›ç¨‹å¼€å§‹æ‰§è¡Œï¼Œé™¤éå®ƒå®Œæˆï¼Œå¦åˆ™ä¸ä¼šè¢«æŠ¢å </li><li>æŠ¢å å¼ï¼šå¦‚æœä¸€ä¸ªæ–°åˆ°è¾¾çš„è¿›ç¨‹æ»¡è¶³æŠ¢å æ¡ä»¶ï¼Œåˆ™æŠ¢å å½“å‰è¿›ç¨‹</li></ul><h4 id="3-1-å…ˆåˆ°å…ˆæœåŠ¡ï¼ˆFCFSï¼‰"><a href="#3-1-å…ˆåˆ°å…ˆæœåŠ¡ï¼ˆFCFSï¼‰" class="headerlink" title="3.1 å…ˆåˆ°å…ˆæœåŠ¡ï¼ˆFCFSï¼‰"></a>3.1 å…ˆåˆ°å…ˆæœåŠ¡ï¼ˆFCFSï¼‰</h4><p>å…ˆåˆ°å…ˆæœåŠ¡ï¼ˆFirst-Come, First-Served, FCFSï¼‰æ˜¯æœ€ç®€å•çš„è°ƒåº¦ç®—æ³•ã€‚</p><p>æŒ‰ç…§è¿›ç¨‹åˆ°è¾¾å°±ç»ªé˜Ÿåˆ—çš„é¡ºåºè¿›è¡Œè°ƒåº¦ã€‚</p><p>é—®é¢˜ï¼šæŠ¤èˆªæ•ˆåº”ï¼šé•¿è¿›ç¨‹å¯èƒ½ä¼šé˜»å¡çŸ­è¿›ç¨‹ï¼Œå¯¼è‡´å¹³å‡ç­‰å¾…æ—¶é—´å¢åŠ ã€‚</p><h4 id="3-2-æœ€çŸ­ä½œä¸šä¼˜å…ˆ"><a href="#3-2-æœ€çŸ­ä½œä¸šä¼˜å…ˆ" class="headerlink" title="3.2 æœ€çŸ­ä½œä¸šä¼˜å…ˆ"></a>3.2 æœ€çŸ­ä½œä¸šä¼˜å…ˆ</h4><p>æœ€çŸ­ä½œä¸šä¼˜å…ˆï¼ˆShortest Job First, SJFï¼‰ï¼Œæ˜¯æœ€ä½³çš„è°ƒåº¦ç®—æ³•ä¹‹ä¸€ã€‚</p><p>åŸºäºè¿›ç¨‹æ‰§è¡Œæ—¶é—´çš„è°ƒåº¦ç®—æ³•ï¼Œé€‰æ‹©é¢„è®¡æ‰§è¡Œæ—¶é—´æœ€çŸ­çš„è¿›ç¨‹è¿›è¡Œè°ƒåº¦ã€‚</p><p>åˆ†ä¸ºéæŠ¢å å¼ï¼ˆæœ€çŸ­ä½œä¸šä¼˜å…ˆSJFï¼‰å’ŒæŠ¢å å¼ï¼ˆæœ€çŸ­å‰©ä½™æ—¶é—´è°ƒåº¦SRTFï¼‰</p><p>SJFç®—æ³•æ˜¯æœ€ä½³çš„ï¼Œä½†æ˜¯å®ƒä¸èƒ½åœ¨çŸ­æœŸCPUè°ƒåº¦çš„å±‚æ¬¡ä¸Šå®ç°ï¼Œå› ä¸ºæ²¡æœ‰åŠæ³•çŸ¥é“ä¸‹ä¸€ä¸ªCPUè¯·æ±‚çš„é•¿åº¦ã€‚</p><p>é—®é¢˜ï¼šé¥¥é¥¿ç°è±¡/æ— ç©·é˜»å¡ï¼šé•¿è¿›ç¨‹å¯èƒ½æ°¸è¿œå¾—ä¸åˆ°æ‰§è¡Œã€‚</p><h4 id="3-3-ä¼˜å…ˆçº§è°ƒåº¦"><a href="#3-3-ä¼˜å…ˆçº§è°ƒåº¦" class="headerlink" title="3.3 ä¼˜å…ˆçº§è°ƒåº¦"></a>3.3 ä¼˜å…ˆçº§è°ƒåº¦</h4><p>ä¼˜å…ˆçº§è°ƒåº¦ï¼ˆPriority Schedulingï¼‰ä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€ä¸ªä¼˜å…ˆçº§ï¼Œè°ƒåº¦æ—¶é€‰æ‹©ä¼˜å…ˆçº§æœ€é«˜çš„è¿›ç¨‹ã€‚</p><p>åˆ†ä¸ºéæŠ¢å å¼å’ŒæŠ¢å å¼ã€‚</p><p>SJFç®—æ³•æ˜¯é€šç”¨ä¼˜å…ˆçº§è°ƒåº¦ç®—æ³•çš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œåªä¸è¿‡SJFç®—æ³•çš„ä¼˜å…ˆçº§æ˜¯é€šè¿‡é¢„æµ‹CPUåŒºé—´çš„é•¿çŸ­æ¥å®ç°çš„ã€‚</p><p>é—®é¢˜ï¼šé¥¥é¥¿ç°è±¡/æ— ç©·é˜»å¡</p><p>è§£å†³åŠæ³•ï¼šè€åŒ–ï¼šé€æ¸å¢å¤§åœ¨ç³»ç»Ÿä¸­ç­‰å¾…å¾ˆé•¿æ—¶é—´çš„è¿›ç¨‹çš„ä¼˜å…ˆçº§ã€‚</p><h4 id="3-4-è½®è½¬è°ƒåº¦ï¼ˆRRï¼‰"><a href="#3-4-è½®è½¬è°ƒåº¦ï¼ˆRRï¼‰" class="headerlink" title="3.4 è½®è½¬è°ƒåº¦ï¼ˆRRï¼‰"></a>3.4 è½®è½¬è°ƒåº¦ï¼ˆRRï¼‰</h4><p>è½®è½¬è°ƒåº¦ï¼ˆRound Robin, RRï¼‰æ˜¯æœ€å¸¸ç”¨çš„æŠ¢å å¼è°ƒåº¦ç®—æ³•ã€‚</p><p>å°†ä¸€ä¸ªè¾ƒå°çš„æ—¶é—´å•å…ƒå®šä¹‰ä¸ºæ—¶é—´ç‰‡ï¼ˆTime Quantumï¼‰ï¼Œæ¯ä¸ªè¿›ç¨‹åœ¨æ—¶é—´ç‰‡å†…æ‰§è¡Œã€‚</p><p>å¦‚æœæ—¶é—´ç‰‡ç”¨å®Œï¼Œè¿›ç¨‹è¢«æŠ¢å å¹¶æ”¾å›å°±ç»ªé˜Ÿåˆ—çš„æœ«å°¾ã€‚</p><p>ä¼˜ç‚¹ï¼šå“åº”æ—¶é—´å°ã€ä¸ä¼šå‡ºç°æŠ¤èˆªæ•ˆåº”å’Œé¥¥é¥¿ç°è±¡ã€‚</p><p>RRä¾èµ–äºæ—¶é—´ç‰‡å¤§å°ï¼Œè¿‡å¤§åˆ™å’ŒFCFSç›¸åŒï¼Œè¿‡å°åˆ™ä¼šå¯¼è‡´é¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢</p><p>æ³¨ï¼šè€ƒè¯•ä¸­æ—¶é—´ç‰‡é»˜è®¤ä¸º2s</p><h4 id="3-5-å¤šçº§é˜Ÿåˆ—è°ƒåº¦"><a href="#3-5-å¤šçº§é˜Ÿåˆ—è°ƒåº¦" class="headerlink" title="3.5 å¤šçº§é˜Ÿåˆ—è°ƒåº¦"></a>3.5 å¤šçº§é˜Ÿåˆ—è°ƒåº¦</h4><p>å°†å°±ç»ªé˜Ÿåˆ—åˆ’åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹é˜Ÿåˆ—ï¼Œæ ¹æ®è¿›ç¨‹çš„æŸäº›å±æ€§åˆ†é…åˆ°ä¸åŒé˜Ÿåˆ—ï¼Œæ¯ä¸ªé˜Ÿåˆ—æœ‰è‡ªå·±çš„è°ƒåº¦ç®—æ³•ã€‚</p><p>é˜Ÿåˆ—ä¹‹é—´ä¹Ÿéœ€è¦ä¼˜å…ˆçº§ï¼Œå¯ä»¥æ˜¯å›ºå®šä¼˜å…ˆçº§æˆ–åˆ’åˆ†æ—¶é—´ç‰‡</p><h4 id="3-6-å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦"><a href="#3-6-å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦" class="headerlink" title="3.6 å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦"></a>3.6 å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦</h4><p>æ ¹æ®ä¸åŒCPUåŒºé—´ç‰¹ç‚¹ä»¥åŒºåˆ†è¿›ç¨‹ï¼Œå…è®¸è¿›ç¨‹åœ¨é˜Ÿåˆ—ä¹‹é—´ç§»åŠ¨ã€‚</p><p>å¦‚æœè¿›ç¨‹ä½¿ç”¨è¿‡å¤šçš„CPUæ—¶é—´ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«ç§»åˆ°æ›´ä½ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œè¿™ä¸€æ–¹æ¡ˆä¼šå°†I/Oä¸ºä¸»å’Œäº¤äº’å¼è¿›ç¨‹ç•™åœ¨è¾ƒé«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ã€‚</p><p>åœ¨è¾ƒä½ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­ç­‰å¾…è¿‡é•¿çš„è¿›ç¨‹ä¼šè¢«è½¬ç§»åˆ°è¾ƒé«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œè¿™ç§å½¢å¼çš„è€åŒ–èƒ½å¤Ÿé˜»æ­¢é¥¥é¥¿çš„å‘ç”Ÿã€‚</p><h3 id="4-è°ƒåº¦ç®—æ³•è®¡ç®—é¢˜"><a href="#4-è°ƒåº¦ç®—æ³•è®¡ç®—é¢˜" class="headerlink" title="4. è°ƒåº¦ç®—æ³•è®¡ç®—é¢˜"></a>4. è°ƒåº¦ç®—æ³•è®¡ç®—é¢˜</h3><div class="table-container"><table><thead><tr><th style="text-align:center">è¿›ç¨‹</th><th style="text-align:center">åˆ°è¾¾æ—¶é—´</th><th style="text-align:center">æ‰§è¡Œæ—¶é—´</th><th style="text-align:center">ä¼˜å…ˆçº§</th></tr></thead><tbody><tr><td style="text-align:center">P1</td><td style="text-align:center">0</td><td style="text-align:center">10</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center">P2</td><td style="text-align:center">1</td><td style="text-align:center">4</td><td style="text-align:center">5</td></tr><tr><td style="text-align:center">P3</td><td style="text-align:center">2</td><td style="text-align:center">9</td><td style="text-align:center">3</td></tr><tr><td style="text-align:center">P4</td><td style="text-align:center">3</td><td style="text-align:center">5</td><td style="text-align:center">1</td></tr><tr><td style="text-align:center">P5</td><td style="text-align:center">4</td><td style="text-align:center">2</td><td style="text-align:center">4</td></tr></tbody></table></div><h4 id="4-1-FCFSè°ƒåº¦"><a href="#4-1-FCFSè°ƒåº¦" class="headerlink" title="4.1 FCFSè°ƒåº¦"></a>4.1 FCFSè°ƒåº¦</h4><p>ç”˜ç‰¹å›¾ï¼š</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">| <span class="type">P1</span> | <span class="type">P2</span> | <span class="type">P3</span> | <span class="type">P4</span> | <span class="type">P5</span> |</span><br><span class="line"><span class="type">0</span>    <span class="number">10</span>   <span class="number">14</span>   <span class="number">23</span>   <span class="number">28</span>   <span class="number">30</span> </span><br></pre></td></tr></table></figure><ul><li>å¹³å‡ç­‰å¾…æ—¶é—´ï¼š$(0+(10-1)+(14-2)+(23-3)+(28-4))\div 5 = 13$</li><li>å¹³å‡å‘¨è½¬æ—¶é—´ï¼š$(10+(14-1)+(23-2)+(28-3)+(30-4))\div 5 = 19$</li><li>å¹³å‡å“åº”æ—¶é—´=å¹³å‡ç­‰å¾…æ—¶é—´</li></ul><h4 id="4-2-SJFè°ƒåº¦"><a href="#4-2-SJFè°ƒåº¦" class="headerlink" title="4.2 SJFè°ƒåº¦"></a>4.2 SJFè°ƒåº¦</h4><p>ç”±äºP1å…ˆåˆ°ï¼Œæ‰€ä»¥P1å…ˆæ‰§è¡Œï¼ŒéæŠ¢å å¼</p><p>ç”˜ç‰¹å›¾ï¼š</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">| <span class="type">P1</span> | <span class="type">P5</span> | <span class="type">P2</span> | <span class="type">P4</span> | <span class="type">P3</span> |</span><br><span class="line"><span class="type">0</span>    <span class="number">10</span>   <span class="number">12</span>   <span class="number">16</span>   <span class="number">21</span>   <span class="number">30</span></span><br></pre></td></tr></table></figure><ul><li>å¹³å‡ç­‰å¾…æ—¶é—´ï¼š$(0+(12-1)+(21-2)+(16-3)+(10-4))\div 5 = 9.8$</li><li>å¹³å‡å‘¨è½¬æ—¶é—´ï¼š$(10+(16-1)+(30-2)+(21-3)+(12-4))\div 5 = 15.8$</li><li>å¹³å‡å“åº”æ—¶é—´=å¹³å‡ç­‰å¾…æ—¶é—´</li></ul><h4 id="4-3-SRTFè°ƒåº¦"><a href="#4-3-SRTFè°ƒåº¦" class="headerlink" title="4.3 SRTFè°ƒåº¦"></a>4.3 SRTFè°ƒåº¦</h4><p>ç”˜ç‰¹å›¾ï¼š</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">| <span class="type">P1</span> | <span class="type">P2</span> | <span class="type">P5</span> | <span class="type">P4</span> | <span class="type">P1</span> | <span class="type">P3</span> |</span><br><span class="line"><span class="type">0</span>    <span class="number">1</span>    <span class="number">5</span>    <span class="number">7</span>    <span class="number">12</span>   <span class="number">21</span>   <span class="number">30</span></span><br></pre></td></tr></table></figure><ul><li>å¹³å‡ç­‰å¾…æ—¶é—´ï¼š$((0+(12-1))+(1-1)+(21-2)+(7-3)+(5-4))\div 5 = 7$</li><li>å¹³å‡å‘¨è½¬æ—¶é—´ï¼š$(21+(5-1)+(30-2)+(12-3)+(7-4))\div 5 = 13$</li><li>å¹³å‡å“åº”æ—¶é—´ï¼š$(0+(1-1)+(21-2)+(7-3)+(5-4))\div 5 = 4.8$</li></ul><h4 id="4-4-ä¼˜å…ˆçº§è°ƒåº¦ï¼ˆéæŠ¢å å¼ï¼‰"><a href="#4-4-ä¼˜å…ˆçº§è°ƒåº¦ï¼ˆéæŠ¢å å¼ï¼‰" class="headerlink" title="4.4 ä¼˜å…ˆçº§è°ƒåº¦ï¼ˆéæŠ¢å å¼ï¼‰"></a>4.4 ä¼˜å…ˆçº§è°ƒåº¦ï¼ˆéæŠ¢å å¼ï¼‰</h4><p>ç”±äºP1å…ˆåˆ°ï¼Œæ‰€ä»¥P1å…ˆæ‰§è¡Œï¼ŒéæŠ¢å å¼</p><p>ç”˜ç‰¹å›¾ï¼š</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">| <span class="type">P1</span> | <span class="type">P4</span> | <span class="type">P3</span> | <span class="type">P5</span> | <span class="type">P2</span> |</span><br><span class="line"><span class="type">0</span>    <span class="number">10</span>   <span class="number">15</span>   <span class="number">24</span>   <span class="number">26</span>   <span class="number">30</span></span><br></pre></td></tr></table></figure><ul><li>å¹³å‡ç­‰å¾…æ—¶é—´ï¼š$(0+(24-1)+(15-2)+(10-3)+(26-4))\div 5 = 13$</li><li>å¹³å‡å‘¨è½¬æ—¶é—´ï¼š$(10+(30-1)+(26-2)+(15-3)+(24-4))\div 5 = 19$</li><li>å¹³å‡å“åº”æ—¶é—´=å¹³å‡ç­‰å¾…æ—¶é—´</li></ul><h4 id="4-5-ä¼˜å…ˆçº§è°ƒåº¦ï¼ˆæŠ¢å å¼ï¼‰"><a href="#4-5-ä¼˜å…ˆçº§è°ƒåº¦ï¼ˆæŠ¢å å¼ï¼‰" class="headerlink" title="4.5 ä¼˜å…ˆçº§è°ƒåº¦ï¼ˆæŠ¢å å¼ï¼‰"></a>4.5 ä¼˜å…ˆçº§è°ƒåº¦ï¼ˆæŠ¢å å¼ï¼‰</h4><p>ç”˜ç‰¹å›¾ï¼š</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">| <span class="type">P1</span> | <span class="type">P4</span> | <span class="type">P1</span> | <span class="type">P3</span> | <span class="type">P5</span> | <span class="type">P2</span> |</span><br><span class="line"><span class="type">0</span>    <span class="number">3</span>    <span class="number">8</span>    <span class="number">15</span>   <span class="number">24</span>   <span class="number">26</span>   <span class="number">30</span></span><br></pre></td></tr></table></figure><ul><li>å¹³å‡ç­‰å¾…æ—¶é—´ï¼š$((0+(8-3))+(26-1)+(15-2)+(4-3)+(24-4))\div 5 = 12.6$</li><li>å¹³å‡å‘¨è½¬æ—¶é—´ï¼š$(15+(30-1)+(24-2)+(8-3)+(26-4))\div 5 = 18.6$</li><li>å¹³å‡å“åº”æ—¶é—´ï¼š$(0+(26-1)+(15-2)+(4-3)+(24-4))\div 5 = 11.6$</li></ul><h4 id="4-6-è½®è½¬è°ƒåº¦ï¼ˆRRï¼‰"><a href="#4-6-è½®è½¬è°ƒåº¦ï¼ˆRRï¼‰" class="headerlink" title="4.6 è½®è½¬è°ƒåº¦ï¼ˆRRï¼‰"></a>4.6 è½®è½¬è°ƒåº¦ï¼ˆRRï¼‰</h4><p>å‡è®¾æ—¶é—´ç‰‡ä¸º2sï¼Œè¿›ç¨‹åˆ°è¾¾å…¥é˜Ÿ ä¼˜å…ˆäº æ—¶é—´ç‰‡åˆ°å…¥é˜Ÿ</p><p>è¿è¡Œæµç¨‹</p><div class="table-container"><table><thead><tr><th style="text-align:center">æ—¶é—´</th><th style="text-align:center">CPUæ‰§è¡Œ</th><th style="text-align:center">å°±ç»ªé˜Ÿåˆ—</th><th style="text-align:center">å¤‡æ³¨</th></tr></thead><tbody><tr><td style="text-align:center">0</td><td style="text-align:center">P1(0/10)</td><td style="text-align:center">[]</td><td style="text-align:center">P1åˆ°è¾¾ï¼ŒP1æ‰§è¡Œ</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">P1(1/10)</td><td style="text-align:center">[P2(0/4) ]</td><td style="text-align:center">P2åˆ°è¾¾ï¼ŒP1ç»§ç»­æ‰§è¡Œ</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">P2(0/4)</td><td style="text-align:center">[P3(0/9), P1(2/10)]</td><td style="text-align:center">P3åˆ°è¾¾ï¼ŒP1æ—¶é—´ç‰‡åˆ°ï¼ŒP2æ‰§è¡Œ</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">P2(1/4)</td><td style="text-align:center">[P3(0/9), P1(2/10), P4(0/5)]</td><td style="text-align:center">P4åˆ°è¾¾ï¼ŒP2ç»§ç»­æ‰§è¡Œ</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">P3(0/9)</td><td style="text-align:center">[P1(2/10), P4(0/5), P5(0/2), P2(2/4)]</td><td style="text-align:center">P5åˆ°è¾¾ï¼ŒP2æ—¶é—´ç‰‡åˆ°ï¼ŒP3æ‰§è¡Œ</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">P1(2/10)</td><td style="text-align:center">[P4(0/5), P5(0/2), P2(2/4), P3(2/9)]</td><td style="text-align:center">P3æ—¶é—´ç‰‡åˆ°ï¼ŒP1æ‰§è¡Œ</td></tr><tr><td style="text-align:center">8</td><td style="text-align:center">P4(0/5)</td><td style="text-align:center">[P5(0/2), P2(2/4), P3(2/9), P1(4/10)]</td><td style="text-align:center">P1æ—¶é—´ç‰‡åˆ°ï¼ŒP4æ‰§è¡Œ</td></tr><tr><td style="text-align:center">10</td><td style="text-align:center">P5(0/2)</td><td style="text-align:center">[P2(2/4), P3(2/9), P1(4/10), P4(2/5)]</td><td style="text-align:center">P4æ—¶é—´ç‰‡åˆ°ï¼ŒP5æ‰§è¡Œ</td></tr><tr><td style="text-align:center">12</td><td style="text-align:center">P2(2/4)</td><td style="text-align:center">[P3(2/9), P1(4/10), P4(2/5)]</td><td style="text-align:center">P5å®Œæˆï¼ŒP2æ‰§è¡Œ</td></tr><tr><td style="text-align:center">14</td><td style="text-align:center">P3(2/9)</td><td style="text-align:center">[P1(4/10), P4(2/5)]</td><td style="text-align:center">P2å®Œæˆï¼ŒP3æ‰§è¡Œ</td></tr><tr><td style="text-align:center">16</td><td style="text-align:center">P1(4/10)</td><td style="text-align:center">[P4(2/5), P3(4/9)]</td><td style="text-align:center">P3æ—¶é—´ç‰‡åˆ°ï¼ŒP1æ‰§è¡Œ</td></tr><tr><td style="text-align:center">18</td><td style="text-align:center">P4(2/5)</td><td style="text-align:center">[P3(4/9), P1(6/10)]</td><td style="text-align:center">P1æ—¶é—´ç‰‡åˆ°ï¼ŒP4æ‰§è¡Œ</td></tr><tr><td style="text-align:center">20</td><td style="text-align:center">P3(4/9)</td><td style="text-align:center">[P1(6/10), P4(4/5)]</td><td style="text-align:center">P4æ—¶é—´ç‰‡åˆ°ï¼ŒP3æ‰§è¡Œ</td></tr><tr><td style="text-align:center">22</td><td style="text-align:center">P1(6/10)</td><td style="text-align:center">[P4(4/5), P3(6/9)]</td><td style="text-align:center">P3æ—¶é—´ç‰‡åˆ°ï¼ŒP1æ‰§è¡Œ</td></tr><tr><td style="text-align:center">24</td><td style="text-align:center">P4(4/5)</td><td style="text-align:center">[P3(6/9), P1(8/10)]</td><td style="text-align:center">P1æ—¶é—´ç‰‡åˆ°ï¼ŒP4æ‰§è¡Œ</td></tr><tr><td style="text-align:center">25</td><td style="text-align:center">P3(6/9)</td><td style="text-align:center">[P1(8/10) ]</td><td style="text-align:center">P4å®Œæˆï¼ŒP3æ‰§è¡Œ</td></tr><tr><td style="text-align:center">27</td><td style="text-align:center">P1(8/10)</td><td style="text-align:center">[P3(8/9) ]</td><td style="text-align:center">P3æ—¶é—´ç‰‡åˆ°ï¼ŒP1æ‰§è¡Œ</td></tr><tr><td style="text-align:center">29</td><td style="text-align:center">P3(8/9)</td><td style="text-align:center">[]</td><td style="text-align:center">P1å®Œæˆï¼ŒP3æ‰§è¡Œ</td></tr><tr><td style="text-align:center">30</td><td style="text-align:center">P3(9/9)</td><td style="text-align:center">[]</td><td style="text-align:center">P3å®Œæˆï¼Œæ‰€æœ‰è¿›ç¨‹æ‰§è¡Œå®Œæ¯•</td></tr></tbody></table></div><p>ç”˜ç‰¹å›¾ï¼š</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">| <span class="type">P1</span> | <span class="type">P2</span> | <span class="type">P3</span> | <span class="type">P1</span> | <span class="type">P4</span> | <span class="type">P5</span> | <span class="type">P2</span> | <span class="type">P3</span> | <span class="type">P1</span> | <span class="type">P4</span> | <span class="type">P3</span> | <span class="type">P1</span> | <span class="type">P4</span> | <span class="type">P3</span> | <span class="type">P1</span> | <span class="type">P3</span> |</span><br><span class="line"><span class="type">0</span>    <span class="number">2</span>    <span class="number">4</span>    <span class="number">6</span>    <span class="number">8</span>    <span class="number">10</span>   <span class="number">12</span>   <span class="number">14</span>   <span class="number">16</span>   <span class="number">18</span>   <span class="number">20</span>   <span class="number">22</span>   <span class="number">24</span>   <span class="number">25</span>   <span class="number">27</span>   <span class="number">29</span>   <span class="number">30</span></span><br></pre></td></tr></table></figure><ul><li>å¹³å‡ç­‰å¾…æ—¶é—´=å‘¨è½¬æ—¶é—´-æ‰§è¡Œæ—¶é—´=$((29-0-10)+(14-1-4)+(30-2-9)+(23-3-5)+(25-4-2))/5=14$</li><li>å¹³å‡å‘¨è½¬æ—¶é—´=$(29+(14-1)+(30-2)+(23-3)+(25-4))/5=20$</li><li>å¹³å‡å“åº”æ—¶é—´=$(0+(2-1)+(4-2)+(8-3)+(10-4))/5=2.8$</li></ul><h2 id="å…­ã€è¿›ç¨‹åŒæ­¥"><a href="#å…­ã€è¿›ç¨‹åŒæ­¥" class="headerlink" title="å…­ã€è¿›ç¨‹åŒæ­¥"></a>å…­ã€è¿›ç¨‹åŒæ­¥</h2><h3 id="1-ç«äº‰æ¡ä»¶"><a href="#1-ç«äº‰æ¡ä»¶" class="headerlink" title="1. ç«äº‰æ¡ä»¶"></a>1. ç«äº‰æ¡ä»¶</h3><p>å¤šä¸ªè¿›ç¨‹å¹¶å‘è®¿é—®å’Œæ“ä½œåŒä¸€æ•°æ®æ—¶ï¼Œæ‰§è¡Œç»“æœå’Œè®¿é—®å‘ç”Ÿçš„ç‰¹å®šé¡ºåºæœ‰å…³ï¼Œè¿™ç§æƒ…å†µç§°ä¸ºç«äº‰æ¡ä»¶ã€‚</p><p>ä¾‹å¦‚ï¼šèµ‹å€¼è¯­å¥å’Œè‡ªå¢è¯­å¥</p><h3 id="2-ä¸´ç•ŒåŒºé—®é¢˜"><a href="#2-ä¸´ç•ŒåŒºé—®é¢˜" class="headerlink" title="2. ä¸´ç•ŒåŒºé—®é¢˜"></a>2. ä¸´ç•ŒåŒºé—®é¢˜</h3><p>ä¸´ç•ŒåŒº(Critical Section)ï¼šå¹¶å‘è¿‡ç¨‹ä¸­å¯èƒ½è®¿é—®/ä¿®æ”¹å…±äº«æ•°æ®çš„ä»£ç æ®µã€‚</p><p>ä¸´ç•ŒåŒºé—®é¢˜ï¼šç¡®ä¿åœ¨ä»»ä½•æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªè¿›ç¨‹å¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºã€‚</p><p>è§£å†³ä¸´ç•ŒåŒºé—®é¢˜å¿…é¡»æ»¡è¶³çš„3ä¸ªæ¡ä»¶ï¼š</p><ol><li>äº’æ–¥ï¼šè¿›ç¨‹åœ¨ä¸´ç•ŒåŒºï¼Œå…¶ä»–è¿›ç¨‹ä¸èƒ½è¿›å…¥ä¸´ç•ŒåŒº</li><li>å‰è¿›ï¼šæ²¡æœ‰è¿›ç¨‹åœ¨ä¸´ç•ŒåŒºï¼Œå…è®¸å…¶ä»–è¿›ç¨‹è¿›å…¥ä¸´ç•ŒåŒºï¼Œä¸èƒ½æ— é™ç­‰å¾…</li><li>æœ‰é™ç­‰å¾…ï¼šä»ä¸€ä¸ªè¿›ç¨‹ä½œå‡ºè¿›å…¥ä¸´ç•ŒåŒºçš„è¯·æ±‚åˆ°è¯¥è¿›ç¨‹è¿›å…¥ä¸´ç•ŒåŒºä¹‹é—´ï¼Œå…¶ä»–è¿›ç¨‹è¿›å…¥ä¸´ç•ŒåŒºçš„è¯·æ±‚ä¸ªæ•°æœ‰é™</li></ol><p>å¿™åˆ™ç­‰å¾…ï¼›ç©ºåˆ™è®©è¿›ï¼›ç­‰åˆ™æœ‰é™ï¼›ç­‰åˆ™è®©æƒ</p><h3 id="3-Petersonç®—æ³•"><a href="#3-Petersonç®—æ³•" class="headerlink" title="3. Petersonç®—æ³•"></a>3. Petersonç®—æ³•</h3><p>é€‚ç”¨äºä¸¤ä¸ªè¿›ç¨‹çš„ä¸´ç•ŒåŒºé—®é¢˜ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> flag[<span class="number">2</span>] = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;; <span class="comment">// è¡¨ç¤ºå“ªä¸ªè¿›ç¨‹æƒ³è¦è¿›å…¥ä¸´ç•ŒåŒº,é»˜è®¤ä¸ºfalse</span></span><br><span class="line"><span class="type">int</span> turn; <span class="comment">// è¡¨ç¤ºå½“å‰è½®åˆ°å“ªä¸ªè¿›ç¨‹è¿›å…¥ä¸´ç•ŒåŒº</span></span><br><span class="line"><span class="comment">// P0</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">    flag[<span class="number">0</span>] = <span class="number">1</span>; <span class="comment">// è¡¨ç¤ºè¿›ç¨‹0æƒ³è¿›å…¥ä¸´ç•ŒåŒº</span></span><br><span class="line">    turn = <span class="number">1</span>; <span class="comment">// è®©è¿›ç¨‹1å…ˆè¿›å…¥ä¸´ç•ŒåŒºï¼ˆç­‰åˆ™è®©æƒï¼‰</span></span><br><span class="line">    <span class="keyword">while</span>(flag[<span class="number">1</span>] &amp;&amp; turn == <span class="number">1</span>); <span class="comment">// ç­‰å¾…è¿›ç¨‹1é€€å‡ºä¸´ç•ŒåŒº</span></span><br><span class="line">    <span class="comment">// ä¸´ç•ŒåŒºä»£ç </span></span><br><span class="line">    flag[<span class="number">0</span>] = <span class="number">0</span>; <span class="comment">// é€€å‡ºä¸´ç•ŒåŒº</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// P1</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">    flag[<span class="number">1</span>] = <span class="number">1</span>; <span class="comment">// è¡¨ç¤ºè¿›ç¨‹1æƒ³è¿›å…¥ä¸´ç•ŒåŒº</span></span><br><span class="line">    turn = <span class="number">0</span>; <span class="comment">// è®©è¿›ç¨‹0å…ˆè¿›å…¥ä¸´ç•ŒåŒº</span></span><br><span class="line">    <span class="keyword">while</span>(flag[<span class="number">0</span>] &amp;&amp; turn == <span class="number">0</span>); <span class="comment">// ç­‰å¾…è¿›ç¨‹0é€€å‡ºä¸´ç•ŒåŒº</span></span><br><span class="line">    <span class="comment">// ä¸´ç•ŒåŒºä»£ç </span></span><br><span class="line">    flag[<span class="number">1</span>] = <span class="number">0</span>; <span class="comment">// é€€å‡ºä¸´ç•ŒåŒº</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-ç¡¬ä»¶åŒæ­¥"><a href="#4-ç¡¬ä»¶åŒæ­¥" class="headerlink" title="4. ç¡¬ä»¶åŒæ­¥"></a>4. ç¡¬ä»¶åŒæ­¥</h3><p>è®¸å¤šç³»ç»Ÿä¸ºè§£å†³ä¸´ç•ŒåŒºé—®é¢˜æä¾›äº†ç¡¬ä»¶æ”¯æŒ</p><ol><li>ä¿®æ”¹å…±äº«å˜é‡ç¦æ­¢ä¸­æ–­<ul><li>æ­£åœ¨è¿è¡Œçš„æŒ‡ä»¤ä¸è¢«å…¶ä»–æŒ‡ä»¤æŠ¢å CPU</li><li>é€‚ç”¨äºå•å¤„ç†å™¨ç¯å¢ƒï¼ŒéæŠ¢å å†…æ ¸ï¼ˆä¸å…è®¸å†…æ ¸æ¨¡å¼è¿›ç¨‹è¢«æŠ¢å ï¼ŒåŒæ—¶åˆ»åªæœ‰ä¸€ä¸ªå†…æ ¸æ¨¡å¼è¿›ç¨‹ï¼‰ </li></ul></li><li>ä½¿ç”¨åŸå­æ“ä½œï¼šä¸èƒ½è¢«ä¸­æ–­çš„åŸå­æŒ‡ä»¤</li></ol><h3 id="5-ä¿¡å·é‡-Semaphore"><a href="#5-ä¿¡å·é‡-Semaphore" class="headerlink" title="5. ä¿¡å·é‡(Semaphore)"></a>5. ä¿¡å·é‡(Semaphore)</h3><p>ä¿¡å·é‡æ˜¯ä¸€ç§ä¸éœ€è¦å¿™ç­‰çš„è¿›ç¨‹åŒæ­¥æœºåˆ¶ï¼ˆç©ºåˆ™è®©è¿›ï¼‰ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªæ•´æ•°å˜é‡ã€‚</p><p>é™¤åˆå§‹åŒ–å¤–ï¼Œåªèƒ½é€šè¿‡ä¸¤ä¸ªåŸå­æ“ä½œæ¥ä¿®æ”¹ï¼šPï¼ˆwaitï¼‰å’ŒVï¼ˆsignalï¼‰ã€‚</p><ul><li>Pæ“ä½œï¼šå¦‚æœä¿¡å·é‡å€¼å¤§äº0ï¼Œåˆ™å°†å…¶å‡1å¹¶ç»§ç»­æ‰§è¡Œï¼›å¦‚æœä¿¡å·é‡å€¼ä¸º0ï¼Œåˆ™é˜»å¡è¿›ç¨‹ï¼Œç›´åˆ°ä¿¡å·é‡å€¼å¤§äº0ã€‚</li><li>Væ“ä½œï¼šå°†ä¿¡å·é‡å€¼åŠ 1ï¼Œå¦‚æœæœ‰è¿›ç¨‹åœ¨ç­‰å¾…ï¼Œåˆ™å”¤é†’ä¸€ä¸ªç­‰å¾…çš„è¿›ç¨‹ã€‚</li></ul><p>ä¿¡å·é‡åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š</p><ol><li>äºŒè¿›åˆ¶ä¿¡å·é‡ï¼ˆBinary Semaphoreï¼‰ï¼šå€¼åªèƒ½ä¸º0æˆ–1ï¼Œé€šå¸¸ç”¨äºäº’æ–¥è®¿é—®ä¸´ç•ŒåŒºï¼Œåˆè¢«ç§°ä¸ºäº’æ–¥é”ï¼ˆMutexï¼‰ã€‚</li><li>è®¡æ•°ä¿¡å·é‡ï¼ˆCounting Semaphoreï¼‰ï¼šå€¼å¯ä»¥ä¸ºä»»æ„éè´Ÿæ•´æ•°ï¼Œé€šå¸¸ç”¨äºæ§åˆ¶å¯¹æœ‰é™èµ„æºçš„è®¿é—®ã€‚</li></ol><p>å®ç°æ–¹æ¡ˆï¼šå¿™ç­‰å®ç°ï¼ˆS&gt;=0ï¼‰å’Œé˜»å¡å®ç°ï¼ˆSå¯ä»¥ä¸ºè´Ÿæ•°ï¼Œç»å¯¹å€¼è¡¨ç¤ºç­‰å¾…çš„è¿›ç¨‹æ•°ï¼‰ã€‚</p><p>å¿™ç­‰å®ç°-è‡ªæ—‹é”(Spinlock)ï¼š</p><ul><li>å½“ä¸€ä¸ªè¿›ç¨‹ä½äºå…¶ä¸´ç•ŒåŒºæ—¶ï¼Œå…¶å®ƒä»»ä½•è¯•å›¾è¿›å…¥ä¸´ç•ŒåŒºçš„è¿›ç¨‹éƒ½å¿…é¡»åœ¨å…¶è¿›å…¥åŒºçš„ä»£ç ä¸­è¿ç»­å¾ªç¯</li><li>ä¸ç”¨é˜»å¡è¿›ç¨‹ã€ä¸å¿…ä¸Šä¸‹æ–‡åˆ‡æ¢</li><li>ä¸´ç•ŒåŒºä»£ç çŸ­æ—¶æ•ˆç‡é«˜</li><li>é€‚åˆå¤šå¤„ç†å™¨ç¯å¢ƒï¼ˆå•å¤„ç†å™¨å¯ä»¥é€šè¿‡ç®€å•çš„ç¦æ­¢ä¸­æ–­å®ç°waitå’Œsignalçš„åŸå­æ‰§è¡Œï¼‰</li><li>å•å¤„ç†å™¨ç³»ç»Ÿå¿™ç­‰æ—¶ä¸ä¼šé‡Šæ”¾CPUï¼Œä¹Ÿæ²¡æœ‰å…¶ä»–è¿›ç¨‹èƒ½å¤Ÿè¿è¡Œä»¥è·å¾—CPUæ§åˆ¶æƒ</li></ul><h3 id="6-æ­»é”å’Œé¥¥é¥¿"><a href="#6-æ­»é”å’Œé¥¥é¥¿" class="headerlink" title="6. æ­»é”å’Œé¥¥é¥¿"></a>6. æ­»é”å’Œé¥¥é¥¿</h3><p>æ­»é”ï¼ˆDeadlockï¼‰ï¼šä¸¤ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹äº’ç›¸ç­‰å¾…å¯¹æ–¹é‡Šæ”¾èµ„æºï¼Œå¯¼è‡´æ‰€æœ‰è¿›ç¨‹éƒ½æ— æ³•ç»§ç»­æ‰§è¡Œã€‚</p><p>é¥¥é¥¿ï¼ˆStarvationï¼‰ï¼šè¿›ç¨‹æ— é™ç­‰å¾…ä¿¡å·é‡ã€‚å¯¹ä¿¡å·é‡æœ‰å…³çš„é“¾è¡¨LIFOé¡ºåºå¢åˆ è¿›ç¨‹å¯èƒ½å¯¼è‡´ã€‚</p><h3 id="7-ç»å…¸åŒæ­¥é—®é¢˜"><a href="#7-ç»å…¸åŒæ­¥é—®é¢˜" class="headerlink" title="7. ç»å…¸åŒæ­¥é—®é¢˜"></a>7. ç»å…¸åŒæ­¥é—®é¢˜</h3><h4 id="7-1-å­˜åœ¨å…ˆåå…³ç³»çš„ç®€å•åŒæ­¥é—®é¢˜"><a href="#7-1-å­˜åœ¨å…ˆåå…³ç³»çš„ç®€å•åŒæ­¥é—®é¢˜" class="headerlink" title="7.1 å­˜åœ¨å…ˆåå…³ç³»çš„ç®€å•åŒæ­¥é—®é¢˜"></a>7.1 å­˜åœ¨å…ˆåå…³ç³»çš„ç®€å•åŒæ­¥é—®é¢˜</h4><p>å°†ä¸åŒè¿›ç¨‹é—´çš„ä»£ç å—çš„æ‰§è¡Œé¡ºåºè§†ä¸ºDAGï¼Œè¿›è¡Œæ‹“æ‰‘æ’åºï¼š</p><p><img src="https://source.cclmsy.cc/posts/notes/course/operating_system/image-2.png" alt="alt text"></p><p>è®°ä¿¡å·é‡<code>Sij</code>è¡¨ç¤ºè¿›ç¨‹<code>j</code>ç­‰å¾…è¿›ç¨‹<code>i</code>çš„ä¿¡å·é‡ï¼ˆè¿›ç¨‹<code>i</code>æ‰§è¡Œå®Œåæ‰èƒ½æ‰§è¡Œè¿›ç¨‹<code>j</code>ï¼‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// P1</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">    wait(S21);</span><br><span class="line">    <span class="comment">// ä¸´ç•ŒåŒº1ä»£ç </span></span><br><span class="line">    signal(S15);</span><br><span class="line"></span><br><span class="line">    wait(S54);</span><br><span class="line">    <span class="comment">// ä¸´ç•ŒåŒº4ä»£ç </span></span><br><span class="line">    signal(S47);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// P2</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="comment">// ä»£ç å—2</span></span><br><span class="line">    signal(S21);</span><br><span class="line">    </span><br><span class="line">    wait(S15);</span><br><span class="line">    wait(S35);</span><br><span class="line">    <span class="comment">// ä¸´ç•ŒåŒº5ä»£ç </span></span><br><span class="line">    signal(S54);</span><br><span class="line">    signal(S56);</span><br><span class="line"></span><br><span class="line">    wait(S47);</span><br><span class="line">    wait(S67);</span><br><span class="line">    <span class="comment">// ä»£ç å—7</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// P3ç•¥</span></span><br></pre></td></tr></table></figure><h4 id="7-2-ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜"><a href="#7-2-ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜" class="headerlink" title="7.2 ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜"></a>7.2 ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜</h4><p>ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜æ˜¯ç»å…¸çš„è¿›ç¨‹åŒæ­¥é—®é¢˜ï¼Œæ¶‰åŠåˆ°ä¸¤ä¸ªè¿›ç¨‹ï¼šç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ã€‚</p><p>ç”Ÿäº§è€…è¿›ç¨‹ç”Ÿæˆæ•°æ®å¹¶å°†å…¶æ”¾å…¥ç¼“å†²åŒºï¼Œæ¶ˆè´¹è€…è¿›ç¨‹ä»ç¼“å†²åŒºä¸­å–å‡ºæ•°æ®è¿›è¡Œå¤„ç†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”Ÿäº§è€…</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">    wait(empty); <span class="comment">// ç­‰å¾…ç¼“å†²åŒºæœ‰ç©ºä½</span></span><br><span class="line"></span><br><span class="line">    wait(mutex); <span class="comment">// è¿›å…¥ä¸´ç•ŒåŒº</span></span><br><span class="line">    buffer[in] = produce_item(); <span class="comment">// ç”Ÿäº§ä¸€ä¸ªé¡¹ç›®</span></span><br><span class="line">    in = (in + <span class="number">1</span>) % N; <span class="comment">// æ›´æ–°è¾“å…¥æŒ‡é’ˆ</span></span><br><span class="line">    signal(mutex); <span class="comment">// ç¦»å¼€ä¸´ç•ŒåŒº</span></span><br><span class="line"></span><br><span class="line">    signal(full); <span class="comment">// å¢åŠ ç¼“å†²åŒºæ»¡çš„è®¡æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">    wait(full); <span class="comment">// ç­‰å¾…ç¼“å†²åŒºæœ‰é¡¹ç›®</span></span><br><span class="line"></span><br><span class="line">    wait(mutex); <span class="comment">// è¿›å…¥ä¸´ç•ŒåŒº</span></span><br><span class="line">    consume_item(buffer[out]); <span class="comment">// æ¶ˆè´¹ä¸€ä¸ªé¡¹ç›®</span></span><br><span class="line">    out = (out + <span class="number">1</span>) % N; <span class="comment">// æ›´æ–°è¾“å‡ºæŒ‡é’ˆ</span></span><br><span class="line">    signal(mutex); <span class="comment">// ç¦»å¼€ä¸´ç•ŒåŒº</span></span><br><span class="line"></span><br><span class="line">    signal(empty); <span class="comment">// å¢åŠ ç¼“å†²åŒºç©ºçš„è®¡æ•°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="7-3-è¯»è€…-å†™è€…é—®é¢˜"><a href="#7-3-è¯»è€…-å†™è€…é—®é¢˜" class="headerlink" title="7.3 è¯»è€…-å†™è€…é—®é¢˜"></a>7.3 è¯»è€…-å†™è€…é—®é¢˜</h4><p>è¯»è€…-å†™è€…é—®é¢˜æ˜¯ç»å…¸çš„è¿›ç¨‹åŒæ­¥é—®é¢˜ï¼Œæ¶‰åŠåˆ°å¤šä¸ªè¯»è€…å’Œä¸€ä¸ªå†™è€…ã€‚</p><ul><li>è¯»è€…ï¼šå¹¶å‘è¯»å–æ•°æ®ï¼Œä¸ä¿®æ”¹æ•°æ®</li><li>å†™è€…ï¼šç‹¬å è®¿é—®æ•°æ®ï¼Œä¿®æ”¹æ•°æ®</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¯»è€…</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">    wait(read_mutex); <span class="comment">// è¿›å…¥è¯»è€…ä¸´ç•ŒåŒº</span></span><br><span class="line">    read_count++; <span class="comment">// å¢åŠ è¯»è€…è®¡æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (read_count == <span class="number">1</span>) wait(write_mutex); <span class="comment">// ç¬¬ä¸€ä¸ªè¯»è€…é˜»å¡å†™è€…</span></span><br><span class="line">    signal(read_mutex); <span class="comment">// ç¦»å¼€è¯»è€…ä¸´ç•ŒåŒº</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¯»å–æ•°æ®</span></span><br><span class="line">    read_data();</span><br><span class="line"></span><br><span class="line">    wait(read_mutex); <span class="comment">// è¿›å…¥è¯»è€…ä¸´ç•ŒåŒº</span></span><br><span class="line">    read_count--; <span class="comment">// å‡å°‘è¯»è€…è®¡æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (read_count == <span class="number">0</span>) signal(write_mutex); <span class="comment">// æœ€åä¸€ä¸ªè¯»è€…é‡Šæ”¾å†™è€…</span></span><br><span class="line">    signal(read_mutex); <span class="comment">// ç¦»å¼€è¯»è€…ä¸´ç•ŒåŒº</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å†™è€…</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">    wait(write_mutex); <span class="comment">// è¿›å…¥å†™è€…ä¸´ç•ŒåŒº</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å†™å…¥æ•°æ®</span></span><br><span class="line">    write_data();</span><br><span class="line"></span><br><span class="line">    signal(write_mutex); <span class="comment">// ç¦»å¼€å†™è€…ä¸´ç•ŒåŒº</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿›ä¸€æ­¥çš„ï¼š</p><ul><li>è¯»è€…ä¼˜å…ˆï¼šç›´åˆ°æ— è¯»è€…ç­‰å¾…ï¼Œå†™è€…æ‰èƒ½è¿›å…¥ä¸´ç•ŒåŒº</li><li>å†™è€…ä¼˜å…ˆï¼šæœ‰å†™è€…ç­‰å¾…æ—¶ï¼Œè¯»è€…ä¸èƒ½è¿›å…¥ä¸´ç•ŒåŒº</li></ul><h4 id="7-4-å“²å­¦å®¶å°±é¤é—®é¢˜"><a href="#7-4-å“²å­¦å®¶å°±é¤é—®é¢˜" class="headerlink" title="7.4 å“²å­¦å®¶å°±é¤é—®é¢˜"></a>7.4 å“²å­¦å®¶å°±é¤é—®é¢˜</h4><p>å“²å­¦å®¶å°±é¤é—®é¢˜æ˜¯ç»å…¸çš„è¿›ç¨‹åŒæ­¥é—®é¢˜ï¼Œæ¶‰åŠåˆ°5ä¸ªå“²å­¦å®¶å’Œ5ä¸ªå‰å­ã€‚</p><p>å¦‚æœæ‰€æœ‰å“²å­¦å®¶éƒ½æ‹¿èµ·å·¦è¾¹çš„å‰å­ï¼Œé‚£ä¹ˆå°±ä¼šå‘ç”Ÿæ­»é”ã€‚</p><p>è§£å†³æ€è·¯ï¼š</p><ol><li>å½“4ä¸ªå‰å­è¢«æ‹¿èµ·æ—¶ï¼Œæ²¡æœ‰å‰å­çš„å“²å­¦å®¶ä¸èƒ½æ‹¿èµ·å‰å­</li><li>ä»»ä¸€å“²å­¦å®¶æ‹¿èµ·ä¸¤ä¸ªå‰å­å‰æ—¶ï¼Œå…¶ä»–å“²å­¦å®¶ä¸èƒ½æ‹¿èµ·å‰å­</li><li>â€¦</li></ol><h2 id="ä¸ƒã€æ­»é”-Deadlock"><a href="#ä¸ƒã€æ­»é”-Deadlock" class="headerlink" title="ä¸ƒã€æ­»é”(Deadlock)"></a>ä¸ƒã€æ­»é”(Deadlock)</h2><h3 id="1-æ­»é”çš„4ä¸ªå¿…è¦æ¡ä»¶"><a href="#1-æ­»é”çš„4ä¸ªå¿…è¦æ¡ä»¶" class="headerlink" title="1. æ­»é”çš„4ä¸ªå¿…è¦æ¡ä»¶"></a>1. æ­»é”çš„4ä¸ªå¿…è¦æ¡ä»¶</h3><ol><li>äº’æ–¥ï¼šè‡³å°‘æœ‰ä¸€ä¸ªèµ„æºä¸èƒ½å…±äº«</li><li>å æœ‰å¹¶ç­‰å¾…ï¼šä¸€ä¸ªè¿›ç¨‹è‡³å°‘æŒæœ‰ä¸€ä¸ªèµ„æºï¼Œå¹¶ç­‰å¾…å…¶ä»–èµ„æºï¼ˆè¢«å…¶ä»–è¿›ç¨‹æŒæœ‰ï¼‰</li><li>éæŠ¢å ï¼šèµ„æºä¸èƒ½è¢«æŠ¢å ï¼Œåªèƒ½ç”±æŒæœ‰è¯¥èµ„æºçš„è¿›ç¨‹é‡Šæ”¾</li><li>å¾ªç¯ç­‰å¾…ï¼šå­˜åœ¨ä¸€ä¸ªè¿›ç¨‹ç­‰å¾…ç¯ï¼Œå…¶ä¸­æ¯ä¸ªè¿›ç¨‹éƒ½åœ¨ç­‰å¾…ä¸‹ä¸€ä¸ªè¿›ç¨‹æŒæœ‰çš„èµ„æº</li></ol><p>å¿…é¡»åŒæ—¶æ»¡è¶³è¿™å››ä¸ªæ¡ä»¶æ‰èƒ½å‘ç”Ÿæ­»é”ã€‚</p><h4 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h4><p>å‡è®¾æœ‰4ä¸ªç›¸åŒç±»å‹çš„èµ„æºè¢«3ä¸ªè¿›ç¨‹å…±äº«ï¼Œæ¯ä¸ªè¿›ç¨‹æœ€å¤šéœ€è¦2ä¸ªèµ„æºï¼Œè¯•è¯æ˜è¿™ä¸ªç³»ç»Ÿä¸ä¼šæ­»é”ã€‚</p><p>åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œå³ä½¿æ‰€æœ‰è¿›ç¨‹éƒ½æŒæœ‰æœ€å¤§â€œä¸å®Œå…¨â€èµ„æºï¼ˆæ¯ä¸ªè¿›ç¨‹1ä¸ªèµ„æºï¼‰ï¼Œç³»ç»Ÿä¸­ä¹Ÿæ€»ä¼šå‰©ä¸‹è‡³å°‘1ä¸ªèµ„æºã€‚è¿™ä¸ªå‰©ä½™çš„èµ„æºè¶³ä»¥è®©å…¶ä¸­ä¸€ä¸ªè¿›ç¨‹è·å¾—å¹¶å®Œæˆä»»åŠ¡ï¼Œç„¶åé‡Šæ”¾å…¶å æœ‰çš„èµ„æºã€‚</p><p>éšç€èµ„æºçš„é‡Šæ”¾ï¼Œå…¶ä»–è¢«é˜»å¡çš„è¿›ç¨‹ä¹Ÿèƒ½ä¾æ¬¡è·å¾—èµ„æºå¹¶å®Œæˆä»»åŠ¡ã€‚</p><p>å› æ­¤ï¼Œç³»ç»Ÿæ°¸è¿œä¸ä¼šè¿›å…¥æ‰€æœ‰è¿›ç¨‹éƒ½æ— æ³•ç»§ç»­æ‰§è¡Œçš„æ­»é”çŠ¶æ€ã€‚</p><h3 id="2-èµ„æºåˆ†é…å›¾"><a href="#2-èµ„æºåˆ†é…å›¾" class="headerlink" title="2. èµ„æºåˆ†é…å›¾"></a>2. èµ„æºåˆ†é…å›¾</h3><p>æ–¹å½¢Rè¡¨ç¤ºèµ„æºï¼Œå†…éƒ¨ç‚¹ä¸ªæ•°è¡¨ç¤ºèµ„æºæ•°é‡ï¼›åœ†å½¢Pè¡¨ç¤ºè¿›ç¨‹ã€‚</p><ul><li>P-&gt;Rï¼šè¡¨ç¤ºè¿›ç¨‹Pè¯·æ±‚èµ„æºR</li><li>R-&gt;Pï¼šè¡¨ç¤ºèµ„æºRè¢«è¿›ç¨‹På ç”¨</li></ul><p><img src="https://source.cclmsy.cc/posts/notes/course/operating_system/image-3.png" alt="alt text"></p><p>æ­»é”åˆ¤æ–­ï¼š</p><ol><li>æ ¹æ®èµ„æºRçš„å‡ºè¾¹ï¼Œåˆ’æ‰å·²è¢«åˆ†é…çš„èµ„æº</li><li>æ‰¾åˆ°ä¸€ä¸ªè¿›ç¨‹Pï¼Œå…¶æ‰€æœ‰è¯·æ±‚ï¼ˆå‡ºè¾¹ï¼‰éƒ½å¯è¢«æ»¡è¶³</li><li>é‡Šæ”¾è¿›ç¨‹På ç”¨çš„èµ„æºRï¼Œå¹¶å°†å…¶è¾¹ä»å›¾ä¸­åˆ é™¤</li><li>é‡å¤æ­¥éª¤2å’Œ3ï¼Œç›´åˆ°æ²¡æœ‰è¿›ç¨‹æ»¡è¶³æ¡ä»¶æˆ–æ‰€æœ‰è¿›ç¨‹éƒ½è¢«é‡Šæ”¾</li></ol><h3 id="3-æ­»é”çš„é¢„é˜²"><a href="#3-æ­»é”çš„é¢„é˜²" class="headerlink" title="3. æ­»é”çš„é¢„é˜²"></a>3. æ­»é”çš„é¢„é˜²</h3><p>å¦å®šæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶ä¹‹ä¸€ï¼š</p><ol><li>äº’æ–¥ï¼šéå…±äº«èµ„æºå¿…é¡»è¦æœ‰äº’æ–¥æ¡ä»¶ï¼Œä¸èƒ½å¦å®š</li><li>å æœ‰å¹¶ç­‰å¾…ï¼šé™ä½èµ„æºåˆ©ç”¨ç‡ï¼Œå¹¶ä¸”å¯èƒ½å¯¼è‡´é¥¥é¥¿<ol><li>æ‰§è¡Œå‰å¿…é¡»ç”³è¯·åˆ°æ‰€æœ‰èµ„æº</li><li>ç”³è¯·æ–°èµ„æºå‰å¿…é¡»é‡Šæ”¾æ‰€æœ‰å·²å æœ‰çš„èµ„æº</li></ol></li><li>éæŠ¢å ï¼šä½¿ç”¨èŒƒå›´æœ‰é™ï¼Œåªèƒ½ç”¨äºå¯ä¿å­˜å’Œæ¢å¤çš„èµ„æºï¼ˆå¯„å­˜å™¨ã€å†…å­˜ç­‰ï¼‰<ol><li>å¦‚æœä¸€ä¸ªè¿›ç¨‹ç”³è¯·çš„èµ„æºä¸èƒ½ç«‹åˆ»åˆ†é…ï¼Œå·²åˆ†é…èµ„æºå¯è¢«æŠ¢å </li></ol></li><li>å¾ªç¯ç­‰å¾…ï¼šå¯¹æ‰€æœ‰èµ„æºçš„ç±»å‹è¿›è¡Œå®Œå…¨æ’åºï¼Œè¦æ±‚æ¯ä¸ªè¿›ç¨‹æŒ‰é€’å¢é¡ºåºç”³è¯·èµ„æº</li></ol><h3 id="4-æ­»é”çš„é¿å…"><a href="#4-æ­»é”çš„é¿å…" class="headerlink" title="4. æ­»é”çš„é¿å…"></a>4. æ­»é”çš„é¿å…</h3><p>å®‰å…¨çŠ¶æ€ï¼šå­˜åœ¨ä¸€ç§é¡ºåºä¸ºæ‰€æœ‰è¿›ç¨‹åˆ†é…èµ„æºï¼Œèƒ½å¤Ÿé¿å…æ­»é”</p><h4 id="4-1-èµ„æºåˆ†é…å›¾ç®—æ³•"><a href="#4-1-èµ„æºåˆ†é…å›¾ç®—æ³•" class="headerlink" title="4.1 èµ„æºåˆ†é…å›¾ç®—æ³•"></a>4.1 èµ„æºåˆ†é…å›¾ç®—æ³•</h4><p>[èµ„æºåˆ†é…å›¾]ç®—æ³•(#2-èµ„æºåˆ†é…å›¾)é€‚ç”¨äºæ¯ç§èµ„æºç±»å‹åªæœ‰ä¸€ä¸ªå®ä¾‹çš„æƒ…å†µï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯æ£€æµ‹å›¾ä¸­æ˜¯å¦å­˜åœ¨ç¯è·¯ã€‚</p><p>ç®—æ³•æœºåˆ¶ï¼š</p><ol><li>é™¤ç”³è¯·è¾¹å’Œåˆ†é…è¾¹å¤–ï¼Œå¼•å…¥ä¸€ç§æ–°ç±»å‹çš„è¾¹ï¼Œç§°ä¸ºéœ€æ±‚è¾¹ã€‚<ul><li>éœ€æ±‚è¾¹Pi-&gt;Rj è¡¨ç¤ºè¿›ç¨‹Piå¯èƒ½åœ¨å°†æ¥æŸä¸ªæ—¶å€™ç”³è¯·èµ„æºRjã€‚</li><li>éœ€æ±‚è¾¹ç±»ä¼¼äºç”³è¯·è¾¹ï¼Œä½†ç”¨è™šçº¿è¡¨ç¤ºã€‚</li></ul></li><li>å½“è¿›ç¨‹ç”³è¯·èµ„æºæ—¶ï¼Œéœ€æ±‚è¾¹å˜æˆç”³è¯·è¾¹ã€‚</li><li>å½“èµ„æºåˆ†é…ç»™è¿›ç¨‹æ—¶ï¼Œç”³è¯·è¾¹å˜æˆåˆ†é…è¾¹ã€‚</li><li>å½“è¿›ç¨‹é‡Šæ”¾èµ„æºæ—¶ï¼Œåˆ†é…è¾¹å˜æˆéœ€æ±‚è¾¹ã€‚</li><li>ç³»ç»Ÿå¿…é¡»äº‹å…ˆè¦æ±‚èµ„æºï¼Œå³å½“è¿›ç¨‹Piå¼€å§‹æ‰§è¡Œæ—¶ï¼Œæ‰€æœ‰éœ€æ±‚è¾¹å¿…é¡»å¤„äºèµ„æºåˆ†é…å›¾ã€‚</li></ol><p>å‡è®¾è¿›ç¨‹Piç”³è¯·èµ„æºRjï¼Œåªæœ‰åœ¨å°†ç”³è¯·è¾¹Pi-&gt;Rjå˜æˆåˆ†é…è¾¹Rj-&gt;Piï¼Œä¸”ä¸ä¼šå¯¼è‡´èµ„æºåˆ†é…å›¾å½¢æˆç¯æ—¶æ‰å…è®¸ç”³è¯·ã€‚</p><h4 id="4-2-é“¶è¡Œå®¶ç®—æ³•"><a href="#4-2-é“¶è¡Œå®¶ç®—æ³•" class="headerlink" title="4.2 é“¶è¡Œå®¶ç®—æ³•"></a>4.2 é“¶è¡Œå®¶ç®—æ³•</h4><p>é€‚ç”¨äºæ¯ç§èµ„æºç±»å‹æœ‰å¤šä¸ªå®ä¾‹çš„æƒ…å†µã€‚</p><p>å½“è¿›ç¨‹ç”³è¯·ä¸€ç»„èµ„æºæ—¶ï¼Œç³»ç»Ÿå¿…é¡»ç¡®å®šåˆ†é…è¿™äº›èµ„æºåç³»ç»Ÿæ˜¯å¦ä»å¤„äºå®‰å…¨çŠ¶æ€ã€‚<br>å¦‚æœæ˜¯ï¼Œå°±åˆ†é…èµ„æºï¼Œå¦åˆ™ï¼Œè¿›ç¨‹å¿…é¡»ç­‰å¾…ç›´åˆ°å…¶ä»–è¿›ç¨‹é‡Šæ”¾è¶³å¤Ÿçš„èµ„æºã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é“¶è¡Œå®¶ç®—æ³•</span></span><br><span class="line"><span class="type">int</span> n,m; <span class="comment">// nä¸ºè¿›ç¨‹æ•°ï¼Œmä¸ºèµ„æºç§ç±»æ•°</span></span><br><span class="line"><span class="type">int</span> available[m]; <span class="comment">// å¯ç”¨èµ„æºå‘é‡</span></span><br><span class="line"><span class="type">int</span> max[n][m]; <span class="comment">// æœ€å¤§éœ€æ±‚çŸ©é˜µ</span></span><br><span class="line"><span class="type">int</span> allocation[n][m]; <span class="comment">// å½“å‰åˆ†é…çŸ©é˜µ</span></span><br><span class="line"><span class="type">int</span> need[n][m]; <span class="comment">// éœ€æ±‚çŸ©é˜µï¼Œneed[i][j] = max[i][j] - allocation[i][j]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®‰å…¨æ€§æ£€æŸ¥ </span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">is_safe</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> work = available; <span class="comment">// å¯ç”¨èµ„æºå‘é‡</span></span><br><span class="line">    <span class="keyword">auto</span> finish = <span class="built_in">vector</span>&lt;<span class="type">bool</span>&gt;(n, <span class="literal">false</span>); <span class="comment">// è¿›ç¨‹å®Œæˆæ ‡å¿—</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="comment">// è¿›ç¨‹iæœªå®Œæˆä¸”éœ€æ±‚å°äºç­‰äºå¯ç”¨èµ„æº</span></span><br><span class="line">        <span class="keyword">if</span>(finish[i]==<span class="literal">false</span> &amp;&amp; need[i] &lt;= work) &#123;</span><br><span class="line">            work += allocation[i]; <span class="comment">// å®Œæˆï¼Œé‡Šæ”¾èµ„æº</span></span><br><span class="line">            finish[i] = <span class="literal">true</span>; <span class="comment">// æ ‡è®°è¿›ç¨‹iå®Œæˆ</span></span><br><span class="line">            i = <span class="number">-1</span>; <span class="comment">// é‡ç½®iï¼Œé‡æ–°æ£€æŸ¥æ‰€æœ‰è¿›ç¨‹</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="comment">// æ£€æŸ¥æ˜¯å¦æ‰€æœ‰è¿›ç¨‹éƒ½å®Œæˆ</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(finish[i] == <span class="literal">false</span>) <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// å­˜åœ¨æœªå®Œæˆè¿›ç¨‹ï¼Œç³»ç»Ÿä¸å®‰å…¨</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// æ‰€æœ‰è¿›ç¨‹éƒ½å®Œæˆï¼Œç³»ç»Ÿå®‰å…¨</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// èµ„æºè¯·æ±‚ç®—æ³•</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">request_resources</span><span class="params">(<span class="type">int</span> i, vector&lt;<span class="type">int</span>&gt; request)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!(request&lt;= need[i])) <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// è¯·æ±‚è¶…è¿‡éœ€æ±‚</span></span><br><span class="line">    <span class="keyword">if</span> (!(request &lt;= available)) <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// è¯·æ±‚è¶…è¿‡å¯ç”¨èµ„æº</span></span><br><span class="line">    <span class="comment">// å‡è®¾åˆ†é…èµ„æº</span></span><br><span class="line">    available -= request; <span class="comment">// æ›´æ–°å¯ç”¨èµ„æº</span></span><br><span class="line">    allocation[i] += request; <span class="comment">// æ›´æ–°åˆ†é…çŸ©é˜µ</span></span><br><span class="line">    need[i] -= request; <span class="comment">// æ›´æ–°éœ€æ±‚çŸ©é˜µ</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">is_safe</span>()) &#123; <span class="comment">// æ£€æŸ¥æ˜¯å¦å®‰å…¨</span></span><br><span class="line">        <span class="comment">// å¦‚æœä¸å®‰å…¨ï¼Œå›æ»šåˆ†é…</span></span><br><span class="line">        available += request; <span class="comment">// æ¢å¤å¯ç”¨èµ„æº</span></span><br><span class="line">        allocation[i] -= request; <span class="comment">// æ¢å¤åˆ†é…çŸ©é˜µ</span></span><br><span class="line">        need[i] += request; <span class="comment">// æ¢å¤éœ€æ±‚çŸ©é˜µ</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// è¯·æ±‚å¤±è´¥</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-æ­»é”çš„æ£€æµ‹å’Œæ¢å¤"><a href="#5-æ­»é”çš„æ£€æµ‹å’Œæ¢å¤" class="headerlink" title="5. æ­»é”çš„æ£€æµ‹å’Œæ¢å¤"></a>5. æ­»é”çš„æ£€æµ‹å’Œæ¢å¤</h3><p>æ­»é”æ£€æµ‹ç®—æ³•ï¼šæ£€æµ‹ç³»ç»ŸçŠ¶æ€ï¼Œç¡®å®šç³»ç»Ÿæ˜¯å¦å‡ºç°äº†æ­»é”ã€‚ï¼ˆåŸç†ç±»ä¼¼äºæ­»é”é¿å…ï¼‰</p><p>æ¢å¤æœºåˆ¶ï¼šç»ˆæ­¢ï¼ˆä»£ä»·å¤§ï¼‰ã€èµ„æºæŠ¢å </p><h2 id="å…«ã€ä¸»å­˜ç®¡ç†"><a href="#å…«ã€ä¸»å­˜ç®¡ç†" class="headerlink" title="å…«ã€ä¸»å­˜ç®¡ç†"></a>å…«ã€ä¸»å­˜ç®¡ç†</h2><h3 id="1-å†…å­˜ç®¡ç†å•å…ƒMMU"><a href="#1-å†…å­˜ç®¡ç†å•å…ƒMMU" class="headerlink" title="1. å†…å­˜ç®¡ç†å•å…ƒMMU"></a>1. å†…å­˜ç®¡ç†å•å…ƒMMU</h3><p>åœ¨è¿è¡Œæ—¶å®Œæˆé€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€çš„è½¬æ¢çš„ç¡¬ä»¶è¢«ç§°ä¸ºå†…å­˜ç®¡ç†å•å…ƒï¼ˆMemory Management Unit, MMUï¼‰ã€‚</p><p>ä¸‰ç§å®ç°æ–¹æ³•ï¼šè¿ç»­å†…å­˜åˆ†é…ã€åˆ†é¡µå’Œåˆ†æ®µ</p><h3 id="2-è¿ç»­å†…å­˜åˆ†é…"><a href="#2-è¿ç»­å†…å­˜åˆ†é…" class="headerlink" title="2. è¿ç»­å†…å­˜åˆ†é…"></a>2. è¿ç»­å†…å­˜åˆ†é…</h3><p>å†…å­˜ä¿æŠ¤ï¼šé€šè¿‡åŸºå€å¯„å­˜å™¨å’Œç•Œé™å¯„å­˜å™¨æ¥å®ç°ã€‚</p><ul><li>åŸºå€å¯„å­˜å™¨ï¼šå­˜å‚¨é€»è¾‘åœ°å€ç©ºé—´çš„èµ·å§‹åœ°å€</li><li>ç•Œé™å¯„å­˜å™¨ï¼šå­˜å‚¨é€»è¾‘åœ°å€ç©ºé—´çš„å¤§å°</li></ul><p>å¤šåˆ†åŒºæ–¹æ³•ï¼šå›ºå®šåˆ†åŒºã€<strong>å¯å˜åˆ†åŒº</strong></p><p>å­”ï¼šå¯ç”¨çš„å†…å­˜å—ã€‚<br>ä¸€å¼€å§‹æ•´ä¸ªå†…å­˜æ˜¯ä¸€ä¸ªå­”ï¼Œéšç€è¿›ç¨‹çš„è¿›å…¥å’Œä¸­æ­¢ï¼Œæ•´ä¸ªå†…å­˜å°†éå¸ƒç€è®¸å¤šå¤§å°ä¸åŒçš„å­”ã€‚</p><p>åŠ¨æ€å­˜å‚¨åˆ†é…é—®é¢˜ï¼šæ ¹æ®ä¸€ç»„ç©ºé—²çš„å­”å’Œä¸€ä¸ªè¯·æ±‚çš„å¤§å°ï¼Œé€‰æ‹©ä¸€ä¸ªå­”æ¥æ»¡è¶³è¯·æ±‚ã€‚</p><p>ä¸‰ç§åˆ†é…ç­–ç•¥ï¼š</p><ol><li>é¦–æ¬¡é€‚åº”ï¼ˆFirst Fitï¼‰ï¼šä»å¤´å¼€å§‹æœç´¢ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªè¶³å¤Ÿå¤§çš„å­”åˆ†é…ç»™è¿›ç¨‹ã€‚</li><li>æœ€ä½³é€‚åº”ï¼ˆBest Fitï¼‰ï¼šæœç´¢æ‰€æœ‰å­”ï¼Œæ‰¾åˆ°æœ€å°çš„è¶³å¤Ÿå¤§çš„å­”åˆ†é…ç»™è¿›ç¨‹ã€‚</li><li>æœ€å·®é€‚åº”ï¼ˆWorst Fitï¼‰ï¼šæœç´¢æ‰€æœ‰å­”ï¼Œæ‰¾åˆ°æœ€å¤§çš„å­”åˆ†é…ç»™è¿›ç¨‹ã€‚</li></ol><ul><li>é¦–æ¬¡é€‚åº”å’Œæœ€ä½³é€‚åº”åœ¨æ‰§è¡Œæ—¶é—´å’Œåˆ©ç”¨ç©ºé—´æ–¹é¢éƒ½å¥½äºæœ€å·®é€‚åº”ã€‚</li><li>é¦–æ¬¡é€‚åº”æ¯”æœ€ä½³é€‚åº”è¦å¿«</li></ul><p>ç¢ç‰‡ï¼šå› å¤ªå°è€Œæ— æ³•åˆ†é…ç»™ä»»ä½•è¿›ç¨‹çš„å­”ã€‚</p><ul><li>å¤–éƒ¨ç¢ç‰‡ï¼šç”±äºåˆ†é…å’Œé‡Šæ”¾å†…å­˜å—åï¼Œå‰©ä½™çš„å†…å­˜å—å¤ªå°è€Œæ— æ³•æ»¡è¶³æ–°çš„è¯·æ±‚ï¼Œä¸‰ç§åˆ†é…ç­–ç•¥éƒ½å¯èƒ½å¯¼è‡´å¤–éƒ¨ç¢ç‰‡ã€‚</li><li>å†…éƒ¨ç¢ç‰‡ï¼šå›ºå®šåˆ†åŒºï¼ˆåˆ†é¡µï¼‰æ–¹æ³•çš„é—®é¢˜ï¼Œè¿›ç¨‹åˆ†é…åˆ°çš„å†…å­˜å—æ¯”å®é™…éœ€è¦çš„è¦å¤§ï¼Œå¯¼è‡´æœªä½¿ç”¨çš„å†…å­˜ç©ºé—´ã€‚</li></ul><p>è§£å†³å¤–éƒ¨ç¢ç‰‡çš„æ–¹æ³•ï¼š</p><ol><li>ç´§ç¼©ï¼šç§»åŠ¨å†…å­˜å†…å®¹ï¼Œå°†æ‰€æœ‰ç©ºé—²ç©ºé—´åˆå¹¶æˆä¸€æ•´å—<ul><li>ç¼ºç‚¹ï¼šæœ‰æ¡ä»¶é™åˆ¶ï¼ˆè¦æ±‚é‡å®šä½æ˜¯åŠ¨æ€çš„ï¼‰ã€å¼€é”€å¤§</li></ul></li><li>å…è®¸ç‰©ç†åœ°å€ç©ºé—´ä¸ºéè¿ç»­çš„ï¼ˆåˆ†é¡µå’Œåˆ†æ®µï¼‰</li></ol><h3 id="3-åˆ†é¡µï¼ˆPagingï¼‰"><a href="#3-åˆ†é¡µï¼ˆPagingï¼‰" class="headerlink" title="3. åˆ†é¡µï¼ˆPagingï¼‰"></a>3. åˆ†é¡µï¼ˆPagingï¼‰</h3><h4 id="3-1-åŸºæœ¬æ–¹æ³•"><a href="#3-1-åŸºæœ¬æ–¹æ³•" class="headerlink" title="3.1 åŸºæœ¬æ–¹æ³•"></a>3.1 åŸºæœ¬æ–¹æ³•</h4><p>ç‰©ç†åœ°å€åˆ†ä¸ºå›ºå®šå¤§å°çš„å—ï¼Œç§°ä¸º<strong>å¸§</strong>(Frame)ï¼Œé€»è¾‘åœ°å€åˆ†ä¸ºåŒæ ·å¤§å°çš„å—ï¼Œç§°ä¸º<strong>é¡µ</strong>(Page)ã€‚</p><p>å†…å­˜çš„åˆ†é…ä¿¡æ¯ä¿å­˜åœ¨ç§°ä¸º<strong>å¸§è¡¨</strong>(frame table)çš„æ•°æ®ç»“æ„ä¸­</p><p>å¦‚æœä¸€ä¸ªè¿›ç¨‹éœ€è¦xé¡µï¼Œåˆ™åœ¨å†…å­˜åœ¨å¯»æ‰¾xä¸ªç©ºé—²å¸§ï¼Œå¦‚æœæœ‰ï¼Œåˆ™åˆ†é…ã€‚</p><p>ä¸ºè¿›ç¨‹åˆ†é…å†…å­˜æ—¶å»ºç«‹ä¸€ä¸ª<strong>é¡µè¡¨</strong>ï¼Œç”¨äºå°†é€»è¾‘åœ°å€è½¬æ¢æˆç‰©ç†åœ°å€ï¼Œé¡µè¡¨çš„æŒ‡é’ˆä¸å…¶ä»–ä¿¡æ¯ä¸€èµ·å­˜å…¥è¿›ç¨‹æ§åˆ¶å—ã€‚</p><p>é¡µè¡¨åŸºå¯„å­˜å™¨(PTBR)æŒ‡å‘é¡µè¡¨ï¼Œåˆ‡æ¢é¡µè¡¨åªéœ€æ”¹å˜PTBRçš„å€¼å³å¯ã€‚</p><p>é¡µè¡¨é•¿åº¦å¯„å­˜å™¨(PTLB)è¡¨ç¤ºé¡µè¡¨çš„é•¿åº¦ã€‚</p><p>é‡‡ç”¨åˆ†é¡µæŠ€æœ¯ä¸ä¼šäº§ç”Ÿå¤–éƒ¨ç¢ç‰‡ï¼Œä½†æ˜¯ä¼šæœ‰<strong>å†…éƒ¨ç¢ç‰‡</strong>ã€‚</p><p>åˆ†é¡µçš„ä¼˜ç‚¹ä¹‹ä¸€æ˜¯å¯ä»¥å…±äº«å…±åŒä»£ç ï¼šå¤šä¸ªè¿›ç¨‹ä¹‹é—´å¯ä»¥å…±äº«åŒä¸€åªè¯»ä»£ç ï¼ˆé‡å…¥ä»£ç ï¼‰æ®µçš„æ‹·è´ï¼›ç§æœ‰ç‹¬å ä»£ç å’Œæ•°æ®</p><p>è®°å—å¤§å°$2^n$ï¼Œç‰©ç†å†…å­˜å¤§å°ä¸º$2^k$ï¼Œè¿›ç¨‹é€»è¾‘åœ°å€å¤§å°ä¸º$2^m$ã€‚</p><p>å¸§æ•°ï¼š$2^{k-n}$ï¼Œé¡µæ•°ï¼š$2^{m-n}$</p><p>é€»è¾‘åœ°å€é«˜m-nä½ä¸º(p)é¡µè¡¨ç´¢å¼•ï¼Œä½nä½(d)ä¸ºé¡µåç§»</p><p>å‡è®¾æ¯é¡µ4Bï¼š</p><p><img src="https://source.cclmsy.cc/posts/notes/course/operating_system/image-5.png" alt="alt text"></p><p><img src="https://source.cclmsy.cc/posts/notes/course/operating_system/image-4.png" alt="alt text"></p><h4 id="3-2-è½¬æ¢è¡¨ç¼“å†²TLB"><a href="#3-2-è½¬æ¢è¡¨ç¼“å†²TLB" class="headerlink" title="3.2 è½¬æ¢è¡¨ç¼“å†²TLB"></a>3.2 è½¬æ¢è¡¨ç¼“å†²TLB</h4><p>é¡µè¡¨å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œæ¯è®¿é—®ä¸€ä¸ªå­—èŠ‚ï¼Œéœ€è¦ä¸¤æ¬¡è®¿é—®å†…å­˜ï¼ˆæŸ¥æ‰¾é¡µè¡¨ã€æ‰¾åˆ°éœ€è¦çš„ä¿¡æ¯ï¼‰ï¼Œé’ˆå¯¹è¿™ä¸€é—®é¢˜çš„æ ‡å‡†è§£å†³æ–¹æ¡ˆæ˜¯å…³è”å†…å­˜(TLB)ã€‚</p><p>å½“å…³è”å†…å­˜æ ¹æ®ç»™å®šå€¼ï¼ˆé¡µå·ï¼‰æŸ¥æ‰¾æ—¶ï¼Œå®ƒä¼šåŒæ—¶ä¸æ‰€æœ‰é”®è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœæ‰¾åˆ°æ¡ç›®ï¼Œå°±å¾—åˆ°ç›¸åº”çš„å€¼åŸŸï¼ˆå¸§å·ï¼‰</p><p>ç›¸å½“äºé¡µè¡¨çš„ä¸€ä¸ªç¼“å­˜ï¼ŒTLBçš„å¤§å°é€šå¸¸å¾ˆå°ï¼ˆå‡ åä¸ªæ¡ç›®ï¼‰ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨æ›¿æ¢ç®—æ³•</p><p>æœ‰æ•ˆå†…å­˜è®¿é—®æ—¶é—´(Effective Memory Access Time, EMAT)ï¼š</p><script type="math/tex; mode=display">EMAT = (T+\epsilon)\alpha + (2T+\epsilon)(1-\alpha)</script><ul><li>Tï¼šè®¿é—®ä¸€æ¬¡å†…å­˜çš„æ—¶é—´</li><li>Îµï¼šè®¿é—®ä¸€æ¬¡TLBçš„æ—¶é—´</li><li>Î±ï¼šTLBå‘½ä¸­ç‡</li><li>ç¬¬ä¸€é¡¹ï¼šTLBå‘½ä¸­ï¼Œè®¿é—®ä¸€æ¬¡å†…å­˜</li><li>ç¬¬äºŒé¡¹ï¼šTLBæœªå‘½ä¸­ï¼Œè®¿é—®ä¸¤æ¬¡å†…å­˜</li></ul><h4 id="3-3-é¡µè¡¨çš„ç»“æ„"><a href="#3-3-é¡µè¡¨çš„ç»“æ„" class="headerlink" title="3.3 é¡µè¡¨çš„ç»“æ„"></a>3.3 é¡µè¡¨çš„ç»“æ„</h4><ol><li>å±‚æ¬¡åŒ–é¡µè¡¨ï¼šå°†é¡µè¡¨åˆ†ä¸ºå¤šä¸ªå±‚æ¬¡ï¼Œæ¯ä¸ªå±‚æ¬¡çš„é¡µè¡¨åªåŒ…å«ä¸€éƒ¨åˆ†é¡µè¡¨é¡¹ï¼Œå‡å°‘å†…å­˜å ç”¨ã€‚</li><li>å“ˆå¸Œé¡µè¡¨ï¼šä½¿ç”¨å“ˆå¸Œå‡½æ•°å°†é¡µå·æ˜ å°„åˆ°é¡µè¡¨é¡¹ï¼Œå‡å°‘å†…å­˜å ç”¨</li><li>åå‘é¡µè¡¨ï¼šæ¯ä¸ªç‰©ç†å¸§å¯¹åº”ä¸€ä¸ªé¡µè¡¨é¡¹ï¼Œè®°å½•å“ªä¸ªè¿›ç¨‹çš„å“ªä¸ªé¡µæ˜ å°„åˆ°è¯¥å¸§</li></ol><p><img src="https://source.cclmsy.cc/posts/notes/course/operating_system/image-6.png" alt="alt text"></p><h4 id="3-4-ä¾‹é¢˜1"><a href="#3-4-ä¾‹é¢˜1" class="headerlink" title="3.4 ä¾‹é¢˜1"></a>3.4 ä¾‹é¢˜1</h4><p>é¡µé¢å¤§å°ä¸º4KBï¼Œé€»è¾‘åœ°å€24KBï¼Œé¡µè¡¨çš„å†…å®¹ä¸ºï¼š[2,5,6,8,3,11]ã€‚<br>åˆ™é€»è¾‘åœ°å€12293è½¬æ¢æˆç‰©ç†åœ°å€ä¸ºå¤šå°‘ï¼Ÿç»™å‡ºè®¡ç®—è¿‡ç¨‹ã€‚</p><p>12293D=011|0000,0000,0101B</p><p>é¡µå·p=011=3 =&gt; å¸§å·8</p><p>é¡µå†…åç§»d=101=5</p><p>ç‰©ç†åœ°å€=å¸§å·<em>é¡µå¤§å°+é¡µå†…åç§»=8</em>4KB+5=32768+5=32773</p><h4 id="3-5-ä¾‹é¢˜2"><a href="#3-5-ä¾‹é¢˜2" class="headerlink" title="3.5 ä¾‹é¢˜2"></a>3.5 ä¾‹é¢˜2</h4><p>å¦‚æœè®¿é—®ä¸€æ¬¡å†…å­˜è¦1.5nsï¼Œå¿«è¡¨çš„å‘½ä¸­ç‡ä¸º85%ï¼ŒæŸ¥æ‰¾å¿«è¡¨çš„æ—¶é—´ä¸º0.5nsã€‚è®¡ç®—è¯¥ç³»ç»Ÿçš„æœ‰æ•ˆè®¿é—®æ—¶é—´ã€‚</p><p>EMAT = (T + Îµ)Î± + (2T + Îµ)(1 - Î±) = (1.5 + 0.5) <em> 0.85 + (2 </em> 1.5 + 0.5) * (1 - 0.85)</p><h3 id="4-åˆ†æ®µï¼ˆSegmentationï¼‰"><a href="#4-åˆ†æ®µï¼ˆSegmentationï¼‰" class="headerlink" title="4. åˆ†æ®µï¼ˆSegmentationï¼‰"></a>4. åˆ†æ®µï¼ˆSegmentationï¼‰</h3><p>åˆ†æ®µæ˜¯æŒ‡å°†é€»è¾‘åœ°å€ç©ºé—´åˆ’åˆ†æˆä¸€ç»„æ®µï¼Œæ¯ä¸ªæ®µéƒ½æœ‰åç§°å’Œé•¿åº¦ã€‚<br>åœ°å€æŒ‡å®šäº†æ®µåå’Œæ®µå†…åç§»ã€‚<br>å› æ­¤ç”¨æˆ·å¯é€šè¿‡ä¸¤ä¸ªé‡æ¥æŒ‡å®šåœ°å€æ®µåå’Œåç§»ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ ¹æ®ç”¨æˆ·ç¨‹åºæ„é€ æ®µã€‚</p><p>é€»è¾‘åœ°å€ç”±ä¸¤ä¸ªå…ƒç´ ç»„æˆï¼š&lt;æ®µå·sï¼Œæ®µå†…åç§»d&gt;</p><p>æ®µè¡¨ï¼šå°†äºŒç»´çš„ç”¨æˆ·å®šä¹‰åœ°å€æ˜ å°„ä¸ºä¸€ç»´ç‰©ç†åœ°å€ã€‚æ®µè¡¨çš„æ¯ä¸ªæ¡ç›®éƒ½åŒ…å«ï¼š</p><ul><li>åŸºåœ°å€ï¼šåŒ…å«æ®µçš„èµ·å§‹åœ°å€</li><li>ç•Œé™ï¼šæŒ‡å®šæ®µçš„é•¿åº¦</li></ul><p>æ®µè¡¨åŸºåœ°å€å¯„å­˜å™¨ï¼ˆSTBRï¼‰æŒ‡å‘å†…å­˜ä¸­çš„æ®µè¡¨æ‰€åœ¨çš„ç‰©ç†åœ°å€</p><p>æ®µè¡¨ç•Œé™å¯„å­˜å™¨ï¼ˆSTLRï¼‰æŒ‡ç¤ºç¨‹åºæ‰€ç”¨çš„æ®µçš„ä¸ªæ•°ï¼Œæ®µå·Så°äºSTLRçš„æ—¶å€™æ‰æ˜¯æœ‰æ•ˆçš„</p><h3 id="5-æ¯”è¾ƒ"><a href="#5-æ¯”è¾ƒ" class="headerlink" title="5. æ¯”è¾ƒ"></a>5. æ¯”è¾ƒ</h3><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">è¿ç»­å†…å­˜åˆ†é…</th><th style="text-align:center">åˆ†é¡µ</th><th style="text-align:center">åˆ†æ®µ</th></tr></thead><tbody><tr><td style="text-align:center">å¤–éƒ¨ç¢ç‰‡</td><td style="text-align:center">æœ‰</td><td style="text-align:center">æ— </td><td style="text-align:center">æœ‰</td></tr><tr><td style="text-align:center">å†…éƒ¨ç¢ç‰‡</td><td style="text-align:center">æ— </td><td style="text-align:center">æœ‰</td><td style="text-align:center">æ— </td></tr><tr><td style="text-align:center">ä»£ç å…±äº«</td><td style="text-align:center">ä¸å¯ä»¥</td><td style="text-align:center">å¯ä»¥</td><td style="text-align:center">å¯ä»¥</td></tr></tbody></table></div><h3 id="6-å…¶ä»–"><a href="#6-å…¶ä»–" class="headerlink" title="6. å…¶ä»–"></a>6. å…¶ä»–</h3><p>åœ°å€æ˜ å°„æ˜¯æŒ‡å°†ç¨‹åºä¸­çš„<strong>é€»è¾‘</strong>åœ°å€è½¬æ¢ä¸ºå†…å­˜ä¸­çš„<strong>ç‰©ç†</strong>åœ°å€ã€‚</p><p>åœ¨åˆ†é¡µç®¡ç†ç³»ç»Ÿä¸­ï¼Œä¸ºå®ç°åœ°å€è½¬æ¢è®¾ç½®äº†æ§åˆ¶å¯„å­˜å™¨ï¼Œå…¶ä¸­å­˜æ”¾çš„æ˜¯<strong>é¡µè¡¨</strong>åœ¨å†…å­˜ä¸­çš„èµ·å§‹åœ°å€ã€‚</p><p>å­˜å‚¨ç®¡ç†åº”å…·æœ‰çš„åŠŸèƒ½åŒ…æ‹¬ï¼š<strong>å†…å­˜åˆ†é…ä¸å›æ”¶</strong>ï¼Œ<strong>åœ°å€æ˜ å°„</strong>ï¼Œ<strong>å†…å­˜ä¿æŠ¤</strong>å’Œ<strong>å†…å­˜æ‰©å……</strong>ã€‚</p><p>åœ¨åˆ†é¡µå¼è™šæ‹Ÿå†…å­˜ä¸­ï¼Œå½“å‘ç°æŸé¡µä¸åœ¨<strong>é¡µè¡¨</strong>ä¸­ï¼Œå°†äº§ç”Ÿç¼ºé¡µä¸­æ–­ã€‚è‹¥å†…å­˜æ²¡æœ‰ç©ºé—²å¸§ï¼Œåˆ™éœ€è¦è¿›è¡Œ<strong>é¡µé¢ç½®æ¢</strong>ã€‚å¦‚æœç®—æ³•é€‰æ‹©ä¸åˆç†ï¼Œå¯èƒ½ä¼šå‡ºç°é¢‘ç¹çš„é¡µé¢è°ƒåº¦ï¼Œç³»ç»Ÿäº§ç”Ÿ<strong>æŠ–åŠ¨</strong>ç°è±¡ã€‚</p><h2 id="ä¹ã€è™šæ‹Ÿå†…å­˜"><a href="#ä¹ã€è™šæ‹Ÿå†…å­˜" class="headerlink" title="ä¹ã€è™šæ‹Ÿå†…å­˜"></a>ä¹ã€è™šæ‹Ÿå†…å­˜</h2><h3 id="1-æœ‰æ•ˆè®¿é—®æ—¶é—´"><a href="#1-æœ‰æ•ˆè®¿é—®æ—¶é—´" class="headerlink" title="1. æœ‰æ•ˆè®¿é—®æ—¶é—´"></a>1. æœ‰æ•ˆè®¿é—®æ—¶é—´</h3><p>æœ‰æ•ˆè®¿é—®æ—¶é—´ï¼ˆEffective Access Time, EATï¼‰æ˜¯æŒ‡åœ¨è™šæ‹Ÿå†…å­˜ç³»ç»Ÿä¸­ï¼Œå¹³å‡æ¯æ¬¡è®¿é—®å†…å­˜æ‰€éœ€çš„æ—¶é—´ã€‚</p><p>EATçš„è®¡ç®—å…¬å¼ä¸ºï¼š</p><script type="math/tex; mode=display">EAT = (1 - p) \times T + p \times S</script><ul><li>pï¼šç¼ºé¡µç‡ï¼ˆPage Fault Rateï¼‰ï¼Œè¡¨ç¤ºè®¿é—®å†…å­˜æ—¶å‘ç”Ÿç¼ºé¡µçš„æ¦‚ç‡</li><li>Tï¼šå¹³å‡å†…å­˜è®¿é—®æ—¶é—´</li><li>Sï¼šå¹³å‡é¡µé”™è¯¯å¤„ç†æ—¶é—´</li></ul><p>å®ç°æŒ‰éœ€é¡µé¢è°ƒåº¦è¦è§£å†³çš„ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>å¸§åˆ†é…ï¼šå†…å­˜ä¸­å­˜åœ¨å¤šä¸ªè¿›ç¨‹ï¼Œéœ€è¦å†³å®šæ¯ä¸ªè¿›ç¨‹åˆ†é…å¤šå°‘å¸§</li><li>é¡µé¢ç½®æ¢ï¼šå½“å†…å­˜æ»¡æ—¶ï¼Œéœ€è¦å†³å®šå°†å“ªä¸ªé¡µé¢æ¢å‡ºï¼ŒåŸåˆ™ï¼šæœ€å°é¡µé”™è¯¯ç‡</li></ol><h3 id="2-é¡µé¢ç½®æ¢ç®—æ³•"><a href="#2-é¡µé¢ç½®æ¢ç®—æ³•" class="headerlink" title="2. é¡µé¢ç½®æ¢ç®—æ³•"></a>2. é¡µé¢ç½®æ¢ç®—æ³•</h3><p>é¡µé¢ç½®æ¢çš„åŸºæœ¬æ–¹æ³•ï¼š</p><ol><li>æŸ¥æ‰¾æ‰€éœ€é¡µåœ¨ç£ç›˜ä¸Šçš„ä½ç½®ã€‚</li><li>æŸ¥æ‰¾ç©ºé—²å¸§<ul><li>å¦‚æœæœ‰ç©ºé—²å¸§ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨å®ƒï¼›</li><li>å¦‚æœæ²¡æœ‰ç©ºé—²å¸§ï¼Œå°±ä½¿ç”¨é¡µé¢ç½®æ¢ç®—æ³•é€‰æ‹©ä¸€ä¸ªâ€œç‰ºç‰²â€å¸§ã€‚</li><li>å°†â€œç‰ºç‰²â€å¸§çš„å†…å®¹å†™åˆ°ç£ç›˜ä¸Šï¼Œä¿®æ”¹é¡µè¡¨å’Œå¸§è¡¨ã€‚</li></ul></li><li>å°†æ‰€éœ€çš„é¡µè¯»å…¥ç©ºé—²å¸§ï¼Œä¿®æ”¹é¡µè¡¨å’Œå¸§è¡¨ã€‚</li><li>é‡å¯è¿›ç¨‹ã€‚</li></ol><h3 id="3-FIFOé¡µé¢ç½®æ¢ç®—æ³•"><a href="#3-FIFOé¡µé¢ç½®æ¢ç®—æ³•" class="headerlink" title="3. FIFOé¡µé¢ç½®æ¢ç®—æ³•"></a>3. FIFOé¡µé¢ç½®æ¢ç®—æ³•</h3><p>FIFOï¼ˆFirst In First Outï¼‰é¡µé¢ç½®æ¢ç®—æ³•æ˜¯æœ€ç®€å•çš„é¡µé¢ç½®æ¢ç®—æ³•ã€‚</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  1 , 2 , 3 , 4 , 1 , 2 , 5 , 1 , 2 , 3 , 4 , 5</span><br><span class="line"></span><br><span class="line">|<span class="string"> 1*</span>|<span class="string"> 1 </span>|<span class="string"> 1 </span>|<span class="string"> 4*</span>|<span class="string"> 4 </span>|<span class="string"> 4 </span>|<span class="string"> 5*</span>|<span class="string">   </span>|<span class="string">   </span>|<span class="string"> 5 </span>|<span class="string"> 5 </span>|<span class="string"> H </span>|</span><br><span class="line">|<span class="string">   </span>|<span class="string"> 2*</span>|<span class="string"> 2 </span>|<span class="string"> 2 </span>|<span class="string"> 1*</span>|<span class="string"> 1 </span>|<span class="string"> 1 </span>|<span class="string"> H </span>|<span class="string">   </span>|<span class="string"> 3*</span>|<span class="string"> 3 </span>|<span class="string">   </span>|</span><br><span class="line">|<span class="string">   </span>|<span class="string">   </span>|<span class="string"> 3*</span>|<span class="string"> 3 </span>|<span class="string"> 3 </span>|<span class="string"> 2*</span>|<span class="string"> 2 </span>|<span class="string">   </span>|<span class="string"> H </span>|<span class="string"> 2 </span>|<span class="string"> 4*</span>|<span class="string">   </span>|</span><br></pre></td></tr></table></figure><p>é¡µé”™è¯¯æ¬¡æ•°ï¼š9</p><p>è§„å¾‹ï¼šä¸è®¡å‘½ä¸­ï¼Œè‡ªæŸå¸§è¿›å…¥å†…å­˜å¼€å§‹ä¼šå‡ºç°næ¬¡ï¼Œnä¸ºå†…å­˜å¸§æ•°</p><p>Beladyå¼‚å¸¸ï¼šé¡µé”™è¯¯ç‡å¯èƒ½ä¼šéšç€æ‰€åˆ†é…çš„å¸§æ•°çš„å¢åŠ è€Œå¢åŠ ï¼Œå¦‚ä¸Šä¾‹å¢åŠ ä¸º4å¸§æ—¶ï¼š</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  1 , 2 , 3 , 4 , 1 , 2 , 5 , 1 , 2 , 3 , 4 , 5</span><br><span class="line"></span><br><span class="line">|<span class="string"> 1*</span>|<span class="string"> 1 </span>|<span class="string"> 1 </span>|<span class="string"> 1 </span>|<span class="string"> H </span>|<span class="string">   </span>|<span class="string"> 5*</span>|<span class="string"> 5 </span>|<span class="string"> 5 </span>|<span class="string"> 5 </span>|<span class="string"> 4*</span>|<span class="string"> 4 </span>|</span><br><span class="line">|<span class="string">   </span>|<span class="string"> 2*</span>|<span class="string"> 2 </span>|<span class="string"> 2 </span>|<span class="string">   </span>|<span class="string"> H </span>|<span class="string"> 2 </span>|<span class="string"> 1*</span>|<span class="string"> 1 </span>|<span class="string"> 1 </span>|<span class="string"> 1 </span>|<span class="string"> 5*</span>|</span><br><span class="line">|<span class="string">   </span>|<span class="string">   </span>|<span class="string"> 3*</span>|<span class="string"> 3 </span>|<span class="string">   </span>|<span class="string">   </span>|<span class="string"> 3 </span>|<span class="string"> 3 </span>|<span class="string"> 2*</span>|<span class="string"> 2 </span>|<span class="string"> 2 </span>|<span class="string"> 2 </span>|</span><br><span class="line">|<span class="string">   </span>|<span class="string">   </span>|<span class="string">   </span>|<span class="string"> 4*</span>|<span class="string">   </span>|<span class="string">   </span>|<span class="string"> 4 </span>|<span class="string"> 4 </span>|<span class="string"> 4 </span>|<span class="string"> 3*</span>|<span class="string"> 3 </span>|<span class="string"> 3 </span>|</span><br></pre></td></tr></table></figure><h3 id="4-æœ€ä¼˜é¡µé¢ç½®æ¢OPT"><a href="#4-æœ€ä¼˜é¡µé¢ç½®æ¢OPT" class="headerlink" title="4. æœ€ä¼˜é¡µé¢ç½®æ¢OPT"></a>4. æœ€ä¼˜é¡µé¢ç½®æ¢OPT</h3><p>æœ€ä¼˜é¡µé¢ç½®æ¢ç®—æ³•ï¼ˆOptimal Page Replacementï¼‰æ˜¯ç†è®ºä¸Šæœ€å¥½çš„é¡µé¢ç½®æ¢ç®—æ³•ã€‚</p><p>é€‰æ‹©å°†æ¥æœ€é•¿æ—¶é—´ä¸è¢«è®¿é—®çš„é¡µé¢è¿›è¡Œç½®æ¢ã€‚</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  1 , 2 , 3 , 4 , 1 , 2 , 5 , 1 , 2 , 3 , 4 , 5</span><br><span class="line"></span><br><span class="line">|<span class="string"> 1*</span>|<span class="string"> 1 </span>|<span class="string"> 1 </span>|<span class="string"> 1 </span>|<span class="string"> H </span>|<span class="string">   </span>|<span class="string"> 1 </span>|<span class="string"> H </span>|<span class="string">   </span>|<span class="string"> 3*</span>|<span class="string"> 3 </span>|<span class="string">   </span>|</span><br><span class="line">|<span class="string">   </span>|<span class="string"> 2*</span>|<span class="string"> 2 </span>|<span class="string"> 2 </span>|<span class="string">   </span>|<span class="string"> H </span>|<span class="string"> 2 </span>|<span class="string">   </span>|<span class="string"> H </span>|<span class="string"> 2 </span>|<span class="string"> 4*</span>|<span class="string">   </span>|</span><br><span class="line">|<span class="string">   </span>|<span class="string">   </span>|<span class="string"> 3*</span>|<span class="string"> 4*</span>|<span class="string">   </span>|<span class="string">   </span>|<span class="string"> 5*</span>|<span class="string">   </span>|<span class="string">   </span>|<span class="string"> 5 </span>|<span class="string"> 5 </span>|<span class="string"> H </span>|</span><br></pre></td></tr></table></figure><p>é¡µé”™è¯¯æ¬¡æ•°ï¼š7</p><h3 id="5-LRUé¡µé¢ç½®æ¢ç®—æ³•"><a href="#5-LRUé¡µé¢ç½®æ¢ç®—æ³•" class="headerlink" title="5. LRUé¡µé¢ç½®æ¢ç®—æ³•"></a>5. LRUé¡µé¢ç½®æ¢ç®—æ³•</h3><p>LRUï¼ˆLeast Recently Usedï¼‰é¡µé¢ç½®æ¢ç®—æ³•æ˜¯åŸºäºæœ€è¿‘æœ€å°‘ä½¿ç”¨åŸåˆ™çš„é¡µé¢ç½®æ¢ç®—æ³•ã€‚</p><p>LRUç®—æ³•é€‰æ‹©æœ€ä¹…æœªè¢«è®¿é—®çš„é¡µé¢è¿›è¡Œç½®æ¢ã€‚</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  1 , 2 , 3 , 4 , 1 , 2 , 5 , 1 , 2 , 3 , 4 , 5</span><br><span class="line"></span><br><span class="line">|<span class="string"> 1*</span>|<span class="string"> 1 </span>|<span class="string"> 1 </span>|<span class="string"> 4*</span>|<span class="string"> 4 </span>|<span class="string"> 4 </span>|<span class="string"> 5*</span>|<span class="string">   </span>|<span class="string">   </span>|<span class="string"> 3*</span>|<span class="string"> 5 </span>|<span class="string"> H </span>|</span><br><span class="line">|<span class="string">   </span>|<span class="string"> 2*</span>|<span class="string"> 2 </span>|<span class="string"> 2 </span>|<span class="string"> 1*</span>|<span class="string"> 1 </span>|<span class="string"> 1 </span>|<span class="string"> H </span>|<span class="string">   </span>|<span class="string"> 1 </span>|<span class="string"> 4*</span>|<span class="string">   </span>|</span><br><span class="line">|<span class="string">   </span>|<span class="string">   </span>|<span class="string"> 3*</span>|<span class="string"> 3 </span>|<span class="string"> 3 </span>|<span class="string"> 2*</span>|<span class="string"> 2 </span>|<span class="string">   </span>|<span class="string"> H </span>|<span class="string"> 2 </span>|<span class="string"> 2 </span>|<span class="string">   </span>|</span><br></pre></td></tr></table></figure><p>é¡µé”™è¯¯æ¬¡æ•°ï¼š9</p><p>OPTå’ŒLRUæ²¡æœ‰Beladyå¼‚å¸¸ã€‚</p><h2 id="åã€æ–‡ä»¶ç³»ç»Ÿ"><a href="#åã€æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="åã€æ–‡ä»¶ç³»ç»Ÿ"></a>åã€æ–‡ä»¶ç³»ç»Ÿ</h2><h3 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1. æ¦‚å¿µ"></a>1. æ¦‚å¿µ</h3><ul><li>æ–‡ä»¶å±æ€§ï¼šåç§°ã€ç±»å‹ã€ä½ç½®ã€å¤§å°ã€æ—¶é—´æˆ³ã€æƒé™ç­‰</li><li>æ–‡ä»¶æ“ä½œï¼šåˆ›å»ºã€åˆ é™¤ã€è¯»ã€å†™ã€é‡å®šä½ç­‰</li><li>æ–‡ä»¶ç±»å‹ï¼šæ‰©å±•å</li></ul><h3 id="2-è®¿é—®æ–¹æ³•"><a href="#2-è®¿é—®æ–¹æ³•" class="headerlink" title="2. è®¿é—®æ–¹æ³•"></a>2. è®¿é—®æ–¹æ³•</h3><ol><li>é¡ºåºè®¿é—®ï¼šä»å¤´åˆ°å°¾ä¾æ¬¡è®¿é—®æ–‡ä»¶å†…å®¹<ul><li>read_next(), write_next(), reset()ç­‰</li></ul></li><li>ç›´æ¥è®¿é—®ï¼ˆéšæœºè®¿é—®ã€ç›¸å¯¹è®¿é—®ï¼‰ï¼šå¯ä»¥ç›´æ¥è·³è½¬åˆ°æ–‡ä»¶çš„ä»»æ„ä½ç½®è¿›è¡Œè¯»å†™æ“ä½œ<ul><li>read(n), write(n), position_to(n)ç­‰</li></ul></li><li>ç´¢å¼•è®¿é—®ï¼šä½¿ç”¨ç´¢å¼•è¡¨æ¥å¿«é€Ÿå®šä½æ–‡ä»¶ä¸­çš„æ•°æ®å—</li></ol><h3 id="3-æ–‡ä»¶çš„è·¯å¾„å"><a href="#3-æ–‡ä»¶çš„è·¯å¾„å" class="headerlink" title="3. æ–‡ä»¶çš„è·¯å¾„å"></a>3. æ–‡ä»¶çš„è·¯å¾„å</h3><p><code>ç›˜ç¬¦:\ç›®å½•1\ç›®å½•2\...\æ–‡ä»¶å.æ‰©å±•å</code></p><p>ç›¸å¯¹è·¯å¾„ã€ç»å¯¹è·¯å¾„</p><h3 id="4-ç›®å½•ä¸ç£ç›˜ç»“æ„"><a href="#4-ç›®å½•ä¸ç£ç›˜ç»“æ„" class="headerlink" title="4. ç›®å½•ä¸ç£ç›˜ç»“æ„"></a>4. ç›®å½•ä¸ç£ç›˜ç»“æ„</h3><ol><li>å•å±‚ç›®å½•ï¼šæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œå‘½åå†²çªã€åˆ†ç»„é—®é¢˜</li><li>åŒå±‚ç›®å½•ï¼šæ¯ä¸ªç”¨æˆ·æœ‰è‡ªå·±çš„ç›®å½•ï¼Œç”¨æˆ·ç›®å½•ä¸‹æœ‰æ–‡ä»¶</li><li>æ ‘å½¢ç›®å½•ï¼šå…¸å‹ï¼Œç›¸å¯¹è·¯å¾„ã€ç»å¯¹è·¯å¾„éƒ½å”¯ä¸€</li><li>æ— ç¯å›¾ç›®å½•ï¼šæœ‰å¤šæ¡è·¯å¾„è®¿é—®åŒä¸€æ–‡ä»¶<ul><li>å‘½åï¼šä¸€ä¸ªæ–‡ä»¶å¯æœ‰å¤šä¸ªç»å¯¹è·¯å¾„åï¼Œä¸åŒæ–‡ä»¶åå¯èƒ½è¡¨ç¤ºåŒä¸€æ–‡ä»¶</li><li>åˆ é™¤ï¼šåˆ é™¤æ–‡ä»¶å¯¼è‡´æ‚¬æŒ‚æŒ‡é’ˆï¼ˆæŒ‡å‘ä¸å­˜åœ¨çš„æ–‡ä»¶æˆ–è€…æ‰§è¡Œäº†å…¶ä»–æ–‡ä»¶ï¼‰</li></ul></li><li>é€šç”¨å›¾ç›®å½•ï¼šæœ‰å¤šæ¡è·¯å¾„è®¿é—®åŒä¸€æ–‡ä»¶æˆ–ç›®å½•</li></ol><h2 id="åä¸€ã€æ–‡ä»¶ç³»ç»Ÿå®ç°ï¼ˆç£ç›˜åˆ†é…æ–¹æ³•ï¼‰"><a href="#åä¸€ã€æ–‡ä»¶ç³»ç»Ÿå®ç°ï¼ˆç£ç›˜åˆ†é…æ–¹æ³•ï¼‰" class="headerlink" title="åä¸€ã€æ–‡ä»¶ç³»ç»Ÿå®ç°ï¼ˆç£ç›˜åˆ†é…æ–¹æ³•ï¼‰"></a>åä¸€ã€æ–‡ä»¶ç³»ç»Ÿå®ç°ï¼ˆç£ç›˜åˆ†é…æ–¹æ³•ï¼‰</h2><h3 id="1-è¿ç»­åˆ†é…"><a href="#1-è¿ç»­åˆ†é…" class="headerlink" title="1. è¿ç»­åˆ†é…"></a>1. è¿ç»­åˆ†é…</h3><p>æ¯ä¸ªæ–‡ä»¶åœ¨ç£ç›˜ä¸Šå ç”¨ä¸€ç»„è¿ç»­çš„å—ã€‚</p><p>ä¼˜ç‚¹ï¼š</p><ol><li>ç®€å•ï¼šåªéœ€è¦å—èµ·å§‹åœ°å€å’Œå—é•¿åº¦ï¼ˆå ç”¨å‡ ä¸ªå—ï¼‰å°±èƒ½è®¿é—®æ–‡ä»¶ </li><li>è®¿é—®è¿ç»­åˆ†é…çš„æ–‡ä»¶æ‰€éœ€çš„å¯»é“æ—¶é—´æœ€å° </li><li>æ”¯æŒéšæœºè®¿é—®</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>å¤–éƒ¨ç¢ç‰‡ï¼šéšç€æ–‡ä»¶çš„åˆ›å»ºå’Œåˆ é™¤ï¼Œç£ç›˜ä¸Šä¼šäº§ç”Ÿå¤–éƒ¨ç¢ç‰‡ï¼Œå¯¼è‡´æ— æ³•åˆ†é…è¿ç»­ç©ºé—´</li><li>æœ‰æ—¶åˆ›å»ºæ–‡ä»¶æ—¶ä¸èƒ½ç¡®å®šæ–‡ä»¶çš„å¤§å°</li><li>æ–‡ä»¶ä¸èƒ½åŠ¨æ€æ‰©å±•</li></ol><h3 id="2-é“¾æ¥åˆ†é…"><a href="#2-é“¾æ¥åˆ†é…" class="headerlink" title="2. é“¾æ¥åˆ†é…"></a>2. é“¾æ¥åˆ†é…</h3><p>æ¯ä¸ªæ–‡ä»¶æ˜¯ç£ç›˜å—çš„é“¾è¡¨ï¼Œæ¯ä¸ªå—åŒ…å«ä¸‹ä¸€ä¸ªå—çš„åœ°å€ã€‚</p><p>ä¼˜ç‚¹ï¼š</p><ol><li>ç®€å•ï¼šåªéœ€è¦èµ·å§‹åœ°å€ï¼›</li><li>åˆ©ç”¨ç‡é«˜ï¼šæ²¡æœ‰å¤–éƒ¨ç¢ç‰‡ï¼Œåªè¦æœ‰ç©ºé—²å—ï¼Œæ–‡ä»¶å°±èƒ½å¢å¤§</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>åªèƒ½ç”¨äºæ–‡ä»¶çš„é¡ºåºè®¿é—®ï¼Œä¸æ”¯æŒæ–‡ä»¶çš„ç›´æ¥è®¿é—®ã€‚</li><li>æŒ‡é’ˆéœ€è¦ç©ºé—´ï¼Œç£ç›˜ç©ºé—´æœ‰ä¸€éƒ¨åˆ†ç”¨äºå­˜å‚¨æŒ‡é’ˆã€‚</li><li>å¯é æ€§ä½ï¼šå¦‚æœæŒ‡é’ˆä¸¢å¤±æˆ–æŸåå¯èƒ½ç‰µè¿åˆ°ç©ºé—²ç©ºé—´åˆ—è¡¨ã€‚</li></ol><h3 id="3-ç´¢å¼•åˆ†é…ï¼ˆæ•£åˆ—åˆ†é…ï¼‰"><a href="#3-ç´¢å¼•åˆ†é…ï¼ˆæ•£åˆ—åˆ†é…ï¼‰" class="headerlink" title="3. ç´¢å¼•åˆ†é…ï¼ˆæ•£åˆ—åˆ†é…ï¼‰"></a>3. ç´¢å¼•åˆ†é…ï¼ˆæ•£åˆ—åˆ†é…ï¼‰</h3><p>å°†æ‰€æœ‰æŒ‡é’ˆæ”¾åœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªç´¢å¼•å—ï¼Œç´¢å¼•å—åŒ…å«æ–‡ä»¶çš„æ‰€æœ‰å—çš„åœ°å€ã€‚</p><p>ç´¢å¼•å—æ–¹æ¡ˆï¼šé“¾æ¥ç´¢å¼•ã€å¤šçº§ç´¢å¼•ã€ç»„åˆæ–¹æ¡ˆ</p><h2 id="åäºŒã€å¤§å®¹é‡å­˜å‚¨ç»“æ„ï¼ˆç£ç›˜ï¼‰"><a href="#åäºŒã€å¤§å®¹é‡å­˜å‚¨ç»“æ„ï¼ˆç£ç›˜ï¼‰" class="headerlink" title="åäºŒã€å¤§å®¹é‡å­˜å‚¨ç»“æ„ï¼ˆç£ç›˜ï¼‰"></a>åäºŒã€å¤§å®¹é‡å­˜å‚¨ç»“æ„ï¼ˆç£ç›˜ï¼‰</h2><h3 id="1-ç£ç›˜é€Ÿåº¦"><a href="#1-ç£ç›˜é€Ÿåº¦" class="headerlink" title="1. ç£ç›˜é€Ÿåº¦"></a>1. ç£ç›˜é€Ÿåº¦</h3><p>ç£ç›˜çš„è®¿é—®æ—¶é—´ï¼š</p><ul><li>æ•°æ®ä¼ è¾“æ—¶é—´ï¼šé©±åŠ¨å™¨ä¸è®¡ç®—æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“é€Ÿç‡</li><li>å®šä½æ—¶é—´/éšæœºè®¿é—®æ—¶é—´<ul><li>å¯»é“æ—¶é—´ï¼šç£å¤´ç§»åŠ¨åˆ°æŸ±é¢æ‰€éœ€çš„æ—¶é—´  </li><li>æ—‹è½¬å»¶æ—¶ï¼šç­‰å¾…æ‰‡åŒºæ—‹è½¬åˆ°ç£å¤´ä¸‹æ‰€éœ€çš„æ—¶é—´</li></ul></li></ul><h3 id="2-ç£ç›˜è°ƒåº¦"><a href="#2-ç£ç›˜è°ƒåº¦" class="headerlink" title="2. ç£ç›˜è°ƒåº¦"></a>2. ç£ç›˜è°ƒåº¦</h3><p>å‡è®¾æœ‰ä¸€ä¸ªç£ç›˜é˜Ÿåˆ—ï¼Œå…¶I/Oå¯¹å„ä¸ªæŸ±é¢ä¸Šå—çš„è¯·æ±‚é¡ºåºï¼š98, 183, 37, 122, 14, 124, 65, 67ï¼Œç£å¤´ä½äº53å·æŸ±é¢</p><p>å¯»é“è·ç¦»ï¼šå¯»é“é¡ºåºä¸‹ï¼Œç›¸é‚»é¡¹åºå·ä¹‹å·®çš„ç»å¯¹å€¼ä¹‹å’Œ</p><p>è°ƒåº¦æ—¶é—´=å¯»é“è·ç¦»Ã—å¹³å‡å¯»é“æ—¶é—´+æ—‹è½¬å»¶æ—¶Ã—æ—‹è½¬æ¬¡æ•°</p><h4 id="2-1-FCFS"><a href="#2-1-FCFS" class="headerlink" title="2.1 FCFS"></a>2.1 FCFS</h4><p>å¯»é“é¡ºåºï¼š53-&gt;98-&gt;183-&gt;37-&gt;122-&gt;14-&gt;124-&gt;65-&gt;67</p><p>å¯»é“è·ç¦»ï¼š640</p><p><img src="https://source.cclmsy.cc/posts/notes/course/operating_system/image-7.png" alt="alt text"></p><h4 id="2-2-SSTF-æœ€çŸ­å¯»é“æ—¶é—´ä¼˜å…ˆ"><a href="#2-2-SSTF-æœ€çŸ­å¯»é“æ—¶é—´ä¼˜å…ˆ" class="headerlink" title="2.2 SSTF æœ€çŸ­å¯»é“æ—¶é—´ä¼˜å…ˆ"></a>2.2 SSTF æœ€çŸ­å¯»é“æ—¶é—´ä¼˜å…ˆ</h4><p>ä¼˜å…ˆå‰å¾€è·ç¦»å½“å‰ç£å¤´ä½ç½®æœ€è¿‘çš„è¯·æ±‚ã€‚</p><p>å¯»é“é¡ºåºï¼š53-&gt;65-&gt;67-&gt;37-&gt;14-&gt;98-&gt;122-&gt;124-&gt;183</p><p>å¯»é“è·ç¦»ï¼š236</p><p><img src="https://source.cclmsy.cc/posts/notes/course/operating_system/image-8.png" alt="alt text"></p><h4 id="2-3-SCAN-æ‰«æç®—æ³•"><a href="#2-3-SCAN-æ‰«æç®—æ³•" class="headerlink" title="2.3 SCAN æ‰«æç®—æ³•"></a>2.3 SCAN æ‰«æç®—æ³•</h4><p>ç£è‡‚ä¸›ç£ç›˜çš„ä¸€ç«¯ç§»åŠ¨åˆ°å¦ä¸€ç«¯ï¼Œå½“ç£å¤´ç§»è¿‡æ¯ä¸ªæŸ±é¢æ—¶ï¼Œå¤„ç†è¯¥æŸ±é¢ä¸Šçš„è¯·æ±‚ï¼›åˆ°è¾¾å¦ä¸€ç«¯æ—¶è¿”å›å¹¶ä¾æ¬¡å¤„ç†æŸ±é¢ä¸Šçš„è¯·æ±‚ã€‚</p><p>å¯»é“é¡ºåºï¼š53-&gt;37-&gt;14-&gt;(0)-&gt;65-&gt;67-&gt;98-&gt;122-&gt;124-&gt;183</p><p>å¯»é“è·ç¦»ï¼š208+28(åˆ°è¾¾0é€ æˆçš„å¤šä½™å¯»é“è·ç¦»)=236</p><p><img src="https://source.cclmsy.cc/posts/notes/course/operating_system/image-9.png" alt="alt text"></p><h4 id="2-4-C-SCAN-å¾ªç¯æ‰«æç®—æ³•"><a href="#2-4-C-SCAN-å¾ªç¯æ‰«æç®—æ³•" class="headerlink" title="2.4 C-SCAN å¾ªç¯æ‰«æç®—æ³•"></a>2.4 C-SCAN å¾ªç¯æ‰«æç®—æ³•</h4><p>æä¾›æ›´åŠ å‡åŒ€çš„ç­‰å¾…æ—¶é—´ï¼Œç£å¤´ç§»åŠ¨åˆ°å¦ä¸€ç«¯åç«‹å³è¿”å›ç£ç›˜å¼€å§‹ï¼Œè¿”å›æ—¶ä¸å¤„ç†è¯·æ±‚ã€‚ </p><p>å¯»é“é¡ºåºï¼š53-&gt;65-&gt;67-&gt;98-&gt;122-&gt;124-&gt;183-&gt;(199)-&gt;(0)-&gt;14-&gt;37</p><p>å¯»é“è·ç¦»ï¼š382</p><p><img src="https://source.cclmsy.cc/posts/notes/course/operating_system/image-10.png" alt="alt text"></p><h4 id="2-5-LOOK-C-LOOK-è°ƒåº¦ç®—æ³•"><a href="#2-5-LOOK-C-LOOK-è°ƒåº¦ç®—æ³•" class="headerlink" title="2.5 LOOK/C-LOOK è°ƒåº¦ç®—æ³•"></a>2.5 LOOK/C-LOOK è°ƒåº¦ç®—æ³•</h4><p>å’ŒSCAN/C-SCANå¯¹åº”ï¼ŒLOOKè°ƒåº¦ç®—æ³•åªæ‰«æåˆ°æœ€åä¸€ä¸ªè¯·æ±‚çš„æŸ±é¢ï¼Œç„¶åè¿”å›ã€‚</p><p>C-LOOKå¯»é“é¡ºåºï¼š53-&gt;65-&gt;67-&gt;98-&gt;122-&gt;124-&gt;183-&gt;14-&gt;37</p><p>å¯»é“è·ç¦»ï¼š322</p><p><img src="https://source.cclmsy.cc/posts/notes/course/operating_system/image-11.png" alt="alt text"></p><h2 id="åä¸‰ã€I-Oç³»ç»Ÿ"><a href="#åä¸‰ã€I-Oç³»ç»Ÿ" class="headerlink" title="åä¸‰ã€I/Oç³»ç»Ÿ"></a>åä¸‰ã€I/Oç³»ç»Ÿ</h2><h3 id="1-I-Oç¡¬ä»¶"><a href="#1-I-Oç¡¬ä»¶" class="headerlink" title="1. I/Oç¡¬ä»¶"></a>1. I/Oç¡¬ä»¶</h3><ol><li>è½®è¯¢ï¼ˆPollingï¼‰ï¼šI/Oè®¾å¤‡ä¼ è¾“æ•°æ®æ—¶CPUå¤„äºå¿™ç­‰çŠ¶æ€ï¼ŒCPUä¸æ–­æ£€æŸ¥è®¾å¤‡çŠ¶æ€ï¼Œç›´åˆ°è®¾å¤‡å‡†å¤‡å¥½æ•°æ®ã€‚<ul><li>å¹¶å‘æ€§å·®ã€I/Oæ•ˆç‡ä½ã€‚</li></ul></li><li>ä¸­æ–­ï¼ˆInterruptï¼‰ï¼šI/Oè®¾å¤‡ä¼ è¾“æ•°æ®æ—¶ï¼ŒCPUå¯ä»¥ä¸ºå…¶å®ƒè¿›ç¨‹æœåŠ¡ï¼Œæ¯ä¼ è¾“å®Œä¸€ä¸ªå­—èŠ‚ï¼Œç”±I/Oè®¾å¤‡å‘CPUå‘é€ä¸­æ–­è¯·æ±‚ä¿¡å·ã€‚<ul><li>å¹¶å‘æ€§å¥½ï¼Œä¼ é€å¤§æ‰¹æ•°æ®æ—¶I/Oæ•ˆç‡ä½ã€‚</li><li>é€‚ç”¨äºä½é€Ÿå¤–è®¾ï¼Œå¦‚é”®ç›˜ã€é¼ æ ‡ç­‰</li></ul></li><li>å†…å­˜ç›´æ¥è®¿é—®(DMA)ï¼šCPUæä¾›æºåœ°å€ã€ç›®æ ‡åœ°å€ä»¥åŠå­—èŠ‚æ•°ï¼Œå®Œæˆæ•´å—æ•°æ®ä¼ è¾“åäº§ç”Ÿä¸€æ¬¡ä¸­æ–­<ul><li>å¹¶å‘æ€§å¥½ï¼Œå¯ä¸€æ¬¡æ€§ä¼ é€å¤§æ‰¹æ•°æ®ï¼Œæ•ˆç‡é«˜</li><li>é€‚ç”¨äºé«˜é€Ÿå¤–è®¾ï¼Œå¦‚ç£ç›˜ã€ç½‘ç»œç­‰</li></ul></li></ol><h3 id="2-ä¸­æ–­å’Œé™·é˜±"><a href="#2-ä¸­æ–­å’Œé™·é˜±" class="headerlink" title="2. ä¸­æ–­å’Œé™·é˜±"></a>2. ä¸­æ–­å’Œé™·é˜±</h3><p>ä¸­æ–­ï¼šæ“ä½œç³»ç»Ÿä¸­å‘ç”ŸæŸä¸€äº‹ä»¶æ—¶ï¼Œç¡¬ä»¶å°†è§¦å‘ä¸€ä¸ªä¸­æ–­ï¼Œä¸­æ–­ä¿¡å·é€šè¿‡ä¸­æ–­å‘é‡å°†æ§åˆ¶ç¨‹åºè½¬ç§»åˆ°åˆé€‚çš„ç»ˆç«¯æœåŠ¡ç¨‹åºï¼Œä»¥æ”¹å˜CPUçš„æ‰§è¡Œè¿‡ç¨‹</p><p>é™·é˜±ï¼šé™·é˜±æ˜¯ç”±è½¯ä»¶äº§ç”Ÿçš„ï¼Œä¸€èˆ¬ç”±ç”¨æˆ·è¯·æ±‚æˆ–è€…é”™è¯¯å¼•èµ·ï¼Œä¸»è¦ç”¨äºè°ƒç”¨æ“ä½œç³»ç»ŸæœåŠ¡æˆ–è€…æ•æ‰ç®—æ³•é”™è¯¯ã€‚</p>]]></content>
    
    
    <summary type="html">æ“ä½œæ“ä½œç³»ç»Ÿæ“ä½œè®¡ç®—æœºå®Œæˆæ“ä½œï¼ˆä¹</summary>
    
    
    
    <category term="è¯¾ç¨‹ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="è¯¾ç¨‹ç¬”è®°" scheme="https://www.cclmsy.cc/tags/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>è®ºæ–‡ç¬”è®°|MLLM-as-a-Judge for Image Safety without Human Labeling</title>
    <link href="https://www.cclmsy.cc/posts/2501.00192.html"/>
    <id>https://www.cclmsy.cc/posts/2501.00192.html</id>
    <published>2025-06-13T16:00:00.000Z</published>
    <updated>2025-10-16T07:41:48.327Z</updated>
    
    <content type="html"><![CDATA[<p>è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/2501.00192">MLLM-as-a-Judge for Image Safety without Human Labeling(CVPR2025)</a></p><h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h2><p>æ–¹å‘ï¼šImage Safety Judgmentï¼ˆå›¾åƒå®‰å…¨æ€§åˆ¤æ–­ï¼‰</p><p>ç°æœ‰æ–¹æ¡ˆï¼ˆTraditional Classiferã€MLLMï¼‰æåº¦ä¾èµ–äººå·¥æ ‡æ³¨æ•°æ®ï¼Œæœ‰æ•ˆä½†è€—è´¹æ—¶é—´å’Œèµ„æº</p><p>ä¸€ç§â€œ<strong>åˆ©ç”¨é¢„è®­ç»ƒMLLMçš„èƒ½åŠ›ï¼Œæ ¹æ®ä¸€å¥—å®‰å…¨è§„åˆ™ï¼Œä»¥0-Shotæ–¹å¼åˆ¤æ–­å›¾åƒå®‰å…¨æ€§</strong>â€çš„æ–¹æ¡ˆå—åˆ°å…³æ³¨ã€‚</p><p>å¯¹MLLMè¿›è¡Œå®‰å…¨æ€§è§„åˆ™æŸ¥è¯¢ä¸è¶³ä»¥å®ç°å¯é çš„å®‰å…¨æ€§æ£€æµ‹ï¼ŒåŸå› æœ‰ä»¥ä¸‹ä¸‰ç‚¹ï¼š</p><ol><li><strong>å®‰å…¨æ€§è§„åˆ™æè¿°æ¨¡ç³Šæˆ–å…·æœ‰ä¸»è§‚æ€§</strong>ã€‚æ ·ä¾‹è¯¢é—®â€œä¸é€‚åˆå…¬ä¼—è§‚çœ‹çš„å†…å®¹â€æè¿°ç¬¼ç»Ÿï¼Œä¸åŒäººå¯¹â€œä¸é€‚åˆâ€çš„ç†è§£å¯èƒ½ä¸åŒ</li><li><strong>å½“å‰çš„MLLMéš¾ä»¥æ¨ç†å¤æ‚å†—é•¿çš„å®‰å…¨æ€§è§„åˆ™</strong>ã€‚æ ·ä¾‹è¯¢é—®åŒ…å«2ä¸ªåˆ†å¥25ä¸ªè‹±æ–‡å•è¯ï¼ŒMLLMå¯èƒ½æ— æ³•å®Œå…¨ç†è§£</li><li><strong>MLLMå­˜åœ¨å›ºæœ‰åå·®</strong>ã€‚æ ·ä¾‹è¯¢é—®â€œæ˜¯å¦æœ‰å–‰éƒ¨ä¼¤å£â€œï¼Œå³ä½¿å›¾ç‰‡ä¸­åªæœ‰åœ°é¢å’Œæ¯›å‘ä¸Šæœ‰è¡€è¿¹ï¼ŒMLLMä¹Ÿå¯èƒ½ä¼šé”™è¯¯åœ°è®¤ä¸ºæœ‰å–‰éƒ¨ä¼¤å£</li></ol><p><img src="https://source.cclmsy.cc/posts/papers/2501.00192/image.png" alt="alt text"></p><p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæœ¬æ–‡æå‡ºäº†<strong>CLUE</strong>ï¼ˆ<strong>C</strong>ontrastive M<strong>L</strong>LM J<strong>u</strong>dg<strong>e</strong>ï¼‰ï¼Œæ˜¾è‘—æé«˜äº†MLLM 0-Shot Image Safety Judgeçš„æœ‰æ•ˆæ€§</p><ol><li>å°†å®‰å…¨æ€§è§„åˆ™<strong>å®¢è§‚åŒ–</strong>ï¼Œè½¬åŒ–ä¸ºMLLMå¯ä»¥æœ‰æ•ˆå¤„ç†çš„å®¢è§‚ã€å¯è¡Œçš„è§„åˆ™</li><li>ä¸€æ¬¡æ£€æŸ¥ä¸€ä¸ªè§„åˆ™<ul><li>ä¸ºäº†å¤„ç†å¤æ‚æˆ–å†—é•¿çš„è§„åˆ™ï¼Œæ¯æ¡è§„åˆ™è½¬åŒ–ä¸ºä¸€ç»„é€»è¾‘ä¸Šå®Œæ•´çš„<strong>å‰ææ¡ä»¶é“¾</strong></li><li>ä¸ºäº†åŠ å¿«æ‰€æœ‰è§„åˆ™çš„è¿­ä»£è¿‡ç¨‹ï¼Œé‡‡ç”¨<strong>å¤šæ¨¡æ€å¯¹æ¯”æ¨¡å‹</strong>ï¼ˆå¦‚CLIPï¼‰è¡¡é‡è§„åˆ™å’Œå›¾åƒçš„ç›¸å…³æ€§</li></ul></li><li>è¿›è¡Œ<strong>å»åæ ‡è®°æ¦‚ç‡åˆ†æï¼ˆdebiased token probability analysisï¼‰</strong>ï¼Œä½¿ç”¨å»åæ¦‚ç‡é¢„æµ‹ç»“æœ<ul><li>å‡å°‘ç”±è¯­è¨€å…ˆéªŒå’Œéå›¾åƒä¸­å¿ƒåŒºåŸŸé€ æˆçš„åå·®</li></ul></li></ol><p>å½“æ ‡è®°æ¦‚ç‡åˆ†æç½®ä¿¡åº¦ä½æ—¶ï¼ŒCLUEä¼šä½¿ç”¨æ€ç»´é“¾è¿›è¡Œæ·±å…¥æ¨ç†ã€‚</p><h2 id="2-BG"><a href="#2-BG" class="headerlink" title="2. BG"></a>2. BG</h2><ol><li>Image Content Safety å›¾åƒå†…å®¹å®‰å…¨</li><li>Safety Judge Model å®‰å…¨æ€§åˆ¤æ–­æ¨¡å‹<ul><li>æœ€åˆçš„ä¼ ç»Ÿåˆ†ç±»å™¨ï¼ˆTraditional Classifierï¼‰ã€æœ€è¿‘çš„å¾®è°ƒLLM<ul><li>å±€é™ï¼šäººå·¥æ ‡æ³¨è€—æ—¶ä¸”æ˜‚è´µ</li></ul></li><li>è¿‘æœŸï¼š0-shot MLLMï¼ˆMultimodal Large Language Modelï¼‰<ul><li>æ€§èƒ½ä¸ä»¤äººæ»¡æ„</li></ul></li></ul></li></ol><h2 id="3-Method"><a href="#3-Method" class="headerlink" title="3. Method"></a>3. Method</h2><h3 id="é—®é¢˜æ¨¡å‹"><a href="#é—®é¢˜æ¨¡å‹" class="headerlink" title="é—®é¢˜æ¨¡å‹"></a>é—®é¢˜æ¨¡å‹</h3><p>ç»™å®šä¸€å¼ å›¾åƒ$x$å’Œä¸€ç»„å®‰å…¨æ€§è§„åˆ™$G$ï¼Œæœ‰ä»¥ä¸‹2ä¸ªç›®æ ‡ï¼š</p><ol><li>ç¡®å®šå›¾åƒ$x$æ˜¯å¦è¿åäº†$G$ä¸­çš„ä»»ä½•è§„åˆ™</li><li>æä¾›è¯†åˆ«å‡ºçš„è¿åè§„åˆ™çš„åˆ—è¡¨</li></ol><p>è¡¨ç¤ºä¸ºï¼š$A(x,G)\rightarrow(s,R)$</p><ul><li>$s$ï¼šè¯†åˆ«ç»“æœï¼ˆå®‰å…¨/ä¸å®‰å…¨ï¼‰</li><li>$R$ï¼šè¿åçš„å…·ä½“å®‰å…¨è§„åˆ™</li></ul><h3 id="3-1-Rules-Objectification-è§„åˆ™å®¢è§‚åŒ–"><a href="#3-1-Rules-Objectification-è§„åˆ™å®¢è§‚åŒ–" class="headerlink" title="3.1 Rules Objectification è§„åˆ™å®¢è§‚åŒ–"></a>3.1 Rules Objectification è§„åˆ™å®¢è§‚åŒ–</h3><p>å°†LLMä½œä¸ºä¼˜åŒ–å™¨ï¼ˆLLM-as-an-Optimizerï¼‰å¯¹è§„åˆ™è¿›è¡Œå®¢è§‚åŒ–ã€‚</p><p>è®©LLMå¯¹æ¯æ¡è§„åˆ™è¿›è¡Œ1~10åˆ†çš„æ‰“åˆ†ï¼Œä¿®æ”¹åˆ†æ•°ä½äºé˜ˆå€¼ï¼ˆ9ï¼‰çš„è§„åˆ™ï¼Œç›´åˆ°è¾¾åˆ°9åˆ†ã€‚</p><p>LLMå®¢è§‚æ€§è¯„ä¼°Promptï¼š</p><p><img src="https://source.cclmsy.cc/posts/papers/2501.00192/image-1.png" alt="alt text"></p><p>åŸå§‹è§„åˆ™é›†ï¼š</p><p><img src="https://source.cclmsy.cc/posts/papers/2501.00192/image-2.png" alt="alt text"></p><p>å®¢è§‚åŒ–åçš„è§„åˆ™é›†ï¼š</p><p><img src="https://source.cclmsy.cc/posts/papers/2501.00192/image-3.png" alt="alt text"></p><p>ä»¥ç¬¬4æ¡ä¸ºä¾‹ï¼Œâ€œæŒ¨ç€å¦ä¸€ä¸ªäººèººåœ¨åºŠä¸Šçš„äººâ€çš„7åˆ†æè¿°ä¿®æ”¹ä¸ºâ€œä¸¤ä¸ªäº’ç›¸æ¥è§¦çš„äººèººåœ¨åºŠä¸Šâ€çš„9åˆ†æè¿°â€</p><h3 id="3-2-Relevance-Scanning-ç›¸å…³æ€§æ‰«æ"><a href="#3-2-Relevance-Scanning-ç›¸å…³æ€§æ‰«æ" class="headerlink" title="3.2 Relevance Scanning ç›¸å…³æ€§æ‰«æ"></a>3.2 Relevance Scanning ç›¸å…³æ€§æ‰«æ</h3><p>MLLMå¤„ç†å¤æ‚ç»“æ„æ—¶æ¨ç†èƒ½åŠ›æœ‰é™ï¼Œä¸èƒ½æŠŠæ‰€æœ‰è§„åˆ™ä¸€æ¬¡æ€§è¾“å…¥ã€‚<br>å°è¯•æšä¸¾è§„åˆ™è¾“å…¥ï¼Œä½†æ˜¯æ•ˆç‡ä¸é«˜ï¼Œè€Œä¸”å¾ˆå¤šè§„åˆ™å¯èƒ½å’Œå›¾ç‰‡æ— å…³ã€‚<br>å› æ­¤ï¼Œéœ€è¦è¿‡æ»¤æ‰ä¸å›¾åƒæ— å…³çš„è§„åˆ™ï¼Œå‡å°‘MLLMçš„å·¥ä½œé‡ä»¥æé«˜æ•ˆç‡ã€‚</p><p>CLUEä½¿ç”¨äº†é¢„è®­ç»ƒçš„æ–‡æœ¬å›¾åƒç¼–ç å™¨CLIPï¼Œé€šè¿‡è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦æ¥è¡¡é‡è§„åˆ™å’Œå›¾åƒçš„ç›¸å…³æ€§ã€‚</p><p>æ»¡è¶³<script type="math/tex">cos(I(x),T(r))>t</script>çš„è§„åˆ™$r$è¢«è®¤ä¸ºä¸å›¾åƒ$x$ç›¸å…³</p><ul><li>$I(x)$ï¼šå›¾åƒ$x$çš„CLIPç¼–ç </li><li>$T(r)$ï¼šè§„åˆ™$r$çš„CLIPç¼–ç </li><li>$t$ï¼šé˜ˆå€¼</li></ul><p>ä½¿ç”¨ç¼–ç å™¨çš„å¥½å¤„ï¼šé€Ÿåº¦ï¼ˆæ¯”MLLMï¼‰æ˜æ˜¾å¿«ï¼Œå› ä¸ºå’ŒMLLMæ•°åäº¿çš„å‚æ•°æ•°é‡ç›¸æ¯”ï¼ŒEncoderçš„å¤§å°è¦å°å¾—å¤š</p><p>å®éªŒè¯æ˜ï¼Œtè®¾ç½®ä¸º0.22æ—¶ï¼Œèƒ½å¤Ÿè¿‡æ»¤æ‰67%çš„ä¸ç›¸å…³è§„åˆ™ï¼ŒåŒæ—¶ä¿ç•™96.6%çš„å®é™…è¿è§„è§„åˆ™</p><h3 id="3-3-Precondition-Extraction-å‰ææ¡ä»¶æå–"><a href="#3-3-Precondition-Extraction-å‰ææ¡ä»¶æå–" class="headerlink" title="3.3 Precondition Extraction å‰ææ¡ä»¶æå–"></a>3.3 Precondition Extraction å‰ææ¡ä»¶æå–</h3><p>è‡ªåŠ¨å°†æ¯æ¡è§„åˆ™è½¬åŒ–ä¸ºä¸€ç»„é€»è¾‘ä¸Šå®Œæ•´çš„å‰ææ¡ä»¶é“¾ï¼Œä¾¿äºMLLMæ›´å¥½åœ°ç†è§£å¤„ç†ã€‚</p><p>ä¾‹å¦‚â€œä¸åº”æç»˜äººç‰©æˆ–åŠ¨ç‰©èº«ä½“ä¸Šå¸¦æœ‰æ¸…æ™°å¯è§ã€è¡€è…¥ä¸”å¯èƒ½ä¼šå¯¼è‡´å…¶ç«‹å³æ­»äº¡çš„ä¼¤å®³â€è¢«è½¬åŒ–ä¸ºï¼š</p><ol><li>å›¾ä¸­æœ‰å¯è§çš„äºº OR å›¾ä¸­æœ‰å¯è§çš„åŠ¨ç‰©</li><li>èº«ä½“å¸¦æœ‰æ¸…æ™°å¯è§çš„è¡€è…¥ä¼¤å®³</li><li>ä¼¤å®³å¯èƒ½ä¼šå¯¼è‡´å…¶ç«‹å³æ­»äº¡</li></ol><p><img src="https://source.cclmsy.cc/posts/papers/2501.00192/image-4.png" alt="alt text"></p><p>LLMå‰ææ¡ä»¶æå–Promptï¼š</p><p><img src="https://source.cclmsy.cc/posts/papers/2501.00192/image-5.png" alt="alt text"></p><h3 id="3-4-Debiased-Token-Probability-Analysis-å»åæ ‡è®°æ¦‚ç‡åˆ†æ"><a href="#3-4-Debiased-Token-Probability-Analysis-å»åæ ‡è®°æ¦‚ç‡åˆ†æ" class="headerlink" title="3.4 Debiased Token Probability Analysis å»åæ ‡è®°æ¦‚ç‡åˆ†æ"></a>3.4 Debiased Token Probability Analysis å»åæ ‡è®°æ¦‚ç‡åˆ†æ</h3><p>ç»™å®šMLLM $\mathcal{M}$ã€å›¾åƒ$x$å’Œå‰ææ¡ä»¶$c$ï¼Œæˆ‘ä»¬å°†å‰ææ¡ä»¶å¾—åˆ†è®°ä¸ºï¼š</p><p><img src="https://source.cclmsy.cc/posts/papers/2501.00192/image-6.png" alt="alt text"></p><p>ä¹Ÿå°±æ˜¯é¢å¯¹å›¾åƒ$x$ï¼ŒMLLMå¯¹å‰ææ¡ä»¶$c$æ ‡è®°ä¸ºâ€œYesâ€çš„æ¦‚ç‡ã€‚</p><p>å¦‚æœé«˜äºä¸€å®šå€¼ï¼Œåˆ™è®¤ä¸ºå›¾åƒ$x$æ»¡è¶³äº†å‰ææ¡ä»¶$c$ã€‚</p><p>ä¸€ä¸ªç›´è§‚çš„æƒ³æ³•æ˜¯æŠŠé˜ˆå€¼è®¾ä¸º0.5ï¼Œä½†è¿™ä¸ªæ–¹æ³•å­˜åœ¨é—®é¢˜ã€‚</p><p>MLLMå…·æœ‰token probability biasï¼ˆæ ‡è®°æ¦‚ç‡åå·®ï¼‰ï¼Œå³ææ–™æœ¬èº«çš„å«ä¹‰æˆ–å±æ€§ä¼šå¯¹æ¨¡å‹çš„è¾“å‡ºäº§ç”Ÿè¯¯å¯¼ã€‚</p><h4 id="3-4-1-Bias-from-Language-Prior-è¯­è¨€å…ˆéªŒåå·®"><a href="#3-4-1-Bias-from-Language-Prior-è¯­è¨€å…ˆéªŒåå·®" class="headerlink" title="3.4.1 Bias from Language Prior è¯­è¨€å…ˆéªŒåå·®"></a>3.4.1 Bias from Language Prior è¯­è¨€å…ˆéªŒåå·®</h4><p>ç ”ç©¶è¡¨æ˜ï¼ŒMLLMçš„æ ‡è®°æ¦‚ç‡ä¼šå—åˆ°æ¨¡å‹è¯­è¨€å…ˆéªŒçš„å½±å“ã€‚</p><p>åœ¨InternVL2-76Bä¸Šï¼Œå¤§éƒ¨åˆ†å›¾åƒå¯¹äºâ€œè¡€è…¥ä¼¤å®³å¯èƒ½ä¼šå¯¼è‡´å…¶ç«‹å³æ­»äº¡â€çš„â€œYesâ€æ ‡è®°æ¦‚ç‡éƒ½å¾ˆä½ï¼Œå› ä¸ºæ ¹æ®è®­ç»ƒæ•°æ®ï¼Œè¿™ç§å†…å®¹é€šå¸¸ä¸ä¼šå‡ºç°åœ¨å›¾åƒä¸­ã€‚</p><p>è§£å†³ç­–ç•¥ï¼šè¡¡é‡æœ‰æ— å›¾åƒtokenæŸ¥è¯¢ä¹‹é—´çš„å¾—åˆ†å·®å¼‚ã€‚</p><script type="math/tex; mode=display">\mathcal{M}(x, c) - \mathcal{M}(None, c)</script><ul><li>ä½äº0ï¼Œåˆ™å›¾åƒ$x$å¾ˆå¯èƒ½ä¸æ»¡è¶³å‰ææ¡ä»¶$c$ï¼›</li><li>æ˜æ˜¾é«˜äº0ï¼Œå›¾åƒ$x$ææœ‰å¯èƒ½æ»¡è¶³å‰ææ¡ä»¶$c$</li></ul><h4 id="3-4-2-Bias-from-Image-æ¥è‡ªå›¾åƒçš„åå·®"><a href="#3-4-2-Bias-from-Image-æ¥è‡ªå›¾åƒçš„åå·®" class="headerlink" title="3.4.2 Bias from Image æ¥è‡ªå›¾åƒçš„åå·®"></a>3.4.2 Bias from Image æ¥è‡ªå›¾åƒçš„åå·®</h4><p>å›¾åƒçš„éæ ¸å¿ƒéƒ¨åˆ†ä¹Ÿä¼šå¸¦æ¥å¼ºçƒˆçš„åå·®ã€‚</p><p>æ¯”å¦‚å›¾åƒä¸­çš„äººä¸ŠåŠèº«è£¸ä½“ï¼ŒMLLMå¯¹æé—®â€œè¿™ä¸ªäººè£¸éœ²è‡€éƒ¨â€çš„â€œYesâ€æ ‡è®°æ¦‚ç‡ä¼šå¾ˆé«˜ï¼Œå› ä¸ºæ ¹æ®è®­ç»ƒæ•°æ®ï¼Œä¸ŠåŠèº«è£¸éœ²å’Œè‡€éƒ¨è£¸éœ²å…·æœ‰è¾ƒå¼ºçš„ç›¸å…³æ€§ã€‚</p><p>è§£å†³ç­–ç•¥ï¼šè¡¡é‡æ•´å¹…å›¾åƒå’Œåˆ é™¤å›¾åƒæ ¸å¿ƒåŒºåŸŸ$i$åå›¾åƒä¹‹é—´çš„å¾—åˆ†å·®å¼‚</p><script type="math/tex; mode=display">\mathcal{M}(x, c) - \mathcal{M}(x \ominus i, c)</script><p><img src="https://source.cclmsy.cc/posts/papers/2501.00192/image-7.png" alt="alt text"></p><ul><li>ä½¿ç”¨æœ€å…ˆè¿›çš„å¼€æ”¾è¯æ±‡å¯¹è±¡æ£€æµ‹å™¨OWLv2</li><li>æ˜æ˜¾é«˜äº0ï¼Œä¸”å¯¹è±¡æ£€æµ‹è¾¹ç•Œæ¡†ç½®ä¿¡åº¦è¾ƒé«˜ï¼ˆ0.05ï¼‰ï¼Œå›¾åƒ$x$ææœ‰å¯èƒ½æ»¡è¶³å‰ææ¡ä»¶$c$</li></ul><h3 id="3-5-Reasoning-based-Judgment"><a href="#3-5-Reasoning-based-Judgment" class="headerlink" title="3.5 Reasoning-based Judgment"></a>3.5 Reasoning-based Judgment</h3><p>å¦‚æœåŸºäºå»åæ ‡è®°æ¦‚ç‡åˆ†æçš„ç½®ä¿¡åº¦ä¸å¤Ÿï¼ŒCLUEä¼šé‡‡ç”¨åŸºäºæ¨ç†çš„åˆ¤æ–­ã€‚</p><p>åˆ†ä¸º2æ­¥ï¼š</p><ol><li><strong>æ€ç»´é“¾ç”Ÿæˆ</strong><ul><li>ä½¿ç”¨LLMç”Ÿæˆæ€ç»´é“¾ï¼Œæ¨ç†å›¾åƒæ˜¯å¦æ»¡è¶³å‰ææ¡ä»¶</li><li>å¯¹æ ¼å¼ä¸åšè¦æ±‚</li></ul></li><li><strong>æ ¼å¼åŒ–</strong>ï¼šä»¥Jsonæ ¼å¼è¾“å‡ºé¢„æµ‹ç»“æœå’Œç†ç”±</li></ol><p>å“åº”é€Ÿåº¦æ…¢ï¼Œä½†åœ¨ä¹‹å‰æ­¥éª¤ç½®ä¿¡åº¦ä¸è¶³çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥æä¾›æ›´å¯é çš„ç»“æœã€‚</p><h3 id="3-6-Algorithm"><a href="#3-6-Algorithm" class="headerlink" title="3.6 Algorithm"></a>3.6 Algorithm</h3><p><img src="https://source.cclmsy.cc/posts/papers/2501.00192/image-8.png" alt="alt text"></p><h2 id="4-ä¸ªäººæ€è€ƒ"><a href="#4-ä¸ªäººæ€è€ƒ" class="headerlink" title="4. ä¸ªäººæ€è€ƒ"></a>4. ä¸ªäººæ€è€ƒ</h2><h3 id="4-1-è®ºæ–‡äº®ç‚¹"><a href="#4-1-è®ºæ–‡äº®ç‚¹" class="headerlink" title="4.1 è®ºæ–‡äº®ç‚¹"></a>4.1 è®ºæ–‡äº®ç‚¹</h3><h4 id="4-1-1-æ‘†è„±å¯¹äººå·¥æ ‡æ³¨çš„ä¾èµ–"><a href="#4-1-1-æ‘†è„±å¯¹äººå·¥æ ‡æ³¨çš„ä¾èµ–" class="headerlink" title="4.1.1 æ‘†è„±å¯¹äººå·¥æ ‡æ³¨çš„ä¾èµ–"></a>4.1.1 æ‘†è„±å¯¹äººå·¥æ ‡æ³¨çš„ä¾èµ–</h4><ol><li>é‡‡ç”¨0-Shotæ–¹å¼ï¼Œä¸éœ€è¦äººå·¥æ ‡æ³¨æ•°æ®</li><li>æ‰©å±•æ€§ã€é€‚åº”æ€§å¼ºï¼Œå¦‚æœå®‰å…¨è§„åˆ™å‘ç”Ÿå˜åŒ–ï¼Œåªéœ€è¦æ›´æ–°è§„åˆ™é›†ï¼Œæ— éœ€é‡æ–°æ ‡æ³¨æ•°æ®ã€å¾®è°ƒæ¨¡å‹</li><li>è¡¨ç°ä¼˜å¼‚ï¼šç»“æœè¿œé«˜äºbaselineï¼ˆä¸è®ºæ˜¯0-Shotè¿˜æ˜¯åŸºäºfine-tuningçš„æ–¹æ³•ï¼‰</li></ol><h3 id="4-1-2-æ´å¯Ÿä¸è§£å†³MLLMçš„åå·®é—®é¢˜"><a href="#4-1-2-æ´å¯Ÿä¸è§£å†³MLLMçš„åå·®é—®é¢˜" class="headerlink" title="4.1.2 æ´å¯Ÿä¸è§£å†³MLLMçš„åå·®é—®é¢˜"></a>4.1.2 æ´å¯Ÿä¸è§£å†³MLLMçš„åå·®é—®é¢˜</h3><ol><li>ä½œè€…æ´å¯Ÿåˆ°Pre-trained MLLMåœ¨å¤„ç†å›¾åƒå®‰å…¨æ€§åˆ¤æ–­æ—¶å­˜åœ¨åå·®é—®é¢˜</li><li>æå‡ºäº†å»åæ ‡è®°æ¦‚ç‡åˆ†æï¼ˆdebiased token probability analysisï¼‰çš„æ–¹æ³•ï¼Œé’ˆå¯¹è¯­è¨€å…ˆéªŒå’Œå›¾åƒéæ ¸å¿ƒåŒºåŸŸåˆ†åˆ«è¿›è¡Œå»åå¤„ç†</li></ol><h3 id="4-1-3-è§„åˆ™å®¢è§‚åŒ–ä¸å‰ææ¡ä»¶æå–"><a href="#4-1-3-è§„åˆ™å®¢è§‚åŒ–ä¸å‰ææ¡ä»¶æå–" class="headerlink" title="4.1.3 è§„åˆ™å®¢è§‚åŒ–ä¸å‰ææ¡ä»¶æå–"></a>4.1.3 è§„åˆ™å®¢è§‚åŒ–ä¸å‰ææ¡ä»¶æå–</h3><ol><li>è€ƒè™‘äº†å®‰å…¨è§„åˆ™æè¿°å¯èƒ½å…·æœ‰æ¨¡ç³Šæ€§å’Œä¸»è§‚æ€§çš„é—®é¢˜</li><li>é€šè¿‡LLMå¯¹è§„åˆ™è¿›è¡Œå®¢è§‚åŒ–å¤„ç†ï¼Œç¡®ä¿è§„åˆ™æè¿°æ¸…æ™°ã€å¯æ“ä½œ</li><li>å¯¹è§„åˆ™è¿›è¡Œå‰ææ¡ä»¶æå–ï¼Œå°†å¤æ‚è§„åˆ™è½¬åŒ–ä¸ºé€»è¾‘ä¸Šå®Œæ•´çš„å‰ææ¡ä»¶é“¾ï¼Œä¾¿äºMLLMå¤„ç†</li></ol><h3 id="4-1-4-å¤šé˜¶æ®µæ¨ç†æµç¨‹"><a href="#4-1-4-å¤šé˜¶æ®µæ¨ç†æµç¨‹" class="headerlink" title="4.1.4 å¤šé˜¶æ®µæ¨ç†æµç¨‹"></a>4.1.4 å¤šé˜¶æ®µæ¨ç†æµç¨‹</h3><ol><li>é€šè¿‡ç›¸å…³æ€§æ‰«æè¿‡æ»¤ä¸ç›¸å…³è§„åˆ™ï¼Œå‡å°‘MLLMçš„å·¥ä½œé‡</li><li>åœ¨å»åæ ‡è®°æ¦‚ç‡åˆ†æç½®ä¿¡åº¦ä¸è¶³æ—¶ï¼Œé‡‡ç”¨æ€ç»´é“¾è¿›è¡Œæ·±å…¥æ¨ç†ï¼Œç»“åˆäº†ä¸¤è€…çš„ä¼˜åŠ¿</li></ol><h2 id="4-2-è®ºæ–‡å­˜åœ¨çš„é—®é¢˜"><a href="#4-2-è®ºæ–‡å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="4.2 è®ºæ–‡å­˜åœ¨çš„é—®é¢˜"></a>4.2 è®ºæ–‡å­˜åœ¨çš„é—®é¢˜</h2><h3 id="4-2-1-è§„åˆ™å®¢è§‚åŒ–çš„å±€é™æ€§"><a href="#4-2-1-è§„åˆ™å®¢è§‚åŒ–çš„å±€é™æ€§" class="headerlink" title="4.2.1 è§„åˆ™å®¢è§‚åŒ–çš„å±€é™æ€§"></a>4.2.1 è§„åˆ™å®¢è§‚åŒ–çš„å±€é™æ€§</h3><ol><li>ä»…ä½¿ç”¨ç®€çŸ­çš„Promptæç¤ºLLMè¿›è¡Œ1~10åˆ†çš„è¯„åˆ†ï¼Œä½†å¹¶æ²¡æœ‰å…·ä½“çš„è¯„åˆ†æ ‡å‡†æˆ–ç¤ºä¾‹ï¼Œå¯èƒ½å¯¼è‡´è¯„åˆ†ç»“æœä¸ä¸€è‡´</li><li>ä¸èƒ½ä¿è¯LLMçš„è¯„åˆ†å°±æ˜¯å®¢è§‚å‡†ç¡®çš„ã€‚<ul><li>LLMæœ¬èº«å°±å› è®­ç»ƒæ•°æ®ç­‰åŸå› å­˜åœ¨åå·®ï¼Œç”šè‡³å¯èƒ½äº§ç”Ÿå¹»è§‰</li><li>æ¯ä¸€æ¬¡è°ƒç”¨LLMçš„ç»“æœå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œç¼ºä¹ä¸€è‡´æ€§</li></ul></li><li>LLMå¯èƒ½æ ¹æ®è‡ªå·±çš„ç†è§£å°†è§„åˆ™ä¿®æ”¹ä¸ºå­è§„åˆ™ï¼Œè€Œé—æ¼éƒ¨åˆ†æƒ…å†µï¼Œå½±å“åˆ¤æ–­ç»“æœ</li></ol><h3 id="4-2-2-æœªè€ƒè™‘MLLMå—å¯¹æŠ—æ”»å‡»çš„å½±å“"><a href="#4-2-2-æœªè€ƒè™‘MLLMå—å¯¹æŠ—æ”»å‡»çš„å½±å“" class="headerlink" title="4.2.2 æœªè€ƒè™‘MLLMå—å¯¹æŠ—æ”»å‡»çš„å½±å“"></a>4.2.2 æœªè€ƒè™‘MLLMå—å¯¹æŠ—æ”»å‡»çš„å½±å“</h3><p>MLLMå·²è¢«è¯æ˜æ˜“å—å¯¹æŠ—æ€§æ”»å‡»ï¼šå°å¹…åº¦ä¿®æ”¹è¾“å…¥å›¾åƒï¼Œå¯¼è‡´æ¨¡å‹è¾“å‡ºé”™è¯¯çš„ç»“æœã€‚</p><p>ä¸€ç¯‡ç ”ç©¶<a href="https://arxiv.org/abs/2505.21494">ã€ŠAdversarial Attacks against Closed-Source MLLMs via Feature Optimal Alignmentã€‹</a>ç”šè‡³å¯ä»¥å¯¹é—­æºçš„MLLMè¿›è¡Œå¯¹æŠ—æ”»å‡»ã€‚</p><p>CLUEä¸­å°±å­˜åœ¨å¤šä¸ªå¯èƒ½è¢«å¯¹æŠ—æ”»å‡»çš„ç¯èŠ‚ï¼š</p><ol><li>CLIPç¼–ç å™¨çš„ç›¸å…³æ€§æ‰«æï¼šè®¾è®¡ä¸€ä¸ªä¸å®‰å…¨çš„å›¾åƒï¼Œå…¶å¯¹æŠ—æ€§æ‰°åŠ¨ä¸“é—¨é’ˆå¯¹CLIPæ¨¡å‹ ï¼Œä½¿å…¶å¯¹ç›¸å…³å®‰å…¨è§„åˆ™äº§ç”Ÿä½ç›¸å…³æ€§åˆ†æ•°ï¼Œä»è€Œå¯¼è‡´å¤§éƒ¨åˆ†ç›¸å…³è§„åˆ™è¢«è¿‡æ»¤æ‰ï¼Œè¿›è€Œå‡å°‘å›¾åƒè¢«åˆ¤æ–­ä¸ºä¸å®‰å…¨çš„å¯èƒ½æ€§</li><li>ç”±äºå‰ææ¡ä»¶æå–ï¼Œå¤æ‚è§„åˆ™è¢«åˆ†è§£ä¸ºå¤šä¸ªå‰ææ¡ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥é’ˆå¯¹ä¸ªåˆ«æ¡ä»¶è¿›è¡Œå¯¹æŠ—æ€§æ‰°åŠ¨ï¼Œä½¿å¾—æŸäº›å‰ææ¡ä»¶çš„æ ‡è®°æ¦‚ç‡ä½äºé˜ˆå€¼</li></ol><h2 id="4-3-æ”¹è¿›æ€è·¯å’Œå»ºè®®"><a href="#4-3-æ”¹è¿›æ€è·¯å’Œå»ºè®®" class="headerlink" title="4.3 æ”¹è¿›æ€è·¯å’Œå»ºè®®"></a>4.3 æ”¹è¿›æ€è·¯å’Œå»ºè®®</h2><h3 id="4-3-1-è§„åˆ™å®¢è§‚åŒ–çš„æ”¹è¿›"><a href="#4-3-1-è§„åˆ™å®¢è§‚åŒ–çš„æ”¹è¿›" class="headerlink" title="4.3.1 è§„åˆ™å®¢è§‚åŒ–çš„æ”¹è¿›"></a>4.3.1 è§„åˆ™å®¢è§‚åŒ–çš„æ”¹è¿›</h3><ol><li>å¼•å…¥è¯„åˆ†æ ‡å‡†ï¼šä¸ºLLMè¯„åˆ†æä¾›æ˜ç¡®çš„æ ‡å‡†å’Œç¤ºä¾‹ï¼Œç¡®ä¿è¯„åˆ†çš„ä¸€è‡´æ€§å’Œå®¢è§‚æ€§</li><li>å¤šæ¨¡å‹å¹¶è¡Œå–å¹³å‡ï¼šæ ¹æ®åŒä¸€è§„åˆ™ï¼Œè°ƒç”¨å¤šä¸ªä¸åŒçš„LLMè¿›è¡Œè¯„åˆ†ï¼Œå–å¹³å‡å€¼ï¼Œå‡å°‘å•ä¸€æ¨¡å‹åå·®çš„å½±å“</li></ol><h3 id="4-3-2-å¢å¼ºå¯¹æŠ—æ”»å‡»çš„é˜²å¾¡"><a href="#4-3-2-å¢å¼ºå¯¹æŠ—æ”»å‡»çš„é˜²å¾¡" class="headerlink" title="4.3.2 å¢å¼ºå¯¹æŠ—æ”»å‡»çš„é˜²å¾¡"></a>4.3.2 å¢å¼ºå¯¹æŠ—æ”»å‡»çš„é˜²å¾¡</h3><p>ä¸€ä¸ªå®ç”¨ã€å…è®­ç»ƒçš„æ–¹æ³•æ˜¯é‡‡ç”¨æ¨¡å‹é›†æˆã€‚<br>2020å¹´9æœˆçš„ä¸€ç¯‡è®ºæ–‡<a href="https://arxiv.org/abs/2009.09612">ã€ŠImproving Ensemble Robustness by Collaboratively Promoting and Demoting Adversarial Robustnessã€‹</a>æå‡ºåŸºäºé›†åˆçš„å¯¹æŠ—è®­ç»ƒæ˜¯å®ç°å¯¹æŠ—æ”»å‡»é²æ£’æ€§çš„ä¸€ç§æ–¹æ³•ã€‚</p><p>ä¾‹å¦‚ï¼Œè®©å¤šæ¬¾ä¸åŒçš„MLLMï¼ˆå¦‚InternVLã€LLaVAã€GPT-4Vï¼‰å¯¹åŒä¸€å¼ å›¾ç‰‡è¿›è¡Œåˆ¤æ–­ï¼Œå¹¶è¦æ±‚è¾¾æˆå…±è¯†ï¼Œè¿™å¯ä»¥æé«˜é²æ£’æ€§ï¼Œå› ä¸ºé’ˆå¯¹æŸä¸€æ¨¡å‹çš„æ”»å‡»å¯èƒ½æ— æ³•è¿ç§»åˆ°å…¶ä»–æ¨¡å‹ä¸Šã€‚</p>]]></content>
    
    
    <summary type="html">é˜…è¯»è®ºæ–‡ã€ŠMLLM-as-a-Judge for Image Safety without Human Labelingã€‹</summary>
    
    
    
    <category term="è®ºæ–‡ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="è®ºæ–‡ç¬”è®°" scheme="https://www.cclmsy.cc/tags/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/"/>
    
    <category term="AIå®‰å…¨" scheme="https://www.cclmsy.cc/tags/AI%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>è®ºæ–‡ç¬”è®°&amp;å®ç°|PlugIRï¼šåŸºäºå¯¹è¯çš„å›¾åƒæ£€ç´¢ç³»ç»Ÿ</title>
    <link href="https://www.cclmsy.cc/posts/2406.03411.html"/>
    <id>https://www.cclmsy.cc/posts/2406.03411.html</id>
    <published>2025-04-09T16:00:00.000Z</published>
    <updated>2025-10-15T08:42:17.709Z</updated>
    
    <content type="html"><![CDATA[<p>è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/2406.03411">Interactive Text-to-ImageRetrieval with Large Language Models: A Plug-and-Play Approach</a></p><h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h2><p>ChatIRæ˜¯ä¸€ç§åŸºäºèŠå¤©çš„æ–‡æœ¬åˆ°å›¾åƒçš„æ–¹æ³•ï¼Œæå‡ºäº†åˆ©ç”¨LLMè¿›è¡Œå¤šè½®å¯¹è¯ä»¥æé«˜æ£€ç´¢æ•ˆç‡ã€‚ï¼ˆæˆ‘çš„é˜…è¯»ç¬”è®°è§<a href="https://www.cclmsy.cc/posts/2305.20062.html">Link</a>ï¼‰</p><p>è¿™ä¸ªæ–¹æ³•å…·æœ‰ä»¥ä¸‹ä¸è¶³ï¼š</p><ol><li>éœ€è¦è¿›è¡Œå¾®è°ƒæ–‡æœ¬ç¼–ç å™¨ï¼Œæ¥é€‚åº”å¤šè½®å¯¹è¯æ•°æ®<ul><li>å¾®è°ƒè€—è´¹èµ„æºã€å¯æ‰©å±•æ€§å·®ã€‚</li><li>è§£å†³æ–¹æ³•ï¼šå°†å¯¹è¯é‡æ„ä¸ºå¯ä»¥ç›´æ¥è¾“å…¥åˆ°é¢„è®­ç»ƒçš„è§†è§‰è¯­è¨€æ¨¡å‹çš„æ ¼å¼ï¼Œä¸éœ€è¦å¯¹æ¨¡å‹è¿›è¡Œå¾®è°ƒ</li></ul></li><li>LLMæé—®è€…GåªçŸ¥é“å¯¹è¯å†å²ï¼Œæ— æ³•æŸ¥çœ‹å€™é€‰å›¾åƒ<ul><li>å¯èƒ½ç”Ÿæˆå›¾åƒä¸­ä¸å­˜åœ¨çš„å±æ€§çš„è¯¢é—®</li><li>LLMæé—®è€…åŸºäºå€™é€‰é›†æé—®ï¼Œç¡®ä¿é—®é¢˜ä¸å›¾åƒå±æ€§ç›¸å…³</li></ul></li></ol><p>æœ¬æ–‡æå‡ºçš„PlugIRç³»ç»ŸåŒ…å«2ä¸ªéƒ¨åˆ†ï¼šä¸Šä¸‹æ–‡é‡æ„ï¼ˆContext Reformulationï¼‰å’Œä¸Šä¸‹æ–‡æ„ŸçŸ¥å¯¹è¯ç”Ÿæˆï¼ˆContext-aware Dialogue Generationï¼‰</p><p><img src="https://source.cclmsy.cc/posts/papers/2406.03411/PlugIR.png" alt="PlugIR"></p><p>æœ¬æ–‡è´¡çŒ®ï¼š</p><ol><li>å®è¯0æ ·æœ¬æˆ–å¾®è°ƒçš„å¤§æ¨¡å‹éš¾ä»¥ç†è§£å¯¹è¯æ•°æ®</li><li>æå‡ºäº†ä¸€ç§LLMæé—®è€…ï¼Œè§£å†³äº†å› å†—ä½™é—®é¢˜å’Œå™ªå£°é—®é¢˜å¸¦æ¥çš„æ€§èƒ½ç“¶é¢ˆ</li><li>æå‡ºæ–°æŒ‡æ ‡BRIï¼ˆæœ€ä½³å¯¹æ•°æ’åç§¯åˆ†ï¼ŒBest log Rank Integralï¼‰<ul><li>æ¯”Recall@Kå’ŒHit@Kæ›´æ¥è¿‘äººçš„è¯„ä»·ï¼Œæ›´å…¨é¢åœ°è¯„ä¼°äº¤äº’å¼æ£€ç´¢ç³»ç»Ÿ</li></ul></li><li>PlugIRå…·æœ‰å³æ’å³ç”¨çš„ç‰¹æ€§ï¼Œä¸”å…·æœ‰å®ç”¨æ€§</li></ol><h2 id="2-Related-Work"><a href="#2-Related-Work" class="headerlink" title="2. Related Work"></a>2. Related Work</h2><ul><li>æ–‡æœ¬åˆ°å›¾åƒæ£€ç´¢</li><li>è§†è§‰è¯­è¨€æ¨¡å‹ï¼šBLIPã€CLIP</li><li>å¤§è¯­è¨€æ¨¡å‹LLM</li></ul><h2 id="3-Method"><a href="#3-Method" class="headerlink" title="3. Method"></a>3. Method</h2><h3 id="3-1-Preliminaries-InteractiveText-to-Image-Retrieval-äº¤äº’å¼æ–‡æœ¬åˆ°å›¾åƒæ£€ç´¢"><a href="#3-1-Preliminaries-InteractiveText-to-Image-Retrieval-äº¤äº’å¼æ–‡æœ¬åˆ°å›¾åƒæ£€ç´¢" class="headerlink" title="3.1 Preliminaries:InteractiveText-to-Image Retrieval äº¤äº’å¼æ–‡æœ¬åˆ°å›¾åƒæ£€ç´¢"></a>3.1 Preliminaries:InteractiveText-to-Image Retrieval äº¤äº’å¼æ–‡æœ¬åˆ°å›¾åƒæ£€ç´¢</h3><p>å¯¹è¯è®°å½•è¡¨ç¤ºï¼š$D_i = (C, Q_1, A_1, â€¦, Q_i)$</p><ul><li>$C$ï¼šç›®æ ‡å›¾åƒçš„åˆå§‹æ–‡æœ¬æè¿°ï¼ˆæ ‡é¢˜ï¼‰</li><li>$Q_i$ï¼šç¬¬iä¸ªé—®é¢˜</li><li>$A_i$ï¼šç¬¬iä¸ªå›ç­”</li></ul><p>æ£€ç´¢ç³»ç»Ÿå°†æ•°æ®åº“ä¸­çš„æ‰€æœ‰å›¾ç‰‡ä¸æ–‡æœ¬è¿›è¡ŒåŒ¹é…ï¼Œæ ¹æ®ç›¸ä¼¼åº¦è¿›è¡Œæ’åºï¼Œæ ¹æ®ç›®æ ‡æ’åè¯„ä¼°ç³»ç»Ÿæ€§èƒ½ã€‚</p><ul><li>Recall@Kï¼šæœ¬è½®äº¤äº’æ£€ç´¢åˆ°çš„å‰Kå¼ å›¾ç‰‡åŒ…å«ç›®æ ‡çš„æ¦‚ç‡</li><li>Hit@Kï¼šæœ¬è½®ä»¥åŠä»»æ„ä¸€è½®çš„äº¤äº’æ£€ç´¢åˆ°çš„å‰Kå¼ å›¾ç‰‡åŒ…å«ç›®æ ‡çš„æ¦‚ç‡</li></ul><h3 id="3-2-Context-Reformulation-ä¸Šä¸‹æ–‡é‡æ„"><a href="#3-2-Context-Reformulation-ä¸Šä¸‹æ–‡é‡æ„" class="headerlink" title="3.2 Context Reformulation ä¸Šä¸‹æ–‡é‡æ„"></a>3.2 Context Reformulation ä¸Šä¸‹æ–‡é‡æ„</h3><p>ä½œè€…æµ‹è¯•äº†0æ ·æœ¬çš„CLIPã€BLIPã€BLIP-2å’Œä¸€ä¸ªé»‘ç®±æ¨¡å‹ATM</p><ul><li>Hit@Ké€æ­¥æå‡ï¼Œä½†è¿™æ˜¯ç”±å…¶å®šä¹‰å†³å®šçš„</li><li>Recall@Kåœ¨ä»…åŒ…å«æœ€åˆçš„æ–‡æœ¬æè¿°æ—¶æœ€é«˜ï¼Œéšç€å¯¹è¯è½®æ¬¡å¢åŠ è€Œä¸‹é™<ul><li>å¯¹è¯åœ¨0æ ·æœ¬æ¨¡å‹ä¸Šå¯èƒ½æ²¡æœ‰è´¡çŒ®ã€äº§ç”Ÿäº†å™ªå£°</li><li>0æ ·æœ¬æ¨¡å‹æ— æ³•ç†è§£å¯¹è¯æ•°æ®</li></ul></li></ul><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€ç§æ–¹æ³•æ˜¯åƒChatIRä¸€æ ·å¯¹æ¨¡å‹è¿›è¡Œå¾®è°ƒï¼Œä½†è¿™æ ·åšæœ‰ä»¥ä¸‹é™åˆ¶ï¼š</p><ol><li>ä¸èƒ½ä½¿ç”¨é»‘ç®±æ¨¡å‹ï¼Œæ¯”å¦‚ATM</li><li>éœ€è¦å¤§é‡çš„è®­ç»ƒæ•°æ®</li></ol><p>æœ¬æ–‡ä¸ç›´æ¥ä½¿ç”¨å¯¹è¯ä½œä¸ºè¾“å…¥è¿›è¡ŒæŸ¥è¯¢ï¼Œè€Œæ˜¯å°†å¯¹è¯é‡æ„ä¸ºå¯ä»¥ç›´æ¥è¾“å…¥åˆ°é¢„è®­ç»ƒçš„è§†è§‰è¯­è¨€æ¨¡å‹çš„æ ¼å¼ï¼Œä¸éœ€è¦å¯¹æ¨¡å‹è¿›è¡Œå¾®è°ƒï¼ˆå³æ‰€è°“çš„Plug-and-Playï¼‰ã€‚</p><h3 id="3-3-Context-aware-Dialogue-Generation-ä¸Šä¸‹æ–‡æ„ŸçŸ¥å¯¹è¯ç”Ÿæˆ"><a href="#3-3-Context-aware-Dialogue-Generation-ä¸Šä¸‹æ–‡æ„ŸçŸ¥å¯¹è¯ç”Ÿæˆ" class="headerlink" title="3.3 Context-aware Dialogue Generation ä¸Šä¸‹æ–‡æ„ŸçŸ¥å¯¹è¯ç”Ÿæˆ"></a>3.3 Context-aware Dialogue Generation ä¸Šä¸‹æ–‡æ„ŸçŸ¥å¯¹è¯ç”Ÿæˆ</h3><p>ä»…é å¯¹è¯å†å²ç”Ÿæˆé—®é¢˜å…·æœ‰ä»¥ä¸‹é—®é¢˜ï¼š</p><ol><li>ç”Ÿæˆçš„é—®é¢˜å¯èƒ½ä¸å›¾åƒå±æ€§æ— å…³</li><li>å¯èƒ½è¯¢é—®å†å²å¯¹è¯ä¸­å·²æœ‰ä¿¡æ¯</li></ol><p>æé—®è¿‡ç¨‹ï¼ˆç”¨äºè§£å†³é—®é¢˜1ï¼‰ï¼š</p><ol><li>ä½¿ç”¨é‡æ„åçš„æŸ¥è¯¢è¯­å¥è¿›è¡Œæ£€ç´¢ï¼Œæ‰¾å‡ºé«˜ç›¸ä¼¼åº¦çš„â€œæ£€ç´¢å€™é€‰â€å›¾åƒé›†</li><li>å¯¹å€™é€‰å›¾åƒEmbeddingsè¿›è¡ŒK-meansèšç±»ï¼Œå¾—åˆ°æ¯ä¸ªå€™é€‰å›¾åƒä¸å…¶ä»–å›¾åƒçš„ç›¸ä¼¼åº¦å¾—åˆ†åˆ†å¸ƒ</li><li>å¯¹äºæ¯ä¸ªèšç±»ï¼Œé€‰æ‹©<code>ç›¸ä¼¼åº¦åˆ†å¸ƒç†µ</code>æœ€å°çš„å›¾åƒä½œä¸ºä»£è¡¨<ul><li>ç†µè¶Šå°ï¼Œå±æ€§è¶ŠçœŸå®ã€è¶Šå®¹æ˜“åŒºåˆ†</li><li>ä¾‹å¦‚ï¼ŒåŒä¸€ç»„å›¾åƒå¯¹â€œä¸€å¼ é…æœ‰2å°ç”µè„‘æ˜¾ç¤ºå™¨å’Œä¸€å‰¯é”®ç›˜çš„æ¡Œå­â€çš„æè¿°ç†µæ›´ä½ï¼Œå¯¹â€œåŠå…¬å®¤â€çš„æè¿°ç†µæ›´é«˜</li></ul></li><li>å°†è¿™Kå‰¯å›¾åƒé€šè¿‡image2textæ¨¡å‹ç”Ÿæˆcaptionï¼Œä½œä¸ºé™„åŠ ä¿¡æ¯æä¾›ç»™LLMæé—®è€…</li></ol><p>æé—®ï¼ˆç®—æ³•1ï¼‰ä¼ªä»£ç ï¼š</p><ol><li>è¾“å…¥ï¼šå¯¹è¯ä¸Šä¸‹æ–‡$c$ã€å›¾åƒåº“$I$ã€â€œæ£€ç´¢å€™é€‰â€å›¾åƒæ•°$n$ã€èšç±»æ•°$m$ã€ç›¸ä¼¼åº¦å‡½æ•°$sim$ã€$KMeans$ã€i2tæ¨¡å‹$Captioning$</li><li>ä»$I$ä¸­é€‰å‡ºå‰$n$ä¸ªå’Œ$c$æœ€ç›¸ä¼¼çš„å›¾åƒï¼Œä½œä¸º$S_R$<ol><li>åˆå§‹åŒ–$S_R \leftarrow {}$</li><li>$while S_R.size() &lt; n do$<ol><li>å°†å’Œ$c$æœ€ç›¸ä¼¼çš„å›¾åƒ$x$åŠ å…¥$S_R$</li><li>å°†$x$ä»$I$ä¸­ç§»é™¤</li></ol></li></ol></li><li>å¯¹$S_R$è¿›è¡Œ$KMeans$èšç±»ï¼Œå¾—åˆ°$m$ä¸ªèšç±»$S_R^{(1)}, S_R^{(2)}, â€¦, S_R^{(m)}$</li><li>è®¡ç®—æ¯ä¸ªå›¾åƒç›¸å¯¹$S<em>R$çš„æ¦‚ç‡ï¼Œä½¿ç”¨Softmaxå¾—åˆ°$P_c(x)=\frac{exp(sim(c, x))}{\sum</em>{xâ€™ \in S_R} exp(sim(c, xâ€™))}$</li><li>ä»æ¯ä¸ªç°‡$S_R^{(i)}$ä¸­é€‰æ‹©æœ€ä¼˜çš„å›¾åƒï¼Œå¹¶å¯¹è¿™$m$ä¸ªå›¾åƒè¿›è¡Œ$Captioning$ï¼Œå¾—åˆ°$T$<ol><li>$for i in range(1,m+1) do$<ol><li>è®¡ç®—å½“å‰ç°‡$S_R^{(i)}$ä¸­æ‰€æœ‰å›¾åƒçš„ç†µï¼Œå¹¶æ‰¾å‡ºæœ€å°ç†µçš„å›¾åƒ$\hat x^{(i)}$</li><li>å¯¹$\hat x^{(i)}$è¿›è¡Œ$Captioning$ï¼Œå¹¶åŠ å…¥$T$</li></ol></li></ol></li><li>è¿”å›ï¼š$T$</li></ol><p>é‡‡ç”¨æ€ç»´é“¾ï¼ˆChain of Thoughtï¼‰çš„æ–¹æ³•ï¼Œæç¤ºè¯ä½äºåŸæ–‡18~19é¡µï¼Œè·å–ä¸å›¾åƒç›¸å…³çš„é—®é¢˜ã€‚<br>è¿™æ ·ç”Ÿæˆçš„é—®é¢˜ä»ç„¶å¯èƒ½å†—ä½™ï¼ˆå·²ç»çŸ¥é“ç­”æ¡ˆï¼‰ï¼Œè¿˜éœ€è¦ç»è¿‡è¿‡æ»¤ã€‚</p><p>è¿‡æ»¤è¿‡ç¨‹ï¼ˆç”¨äºè§£å†³é—®é¢˜2ï¼‰ï¼š</p><ol><li>é€šè¿‡ä¸Šä¸‹æ–‡å›ç­”å‡½æ•°ï¼Œåˆ¤æ–­é—®é¢˜æ˜¯å¦â€œç¡®å®šâ€ï¼Œé€‰å–â€œä¸ç¡®å®šâ€çš„é—®é¢˜</li><li>é€‰æ‹©â€œä¸ç¡®å®šâ€çš„é—®é¢˜ä¸­KLæ•£åº¦æœ€å°çš„é—®é¢˜<ol><li>KLæ•£åº¦ï¼š$KL(P<em>c||P</em>{c,q})=\sum<em>{x \in T} P_c(x)log\frac{P_c(x)}{P</em>{c,q}(x)}$</li><li>ç”¨äºé˜²æ­¢ä¸åˆé€‚çš„é—®é¢˜å¯¼è‡´ç›¸ä¼¼åº¦éª¤å˜</li></ol></li></ol><p>è¿‡æ»¤ï¼ˆç®—æ³•2ï¼‰ä¼ªä»£ç ï¼š</p><ol><li>è¾“å…¥ï¼šå¯¹è¯ä¸Šä¸‹æ–‡$c$ã€é—®é¢˜é›†åˆ$Q$ã€æ£€ç´¢å€™é€‰é›†$T$ã€ç›¸ä¼¼åº¦å‡½æ•°$sim$ã€ä¸Šä¸‹æ–‡å›ç­”å‡½æ•°$Answer$</li><li>å®šä¹‰è®¡ç®—ä¸Šä¸‹æ–‡æ¦‚ç‡åˆ†å¸ƒçš„å‡½æ•°<ol><li>å›¾åƒ$x$åœ¨ä¸Šä¸‹æ–‡$c$ä¸‹çš„åˆ†å¸ƒï¼š$P<em>c(x)=\frac{exp(sim(c, x))}{\sum</em>{xâ€™ \in T} exp(sim(c, xâ€™))}$</li><li>åŠ å…¥é—®é¢˜$q$åå›¾åƒ$x$åœ¨ä¸Šä¸‹æ–‡$c$ä¸‹çš„åˆ†å¸ƒï¼š$P<em>{c,q}(x)=\frac{exp(sim(concat(c, q), x))}{\sum</em>{xâ€™ \in T} exp(sim(concat(c, q), xâ€™))}$</li></ol></li><li>ç­›é€‰å‡ºç­”æ¡ˆâ€œä¸ç¡®å®šâ€çš„é—®é¢˜ï¼Œä½œä¸º $Qâ€™$<ol><li>åˆå§‹åŒ– $Qâ€™ \leftarrow {}$</li><li>$for q in Q do$<ol><li>å¦‚æœ $Answer(c, q)$ ä¸ºâ€œä¸ç¡®å®šâ€ï¼Œåˆ™åŠ å…¥ $Qâ€™$</li></ol></li></ol></li><li>é€‰æ‹©KLæ•£åº¦æœ€å°çš„é—®é¢˜ $\hat q$</li><li>è¿”å›ï¼š$\hat q$</li></ol><h3 id="3-4-The-Best-Log-Rank-Integral-BRI-Metric-æœ€ä½³å¯¹æ•°æ’åç§¯åˆ†"><a href="#3-4-The-Best-Log-Rank-Integral-BRI-Metric-æœ€ä½³å¯¹æ•°æ’åç§¯åˆ†" class="headerlink" title="3.4 The Best Log Rank Integral (BRI) Metric æœ€ä½³å¯¹æ•°æ’åç§¯åˆ†"></a>3.4 The Best Log Rank Integral (BRI) Metric æœ€ä½³å¯¹æ•°æ’åç§¯åˆ†</h3><p>ä½œè€…æŒ‡å‡ºï¼Œåœ¨è¯„ä¼°äº¤äº’å¼æ£€ç´¢ç³»ç»Ÿæ—¶ï¼Œæœ‰3ä¸ªå…³é”®ç‚¹ï¼š</p><ol><li>ç”¨æˆ·æ»¡æ„åº¦ï¼šåœ¨å¤šå°‘æ¬¡äº¤äº’ä¸­è‡³å°‘æ‰¾åˆ°äº†ä¸€æ¬¡ç›®æ ‡å›¾åƒç®—æ»¡æ„</li><li>æ•ˆç‡ï¼šæˆåŠŸæ£€ç´¢æ‰€éœ€è½®æ¬¡è¶Šå°‘è¶Šå¥½</li><li>æ’åæå‡æ„ä¹‰ï¼šæ’åé å‰æ—¶æå‡æ’åçš„æ„ä¹‰æ›´å¤§ï¼Œå¦‚ä»2åˆ°1æ¯”ä»100åˆ°99æ›´æœ‰æ„ä¹‰</li></ol><p>Recall@Kç”¨äºéäº¤äº’å¼æ£€ç´¢ï¼›Hit@Kåªè€ƒè™‘äº†ç”¨æˆ·æ»¡æ„åº¦</p><p>ä½œè€…æå‡ºäº†BRIæŒ‡æ ‡ï¼Œç»¼åˆäº†ç”¨æˆ·æ»¡æ„åº¦ã€æ•ˆç‡å’Œæ’åæå‡æ„ä¹‰</p><p>è®°ï¼š$Q$é—®é¢˜é›†åˆã€$T$æœ€å¤§è½®æ¬¡</p><p>$\pi(q_t)$ï¼šè¡¨ç¤ºå…·æœ‰$t$è½®å¯¹è¯çš„æŸ¥è¯¢$q_t$ï¼Œåœ¨è¿™$t$è½®æŸ¥è¯¢ä¸­ï¼Œç›®æ ‡å›¾åƒçš„å†å²æœ€ä½³æ’åï¼Œç”¨äºè¡¡é‡ç”¨æˆ·æ»¡æ„åº¦</p><p>BRIï¼š$\mathbb E<em>{q \in Q}\left[ \dfrac{1}{2T}\log\pi(q_0)\pi(q_T)+\dfrac{1}{T}\sum\limits</em>{t=1}^{T-1}\log\pi(q_t)\right]$</p><ul><li>è¾¹ç•Œé¡¹ï¼š$\dfrac{1}{2T}\log\pi(q_0)\pi(q_T)$<ul><li>æƒé‡è¾ƒå°ï¼Œåæ˜ åˆå§‹æŸ¥è¯¢$q_0$åˆ°æœ€ç»ˆæŸ¥è¯¢$q_T$çš„æ’åæ”¹å–„æƒ…å†µ</li></ul></li><li>å¹³å‡æŸ¥è¯¢æ’åé¡¹ï¼š$\dfrac{1}{T}\sum\limits_{t=1}^{T-1}\log\pi(q_t)$<ul><li>è®¡ç®—äº†æŸ¥è¯¢$q$çš„æ‰€æœ‰$t$è½®ä¸­ï¼Œç›®æ ‡çš„å†å²æœ€ä½³æ’åçš„å¯¹æ•°çš„å‡å€¼</li><li>å¯¹æ•°å‡½æ•°ä½¿å¾—ä½æ’åçš„è¿›ä¸€æ­¥é™ä½å¯¹BRIå˜åŒ–çš„å½±å“æ›´å¤§</li></ul></li><li>BRIè¶Šå°ï¼Œæ€§èƒ½è¶Šå¥½</li><li>BRIä¸ä¾èµ–äºå…·ä½“çš„Kå€¼ï¼Œæ›´å…¨é¢ã€ç»Ÿä¸€</li><li>å®éªŒè¡¨æ˜ï¼ŒBRIä¸äººç±»è¯„ä»·æ›´æ¥è¿‘</li></ul><h2 id="4-Experiments"><a href="#4-Experiments" class="headerlink" title="4. Experiments"></a>4. Experiments</h2><ul><li>æ•°æ®é›†ï¼šVisdailã€COCOã€Flickr30k</li><li>æ–‡æœ¬åˆ°å›¾åƒæ£€ç´¢æ¨¡å‹ï¼šé»˜è®¤BLIPï¼Œä¹Ÿæœ‰BLIP-2ã€ATM</li><li>LLMæé—®è€…ï¼šChatGPT</li><li>æµ‹è¯•é›†å›ç­”è€…ï¼šBLIP-2</li><li>èšç±»æ•°mï¼š10</li></ul><p>Baselineï¼š0-shotã€ChatIR</p><p>åŒæ—¶è¿›è¡Œäº†Ablation Studyï¼Œæµ‹è¯•äº†ä¸åŒç»„ä»¶çš„åŠ å…¥å¯¹ç»“æœçš„å½±å“</p><h2 id="æ€»ç»“å’Œå®ç°"><a href="#æ€»ç»“å’Œå®ç°" class="headerlink" title="æ€»ç»“å’Œå®ç°"></a>æ€»ç»“å’Œå®ç°</h2><ul><li>PlugIRç³»ç»Ÿä¹Ÿæ˜¯ä¸€ä¸ªåŸºäºå¯¹è¯çš„å›¾åƒæ£€ç´¢ç³»ç»Ÿï¼Œåœ¨ChatIRçš„åŸºç¡€ä¸Šè¿›è¡Œäº†æ”¹è¿›</li><li>ä¸»è¦ä¼˜åŒ–äº†æé—®è¿‡ç¨‹ï¼Œä½¿å¾—æé—®çš„æœ‰æ•ˆæ€§æå‡</li><li>ä½¿ç”¨äº†æ–°çš„è¯„ä¼°æŒ‡æ ‡BRIï¼Œèƒ½å¤Ÿæ›´å…¨é¢åœ°è¯„ä¼°äº¤äº’å¼æ£€ç´¢ç³»ç»Ÿ</li></ul><p>ç”±äºç³»ç»Ÿä»£ç é‡è¾ƒå¤§ï¼Œåœ¨å®ç°æ—¶åˆ’åˆ†åˆ°å¤šä¸ªæ–‡ä»¶</p><h3 id="config-py"><a href="#config-py" class="headerlink" title="config.py"></a>config.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line">config = &#123;</span><br><span class="line">    <span class="string">&quot;hitk&quot;</span> : <span class="number">10</span>, <span class="comment"># hit@k</span></span><br><span class="line">    <span class="string">&quot;q_num&quot;</span> : <span class="number">5</span>, <span class="comment"># å¾…selectçš„é—®é¢˜æ•°é‡</span></span><br><span class="line">    <span class="string">&quot;threshold_low&quot;</span> : <span class="number">500</span>, <span class="comment"># ä½é˜ˆå€¼ï¼Œç”¨äºè®¡ç®—Kmeansèšç±»æ—¶çš„æ ·æœ¬æ•°</span></span><br><span class="line">    <span class="string">&quot;gpt_model&quot;</span> : <span class="string">&#x27;gpt-4o-mini&#x27;</span>, <span class="comment"># OpenAIæ¨¡å‹åç§°</span></span><br><span class="line">    <span class="string">&quot;api_key&quot;</span> : <span class="string">&quot;&quot;</span>, <span class="comment"># OpenAI APIå¯†é’¥</span></span><br><span class="line">    <span class="string">&quot;vqa_model&quot;</span> : <span class="string">&#x27;Salesforce/blip2-flan-t5-xl&#x27;</span>, <span class="comment"># VQAæ¨¡å‹åç§°</span></span><br><span class="line">    <span class="string">&quot;retriever&quot;</span> : <span class="string">&quot;blip&quot;</span>, <span class="comment"># æ£€ç´¢å™¨åç§°ï¼Œblipæˆ–clip</span></span><br><span class="line">    <span class="string">&quot;device&quot;</span> : torch.device(<span class="string">&quot;cuda&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>),</span><br><span class="line">    <span class="string">&quot;sep_token&quot;</span> : <span class="string">&quot;, &quot;</span>, <span class="comment"># ChatIRåˆ†éš”ç¬¦</span></span><br><span class="line">    <span class="string">&quot;eval_caption&quot;</span> : <span class="literal">True</span>, <span class="comment"># evalæ—¶æ˜¯å¦ä¸ºPlugIRæ€»ç»“çš„Captionï¼ŒTrueï¼šPlugIRï¼ŒFalseï¼šChatIR</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç®—æ³•é…ç½®</span></span><br><span class="line">    <span class="string">&quot;referring&quot;</span> : <span class="literal">True</span>, <span class="comment"># æ˜¯å¦å‚è€ƒå€™é€‰é›†Captionæé—®ï¼ˆç®—æ³•1ï¼‰</span></span><br><span class="line">    <span class="string">&quot;filtering&quot;</span> : <span class="literal">True</span>, <span class="comment"># æ˜¯å¦AIè¿‡æ»¤é—®é¢˜ï¼ˆç®—æ³•2ï¼‰</span></span><br><span class="line">    <span class="string">&quot;select&quot;</span> : <span class="literal">True</span>, <span class="comment"># æ˜¯å¦ä½¿ç”¨KLæ•£åº¦é€‰æ‹©é—®é¢˜ï¼ˆç®—æ³•2ï¼‰</span></span><br><span class="line">    <span class="string">&quot;reconstruct&quot;</span> : <span class="literal">True</span>, <span class="comment"># æ˜¯å¦é‡æ„å¯¹è¯</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·¯å¾„é…ç½®</span></span><br><span class="line">    <span class="comment"># å›¾ç‰‡è·¯å¾„å‰ç¼€ï¼Œè·¯å¾„=dir_prefix+&lt;img_path&gt;(&quot;unlabeled2017/xxx.jpg&quot;)</span></span><br><span class="line">    <span class="string">&quot;dir_prefix&quot;</span> : <span class="string">&quot;./&quot;</span>, </span><br><span class="line">    <span class="comment"># Visdialæ•°æ®ï¼Œ[&#123;&quot;img&quot;:&quot;&lt;img_path&gt;&quot;, &quot;dialog&quot;:[&quot;&lt;caption&gt;&quot;, &quot;Q? A&quot;, &quot;Q? A&quot;, ...]&#125;, ...]ï¼Œ2064</span></span><br><span class="line">    <span class="string">&quot;visdial_path&quot;</span> : <span class="string">&quot;./dialogues/VisDial_v1.0_queries_val.json&quot;</span>, </span><br><span class="line">    <span class="comment"># æœç´¢ç©ºé—´ï¼Œ[&quot;&lt;img_path&gt;&quot;, &quot;&lt;img_path&gt;&quot;, ...]ï¼Œ50000</span></span><br><span class="line">    <span class="string">&quot;search_space&quot;</span> : <span class="string">&quot;./Protocol/Search_Space_val_50k.json&quot;</span>, </span><br><span class="line"><span class="comment"># Visdialæ•°æ®ï¼Œä»…ä¿ç•™captionï¼Œ[&#123;&quot;id&quot;: &quot;&lt;img_path&gt;&quot;, &quot;caption&quot;: [&quot;&lt;caption&gt;&quot;]&#125;,...]ï¼Œ50000</span></span><br><span class="line">    <span class="string">&quot;captions_path&quot;</span> : <span class="string">&quot;./ChatIR/ChatIR_Protocol/visdial_captions.json&quot;</span>,</span><br><span class="line">    <span class="comment"># blipé¢„å¤„ç†çš„embeddings</span></span><br><span class="line">    <span class="string">&quot;img_emb_path&quot;</span> : <span class="string">&quot;./ChatIR/temp/corpus_finetuned_blip.pth&quot;</span>, </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="OpenAI-py"><a href="#OpenAI-py" class="headerlink" title="OpenAI.py"></a>OpenAI.py</h3><p>æ‰€æœ‰å‡½æ•°ç»Ÿä¸€è¿”å›responseå¯¹è±¡ï¼ŒåŒ…å«äº†æ‰€æœ‰ä¿¡æ¯ã€‚</p><p>messages.pyä¸­å®šä¹‰äº†æ¶ˆæ¯æ ¼å¼ï¼ŒåŒ…å«promptä¿¡æ¯ï¼Œå…·ä½“æ–‡æœ¬è§è®ºæ–‡é™„å½•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openai</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> API.messages <span class="keyword">as</span> messages</span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> config</span><br><span class="line"></span><br><span class="line">client = openai.OpenAI(api_key=config[<span class="string">&quot;api_key&quot;</span>])</span><br><span class="line"></span><br><span class="line">SEED = <span class="number">1021</span> <span class="comment"># éšæœºç§å­ <span class="doctag">TODO:</span>ä¸è®¾ç½®çš„æ•ˆæœ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reconstruct_dialog</span>(<span class="params">dialog:<span class="built_in">list</span>[<span class="built_in">str</span>], temperature:<span class="built_in">float</span>=<span class="number">.0</span>, model:<span class="built_in">str</span>=<span class="string">&#x27;gpt-4o-mini&#x27;</span></span>)-&gt;<span class="built_in">str</span>:</span><br><span class="line"><span class="string">&quot;&quot;&quot;é‡æ„å¯¹è¯æ¡†</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å°†å¯¹è¯ä¸­çš„æœ‰æ•ˆä¿¡æ¯æ€»ç»“ä¸ºä¸€æ®µæè¿°ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Args:</span></span><br><span class="line"><span class="string">dialog : å¯¹è¯åˆ—è¡¨</span></span><br><span class="line"><span class="string">temperature : é‡‡æ ·æ¸©åº¦ï¼Œè¶Šå°è¶Šä¿å®ˆ [0.0,2.0]</span></span><br><span class="line"><span class="string">model : æ¨¡å‹åç§°</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">retry_count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">model=model,</span><br><span class="line">messages=messages.reconstruct_dialog_message(dialog),</span><br><span class="line">n=<span class="number">1</span>,</span><br><span class="line">temperature=temperature,</span><br><span class="line">seed=SEED,</span><br><span class="line">max_tokens=<span class="number">512</span>)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">retry_count += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"><span class="keyword">if</span> retry_count &gt; <span class="number">5</span>:</span><br><span class="line"><span class="keyword">raise</span> Exception(<span class="string">&quot;Retry limit exceeded!&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Retry <span class="subst">&#123;retry_count&#125;</span> times...&quot;</span>)</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_questions</span>(<span class="params">dialog:<span class="built_in">list</span>[<span class="built_in">str</span>], n:<span class="built_in">int</span>=<span class="number">1</span>, model:<span class="built_in">str</span>=<span class="string">&#x27;gpt-4o-mini&#x27;</span></span>)-&gt;<span class="built_in">list</span>[<span class="built_in">str</span>]:</span><br><span class="line"><span class="string">&quot;&quot;&quot;Baseline: 1-shotç”Ÿæˆé—®é¢˜ ChatIR</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä»…å‚è€ƒå†å²å¯¹è¯ç”Ÿæˆæ–°çš„é—®é¢˜ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Args:</span></span><br><span class="line"><span class="string">dialog : å¯¹è¯åˆ—è¡¨</span></span><br><span class="line"><span class="string">n : ç”Ÿæˆé—®é¢˜æ•°é‡</span></span><br><span class="line"><span class="string">model : æ¨¡å‹åç§°</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">response :</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">retry_count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">model=model,</span><br><span class="line">messages=messages.generate_questions_message(dialog),</span><br><span class="line">n=n,</span><br><span class="line">temperature=<span class="number">0.5</span>,</span><br><span class="line">max_tokens=<span class="number">32</span>)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">retry_count += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"><span class="keyword">if</span> retry_count &gt; <span class="number">5</span>:</span><br><span class="line"><span class="keyword">raise</span> Exception(<span class="string">&quot;Retry limit exceeded!&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Retry <span class="subst">&#123;retry_count&#125;</span> times...&quot;</span>)</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_questions_referring</span>(<span class="params">dialog:<span class="built_in">list</span>[<span class="built_in">str</span>], prompt_related_captions:<span class="built_in">str</span>=<span class="string">&quot;&quot;</span>, questions:<span class="built_in">list</span>=[], n:<span class="built_in">int</span>=<span class="number">1</span>, model=<span class="string">&#x27;gpt-4o-mini&#x27;</span></span>):</span><br><span class="line"><span class="string">&quot;&quot;&quot;åˆ©ç”¨æ€ç»´é“¾CoTå’Œå€™é€‰é›†Captionsç”Ÿæˆæ–°é—®é¢˜</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Args:</span></span><br><span class="line"><span class="string">dailog : å¯¹è¯åˆ—è¡¨</span></span><br><span class="line"><span class="string">prompt_related_captions : é¢„å¤„ç†çš„å€™é€‰é›†Caption</span></span><br><span class="line"><span class="string">questions : å†å²é—®ç­”å¯¹</span></span><br><span class="line"><span class="string">n : ç”Ÿæˆé—®é¢˜æ•°é‡</span></span><br><span class="line"><span class="string">model : æ¨¡å‹åç§°</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">retry_count = <span class="number">0</span></span><br><span class="line">message = messages.generate_questions_referring_message(dialog, prompt_related_captions, questions)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">model=model,</span><br><span class="line">messages=message,</span><br><span class="line">n=<span class="number">1</span>,</span><br><span class="line">temperature=<span class="number">0.5</span>,</span><br><span class="line">max_tokens=<span class="number">32</span>)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">retry_count += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"><span class="keyword">if</span> retry_count &gt; <span class="number">5</span>:</span><br><span class="line"><span class="keyword">raise</span> Exception(<span class="string">&quot;Retry limit exceeded!&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Retry <span class="subst">&#123;retry_count&#125;</span> times...&quot;</span>)</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">filter_questions</span>(<span class="params">context:<span class="built_in">str</span>, question:<span class="built_in">str</span>, model=<span class="string">&#x27;gpt-4o-mini&#x27;</span></span>):</span><br><span class="line"><span class="string">&quot;&quot;&quot;è¿‡æ»¤é—®é¢˜</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">åˆ¤æ–­é—®é¢˜æ˜¯å¦â€œUncertainâ€</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Args:</span></span><br><span class="line"><span class="string">context : ä¸Šä¸‹æ–‡</span></span><br><span class="line"><span class="string">question : é—®é¢˜</span></span><br><span class="line"><span class="string">model : æ¨¡å‹åç§°</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">retry_count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">model=model,</span><br><span class="line">messages=messages.filter_questions_message(context, question),</span><br><span class="line">n=<span class="number">1</span>,</span><br><span class="line">temperature=<span class="number">.0</span>,</span><br><span class="line">max_tokens=<span class="number">32</span>)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">retry_count += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"><span class="keyword">if</span> retry_count &gt; <span class="number">5</span>:</span><br><span class="line"><span class="keyword">raise</span> Exception(<span class="string">&quot;Retry limit exceeded!&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Retry <span class="subst">&#123;retry_count&#125;</span> times...&quot;</span>)</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">paraphrase</span>(<span class="params">text:<span class="built_in">str</span>=<span class="string">&quot;&quot;</span>, model=<span class="string">&#x27;gpt-4o-mini&#x27;</span></span>):</span><br><span class="line"><span class="string">&quot;&quot;&quot;é‡è¿°</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">é‡è¿°ç»™å®šçš„æ–‡æœ¬ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Args:</span></span><br><span class="line"><span class="string">text : å¾…é‡è¿°æ–‡æœ¬</span></span><br><span class="line"><span class="string">model : æ¨¡å‹åç§°</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">retry_count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">model=model,</span><br><span class="line">messages=messages.paraphrase(text),</span><br><span class="line">n=<span class="number">1</span>,</span><br><span class="line">temperature=<span class="number">0.7</span>,</span><br><span class="line">top_p=<span class="number">0.8</span>,</span><br><span class="line">max_tokens=<span class="number">512</span>)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">retry_count += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"><span class="keyword">if</span> retry_count &gt; <span class="number">5</span>:</span><br><span class="line"><span class="keyword">raise</span> Exception(<span class="string">&quot;Retry limit exceeded!&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Retry <span class="subst">&#123;retry_count&#125;</span> times...&quot;</span>)</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> response</span><br></pre></td></tr></table></figure><h3 id="utils-py"><a href="#utils-py" class="headerlink" title="utils.py"></a>utils.py</h3><p>å®ç°äº†ç‰¹å¾æå–ã€K-meansèšç±»ã€KLæ•£åº¦è®¡ç®—ã€è·å–ç°‡ä¸­å¿ƒcaptionã€ç†µè®¡ç®—ç­‰å‡½æ•°åŠŸèƒ½ï¼Œä½¿ä¸»ç¨‹åºä»£ç ç®€æ´æ˜“è¯»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch.nn.functional <span class="keyword">import</span> normalize</span><br><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> BlipForImageTextRetrieval,AutoProcessor</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset, DataLoader</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"><span class="keyword">from</span> torchvision.transforms <span class="keyword">import</span> InterpolationMode</span><br><span class="line"><span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> config</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./Protocol/visdial_captions.json&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> ss_cap_json:</span><br><span class="line">captions = json.load(ss_cap_json) <span class="comment"># length:50000</span></span><br><span class="line"><span class="comment"># &#123;&quot;id&quot;: &quot;&lt;img_path&gt;&quot;, &quot;caption&quot;: [&quot;&lt;caption&gt;&quot;]&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BlipForRetrieval</span>(<span class="title class_ inherited__">BlipForImageTextRetrieval</span>):</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_text_features</span>(<span class="params"></span></span><br><span class="line"><span class="params">self,</span></span><br><span class="line"><span class="params">input_ids: torch.LongTensor, <span class="comment"># Tokenized input IDs</span></span></span><br><span class="line"><span class="params">attention_mask: torch.LongTensor | <span class="literal">None</span> = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">return_dict: <span class="built_in">bool</span>|<span class="literal">None</span> = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params"></span>) -&gt; torch.FloatTensor:</span><br><span class="line"><span class="string">&quot;&quot;&quot;è·å–æ–‡æœ¬ç‰¹å¾</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Args:</span></span><br><span class="line"><span class="string">input_ids : æ–‡æœ¬çš„token IDï¼ˆå³ç»è¿‡åˆ†è¯åçš„è¾“å…¥ï¼‰</span></span><br><span class="line"><span class="string">attention_mask : æ³¨æ„åŠ›æ©ç </span></span><br><span class="line"><span class="string">return_dict : æ˜¯å¦è¿”å›å­—å…¸</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">return_dict=return_dict <span class="keyword">if</span> return_dict <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> self.config.use_return_dict</span><br><span class="line"></span><br><span class="line">text_embeddings = self.text_encoder(</span><br><span class="line">input_ids=input_ids,</span><br><span class="line">attention_mask=attention_mask,</span><br><span class="line">return_dict=return_dict,</span><br><span class="line">)</span><br><span class="line">text_embeddings = text_embeddings[<span class="number">0</span>] <span class="keyword">if</span> <span class="keyword">not</span> return_dict <span class="keyword">else</span> text_embeddings.last_hidden_state</span><br><span class="line"><span class="keyword">return</span> normalize(self.text_proj(text_embeddings[:, <span class="number">0</span>, :]), dim=-<span class="number">1</span>) <span class="comment"># [:,0,:]å–çš„æ˜¯[CLS]æ ‡è®°çš„éšè—çŠ¶æ€ï¼Œå®ƒé€šå¸¸è¢«ç”¨ä½œæ•´ä¸ªå¥å­çš„ç‰¹å¾è¡¨ç¤º</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_image_features</span>(<span class="params"></span></span><br><span class="line"><span class="params">self,</span></span><br><span class="line"><span class="params">pixel_values: torch.FloatTensor,</span></span><br><span class="line"><span class="params">output_attentions: <span class="built_in">bool</span> | <span class="literal">None</span> = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">output_hidden_states: <span class="built_in">bool</span> | <span class="literal">None</span> = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">return_dict: <span class="built_in">bool</span> | <span class="literal">None</span> = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params"></span>) -&gt; torch.FloatTensor:</span><br><span class="line"><span class="string">&quot;&quot;&quot;è·å–å›¾ç‰‡ç‰¹å¾</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Args:</span></span><br><span class="line"><span class="string">pixel_values : å›¾ç‰‡åƒç´ å€¼</span></span><br><span class="line"><span class="string">output_attentions : æ˜¯å¦è¾“å‡ºæ³¨æ„åŠ›</span></span><br><span class="line"><span class="string">output_hidden_states : æ˜¯å¦è¾“å‡ºéšè—çŠ¶æ€</span></span><br><span class="line"><span class="string">return_dict : æ˜¯å¦è¿”å›å­—å…¸</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">return_dict = return_dict <span class="keyword">if</span> return_dict <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> self.config.use_return_dict</span><br><span class="line"></span><br><span class="line">output_attentions = output_attentions <span class="keyword">if</span> output_attentions <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> self.config.output_attentions</span><br><span class="line">output_hidden_states = output_hidden_states <span class="keyword">if</span> output_hidden_states <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> self.config.output_hidden_states</span><br><span class="line"></span><br><span class="line">vision_outputs = self.vision_encoder(</span><br><span class="line">pixel_values=pixel_values,</span><br><span class="line">output_attentions=output_attentions,</span><br><span class="line">output_hidden_states=output_hidden_states,</span><br><span class="line">return_dict=return_dict,</span><br><span class="line">)</span><br><span class="line">image_embeddings = vision_outputs[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">return</span> normalize(self.vision_proj(image_embeddings[:, <span class="number">0</span>, :]), dim=-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">processor = AutoProcessor.from_pretrained(<span class="string">&quot;Salesforce/blip-itm-large-coco&quot;</span>)</span><br><span class="line">model = BlipForRetrieval.from_pretrained(<span class="string">&quot;Salesforce/blip-itm-large-coco&quot;</span>).to(config[<span class="string">&quot;device&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_text_features</span>(<span class="params">text: <span class="built_in">str</span>, model=model, processor=processor</span>) -&gt; torch.FloatTensor:</span><br><span class="line"><span class="string">&quot;&quot;&quot;è·å–æ–‡æœ¬ç‰¹å¾</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Args:</span></span><br><span class="line"><span class="string">text : æ–‡æœ¬</span></span><br><span class="line"><span class="string">model : Pretrained Modelï¼Œç”¨äºè·å–æ–‡æœ¬ç‰¹å¾</span></span><br><span class="line"><span class="string">processor : æ–‡æœ¬å¤„ç†å™¨ï¼Œç”¨äºå°†æ–‡æœ¬è½¬æ¢ä¸ºæ¨¡å‹è¾“å…¥</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">text_encodings = processor(text=text, padding=<span class="literal">True</span>, return_tensors=<span class="string">&quot;pt&quot;</span>).to(config[<span class="string">&quot;device&quot;</span>])</span><br><span class="line"><span class="keyword">return</span> model.get_text_features(**text_encodings)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ----------------------------------------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search_imgs</span>(<span class="params">query=<span class="string">&quot;&quot;</span>, img_embs=<span class="literal">None</span>, search_space=<span class="literal">None</span>, k=<span class="number">10</span></span>):</span><br><span class="line"><span class="string">&quot;&quot;&quot;æœç´¢å‰kä¸ªç›¸å…³å›¾ç‰‡</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Args:</span></span><br><span class="line"><span class="string">query : æŸ¥è¯¢æ–‡æœ¬</span></span><br><span class="line"><span class="string">img_embs : å›¾ç‰‡ç‰¹å¾</span></span><br><span class="line"><span class="string">search_space : æœç´¢ç©ºé—´ï¼Œå›¾ç‰‡è·¯å¾„åˆ—è¡¨</span></span><br><span class="line"><span class="string">k : è¿”å›çš„å›¾ç‰‡æ•°é‡</span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">related_imgs : å‰kä¸ªç›¸å…³å›¾ç‰‡</span></span><br><span class="line"><span class="string">related_indices : å‰kä¸ªç›¸å…³å›¾ç‰‡çš„ç´¢å¼•</span></span><br><span class="line"><span class="string">cos_sim : ä½™å¼¦ç›¸ä¼¼åº¦</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">query_emb = get_text_features(query)</span><br><span class="line">query_emb_norm = normalize(query_emb, dim=-<span class="number">1</span>) <span class="comment"># å½’ä¸€åŒ–æŸ¥è¯¢ç‰¹å¾</span></span><br><span class="line">cos_sim = torch.matmul(query_emb_norm, img_embs.T).squeeze() <span class="comment"># è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦</span></span><br><span class="line">related_indices = cos_sim.sort()[<span class="number">1</span>][-k:]</span><br><span class="line"><span class="comment"># related_indices = cos_sim.topk(k).indices</span></span><br><span class="line">related_imgs = []</span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">related_imgs.append(search_space[related_indices[idx].item()])</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> related_imgs, related_indices, cos_sim</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> fast_pytorch_kmeans <span class="keyword">import</span> KMeans</span><br><span class="line">kmeans = KMeans(n_clusters=<span class="number">10</span>, mode=<span class="string">&#x27;cosine&#x27;</span>, verbose=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_related_captions</span>(<span class="params">caption_recon, <span class="built_in">round</span>=<span class="number">1</span>, threshold_low=<span class="number">500</span>, img_embs=<span class="literal">None</span>, captions=<span class="literal">None</span></span>):</span><br><span class="line"><span class="string">&quot;&quot;&quot;è·å–ç°‡ä¸­å¿ƒçš„ç›¸å…³å›¾ç‰‡æè¿°</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å°†low-(round-1)*(low/10.0)ä¸ªæœ€ç›¸å…³çš„å›¾ç‰‡ä½œä¸ºå€™é€‰é›†S_Rï¼Œè¿›è¡Œk-meansèšç±»ï¼Œ</span></span><br><span class="line"><span class="string">å¾—åˆ°10ä¸ªç°‡ä¸­ï¼Œä¿¡æ¯ç†µæœ€å°çš„å›¾ç‰‡æè¿°ä½œä¸ºå½“å‰è½®æ¬¡çš„ç›¸å…³å›¾ç‰‡æè¿°ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Args:</span></span><br><span class="line"><span class="string">caption_recon : å¯¹è¯ä¸Šä¸‹æ–‡ï¼ˆé‡æ„çš„ï¼‰</span></span><br><span class="line"><span class="string">round : å½“å‰è½®æ¬¡</span></span><br><span class="line"><span class="string">threshold_low : æ ¹æ®è½®æ¬¡è®¡ç®—ç›¸å…³å›¾ç‰‡çš„æ•°é‡ low-(round-1)*(low/10.0)</span></span><br><span class="line"><span class="string">img_embs : å›¾ç‰‡ç‰¹å¾</span></span><br><span class="line"><span class="string">captions : å›¾ç‰‡æè¿°</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">caps = []</span><br><span class="line"><span class="comment"># related_size = 100 - (round-1)*10</span></span><br><span class="line">related_size = <span class="built_in">int</span>(threshold_low - (<span class="built_in">round</span>-<span class="number">1</span>) * (threshold_low / <span class="number">10.0</span>)) <span class="comment"># å€™é€‰é›†å¤§å° 500-(round-1)*50</span></span><br><span class="line">emb = normalize(get_text_features(caption_recon), dim=-<span class="number">1</span>) </span><br><span class="line">sim = torch.matmul(emb, img_embs.T).squeeze() <span class="comment"># è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦</span></span><br><span class="line">topk = sim.argsort()[-related_size:] <span class="comment"># è·å–å‰related_sizeä¸ªç›¸å…³å›¾ç‰‡çš„ç´¢å¼•</span></span><br><span class="line">img_embs_topk = img_embs[topk] <span class="comment"># è·å–å‰related_sizeä¸ªç›¸å…³å›¾ç‰‡çš„ç‰¹å¾</span></span><br><span class="line"></span><br><span class="line">entropies = torch.zeros([related_size]) </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(related_size):</span><br><span class="line">cap = captions[topk[i].item()][<span class="string">&#x27;caption&#x27;</span>]</span><br><span class="line">emb = normalize(get_text_features(cap), dim=-<span class="number">1</span>)</span><br><span class="line">sim = torch.matmul(emb, img_embs_topk.T).squeeze()</span><br><span class="line">p = torch.nn.functional.softmax(sim, dim=<span class="number">0</span>)</span><br><span class="line">entropy = (-p * p.log()).<span class="built_in">sum</span>().detach().cpu() <span class="comment"># ä¿¡æ¯ç†µ</span></span><br><span class="line">entropies[i] += entropy</span><br><span class="line">idx_entropies_sorted = entropies.argsort()</span><br><span class="line"></span><br><span class="line">cluster_label = kmeans.fit_predict(img_embs_topk)</span><br><span class="line">cluster_label_sorted = cluster_label[idx_entropies_sorted]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line"><span class="keyword">if</span> (cluster_label_sorted == i).<span class="built_in">any</span>():</span><br><span class="line">idx_c = (cluster_label_sorted == i).nonzero().squeeze().<span class="built_in">min</span>() </span><br><span class="line">caps.append(captions[topk[idx_entropies_sorted[idx_c]].item()][<span class="string">&#x27;caption&#x27;</span>][<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># for i in range(10):</span></span><br><span class="line"><span class="comment">#     caps.append(captions[topk[entropies.argsort()[i]].item()][&#x27;caption&#x27;][0])</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> caps</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_referring_prompt</span>(<span class="params">caption=<span class="string">&quot;&quot;</span>, img_embs=<span class="literal">None</span>, k=<span class="number">10</span>, <span class="built_in">round</span>=<span class="number">1</span>, search_space=<span class="literal">None</span></span>):</span><br><span class="line"><span class="string">&quot;&quot;&quot; è¿›è¡Œk-meansèšç±»ï¼Œè·å–ç›¸å…³å›¾ç‰‡æè¿°ï¼›è·å–å‰kä¸ªç›¸å…³å›¾ç‰‡çš„ç´¢å¼•å’Œä½™å¼¦ç›¸ä¼¼åº¦ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Args:</span></span><br><span class="line"><span class="string">caption : å›¾ç‰‡æè¿°</span></span><br><span class="line"><span class="string">img_embs : å›¾ç‰‡ç‰¹å¾</span></span><br><span class="line"><span class="string">k : è¿”å›çš„å›¾ç‰‡æ•°é‡</span></span><br><span class="line"><span class="string">round : å½“å‰è½®æ¬¡</span></span><br><span class="line"><span class="string">search_space : æœç´¢ç©ºé—´ï¼Œå›¾ç‰‡è·¯å¾„åˆ—è¡¨</span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">prompt_sys : ç³»ç»Ÿprompt</span></span><br><span class="line"><span class="string">prompt_related_captions : ç›¸å…³å›¾ç‰‡æè¿°</span></span><br><span class="line"><span class="string">top_k : å‰kä¸ªç›¸å…³å›¾ç‰‡çš„ç´¢å¼•</span></span><br><span class="line"><span class="string">cos_sims : ä½™å¼¦ç›¸ä¼¼åº¦</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">img_paths, top_k, cos_sims = search_imgs(caption, img_embs, search_space, k=k)</span><br><span class="line">related_captions = get_related_captions(caption, <span class="built_in">round</span>, img_embs=img_embs, captions=captions)</span><br><span class="line"></span><br><span class="line">prompt_sys = <span class="string">&quot;&quot;</span></span><br><span class="line">prompt_sys += <span class="string">&quot;You should leverage the &#x27;related_captions Information&#x27; that is related to the target image &quot;</span></span><br><span class="line">prompt_sys += <span class="string">&quot;corresponding to the caption but does not match the target image.&quot;</span></span><br><span class="line"><span class="comment"># ä½ éœ€è¦åˆ©ç”¨ä¸ç›®æ ‡å›¾åƒç›¸å…³çš„â€œè™šå‡ä¿¡æ¯â€ï¼Œè¯¥ä¿¡æ¯ä¸ç›®æ ‡å›¾åƒæ ‡é¢˜ç›¸å…³ï¼Œä½†ä¸ç›®æ ‡å›¾åƒä¸åŒ¹é…ã€‚</span></span><br><span class="line"></span><br><span class="line">prompt_related_captions = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(related_captions)):</span><br><span class="line">prompt_related_captions += <span class="built_in">str</span>(i) + <span class="string">&#x27;. &#x27;</span> + related_captions[i] + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"><span class="comment"># 1. caption1</span></span><br><span class="line"><span class="comment"># 2. caption2</span></span><br><span class="line"><span class="comment"># ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> prompt_sys, prompt_related_captions, top_k, cos_sims</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">select_question</span>(<span class="params">caption_recon=<span class="string">&quot;&quot;</span>, questions=[], cossim_prev=<span class="literal">None</span>, k=<span class="number">10</span>, img_embs=<span class="literal">None</span>, threshold=<span class="number">500</span>, <span class="built_in">round</span>=<span class="number">1</span></span>):</span><br><span class="line"><span class="string">&quot;&quot;&quot;é€‰æ‹©KLæ•£åº¦æœ€å°çš„é—®é¢˜</span></span><br><span class="line"><span class="string">æ ¹æ®ä¸Šä¸€æ¬¡çš„ç›¸ä¼¼åº¦ï¼Œé€‰æ‹©KLæ•£åº¦æœ€å°çš„é—®é¢˜ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Args:</span></span><br><span class="line"><span class="string">caption_recon : å¯¹è¯ä¸Šä¸‹æ–‡ï¼ˆé‡æ„çš„ï¼‰</span></span><br><span class="line"><span class="string">questions : é—®é¢˜åˆ—è¡¨</span></span><br><span class="line"><span class="string">cossim_prev : ä¸Šä¸€è½®çš„ç›¸ä¼¼åº¦</span></span><br><span class="line"><span class="string">k : è¿”å›çš„å›¾ç‰‡æ•°é‡</span></span><br><span class="line"><span class="string">img_embs : å›¾ç‰‡ç‰¹å¾</span></span><br><span class="line"><span class="string">threshold : ç›¸å…³å›¾ç‰‡çš„æ•°é‡ low-(round-1)*(low/10.0)</span></span><br><span class="line"><span class="string">round : å½“å‰è½®æ¬¡</span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">str : é€‰æ‹©çš„é—®é¢˜</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">threshold = <span class="built_in">int</span>(threshold - (<span class="built_in">round</span>-<span class="number">1</span>) * (threshold / <span class="number">10.0</span>))</span><br><span class="line">idx_related = cossim_prev.argsort()[-threshold:-k]</span><br><span class="line">p_prev = torch.nn.functional.softmax(cossim_prev[idx_related], dim=<span class="number">0</span>)</span><br><span class="line">kl_divs = torch.zeros([<span class="built_in">len</span>(questions)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, ques <span class="keyword">in</span> <span class="built_in">enumerate</span>(questions):</span><br><span class="line">caption_tmp = caption_recon + <span class="string">&quot;, &quot;</span> + ques</span><br><span class="line"></span><br><span class="line">query_emb_tmp = normalize(get_text_features(caption_tmp), dim=-<span class="number">1</span>)</span><br><span class="line">cossim_tmp = torch.matmul(query_emb_tmp, img_embs.T).squeeze()</span><br><span class="line">p_tmp = torch.nn.functional.softmax(cossim_tmp[idx_related], dim=<span class="number">0</span>)</span><br><span class="line">kl_div = (p_prev*(p_prev.log() - p_tmp.log())).<span class="built_in">sum</span>().detach().cpu()</span><br><span class="line">kl_divs[i] += kl_div</span><br><span class="line"></span><br><span class="line">idx_final = kl_divs.argsort()[<span class="number">0</span>].item()</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> questions[idx_final]</span><br></pre></td></tr></table></figure><h3 id="ç³»ç»Ÿå®ç°ï¼šPlugIR-exec-py"><a href="#ç³»ç»Ÿå®ç°ï¼šPlugIR-exec-py" class="headerlink" title="ç³»ç»Ÿå®ç°ï¼šPlugIR_exec.py"></a>ç³»ç»Ÿå®ç°ï¼šPlugIR_exec.py</h3><p>PlugIRçš„è¿è¡Œç‰ˆï¼Œå®ç°åˆ©ç”¨å¤šè½®å¯¹è¯è¿›è¡Œå›¾åƒæ£€ç´¢çš„åŠŸèƒ½ï¼Œæè¿°ä»¥åŠæ¯æ¬¡é—®ç­”åæ˜¾ç¤ºå½“å‰æœ€ç›¸å…³çš„å›¾ç‰‡ã€‚</p><p>æ”¹å†™ä¸º<code>PlugIR_func.py</code>ï¼Œå®ç°äº†å‡½æ•°åŒ–ï¼Œä¾¿äºåç»­æ‰¹é‡ç”Ÿæˆå¯¹è¯æ•°æ®ç”¨äºevaluationã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> API <span class="keyword">import</span> OpenAI</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> utils</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> config</span><br><span class="line"></span><br><span class="line">img_embs = torch.load(config[<span class="string">&quot;img_emb_path&quot;</span>], map_location=config[<span class="string">&quot;device&quot;</span>])[<span class="number">1</span>] <span class="comment"># blipé¢„å¤„ç†çš„embeddings</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> config[<span class="string">&quot;filtering&quot;</span>]:</span><br><span class="line">    config[<span class="string">&quot;q_num&quot;</span>] = <span class="number">1</span> <span class="comment"># ä¸è¿‡æ»¤é—®é¢˜ï¼Œç”Ÿæˆ1ä¸ªé—®é¢˜</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(config[<span class="string">&quot;search_space&quot;</span>], <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> ss_json:</span><br><span class="line">    search_space = json.load(ss_json) <span class="comment"># length:50000</span></span><br><span class="line">    search_space = [config[<span class="string">&quot;dir_prefix&quot;</span>] + path <span class="keyword">for</span> path <span class="keyword">in</span> search_space]</span><br><span class="line">    <span class="comment"># [&quot;&lt;img_path&gt;&quot;, &quot;&lt;img_path&gt;&quot;, ...]</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(config[<span class="string">&quot;visdial_path&quot;</span>], <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> diag_json:</span><br><span class="line">visdial = json.load(diag_json) <span class="comment"># length:2064</span></span><br><span class="line"><span class="comment"># [&#123;&quot;img&quot;:&quot;&lt;img_path&gt;&quot;, &quot;dialog&quot;:[&quot;&lt;caption&gt;&quot;, &quot;Q? A&quot;, &quot;Q? A&quot;, ...]&#125;, ...]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(config[<span class="string">&quot;captions_path&quot;</span>], <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> ss_cap_json:</span><br><span class="line">captions = json.load(ss_cap_json) <span class="comment"># length:50000</span></span><br><span class="line">    <span class="comment"># [&#123;&quot;id&quot;: &quot;&lt;img_path&gt;&quot;, &quot;caption&quot;: [&quot;&lt;caption&gt;&quot;]&#125;,...]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ask_for_caption</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è¯¢é—®ç”¨æˆ·æè¿°&quot;&quot;&quot;</span></span><br><span class="line">    caption = <span class="built_in">input</span>(<span class="string">&quot;Caption: &quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> caption.strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ask_question</span>(<span class="params">question</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è¯¢é—®ç”¨æˆ·é—®é¢˜&quot;&quot;&quot;</span></span><br><span class="line">    ans = <span class="built_in">input</span>(<span class="string">f&quot;<span class="subst">&#123;question&#125;</span> &quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> ans.strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">display_image</span>(<span class="params">img_path</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ˜¾ç¤ºå›¾ç‰‡&quot;&quot;&quot;</span></span><br><span class="line">    img = Image.<span class="built_in">open</span>(img_path)</span><br><span class="line">    img.show()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    caption = ask_for_caption() <span class="comment"># è¯¢é—®ç”¨æˆ·æè¿°</span></span><br><span class="line">    dialogue = [caption] <span class="comment"># å¯¹è¯æ¡†</span></span><br><span class="line">    caption_recon = caption <span class="comment"># é‡æ„åçš„æè¿°ï¼Œç”¨äºåŒ¹é…å›¾ç‰‡</span></span><br><span class="line">    caption_recons = [caption] <span class="comment"># é‡æ„æè¿°åˆ—è¡¨</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">round</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>): <span class="comment"># 10è½®å¯¹è¯</span></span><br><span class="line">        questions = [] <span class="comment"># åˆæ³•é—®é¢˜åˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> config[<span class="string">&quot;referring&quot;</span>]: <span class="comment"># å‚è€ƒå€™é€‰é›†çš„Captionæé—®</span></span><br><span class="line">            ques_prior = [] <span class="comment"># éæ³•é—®é¢˜åˆ—è¡¨</span></span><br><span class="line">            _, prompt_related_captions, top_k, cos_sims = utils.get_referring_prompt(</span><br><span class="line">                caption_recon,</span><br><span class="line">                img_embs=img_embs,</span><br><span class="line">                k=config[<span class="string">&quot;hitk&quot;</span>],</span><br><span class="line">                <span class="built_in">round</span>=<span class="built_in">round</span>+<span class="number">1</span>,</span><br><span class="line">                search_space=search_space)</span><br><span class="line">            display_image(search_space[top_k[-<span class="number">1</span>]]) <span class="comment"># æ˜¾ç¤ºç¬¬ä¸€å¼ å›¾ç‰‡</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(config[<span class="string">&quot;q_num&quot;</span>]): <span class="comment"># ç”Ÿæˆconfig[&quot;q_num&quot;]ä¸ªé—®é¢˜</span></span><br><span class="line">                <span class="keyword">if</span> config[<span class="string">&quot;filtering&quot;</span>]: <span class="comment"># AIè¿‡æ»¤é—®é¢˜</span></span><br><span class="line">                    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>): <span class="comment"># å°è¯•3æ¬¡æ ¹æ®å€™é€‰é›†Captionç”Ÿæˆé—®é¢˜</span></span><br><span class="line">                        resp = OpenAI.generate_questions_referring(</span><br><span class="line">                            dialog=dialogue,</span><br><span class="line">                            prompt_related_captions=prompt_related_captions,</span><br><span class="line">                            questions=ques_prior,</span><br><span class="line">                            model=config[<span class="string">&quot;gpt_model&quot;</span>]</span><br><span class="line">                        ).choices[<span class="number">0</span>].message.content</span><br><span class="line">                        question = resp.split(<span class="string">&#x27;?&#x27;</span>)[<span class="number">0</span>]+<span class="string">&#x27;?&#x27;</span></span><br><span class="line">                        fq = OpenAI.filter_questions(caption_recon, question).choices[<span class="number">0</span>].message.content</span><br><span class="line">                        <span class="keyword">if</span> <span class="string">&quot;uncertain&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> fq.lower(): <span class="comment"># å¦‚æœä¸uncertainï¼Œé—®é¢˜éæ³•</span></span><br><span class="line">                            ques_prior.append(question)</span><br><span class="line">                        <span class="keyword">else</span> : <span class="comment"># å¦‚æœuncertainï¼Œé—®é¢˜åˆæ³•</span></span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">len</span>(ques_prior) == <span class="number">3</span>: <span class="comment"># ä¸‰æ¬¡éæ³•é—®é¢˜ï¼Œå°è¯•ç›´æ¥è¯¢é—®ä¸€æ¬¡ï¼Œå†ä¸è¡Œï¼Œå°±å›ºå®šè¯¢é—®å…¶ä»–å¯¹è±¡</span></span><br><span class="line">                        response = OpenAI.generate_questions(dialog=dialogue, n=<span class="number">1</span>).choices[<span class="number">0</span>].message.content</span><br><span class="line">                        question = response.split(<span class="string">&#x27;?&#x27;</span>)[<span class="number">0</span>]+<span class="string">&#x27;?&#x27;</span></span><br><span class="line">                        fq = OpenAI.filter_questions(caption_recon, question).choices[<span class="number">0</span>].message.content</span><br><span class="line">                        <span class="keyword">if</span> <span class="string">&quot;uncertain&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> fq.lower():</span><br><span class="line">                            question = <span class="string">&quot;what is the other object in the image?&quot;</span></span><br><span class="line">                <span class="keyword">else</span>: <span class="comment"># ä¸è¿‡æ»¤é—®é¢˜</span></span><br><span class="line">                    response = OpenAI.generate_questions_referring(</span><br><span class="line">                        dialog=dialogue, prompt_related_captions=prompt_related_captions, questions=ques_prior, n=<span class="number">1</span>, model=config[<span class="string">&quot;gpt_model&quot;</span>]</span><br><span class="line">                    ).choices[<span class="number">0</span>].message.content</span><br><span class="line">                    question = response.split(<span class="string">&#x27;?&#x27;</span>)[<span class="number">0</span>]+<span class="string">&#x27;?&#x27;</span></span><br><span class="line">            questions.append(question)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>: <span class="comment"># ChatIRï¼šç›´æ¥æé—®</span></span><br><span class="line">            _, top_k, cos_sims = utils.search_imgs(</span><br><span class="line">                query=caption_recon,</span><br><span class="line">                img_embs=img_embs, </span><br><span class="line">                search_space=search_space,</span><br><span class="line">                k=config[<span class="string">&quot;hitk&quot;</span>]</span><br><span class="line">            )</span><br><span class="line">            display_image(search_space[top_k[-<span class="number">1</span>]]) <span class="comment"># æ˜¾ç¤ºç¬¬ä¸€å¼ å›¾ç‰‡</span></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(config[<span class="string">&quot;q_num&quot;</span>]): <span class="comment"># ç”Ÿæˆconfig[&quot;q_num&quot;]ä¸ªé—®é¢˜</span></span><br><span class="line">                question = OpenAI.generate_questions(</span><br><span class="line">                    dialog=dialogue, n=<span class="number">1</span>, model=config[<span class="string">&quot;gpt_model&quot;</span>]</span><br><span class="line">                ).choices[<span class="number">0</span>].message.content</span><br><span class="line">                questions.append(question)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> config[<span class="string">&quot;select&quot;</span>]: <span class="comment"># é€‰æ‹©KLæ•£åº¦æœ€å°çš„é—®é¢˜</span></span><br><span class="line">            question_final = utils.select_question( </span><br><span class="line">                caption_recon=caption_recon,</span><br><span class="line">                questions=questions,</span><br><span class="line">                cossim_prev=cos_sims,</span><br><span class="line">                k=config[<span class="string">&quot;hitk&quot;</span>],</span><br><span class="line">                img_embs=img_embs,</span><br><span class="line">                threshold=config[<span class="string">&quot;threshold_low&quot;</span>],</span><br><span class="line">                <span class="built_in">round</span>=<span class="built_in">round</span>+<span class="number">1</span></span><br><span class="line">            )</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            question_final = questions[<span class="number">0</span>] </span><br><span class="line"></span><br><span class="line">        answer = ask_question(question_final)</span><br><span class="line">        qa = question_final + <span class="string">&#x27; &#x27;</span> + answer</span><br><span class="line">        dialogue.append(qa)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> config[<span class="string">&quot;reconstruct&quot;</span>]: <span class="comment"># é‡æ„å¯¹è¯ä¸Šä¸‹æ–‡</span></span><br><span class="line">            caption_recon = OpenAI.reconstruct_dialog(</span><br><span class="line">                dialog=dialogue,</span><br><span class="line">                model=config[<span class="string">&quot;gpt_model&quot;</span>]</span><br><span class="line">            ).choices[<span class="number">0</span>].message.content</span><br><span class="line">            <span class="keyword">if</span> caption_recon == caption_recons[-<span class="number">1</span>]:</span><br><span class="line">                caption_recon = OpenAI.paraphrase(caption_recon, model=config[<span class="string">&quot;gpt_model&quot;</span>]).choices[<span class="number">0</span>].message.content</span><br><span class="line">        <span class="keyword">else</span>: <span class="comment"># ChatIRï¼š&quot;, &quot;è¿æ¥&quot;</span></span><br><span class="line">            caption_recon = <span class="string">&#x27;, &#x27;</span>.join(dialogue)</span><br><span class="line">        caption_recons.append(caption_recon)</span><br></pre></td></tr></table></figure><p>è¿è¡Œæ•ˆæœï¼š</p><p><img src="https://source.cclmsy.cc/posts/papers/2406.03411/PlugIR_exec.png" alt="PlugIR_exec"></p><h3 id="å¯¹è¯æ•°æ®ç”Ÿæˆï¼štest-gen-py"><a href="#å¯¹è¯æ•°æ®ç”Ÿæˆï¼štest-gen-py" class="headerlink" title="å¯¹è¯æ•°æ®ç”Ÿæˆï¼štest_gen.py"></a>å¯¹è¯æ•°æ®ç”Ÿæˆï¼štest_gen.py</h3><p>ä¸ºäº†è‡ªåŠ¨è·å–æµ‹è¯•æ•°æ®ï¼Œå…é™¤äººå·¥å›ç­”ï¼Œä½¿ç”¨äº†BLIP2æ¨¡å‹å›ç­”é—®é¢˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> lavis.models <span class="keyword">import</span> load_model_and_preprocess</span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> config</span><br><span class="line"><span class="keyword">from</span> PlugIR_func <span class="keyword">import</span> generate_question</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> API <span class="keyword">import</span> OpenAI</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(config[<span class="string">&quot;visdial_path&quot;</span>], <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> diag_json:</span><br><span class="line">visdial = json.load(diag_json) <span class="comment"># length:2064</span></span><br><span class="line"><span class="comment"># [&#123;&quot;img&quot;:&quot;&lt;img_path&gt;&quot;, &quot;dialog&quot;:[&quot;&lt;caption&gt;&quot;, &quot;Q? A&quot;, &quot;Q? A&quot;, ...]&#125;, ...]</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># st,ed = 5,100 # ç›®æ ‡èŒƒå›´[0,2064]</span></span><br><span class="line">st,ed = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>]), <span class="built_in">int</span>(sys.argv[<span class="number">2</span>]) <span class="comment"># ç›®æ ‡èŒƒå›´[0,2064]</span></span><br><span class="line">images = [visdial[i][<span class="string">&quot;img&quot;</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(st,ed)] <span class="comment"># ç›®æ ‡å›¾ç‰‡åˆ—è¡¨</span></span><br><span class="line">target_captions = [visdial[i][<span class="string">&quot;dialog&quot;</span>][<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(st,ed)] <span class="comment"># ç›®æ ‡å›¾ç‰‡å¯¹åº”çš„captionä½œä¸ºç”¨æˆ·æè¿°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> Blip2Processor, Blip2ForConditionalGeneration</span><br><span class="line">processor2 = Blip2Processor.from_pretrained(config[<span class="string">&quot;vqa_model&quot;</span>])</span><br><span class="line">blip2 = Blip2ForConditionalGeneration.from_pretrained(config[<span class="string">&quot;vqa_model&quot;</span>], device_map=&#123;<span class="string">&quot;&quot;</span>: <span class="number">0</span>&#125;, torch_dtype=torch.float16)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reconstruct_caption</span>(<span class="params">dialogue, caption_recons</span>):</span><br><span class="line">caption_recon=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">if</span> config[<span class="string">&quot;reconstruct&quot;</span>]: <span class="comment"># é‡æ„å¯¹è¯ä¸Šä¸‹æ–‡</span></span><br><span class="line">caption_recon = OpenAI.reconstruct_dialog(</span><br><span class="line">dialog=dialogue,</span><br><span class="line">model=config[<span class="string">&quot;gpt_model&quot;</span>]</span><br><span class="line">).choices[<span class="number">0</span>].message.content</span><br><span class="line"><span class="keyword">if</span> caption_recon == caption_recons[-<span class="number">1</span>]:</span><br><span class="line">caption_recon = OpenAI.paraphrase(caption_recon, model=config[<span class="string">&quot;gpt_model&quot;</span>]).choices[<span class="number">0</span>].message.content</span><br><span class="line"><span class="keyword">else</span>: <span class="comment"># ChatIRï¼š&quot;, &quot;è¿æ¥</span></span><br><span class="line">caption_recon = config[<span class="string">&quot;sep_token&quot;</span>].join(dialogue)</span><br><span class="line"><span class="keyword">return</span> caption_recon</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_dialog</span>(<span class="params">idx</span>):</span><br><span class="line"><span class="string">&quot;&quot;&quot;ç”Ÿæˆå¯¹è¯æ•°æ®</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Args:</span></span><br><span class="line"><span class="string">idx : å›¾ç‰‡ç´¢å¼•(st-&gt;0)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">image = Image.<span class="built_in">open</span>(images[idx])</span><br><span class="line">caption = target_captions[idx] <span class="comment"># ç›®æ ‡å›¾ç‰‡å¯¹åº”çš„captionä½œä¸ºç”¨æˆ·æè¿°</span></span><br><span class="line">tqdm.write(<span class="string">f&quot;\nCaption <span class="subst">&#123;idx&#125;</span>: <span class="subst">&#123;caption&#125;</span>&quot;</span>)</span><br><span class="line">dialogue = [caption] <span class="comment"># å¯¹è¯æ¡†</span></span><br><span class="line">caption_recon = caption <span class="comment"># é‡æ„åçš„æè¿°ï¼Œç”¨äºåŒ¹é…å›¾ç‰‡</span></span><br><span class="line">caption_recons = [caption] <span class="comment"># é‡æ„æè¿°åˆ—è¡¨</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>): <span class="comment"># 10è½®å¯¹è¯</span></span><br><span class="line">question = generate_question(dialogue, caption_recon)</span><br><span class="line">prompt = <span class="string">f&quot;Question: <span class="subst">&#123;question&#125;</span> Answer: &quot;</span></span><br><span class="line">_inputs = processor2(images=image, text=prompt, return_tensors=<span class="string">&#x27;pt&#x27;</span>).to(config[<span class="string">&quot;device&quot;</span>])</span><br><span class="line">_outputs = blip2.generate(**_inputs, do_sample=<span class="literal">False</span>)</span><br><span class="line">answer = processor2.decode(_outputs[<span class="number">0</span>], skip_special_tokens=<span class="literal">True</span>).strip()</span><br><span class="line">qa = question.strip()+ <span class="string">&#x27; &#x27;</span> + answer</span><br><span class="line">dialogue.append(qa)</span><br><span class="line">caption_recon = reconstruct_caption(dialogue, caption_recons)</span><br><span class="line">caption_recons.append(caption_recon)</span><br><span class="line">tqdm.write(<span class="string">f&quot;Round <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>: <span class="subst">&#123;caption_recon&#125;</span>&quot;</span>)</span><br><span class="line">ret = &#123;</span><br><span class="line"><span class="string">&quot;img&quot;</span>: images[idx],</span><br><span class="line"><span class="string">&quot;dialog&quot;</span>: caption_recons</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">filename = <span class="string">&quot;dialogues/&quot;</span>+<span class="string">&quot;mine_&quot;</span> + config[<span class="string">&quot;gpt_model&quot;</span>]+<span class="string">&quot;_&quot;</span>+<span class="string">&quot;BLIP2&quot;</span>+<span class="string">&quot;.txt&quot;</span></span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;a&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="built_in">len</span>(images)), desc=<span class="string">&quot;å¯¹è¯ç”Ÿæˆè¿›åº¦&quot;</span>, position=<span class="number">0</span>):</span><br><span class="line">dialog = generate_dialog(idx)</span><br><span class="line">f.write(json.dumps(dialog, ensure_ascii=<span class="literal">False</span>)+<span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="Debugæ—¥å¿—"><a href="#Debugæ—¥å¿—" class="headerlink" title="Debugæ—¥å¿—"></a>Debugæ—¥å¿—</h3><p>æµ‹è¯•ä½¿ç”¨äº†é¡¹ç›®ä»“åº“çš„<code>eval.py</code>æºä»£ç ã€‚</p><p>å¯èƒ½æ˜¯æˆ‘ä½¿ç”¨Windowsç³»ç»Ÿçš„ç¼˜æ•…ï¼Œ<code>eval.py</code>ä»£ç ä¸­æœ‰ä¸€äº›æŠ¥é”™ï¼Œå…·ä½“é—®é¢˜å’Œè°ƒæ•´å¦‚ä¸‹ï¼š</p><ol><li><code>AttributeError: Can&#39;t pickle local object &#39;BLIP_ZERO_SHOT_BASELINE.&lt;locals&gt;.&lt;lambda&gt;&#39;</code><ul><li>åŸå› ï¼šåœ¨Windowsä¸Šä½¿ç”¨å¤šè¿›ç¨‹ï¼ˆ<code>num_workers&gt;0</code>ï¼‰æ—¶ï¼Œéœ€è¦pickleå¯¹è±¡ï¼Œä½†æ˜¯å…¶ä¸­çš„lambdaå‡½æ•°æˆ–å±€éƒ¨å‡½æ•°ä¸èƒ½è¢«pickle</li><li>è§£å†³ï¼šå°†lambdaå‡½æ•°æ”¹ä¸ºå…¨å±€å‡½æ•°ï¼Œå†ä½¿ç”¨<code>functools.partial</code>è¿›è¡Œå‚æ•°ç»‘å®š</li></ul></li><li><code>RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!</code> <ul><li>åŸå› ï¼šå‡½æ•°<code>text_encode_fn</code>ä¸­çš„<code>processor</code>æ²¡æœ‰<code>to(device)</code></li><li>è§£å†³ï¼šå¤šåšä¸€æ­¥ï¼Œå°†<code>processor</code>çš„è¾“å‡º<code>`to(device)</code></li></ul></li></ol><p>å°è¯•è·‘é€š<code>generate_dialog.py</code>çš„è¿‡ç¨‹ä¸­ä¹Ÿé‡åˆ°äº†ä¸Šè¿°é—®é¢˜ï¼Œè§£å†³æ–¹æ³•åŒã€‚</p><h3 id="æµ‹è¯•ç»“æœ"><a href="#æµ‹è¯•ç»“æœ" class="headerlink" title="æµ‹è¯•ç»“æœ"></a>æµ‹è¯•ç»“æœ</h3><p>æ­£å¸¸æƒ…å†µä¸‹3~5åˆ†é’Ÿå¯ä»¥ç”Ÿæˆ1æ¡æ•°æ®ï¼ˆå¤§çº¦80æ¬¡è¯·æ±‚ï¼‰ã€‚<br>ä½†ç”±äºæˆ‘ç”Ÿæˆæ•°æ®çŸ­æ—¶é—´å†…å¤§é‡è°ƒç”¨OpenAI APIï¼Œå¯¼è‡´è¢«é™æµï¼Œ20~30åˆ†é’Ÿæ‰èƒ½äº§ç”Ÿ1æ¡æ•°æ®ï¼Œæ•…æœ¬æ¬¡å®ç°åœ¨evalé˜¶æ®µä»…æœ‰253æ¡æ•°æ®ã€‚</p><p>åœ¨ä½¿ç”¨ChatGPT-4o-miniä½œä¸ºæé—®æ¨¡å‹Gï¼ŒBLIP2ä½œä¸ºå›ç­”æ¨¡å‹Aï¼Œä½¿ç”¨åŒä¸€æµ‹è¯•ä»£ç çš„æƒ…å†µä¸‹ï¼Œæµ‹è¯•ç»“æœå’Œä»“åº“çš„å¯¹è¯æ•°æ®Hit@Kå¯¹æ¯”å¦‚ä¸‹ï¼š</p><div class="table-container"><table><thead><tr><th style="text-align:center">length</th><th style="text-align:center">ä»“åº“æ•°æ®Hit@10(2064 testcases)</th><th style="text-align:center">å®ç°æ•°æ®Hit@10ï¼ˆ253 testcasesï¼‰</th></tr></thead><tbody><tr><td style="text-align:center">0</td><td style="text-align:center">71.12%</td><td style="text-align:center">72.33%</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">79.02%</td><td style="text-align:center">81.42%</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">83.09%</td><td style="text-align:center">83.40%</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">85.85%</td><td style="text-align:center">85.38%</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">87.55%</td><td style="text-align:center">86.56%</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">88.71%</td><td style="text-align:center">87.75%</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">89.39%</td><td style="text-align:center">88.14%</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">90.12%</td><td style="text-align:center">88.54%</td></tr><tr><td style="text-align:center">8</td><td style="text-align:center">90.70%</td><td style="text-align:center">88.93%</td></tr><tr><td style="text-align:center">9</td><td style="text-align:center">91.09%</td><td style="text-align:center">89.33%</td></tr><tr><td style="text-align:center">10</td><td style="text-align:center">91.47%</td><td style="text-align:center">90.12%</td></tr></tbody></table></div><p>BRIå¯¹æ¯”ï¼ˆè¶Šä½è¶Šå¥½ï¼‰ï¼š</p><ul><li>ä»“åº“å¯¹è¯çš„BRIï¼š10.195615768432617</li><li>å®ç°å¯¹è¯çš„BRIï¼š10.252569198608398</li></ul>]]></content>
    
    
    <summary type="html">å®ç°è®ºæ–‡ã€ŠInteractive Text-to-ImageRetrieval with Large Language Modelsï¼šA Plug-and-Play Approachã€‹</summary>
    
    
    
    <category term="è®ºæ–‡ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="å›¾åƒæ£€ç´¢" scheme="https://www.cclmsy.cc/tags/%E5%9B%BE%E5%83%8F%E6%A3%80%E7%B4%A2/"/>
    
    <category term="è®ºæ–‡å®ç°" scheme="https://www.cclmsy.cc/tags/%E8%AE%BA%E6%96%87%E5%AE%9E%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>Bag of Features å›¾åƒæ£€ç´¢ç®—æ³•</title>
    <link href="https://www.cclmsy.cc/posts/bag_of_features.html"/>
    <id>https://www.cclmsy.cc/posts/bag_of_features.html</id>
    <published>2025-03-15T16:00:00.000Z</published>
    <updated>2025-07-18T12:42:11.031Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç®—æ³•åŸç†"><a href="#ç®—æ³•åŸç†" class="headerlink" title="ç®—æ³•åŸç†"></a>ç®—æ³•åŸç†</h2><h3 id="å¼•å…¥ï¼šè¯è¢‹æ¨¡å‹ï¼ˆBag-of-Wordsï¼‰"><a href="#å¼•å…¥ï¼šè¯è¢‹æ¨¡å‹ï¼ˆBag-of-Wordsï¼‰" class="headerlink" title="å¼•å…¥ï¼šè¯è¢‹æ¨¡å‹ï¼ˆBag of Wordsï¼‰"></a>å¼•å…¥ï¼šè¯è¢‹æ¨¡å‹ï¼ˆBag of Wordsï¼‰</h3><p>Bag of Wordsæ˜¯æ–‡æœ¬åˆ†ç±»ä¸­ä¸€ç§é€šä¿—æ˜“æ‡‚çš„ç­–ç•¥ã€‚<br>ä¸€èˆ¬æ¥è®²ï¼Œå¦‚æœæˆ‘ä»¬è¦äº†è§£ä¸€æ®µæ–‡æœ¬çš„ä¸»è¦å†…å®¹ï¼Œæœ€è¡Œä¹‹æœ‰æ•ˆçš„ç­–ç•¥æ˜¯æŠ“å–æ–‡æœ¬ä¸­çš„å…³é”®è¯ï¼Œæ ¹æ®å…³é”®è¯å‡ºç°çš„é¢‘ç‡ç¡®å®šè¿™æ®µæ–‡æœ¬çš„ä¸­å¿ƒæ€æƒ³ã€‚</p><p>Bag of Wordsä¸­çš„Wordsæ˜¯åŒºåˆ†åº¦è¾ƒé«˜çš„å•è¯ã€‚<br>æ ¹æ®è¿™äº›Words ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¿«é€Ÿè¯†åˆ«å‡ºæ–‡ç« å†…å®¹ï¼Œå¹¶å¯¹æ–‡ç« è¿›è¡Œåˆ†ç±»ã€‚</p><p>Bag of Featuresæ˜¯å¯¹å›¾åƒçš„ä¸€ç§ç±»ä¼¼çš„å¤„ç†æ–¹æ³•ï¼ŒæŠ½å‡ºå›¾åƒä¸­çš„å…³é”®ç‰¹å¾ï¼Œæ ¹æ®è¿™äº›ç‰¹å¾æ¥è¯†åˆ«å›¾åƒã€‚</p><h3 id="Bag-of-Features-ç®—æ³•æµç¨‹"><a href="#Bag-of-Features-ç®—æ³•æµç¨‹" class="headerlink" title="Bag of Features ç®—æ³•æµç¨‹"></a>Bag of Features ç®—æ³•æµç¨‹</h3><ol><li>æå–å‡ºå…³é”®ç‰¹å¾ï¼Œé€šå¸¸ä¼šä½¿ç”¨SIFTç‰¹å¾ã€‚</li><li>å°†è¿™äº›ç‰¹å¾è¿›è¡ŒK-Meansèšç±»ï¼Œå¾—åˆ°åŒ…å«Kä¸ªè§†è§‰è¯æ±‡çš„è¯å…¸ã€‚</li><li>å¯¹å›¾åƒä¸­çš„ç‰¹å¾ç‚¹è¿›è¡Œé‡åŒ–ï¼Œå°†ç‰¹å¾ç‚¹æ˜ å°„åˆ°è§†è§‰è¯æ±‡ä¸Šã€‚</li><li>ç»Ÿè®¡æ¯ä¸ªè§†è§‰è¯æ±‡çš„å‡ºç°é¢‘ç‡ï¼Œå¾—åˆ°é¢‘ç‡ç›´æ–¹å›¾ã€‚</li><li>æ„é€ ç‰¹å¾åˆ°å›¾åƒçš„å€’æ’è¡¨ï¼Œç”¨äºå›¾åƒæ£€ç´¢ã€‚</li><li>æ ¹æ®ç´¢å¼•ç»“æœï¼Œè¿›è¡Œç›´æ–¹å›¾åŒ¹é…</li></ol><h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><p><code>image</code>æ–‡ä»¶å¤¹ä¸‹å­˜æ”¾å›¾åƒï¼Œ<code>query</code>æ–‡ä»¶å¤¹ä¸‹å­˜æ”¾æŸ¥è¯¢å›¾åƒã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> KMeans</span><br><span class="line"><span class="keyword">from</span> scipy.spatial <span class="keyword">import</span> distance</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line">os.environ[<span class="string">&quot;LOKY_MAX_CPU_COUNT&quot;</span>] = <span class="string">&quot;4&quot;</span> <span class="comment"># KMenas å¤šçº¿ç¨‹è®¾ç½®</span></span><br><span class="line"></span><br><span class="line">image_paths = [] <span class="comment"># å›¾ç‰‡è·¯å¾„åˆ—è¡¨</span></span><br><span class="line">sift_res = &#123;&#125; <span class="comment"># sift_res[img_path] = (keypoints, descriptors) # SIFTç‰¹å¾å­—å…¸</span></span><br><span class="line">k_means = <span class="literal">None</span> <span class="comment"># K-Meansæ¨¡å‹</span></span><br><span class="line">k = <span class="number">50</span> <span class="comment"># è§†è§‰è¯å…¸å¤§å°</span></span><br><span class="line">histograms = &#123;&#125; <span class="comment"># ç›´æ–¹å›¾å­—å…¸</span></span><br><span class="line">sift = cv2.SIFT_create() <span class="comment"># åˆ›å»ºSIFTå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰å›¾ç‰‡è·¯å¾„</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_images</span>(<span class="params">image_folder</span>):</span><br><span class="line">    <span class="keyword">global</span> image_paths</span><br><span class="line">    <span class="keyword">for</span> root, _, files <span class="keyword">in</span> os.walk(image_folder): </span><br><span class="line">        <span class="keyword">for</span> filename <span class="keyword">in</span> files:</span><br><span class="line">            <span class="keyword">if</span> filename.lower().endswith(<span class="string">&quot;.jpg&quot;</span>):</span><br><span class="line">                image_paths.append(os.path.join(root, filename))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. æå–SIFTç‰¹å¾</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_sift_features</span>(<span class="params">cache=<span class="string">&quot;cache/BOF_SIFT_desc.pkl&quot;</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1.æå–SIFTç‰¹å¾&quot;</span>)</span><br><span class="line">    <span class="keyword">global</span> sift_res, image_paths</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(cache):</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(cache, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;ä»ç¼“å­˜ä¸­åŠ è½½SIFTç‰¹å¾: <span class="subst">&#123;cache&#125;</span>&quot;</span>)</span><br><span class="line">            sift_res = pickle.load(f)</span><br><span class="line">            <span class="keyword">return</span> </span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> img_path <span class="keyword">in</span> tqdm(image_paths):</span><br><span class="line">        img = cv2.imread(img_path, cv2.IMREAD_GRAYSCALE) </span><br><span class="line">        _, desc = sift.detectAndCompute(img, <span class="literal">None</span>) <span class="comment"># æå–ç‰¹å¾ç‚¹å’Œæè¿°ç¬¦</span></span><br><span class="line">        sift_res[img_path] = desc</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(cache, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ä¿å­˜SIFTç‰¹å¾åˆ°ç¼“å­˜: <span class="subst">&#123;cache&#125;</span>&quot;</span>)</span><br><span class="line">        pickle.dump(sift_res, f)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. K-Meansèšç±»ï¼Œåˆ›å»ºè§†è§‰è¯å…¸</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_vocabulary</span>(<span class="params">cache=<span class="string">&quot;cache/BOF_kmeans.pkl&quot;</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2.åˆ›å»ºè§†è§‰è¯å…¸&quot;</span>)</span><br><span class="line">    <span class="keyword">global</span> k_means, k</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(cache):</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(cache, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;ä»ç¼“å­˜ä¸­åŠ è½½K-Meansæ¨¡å‹: <span class="subst">&#123;cache&#125;</span>&quot;</span>)</span><br><span class="line">            k_means=pickle.load(f)</span><br><span class="line">            <span class="keyword">return</span> </span><br><span class="line"></span><br><span class="line">    st = time()</span><br><span class="line">    descriptors_list = <span class="built_in">list</span>(sift_res.values())</span><br><span class="line">    all_descriptors = np.vstack(descriptors_list)  <span class="comment"># æ±‡æ€»æ‰€æœ‰ç‰¹å¾ç‚¹</span></span><br><span class="line">    k_means = KMeans(n_clusters=k, random_state=<span class="number">0</span>, n_init=<span class="number">10</span>)</span><br><span class="line">    k_means.fit(all_descriptors)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;K-Meansèšç±»è€—æ—¶: <span class="subst">&#123;time()-st:<span class="number">.2</span>f&#125;</span>s&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(cache, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ä¿å­˜K-Meansæ¨¡å‹åˆ°ç¼“å­˜: <span class="subst">&#123;cache&#125;</span>&quot;</span>)</span><br><span class="line">        pickle.dump(k_means, f)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. è®¡ç®—BoFç›´æ–¹å›¾</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_histogram</span>(<span class="params">img_path</span>):</span><br><span class="line">    <span class="keyword">if</span> img_path <span class="keyword">in</span> sift_res:</span><br><span class="line">        descriptors = sift_res[img_path] <span class="comment"># è·å–æè¿°ç¬¦</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        img = cv2.imread(img_path, cv2.IMREAD_GRAYSCALE) </span><br><span class="line">        _, descriptors = sift.detectAndCompute(img, <span class="literal">None</span>)</span><br><span class="line">    words = k_means.predict(descriptors) <span class="comment"># é¢„æµ‹æ¯ä¸ªæè¿°ç¬¦çš„è¯æ±‡ç´¢å¼•</span></span><br><span class="line">    hist, _ = np.histogram(words, bins=np.arange(k+<span class="number">1</span>)) <span class="comment"># è®¡ç®—ç›´æ–¹å›¾</span></span><br><span class="line">    hist = hist / np.linalg.norm(hist)  <span class="comment"># å½’ä¸€åŒ–</span></span><br><span class="line">    <span class="keyword">return</span> hist</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_histograms</span>(<span class="params">cache=<span class="string">&quot;cache/BOF_histogram.pkl&quot;</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;3.è®¡ç®—æ•°æ®åº“çš„BoFç›´æ–¹å›¾&quot;</span>)</span><br><span class="line">    <span class="keyword">global</span> image_paths, histograms, k_means</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(cache):</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(cache, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;ä»ç¼“å­˜ä¸­åŠ è½½æ•°æ®åº“ç›´æ–¹å›¾: <span class="subst">&#123;cache&#125;</span>&quot;</span>)</span><br><span class="line">            histograms=pickle.load(f)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> img_path <span class="keyword">in</span> tqdm(image_paths):</span><br><span class="line">        histograms[img_path] = compute_histogram(img_path)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(cache, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ä¿å­˜æ•°æ®åº“ç›´æ–¹å›¾åˆ°ç¼“å­˜: <span class="subst">&#123;cache&#125;</span>&quot;</span>)</span><br><span class="line">        pickle.dump(histograms, f)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. ç›´æ–¹å›¾åŒ¹é…</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cos_sim</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> np.dot(a, b) / (np.linalg.norm(a) * np.linalg.norm(b))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_topk</span>(<span class="params">query_hist, topk=<span class="number">10</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;4.ç›´æ–¹å›¾åŒ¹é…&quot;</span>)</span><br><span class="line">    <span class="keyword">global</span> histograms</span><br><span class="line">    similarities = []</span><br><span class="line">    <span class="keyword">for</span> img_path, hist <span class="keyword">in</span> tqdm(histograms.items()):</span><br><span class="line">        <span class="comment"># dist = distance.euclidean(query_hist, hist)</span></span><br><span class="line">        dist = cos_sim(query_hist, hist)</span><br><span class="line">        similarities.append((img_path, dist))</span><br><span class="line">    similarities.sort(key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>], reverse=<span class="literal">True</span>) <span class="comment"># é™åºæ’åº</span></span><br><span class="line">    <span class="keyword">return</span> similarities[:topk]</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿è¡ŒBoFæµç¨‹</span></span><br><span class="line">image_folder = <span class="string">&quot;image&quot;</span></span><br><span class="line">get_images(image_folder)</span><br><span class="line">extract_sift_features()</span><br><span class="line">create_vocabulary()</span><br><span class="line">compute_histograms()</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒ¹é…å›¾åƒ</span></span><br><span class="line">test_img = <span class="string">&quot;query/A0C573_20151103073308_3029240562.jpg&quot;</span></span><br><span class="line">test_hist = compute_histogram(test_img)</span><br><span class="line">topk=get_topk(test_hist, topk=<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Top 10 ç›¸ä¼¼å›¾ç‰‡:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i, (filepath, sim) <span class="keyword">in</span> <span class="built_in">enumerate</span>(topk):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>. <span class="subst">&#123;filepath&#125;</span> - ç›¸ä¼¼åº¦: <span class="subst">&#123;sim:<span class="number">.4</span>f&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(DL) PS <span class="attr">D:</span>\Repos\Course\CVLab&gt; &amp; <span class="attr">C:</span><span class="regexp">/Users/</span>CCLMSY<span class="regexp">/.conda/</span>envs<span class="regexp">/DL/</span>python.exe <span class="attr">d:</span><span class="regexp">/Repos/</span>Course<span class="regexp">/CVLab/</span>BOF.py</span><br><span class="line"><span class="number">1.</span>æå–SIFTç‰¹å¾</span><br><span class="line">ä»ç¼“å­˜ä¸­åŠ è½½SIFTç‰¹å¾: cache/BOF_SIFT_desc.pkl</span><br><span class="line"><span class="number">2.</span>åˆ›å»ºè§†è§‰è¯å…¸</span><br><span class="line">ä»ç¼“å­˜ä¸­åŠ è½½K-Meansæ¨¡å‹: cache/BOF_kmeans.pkl</span><br><span class="line"><span class="number">3.</span>è®¡ç®—æ•°æ®åº“çš„BoFç›´æ–¹å›¾</span><br><span class="line">ä»ç¼“å­˜ä¸­åŠ è½½æ•°æ®åº“ç›´æ–¹å›¾: cache/BOF_histogram.pkl</span><br><span class="line"><span class="number">4.</span>æ„é€ å€’æ’ç´¢å¼•</span><br><span class="line"><span class="number">100</span>%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| <span class="number">945</span><span class="regexp">/945 [00:00&lt;00:00, 23779.80it/</span>s] </span><br><span class="line"><span class="number">5.</span>ç›´æ–¹å›¾åŒ¹é…</span><br><span class="line"><span class="number">100</span>%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| <span class="number">946</span><span class="regexp">/946 [00:00&lt;00:00, 157646.77it/</span>s] </span><br><span class="line">query/A0C573_20151029074136_6562078379.jpg åŒ¹é…åˆ°çš„æœ€ç›¸ä¼¼å›¾ç‰‡æ˜¯ image\A0C573\A0C573_20151029074136_6562078379.jpg</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ä¸€ç§æ˜¯ç”¨äºå›¾åƒå’Œè§†é¢‘æ£€ç´¢çš„ç®—æ³•</summary>
    
    
    
    <category term="DLç¬”è®°" scheme="https://www.cclmsy.cc/categories/DL%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="å›¾åƒæ£€ç´¢" scheme="https://www.cclmsy.cc/tags/%E5%9B%BE%E5%83%8F%E6%A3%80%E7%B4%A2/"/>
    
    <category term="CV" scheme="https://www.cclmsy.cc/tags/CV/"/>
    
  </entry>
  
  <entry>
    <title>SIFT å›¾åƒç‰¹å¾åŒ¹é…ç®—æ³•</title>
    <link href="https://www.cclmsy.cc/posts/sift.html"/>
    <id>https://www.cclmsy.cc/posts/sift.html</id>
    <published>2025-03-15T16:00:00.000Z</published>
    <updated>2025-07-21T05:29:25.279Z</updated>
    
    <content type="html"><![CDATA[<h2 id="SIFTç®€ä»‹"><a href="#SIFTç®€ä»‹" class="headerlink" title="SIFTç®€ä»‹"></a>SIFTç®€ä»‹</h2><p>SIFTï¼ˆScale-Invariant Feature Transformï¼Œå°ºåº¦ä¸å˜ç‰¹å¾å˜æ¢åŒ¹é…ç®—æ³•ï¼‰æ˜¯ä¸€ç§é«˜æ•ˆåŒºåŸŸæ£€æµ‹ç®—æ³•ã€‚</p><p>SIFTç®—æ³•å¯ä»¥è§£å†³çš„é—®é¢˜ï¼š</p><ol><li>RSTï¼ˆRotation Scale Translationï¼‰ï¼šå›¾åƒçš„æ—‹è½¬ã€ç¼©æ”¾ã€å¹³ç§»ç­‰å˜æ¢</li><li>å›¾åƒçš„ä»¿å°„å˜æ¢ï¼ˆAffine Transformationï¼‰ï¼šå›¾åƒçš„æ‹‰ä¼¸ã€å‹ç¼©ã€æ‰­æ›²ç­‰å˜æ¢</li><li>å›¾åƒçš„å…‰ç…§å˜åŒ–</li><li>ç›®æ ‡éƒ¨åˆ†é®æŒ¡</li><li>æ‚ç‰©å’Œå™ªå£°å¹²æ‰°</li></ol><h2 id="SIFTç®—æ³•åŸç†"><a href="#SIFTç®—æ³•åŸç†" class="headerlink" title="SIFTç®—æ³•åŸç†"></a>SIFTç®—æ³•åŸç†</h2><h3 id="1-é«˜æ–¯æ»¤æ³¢"><a href="#1-é«˜æ–¯æ»¤æ³¢" class="headerlink" title="1. é«˜æ–¯æ»¤æ³¢"></a>1. é«˜æ–¯æ»¤æ³¢</h3><p>ä¸€ä¸ªå›¾åƒçš„å°ºåº¦ç©ºé—´$L$æ˜¯é«˜æ–¯å‡½æ•°$G(x,y,\sigma)$ä¸å›¾åƒ$I(x,y)$çš„å·ç§¯ï¼š</p><script type="math/tex; mode=display">\begin{aligned}L(x,y,\sigma) &= G(x,y,\sigma) * I(x,y) \\\\G(x,y,\sigma) &= \dfrac{1}{2\pi\sigma^2}e^{-\frac{(x-x_0)^2+(y-y_0)^2}{2\sigma^2}}\end{aligned}</script><p>å…¶ä¸­ï¼Œ$G(x,y,\sigma)$æ˜¯é«˜æ–¯å‡½æ•°ï¼Œ$\sigma$æ˜¯å°ºåº¦å› å­ï¼Œ$*$æ˜¯å·ç§¯è¿ç®—ï¼Œ$x_0,y_0$æ˜¯é«˜æ–¯å‡½æ•°çš„ä¸­å¿ƒï¼ˆå·ç§¯æ ¸çš„ä¸­å¿ƒï¼‰ã€‚</p><p>$\sigma$è¶Šå°ï¼Œå›¾åƒè¢«å¹³æ»‘çš„è¶Šå°‘ï¼Œå›¾åƒçš„ç»†èŠ‚è¶Šå¤šã€‚<br>å°å°ºåº¦å¯¹åº”äºå›¾åƒçš„ç»†èŠ‚ï¼Œå¤§å°ºåº¦å¯¹åº”äºå›¾åƒçš„æ•´ä½“ç‰¹å¾ã€‚</p><p><img src="https://source.cclmsy.cc/posts/notes/others/Gaussian_Blur.png" alt="Gaussian Blur"></p><h3 id="2-é«˜æ–¯é‡‘å­—å¡”"><a href="#2-é«˜æ–¯é‡‘å­—å¡”" class="headerlink" title="2. é«˜æ–¯é‡‘å­—å¡”"></a>2. é«˜æ–¯é‡‘å­—å¡”</h3><p><img src="https://source.cclmsy.cc/posts/notes/others/é«˜æ–¯é‡‘å­—å¡”.png" alt="é«˜æ–¯é‡‘å­—å¡”"></p><p>é«˜æ–¯é‡‘å­—å¡”åŒ…å«å¤šç»„ï¼ˆOctaveï¼‰å›¾åƒï¼Œæ¯ç»„å›¾åƒç”±å¤šå±‚ï¼ˆIntervalï¼‰ä¸åŒå°ºåº¦çš„é«˜æ–¯æ¨¡ç³Šå›¾åƒç»„æˆã€‚</p><p>æ„å»ºè¿‡ç¨‹ï¼š</p><ol><li>å°†åŸå›¾åƒæ‰©å¤§åˆ°ä¸¤å€ï¼Œä½œä¸ºç¬¬0ç»„çš„ç¬¬0å±‚</li><li>å¯¹ç¬¬0ç»„çš„ç¬¬0å±‚è¿›è¡Œ$\sigma_0$çš„é«˜æ–¯æ¨¡ç³Šï¼Œå¾—åˆ°ç¬¬0ç»„çš„ç¬¬1å±‚</li><li>é€‰å®šä¸€ä¸ªæ¯”ä¾‹ç³»æ•°$k$ï¼Œå¯¹ç¬¬0ç»„çš„ç¬¬1å±‚è¿›è¡Œ$k\sigma_0$çš„é«˜æ–¯æ¨¡ç³Šï¼Œå¾—åˆ°ç¬¬0ç»„çš„ç¬¬2å±‚</li><li>å¯¹ç¬¬0ç»„çš„ç¬¬2å±‚è¿›è¡Œ$k^2\sigma_0$çš„é«˜æ–¯æ¨¡ç³Šï¼Œå¾—åˆ°ç¬¬0ç»„çš„ç¬¬3å±‚ï¼Œä»¥æ­¤ç±»æ¨â€¦</li><li>å°†<strong>ä¸Šä¸€ç»„å€’æ•°ç¬¬3å±‚å›¾åƒ</strong>åšæ¯”ä¾‹å› å­ä¸º2çš„é™é‡‡æ ·ï¼Œå¾—åˆ°ä¸‹ä¸€ç»„çš„ç¬¬0å±‚ï¼Œé‡å¤æ­¥éª¤2-4</li></ol><p>ç»„æ•°è®¡ç®—å…¬å¼ï¼š$O=\lfloor\log_2(\min(M,N))\rfloor-3$</p><ul><li>$M,N$ï¼šåŸå›¾åƒçš„é•¿å®½</li></ul><p>å±‚æ•°å…¬å¼ï¼š$S=n+3$</p><ul><li>$S$æ˜¯æ¯ç»„çš„å±‚æ•°ï¼ˆè‡ªè®¾ï¼‰</li><li>$n$æ˜¯æœ€ç»ˆæƒ³åœ¨å·®åˆ†é‡‘å­—å¡”ä¸­æå–æå€¼ç‚¹çš„å±‚æ•°ï¼ˆè§å·®åˆ†é‡‘å­—å¡”ï¼‰</li></ul><p>å¹³æ»‘å› å­å…¬å¼ï¼š$\sigma(o,r)=\sigma_0 2^{o+\frac{r}{n}}$ï¼Œå…¶ä¸­$o$æ˜¯ç»„æ•°ï¼Œ$r$æ˜¯å±‚æ•°</p><ul><li>SIFTç®—æ³•ä¸­ï¼Œ$\sigma_0=1.6$ã€‚ä½†ç”±äºç›¸æœºå…·æœ‰åˆå§‹æ¨¡ç³Š$\sigma_0=0.5$ï¼Œå®é™…$\sigma_0=\sqrt{1.6^2-0.5^2}=1.52$</li><li>ç¬¬oå±‚çš„åˆå§‹å¹³æ»‘å› å­$\sigma(o,0)=2^o\sigma_0$</li><li>$k=2^{1/n}$</li></ul><p><img src="https://source.cclmsy.cc/posts/notes/others/é«˜æ–¯é‡‘å­—å¡”2.png" alt="é«˜æ–¯é‡‘å­—å¡”2"></p><p>é‡‘å­—å¡”å†…å„å›¾ç‰‡çš„å…³ç³»ï¼š</p><ul><li>åœ¨åŒä¸€ç»„å†…ï¼Œä¸åŒå±‚å›¾åƒçš„å°ºå¯¸æ˜¯ä¸€æ ·çš„ï¼Œåä¸€å±‚å›¾åƒçš„é«˜æ–¯å¹³æ»‘å› å­Ïƒæ˜¯å‰ä¸€å±‚å›¾åƒå¹³æ»‘å› å­çš„kå€</li><li>åœ¨ä¸åŒç»„å†…ï¼Œåä¸€ç»„ç¬¬ä¸€ä¸ªå›¾åƒæ˜¯å‰ä¸€ç»„å€’æ•°ç¬¬ä¸‰ä¸ªå›¾åƒçš„äºŒåˆ†ä¹‹ä¸€é‡‡æ ·ï¼Œå›¾åƒå¤§å°æ˜¯å‰ä¸€ç»„çš„ä¸€åŠ</li></ul><h3 id="3-é«˜æ–¯å·®åˆ†é‡‘å­—å¡”ä¸æå€¼ç‚¹æ£€æµ‹"><a href="#3-é«˜æ–¯å·®åˆ†é‡‘å­—å¡”ä¸æå€¼ç‚¹æ£€æµ‹" class="headerlink" title="3. é«˜æ–¯å·®åˆ†é‡‘å­—å¡”ä¸æå€¼ç‚¹æ£€æµ‹"></a>3. é«˜æ–¯å·®åˆ†é‡‘å­—å¡”ä¸æå€¼ç‚¹æ£€æµ‹</h3><h4 id="3-1-é«˜æ–¯å·®åˆ†é‡‘å­—å¡”"><a href="#3-1-é«˜æ–¯å·®åˆ†é‡‘å­—å¡”" class="headerlink" title="3.1 é«˜æ–¯å·®åˆ†é‡‘å­—å¡”"></a>3.1 é«˜æ–¯å·®åˆ†é‡‘å­—å¡”</h4><p>å¯¹é«˜æ–¯é‡‘å­—å¡”çš„æ¯ä¸€ç»„å›¾åƒï¼Œè®¡ç®—ç›¸é‚»ä¸¤å±‚å›¾åƒçš„å·®åˆ†ï¼Œå¾—åˆ°é«˜æ–¯å·®åˆ†é‡‘å­—å¡”(DoG, Difference of Gaussian)ã€‚</p><script type="math/tex; mode=display">D(x,y,\sigma) = (G(x,y,k\sigma)-G(x,y,\sigma)) * I(x,y)</script><h4 id="3-2-ä¼°è®¡æå€¼ç‚¹"><a href="#3-2-ä¼°è®¡æå€¼ç‚¹" class="headerlink" title="3.2 ä¼°è®¡æå€¼ç‚¹"></a>3.2 ä¼°è®¡æå€¼ç‚¹</h4><p>å°†æ¯ä¸ªåƒç´ ç‚¹å’Œå®ƒåœ¨3Ã—3Ã—3çš„é‚»åŸŸå†…çš„26ä¸ªåƒç´ ç‚¹è¿›è¡Œæ¯”è¾ƒã€‚<br>å¦‚æœè¿™ä¸ªç‚¹æ˜¯è¿™27ä¸ªç‚¹ä¸­çš„æœ€å¤§å€¼æˆ–æœ€å°å€¼ï¼Œåˆ™è®¤ä¸ºè¿™ä¸ªç‚¹æ˜¯ä¸€ä¸ªæå€¼ç‚¹ã€‚</p><p>DoGé‡‘å­—å¡”æ˜¯ç¦»æ•£çš„(å› ä¸ºå°ºåº¦ç©ºé—´å’Œåƒç´ ç‚¹éƒ½æ˜¯ç¦»æ•£çš„)ï¼Œæ‰€ä»¥æ‰¾åˆ°çš„æå€¼ç‚¹ä¸å¤ªå‡†ç¡®çš„ï¼Œå¾ˆå¤§å¯èƒ½åœ¨çœŸæ­£æå€¼ç‚¹é™„è¿‘ï¼Œå› æ­¤éœ€è¦å¯¹æ¯ä¸ªæå€¼ç‚¹è¿›è¡Œæ’å€¼ã€‚</p><h4 id="3-3-æ³°å‹’å±•å¼€æ±‚ç²¾ç¡®æå€¼ç‚¹"><a href="#3-3-æ³°å‹’å±•å¼€æ±‚ç²¾ç¡®æå€¼ç‚¹" class="headerlink" title="3.3 æ³°å‹’å±•å¼€æ±‚ç²¾ç¡®æå€¼ç‚¹"></a>3.3 æ³°å‹’å±•å¼€æ±‚ç²¾ç¡®æå€¼ç‚¹</h4><p>å¯¹æ¯ä¸ªæå€¼ç‚¹$X_0(x_0,y_0,\sigma_0)^T$ï¼Œè¿›è¡Œä¸‰å…ƒäºŒæ¬¡æ³°å‹’å±•å¼€ï¼š</p><script type="math/tex; mode=display">\begin{aligned}f(X) &= f(x_0)+\dfrac{\partial f}{\partial X}^T\hat{X}+\dfrac{1}{2}\hat{X}^T\dfrac{\partial^2 f}{\partial X^2}\hat{X} \\\\\hat{X} &= X-X_0 \\\\X &= (x,y,\sigma)^T\end{aligned}</script><p>å°†$f(X)$å¯¹$X$æ±‚å¯¼ï¼š</p><script type="math/tex; mode=display">\dfrac{\partial f(X)}{\partial X} = \dfrac{\partial f}{\partial X}^T+\dfrac{1}{2}\left( \dfrac{\partial^2 f}{\partial X^2} + \dfrac{\partial^2 f}{\partial X^2}^T \right)\hat{X} = \dfrac{\partial f}{\partial X}^T+\dfrac{\partial^2 f}{\partial X^2}\hat{X}</script><p>å¯¼æ•°ä¸º0æ—¶ï¼Œè§£å¾—æå€¼ç‚¹ï¼š</p><script type="math/tex; mode=display">\hat{X} = -\dfrac{\partial^2 f}{\partial X^2}^{-1}\dfrac{\partial f}{\partial X}</script><p>ä»£å…¥$f(X)$å¾—åˆ°æå€¼ï¼š</p><script type="math/tex; mode=display">f(X) = f(x_0)+\dfrac{1}{2}\dfrac{\partial f}{\partial X}^T\hat{X}</script><h4 id="3-4-å»é™¤ä½å¯¹æ¯”åº¦ç‚¹"><a href="#3-4-å»é™¤ä½å¯¹æ¯”åº¦ç‚¹" class="headerlink" title="3.4 å»é™¤ä½å¯¹æ¯”åº¦ç‚¹"></a>3.4 å»é™¤ä½å¯¹æ¯”åº¦ç‚¹</h4><p>èˆå»$|f(X_0)|&lt;\dfrac{T}{n}, T=0.04$çš„æå€¼ç‚¹ï¼Œå› ä¸ºè¿™äº›ç‚¹å¯¹åº”çš„å·®åˆ†å€¼å¤ªå°ï¼Œå¯¹æ¯”åº¦ä½ï¼Œä¸å…·æœ‰ä»£è¡¨æ€§ã€‚</p><h4 id="3-5-å»é™¤è¾¹ç¼˜å“åº”"><a href="#3-5-å»é™¤è¾¹ç¼˜å“åº”" class="headerlink" title="3.5 å»é™¤è¾¹ç¼˜å“åº”"></a>3.5 å»é™¤è¾¹ç¼˜å“åº”</h4><p>DoGåœ¨è¾¹ç¼˜ä¼šæœ‰æ¯”è¾ƒå¤§çš„å€¼ï¼ˆè¾¹ç¼˜å“åº”å¼ºï¼‰ï¼Œä½†è¾¹ç¼˜ä¸ä¸€å®šèƒ½å¤Ÿæä¾›ç¨³å®šçš„ç‰¹å¾ï¼Œå› æ­¤éœ€è¦å»é™¤è¾¹ç¼˜å“åº”å¼ºçš„ç‚¹ã€‚</p><p>å¯¹äºæ¯ä¸ªæå€¼ç‚¹ï¼Œè®¡ç®—HessiançŸ©é˜µçš„è¿¹å’Œè¡Œåˆ—å¼ï¼š</p><script type="math/tex; mode=display">\begin{aligned}H &= \begin{bmatrix} D_{xx} & D_{xy} \\ D_{xy} & D_{yy} \end{bmatrix} \\\\Tr(H) &= D_{xx} + D_{yy} = \alpha + \beta \\\\Det(H) &= D_{xx} D_{yy} - (D_{xy})^2 = \alpha \beta\end{aligned}</script><p>å…¶ä¸­ï¼š</p><ul><li>$\alpha$ä¸ºè¾ƒå¤§çš„ç‰¹å¾å€¼ï¼Œ$\beta$ä¸ºè¾ƒå°çš„ç‰¹å¾å€¼</li><li>$\alpha = r \beta$ï¼Œ$r$æ˜¯ä¸€ä¸ªå¤§äº1çš„å®æ•°</li></ul><p>è¿‡æ»¤ï¼š</p><ol><li>$Det(H)&lt;0$</li><li>$\dfrac{(Tr(H))^2}{Det(H)}\ge (r+1)^2/r$ï¼Œè®ºæ–‡æ¨èå€¼$r=10$</li></ol><h3 id="4-å…³é”®ç‚¹æ–¹å‘åˆ†é…"><a href="#4-å…³é”®ç‚¹æ–¹å‘åˆ†é…" class="headerlink" title="4. å…³é”®ç‚¹æ–¹å‘åˆ†é…"></a>4. å…³é”®ç‚¹æ–¹å‘åˆ†é…</h3><ol><li>0~360åº¦åˆ’åˆ†ä¸º36 binsï¼Œæ¯ä¸ªbinä¸º10åº¦</li><li>åœ¨<strong>é«˜æ–¯é‡‘å­—å¡”</strong>æ‰¾åˆ°å…³é”®ç‚¹å¯¹åº”ä½ç½®ï¼Œä»¥å®ƒä¸ºåœ†å¿ƒï¼ŒåŠå¾„ä¸º$1.5\sigma$ç”»åœ†</li><li>ç»Ÿè®¡åœ†ä¸­æ‰€æœ‰åƒç´ çš„æ¢¯åº¦æ–¹å‘ã€æ¢¯åº¦å¹…å€¼ï¼ˆæ¨¡ï¼‰ï¼Œç›´æ–¹å›¾å¹³æ»‘å¤„ç†ï¼Œç”¨$1.5\sigma$è¿›è¡Œé«˜æ–¯åŠ æƒ<ul><li>å¹³æ»‘å¤„ç†ï¼šé˜²æ­¢æŸä¸ªæ¢¯åº¦æ–¹å‘è§’åº¦å—å™ªå£°å¹²æ‰°ç­‰å› ç´ çªå˜ </li><li>é«˜æ–¯åŠ æƒï¼šä½¿ç‰¹å¾ç‚¹é™„ä»¶çš„æ¢¯åº¦å¹…å€¼å…·æœ‰æ›´å¤§çš„æƒé‡ï¼Œå¼¥è¡¥å› æ²¡æœ‰ä»¿å°„ä¸å˜æ€§è€Œå¯¼è‡´çš„ç‰¹å¾ä¸ç¨³å®š</li></ul></li><li>ç»Ÿè®¡å‡ºæ•°å€¼æœ€é«˜çš„æ¢¯åº¦æ–¹å‘ï¼Œä½œä¸ºä¸»æ–¹å‘ï¼›ä¿ç•™å¤§äºä¸»æ–¹å‘80%çš„æ–¹å‘ä½œä¸ºè¾…æ–¹å‘</li></ol><p>æ¢¯åº¦æ–¹å‘å’Œæ¢¯åº¦å¹…å€¼çš„è®¡ç®—ï¼š</p><script type="math/tex; mode=display">m(x,y) = \sqrt{(L(x+1,y)-L(x-1,y))^2+(L(x,y+1)-L(x,y-1))^2}</script><script type="math/tex; mode=display">\theta(x,y) = \arctan\left(\dfrac{L(x,y+1)-L(x,y-1)}{L(x+1,y)-L(x-1,y)}\right)</script><p>é«˜æ–¯åŠ æƒå…¬å¼ï¼š</p><script type="math/tex; mode=display">W_{i,j} = e^{\dfrac{-(i^2+j^2)}{2\times(1.5\sigma)^2}}</script><ul><li>$i,j$æ˜¯åƒç´ ç‚¹åˆ°å…³é”®ç‚¹çš„è·ç¦»</li></ul><h3 id="5-å…³é”®ç‚¹æè¿°"><a href="#5-å…³é”®ç‚¹æè¿°" class="headerlink" title="5. å…³é”®ç‚¹æè¿°"></a>5. å…³é”®ç‚¹æè¿°</h3><p>æè¿°ç¬¦æ˜¯ä¸€ç»„å‘é‡ï¼Œç”¨äºæè¿°ç‰¹å¾ç‚¹åŠå…¶é¢†åŸŸç‚¹çš„ç‰¹å¾ï¼Œä»¥ä¾¿æ›´å¥½åœ°ä¸å…¶ä»–å›¾ç‰‡åŒ¹é…</p><ol><li>å°†åè½´æ ‡ç§»åˆ°å…³é”®ç‚¹æ–¹å‘</li><li>å°†ç‰¹å¾ç‚¹çš„é¢†åŸŸåˆ’åˆ†ä¸º$d\times d$ä¸ªå­åŒºåŸŸï¼Œæ¯ä¸ªå­åŒºåŸŸå¤§å°ä¸º$m\sigma\times m\sigma$ï¼Œå¹¶åˆ’åˆ†ä¸º8ä¸ªæ–¹å‘ã€‚è®ºæ–‡æ¨èå€¼ï¼š$m=3$ï¼Œ$d=4$</li><li>æ¯ä¸€ä¸ªå­å—è¿›è¡Œ8ä¸ªæ–¹å‘çš„ç›´æ–¹å›¾ç»Ÿè®¡æ“ä½œï¼Œå…±$d\times d\times 8=128$ä¸ªbinï¼Œå¾—åˆ°ä¸€ä¸ª128ç»´çš„ç‰¹å¾å‘é‡ï¼ˆæè¿°ç¬¦ï¼‰</li></ol><h3 id="6-ç‰¹å¾ç‚¹åŒ¹é…"><a href="#6-ç‰¹å¾ç‚¹åŒ¹é…" class="headerlink" title="6. ç‰¹å¾ç‚¹åŒ¹é…"></a>6. ç‰¹å¾ç‚¹åŒ¹é…</h3><p>åˆ†åˆ«å¯¹æ¨¡æ¿å›¾ï¼ˆå‚è€ƒå›¾ï¼Œreference imageï¼‰å’Œå®æ—¶å›¾ï¼ˆè§‚æµ‹å›¾ï¼Œobservation imageï¼‰å»ºç«‹å…³é”®ç‚¹æè¿°å­é›†åˆã€‚</p><p>ç›®æ ‡çš„è¯†åˆ«æ˜¯é€šè¿‡ä¸¤ç‚¹é›†å†…å…³é”®ç‚¹æè¿°å­çš„æ¯”å¯¹æ¥å®Œæˆï¼Œä¸€èˆ¬é‡‡ç”¨æ¬§æ°è·ç¦»æ¥è¡¡é‡ä¸¤ä¸ªæè¿°å­ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚</p><p>å¯ä»¥ä½¿ç”¨<a href="https://oi-wiki.org/ds/kdt/">KDæ ‘</a>ä¼˜åŒ–æœç´¢è¿‡ç¨‹ã€‚</p><h2 id="SIFTå®ç°"><a href="#SIFTå®ç°" class="headerlink" title="SIFTå®ç°"></a>SIFTå®ç°</h2><p>cv2ä¸­å·²ç»ç»™å‡ºäº†SIFTç®—æ³•çš„å®ç°ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–å›¾åƒ</span></span><br><span class="line">img=cv2.imread(<span class="string">&#x27;nz.jpg&#x27;</span>)</span><br><span class="line">cat=cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºSIFTå¯¹è±¡</span></span><br><span class="line">sift=cv2.SIFT_create()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é”®ç‚¹æ£€æµ‹ï¼škpå…³é”®ç‚¹ä¿¡æ¯åŒ…æ‹¬æ–¹å‘ï¼Œå°ºåº¦ï¼Œä½ç½®ä¿¡æ¯ï¼Œdesæ˜¯å…³é”®ç‚¹çš„æè¿°ç¬¦</span></span><br><span class="line">kp,des=sift.detectAndCompute(cat,<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨å›¾åƒä¸Šç»˜åˆ¶å…³é”®ç‚¹çš„æ£€æµ‹ç»“æœ</span></span><br><span class="line">cv2.drawKeypoints(img,kp,img,flags=cv2.DRAW_MATCHES_FLAGS_DRAW_RICH_KEYPOINTS)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å›¾åƒæ˜¾ç¤º</span></span><br><span class="line">plt.imshow(cv2.cvtColor(img, cv2.COLOR_BGR2RGB))</span><br><span class="line">plt.title(<span class="string">&#x27;SIFT Result&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="https://source.cclmsy.cc/posts/notes/others/SIFT_Result.png" alt="SIFT Result"></p>]]></content>
    
    
    <summary type="html">å°ºåº¦ä¸å˜ç‰¹å¾å˜æ¢åŒ¹é…ç®—æ³• Scale-Invariant Feature Transform</summary>
    
    
    
    <category term="DLç¬”è®°" scheme="https://www.cclmsy.cc/categories/DL%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="å›¾åƒæ£€ç´¢" scheme="https://www.cclmsy.cc/tags/%E5%9B%BE%E5%83%8F%E6%A3%80%E7%B4%A2/"/>
    
    <category term="è®¡ç®—æœºè§†è§‰" scheme="https://www.cclmsy.cc/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/"/>
    
  </entry>
  
  <entry>
    <title>K-means/K-means++</title>
    <link href="https://www.cclmsy.cc/posts/k_means.html"/>
    <id>https://www.cclmsy.cc/posts/k_means.html</id>
    <published>2025-03-14T16:00:00.000Z</published>
    <updated>2025-07-21T05:30:01.676Z</updated>
    
    <content type="html"><![CDATA[<h2 id="K-Meansèšç±»ç®—æ³•"><a href="#K-Meansèšç±»ç®—æ³•" class="headerlink" title="K-Meansèšç±»ç®—æ³•"></a>K-Meansèšç±»ç®—æ³•</h2><h3 id="ç®—æ³•æ€æƒ³"><a href="#ç®—æ³•æ€æƒ³" class="headerlink" title="ç®—æ³•æ€æƒ³"></a>ç®—æ³•æ€æƒ³</h3><p>K-meansç®—æ³•æ˜¯ä¸€ç§è¿­ä»£æ±‚è§£çš„èšç±»ç®—æ³•ï¼Œå°†æ•°æ®é›†ä¸­çš„nä¸ªæ ·æœ¬åˆ’åˆ†ä¸ºKä¸ªç°‡ï¼ˆèšç±»ï¼‰ã€‚<br>æ¯ä¸ªå¯¹è±¡åˆ°ç°‡ä¸­å¿ƒçš„è·ç¦»ä¹‹å’Œæœ€å°ã€‚<br>ç°‡å†…çš„å¯¹è±¡ç›¸ä¼¼åº¦è¾ƒé«˜ï¼Œç°‡é—´çš„å¯¹è±¡ç›¸ä¼¼åº¦è¾ƒä½ã€‚</p><h3 id="ç®—æ³•æ­¥éª¤"><a href="#ç®—æ³•æ­¥éª¤" class="headerlink" title="ç®—æ³•æ­¥éª¤"></a>ç®—æ³•æ­¥éª¤</h3><h4 id="1-é€‰æ‹©Kä¸ªåˆå§‹èšç±»ä¸­å¿ƒ"><a href="#1-é€‰æ‹©Kä¸ªåˆå§‹èšç±»ä¸­å¿ƒ" class="headerlink" title="1. é€‰æ‹©Kä¸ªåˆå§‹èšç±»ä¸­å¿ƒ"></a>1. é€‰æ‹©Kä¸ªåˆå§‹èšç±»ä¸­å¿ƒ</h4><p>éšæœºé€‰æ‹©Kä¸ªæ ·æœ¬ä½œä¸ºåˆå§‹èšç±»ä¸­å¿ƒã€‚</p><p>é€‰æ‹©å¯¹æœ€ç»ˆçš„èšç±»ç»“æœæœ‰ä¸€å®šå½±å“ï¼Œå› æ­¤åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé€šå¸¸ä¼šé‡‡ç”¨ä¸€äº›å¯å‘å¼çš„æ–¹æ³•æ¥é€‰æ‹©è¾ƒå¥½çš„åˆå§‹èšç±»ä¸­å¿ƒï¼Œå¦‚K-means++ç®—æ³•</p><h4 id="2-è®¡ç®—æ¯ä¸ªæ ·æœ¬åˆ°èšç±»ä¸­å¿ƒçš„è·ç¦»"><a href="#2-è®¡ç®—æ¯ä¸ªæ ·æœ¬åˆ°èšç±»ä¸­å¿ƒçš„è·ç¦»" class="headerlink" title="2. è®¡ç®—æ¯ä¸ªæ ·æœ¬åˆ°èšç±»ä¸­å¿ƒçš„è·ç¦»"></a>2. è®¡ç®—æ¯ä¸ªæ ·æœ¬åˆ°èšç±»ä¸­å¿ƒçš„è·ç¦»</h4><p>å¯¹äºæ¯ä¸ªæ ·æœ¬ï¼Œè®¡ç®—å…¶åˆ°Kä¸ªèšç±»ä¸­å¿ƒçš„è·ç¦»ï¼Œå°†å…¶åˆ’åˆ†åˆ°è·ç¦»æœ€è¿‘çš„èšç±»ä¸­å¿ƒæ‰€åœ¨çš„ç°‡ä¸­ã€‚</p><p>é€šå¸¸ä½¿ç”¨æ¬§å¼è·ç¦»ï¼š$d(x<em>i, c_j) = \sqrt{\sum</em>{k=1}^{n}(x<em>{ik}-c</em>{jk})^2}$</p><h4 id="3-æ›´æ–°èšç±»ä¸­å¿ƒ"><a href="#3-æ›´æ–°èšç±»ä¸­å¿ƒ" class="headerlink" title="3. æ›´æ–°èšç±»ä¸­å¿ƒ"></a>3. æ›´æ–°èšç±»ä¸­å¿ƒ</h4><p>å¯¹äºæ¯ä¸ªèšç±»ï¼Œé‡æ–°è®¡ç®—å…¶èšç±»ä¸­å¿ƒï¼Œæ–°çš„èšç±»ä¸­å¿ƒæ˜¯è¯¥èšç±»å†…æ‰€æœ‰æ•°æ®ç‚¹çš„å‡å€¼ï¼š$c<em>j = \dfrac{1}{|S_j|}\sum</em>{x_i\in S_j}x_i$</p><h4 id="4-è¿­ä»£"><a href="#4-è¿­ä»£" class="headerlink" title="4. è¿­ä»£"></a>4. è¿­ä»£</h4><p>é‡å¤æ­¥éª¤2å’Œ3ï¼Œç›´åˆ°èšç±»ä¸­å¿ƒä¸å†å‘ç”Ÿæ˜¾è‘—å˜åŒ–æˆ–è€…è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°ã€‚</p><h3 id="ç®—æ³•ä¼˜ç¼ºç‚¹"><a href="#ç®—æ³•ä¼˜ç¼ºç‚¹" class="headerlink" title="ç®—æ³•ä¼˜ç¼ºç‚¹"></a>ç®—æ³•ä¼˜ç¼ºç‚¹</h3><p>ä¼˜ç‚¹ï¼šé€»è¾‘ç®€å•ã€æ˜“äºå®ç°ã€æ”¶æ•›é€Ÿåº¦å¿«</p><p>ç¼ºç‚¹ï¼šéœ€è¦äº‹å…ˆç¡®å®šèšç±»æ•°ç›®Kï¼Œå¯¹åˆå§‹èšç±»ä¸­å¿ƒæ•æ„Ÿï¼Œå¯èƒ½æ”¶æ•›åˆ°å±€éƒ¨æœ€ä¼˜è§£</p><h3 id="K-Means-å®ç°"><a href="#K-Means-å®ç°" class="headerlink" title="K-Means å®ç°"></a>K-Means å®ç°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">k_means</span>(<span class="params">data, k=<span class="number">3</span>, max_iter=<span class="number">100</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;K-means èšç±»ç®—æ³•</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        data: æ•°æ®é›†ï¼Œlist[element]ï¼Œelementæ˜¯ä¸€ä¸ªlist[float]</span></span><br><span class="line"><span class="string">        k: èšç±»æ•°</span></span><br><span class="line"><span class="string">        max_iter: æœ€å¤§è¿­ä»£æ¬¡æ•°</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–èšç±»ä¸­å¿ƒ</span></span><br><span class="line">    centers = random.sample(data, k)</span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–èšç±»ç»“æœ</span></span><br><span class="line">    clusters = [[] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(k)]</span><br><span class="line">    <span class="comment"># è¿­ä»£èšç±»</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">iter</span> <span class="keyword">in</span> <span class="built_in">range</span>(max_iter):</span><br><span class="line">        <span class="comment"># åˆ†é…æ•°æ®åˆ°æœ€è¿‘çš„èšç±»ä¸­å¿ƒ</span></span><br><span class="line">        <span class="keyword">for</span> element <span class="keyword">in</span> data: <span class="comment"># å¯¹äºæ¯ä¸ªæ•°æ®</span></span><br><span class="line">            min_dist = <span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>) <span class="comment"># æœ€å°è·ç¦»</span></span><br><span class="line">            min_idx = -<span class="number">1</span> <span class="comment"># æœ€è¿‘èšç±»</span></span><br><span class="line">            <span class="keyword">for</span> i, center <span class="keyword">in</span> <span class="built_in">enumerate</span>(centers):</span><br><span class="line">                dist = <span class="built_in">sum</span>((x-y)**<span class="number">2</span> <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(element, center)) <span class="comment"># è®¡ç®—è·ç¦»</span></span><br><span class="line">                <span class="keyword">if</span> dist &lt; min_dist:</span><br><span class="line">                    min_dist = dist</span><br><span class="line">                    min_idx = i</span><br><span class="line">            clusters[min_idx].append(element)</span><br><span class="line">        <span class="comment"># æ›´æ–°èšç±»ä¸­å¿ƒ</span></span><br><span class="line">        new_centers = [<span class="literal">None</span>] * k</span><br><span class="line">        <span class="keyword">for</span> i, cluster <span class="keyword">in</span> <span class="built_in">enumerate</span>(clusters):</span><br><span class="line">            new_centers[i] = [<span class="built_in">sum</span>(x)/<span class="built_in">len</span>(cluster) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">zip</span>(*cluster)]</span><br><span class="line">        <span class="comment"># åˆ¤æ–­æ˜¯å¦æ”¶æ•›ï¼šä¸­å¿ƒç‚¹æ˜¯å¦å˜åŒ–å°äºeps</span></span><br><span class="line">        eps = <span class="number">1e-6</span></span><br><span class="line">        fl = <span class="built_in">all</span>((<span class="built_in">sum</span>((x-y)**<span class="number">2</span> <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(a, b)) &lt; eps) <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(centers, new_centers))</span><br><span class="line">        <span class="keyword">if</span> fl <span class="keyword">or</span> <span class="built_in">iter</span> == max_iter-<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        centers = new_centers</span><br><span class="line">        clusters = [[] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(k)]</span><br><span class="line">    <span class="keyword">return</span> clusters</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•</span></span><br><span class="line">data = [[random.random() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>)]</span><br><span class="line">clusters = k_means(data, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»“æœå¯è§†åŒ–</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">colors = [<span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;m&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i, cluster <span class="keyword">in</span> <span class="built_in">enumerate</span>(clusters):</span><br><span class="line">    <span class="keyword">for</span> element <span class="keyword">in</span> cluster:</span><br><span class="line">        plt.scatter(element[<span class="number">0</span>], element[<span class="number">1</span>], c=colors[i])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="https://source.cclmsy.cc/posts/notes/others/k_means.png" alt="k_means"></p><h2 id="K-Means-ç®—æ³•"><a href="#K-Means-ç®—æ³•" class="headerlink" title="K-Means++ç®—æ³•"></a>K-Means++ç®—æ³•</h2><p>K-Means++ç®—æ³•æ˜¯K-meansç®—æ³•çš„æ”¹è¿›ï¼Œä¼˜åŒ–äº†åˆå§‹èšç±»ä¸­å¿ƒçš„é€‰æ‹©ï¼Œä½¿å¾—åˆå§‹èšç±»ä¸­å¿ƒæ›´æœ‰ä»£è¡¨æ€§ï¼Œæ”¶æ•›é€Ÿåº¦æ›´å¿«ã€‚</p><p>é€ä¸ªé€‰å–kä¸ªç°‡ä¸­å¿ƒï¼Œä¸”ç¦»å…¶å®ƒç°‡ä¸­å¿ƒè¶Šè¿œçš„æ ·æœ¬ç‚¹è¶Šæœ‰å¯èƒ½è¢«é€‰ä¸ºä¸‹ä¸€ä¸ªç°‡ä¸­å¿ƒ</p><h3 id="ç®—æ³•æ­¥éª¤ï¼ˆé€‰æ‹©Kä¸ªåˆå§‹èšç±»ä¸­å¿ƒçš„è¿‡ç¨‹ï¼‰"><a href="#ç®—æ³•æ­¥éª¤ï¼ˆé€‰æ‹©Kä¸ªåˆå§‹èšç±»ä¸­å¿ƒçš„è¿‡ç¨‹ï¼‰" class="headerlink" title="ç®—æ³•æ­¥éª¤ï¼ˆé€‰æ‹©Kä¸ªåˆå§‹èšç±»ä¸­å¿ƒçš„è¿‡ç¨‹ï¼‰"></a>ç®—æ³•æ­¥éª¤ï¼ˆé€‰æ‹©Kä¸ªåˆå§‹èšç±»ä¸­å¿ƒçš„è¿‡ç¨‹ï¼‰</h3><h4 id="1-é€‰æ‹©ç¬¬ä¸€ä¸ªç°‡ä¸­å¿ƒ"><a href="#1-é€‰æ‹©ç¬¬ä¸€ä¸ªç°‡ä¸­å¿ƒ" class="headerlink" title="1. é€‰æ‹©ç¬¬ä¸€ä¸ªç°‡ä¸­å¿ƒ"></a>1. é€‰æ‹©ç¬¬ä¸€ä¸ªç°‡ä¸­å¿ƒ</h4><p>éšæœºé€‰æ‹©ä¸€ä¸ªæ ·æœ¬ä½œä¸ºç¬¬ä¸€ä¸ªç°‡ä¸­å¿ƒ</p><h4 id="2-é€‰æ‹©ä¸‹ä¸€ä¸ªç°‡ä¸­å¿ƒ"><a href="#2-é€‰æ‹©ä¸‹ä¸€ä¸ªç°‡ä¸­å¿ƒ" class="headerlink" title="2. é€‰æ‹©ä¸‹ä¸€ä¸ªç°‡ä¸­å¿ƒ"></a>2. é€‰æ‹©ä¸‹ä¸€ä¸ªç°‡ä¸­å¿ƒ</h4><p>å¯¹äºæ ·æœ¬xï¼Œè®¡ç®—å…¶åˆ°å·²æœ‰ç°‡ä¸­å¿ƒçš„æœ€çŸ­è·ç¦»ï¼Œè®°ä¸º$D(x)$ï¼Œé€‰å–xä½œä¸ºä¸‹ä¸€ä¸ªç°‡ä¸­å¿ƒçš„æ¦‚ç‡ä¸º$\dfrac{D(x)^2}{\sum_{x\in X}D(x)^2}$</p><h4 id="3-è¿­ä»£"><a href="#3-è¿­ä»£" class="headerlink" title="3. è¿­ä»£"></a>3. è¿­ä»£</h4><p>é‡å¤æ­¥éª¤2ï¼Œç›´åˆ°é€‰å–kä¸ªç°‡ä¸­å¿ƒ</p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é€‰æ‹©ç¬¬ä¸€ä¸ªèšç±»ä¸­å¿ƒ</span></span><br><span class="line">centers = [random.choice(data)]</span><br><span class="line"><span class="comment"># é€‰æ‹©å…¶ä»–èšç±»ä¸­å¿ƒ</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(k-<span class="number">1</span>):</span><br><span class="line">    dists = [<span class="built_in">min</span>(<span class="built_in">sum</span>((x-y)**<span class="number">2</span> <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(element, center)) <span class="keyword">for</span> center <span class="keyword">in</span> centers) <span class="keyword">for</span> element <span class="keyword">in</span> data]</span><br><span class="line">    probs = [dist**<span class="number">2</span>/<span class="built_in">sum</span>(dists) <span class="keyword">for</span> dist <span class="keyword">in</span> dists]</span><br><span class="line">    centers.append(random.choices(data, probs)[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">æœ€å¸¸ç”¨çš„èšç±»ç®—æ³•</summary>
    
    
    
    <category term="DLç¬”è®°" scheme="https://www.cclmsy.cc/categories/DL%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="èšç±»ç®—æ³•" scheme="https://www.cclmsy.cc/tags/%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>è®ºæ–‡ç¬”è®°&amp;å®ç°|ChatIRï¼šåŸºäºå¯¹è¯çš„å›¾åƒæ£€ç´¢ç³»ç»Ÿ</title>
    <link href="https://www.cclmsy.cc/posts/2305.20062.html"/>
    <id>https://www.cclmsy.cc/posts/2305.20062.html</id>
    <published>2025-03-06T16:00:00.000Z</published>
    <updated>2025-10-15T08:42:17.428Z</updated>
    
    <content type="html"><![CDATA[<p>è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/2305.20062">Chatting Makes Perfect: Chat-based Image Retrival</a></p><h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h2><p>ä¼ ç»Ÿçš„æ–‡æœ¬åˆ°å›¾åƒæ£€ç´¢æ–¹æ³•ï¼Œç”¨æˆ·éœ€è¦ä¸€æ¬¡æ€§æä¾›å…¨é¢è¯¦ç»†çš„æè¿°ï¼Œæ¥æœç´¢ç›®æ ‡å›¾åƒã€‚</p><p>æœ¬æ–‡æå‡ºäº†ä¸€ä¸ªåŸºäºå¯¹è¯çš„å›¾åƒæ£€ç´¢ç³»ç»ŸChatIRï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡å¤šè½®å¯¹è¯é€æ­¥ç»†åŒ–æœç´¢ç›®æ ‡ã€‚</p><p>ChatIRç³»ç»ŸåŒ…å«2ä¸ªéƒ¨åˆ†ï¼šå¯¹è¯æ„å»ºï¼ˆDialog Buildingï¼‰å’Œå›¾åƒæœç´¢ï¼ˆImage Searchï¼‰</p><ul><li>å¯¹è¯æ„å»ºï¼šä½¿ç”¨é—®é¢˜ç”Ÿæˆå™¨Gï¼Œè€ƒè™‘å½“å‰å¯¹è¯å†å²ï¼Œç”Ÿæˆä¸‹ä¸€ä¸ªé—®é¢˜</li><li>å›¾åƒæœç´¢ï¼šä½¿ç”¨æ¨¡å‹Fï¼Œå°†ä¸åŒé•¿åº¦çš„å¯¹è¯åºåˆ—æ˜ å°„åˆ°è§†è§‰åµŒå…¥ç©ºé—´</li><li>ä¸¤ä¸ªç»„æˆéƒ¨åˆ†å»ºç«‹åœ¨Instructional LLMså’Œfundation Vision and Language Modelsä¸Š</li></ul><p><img src="https://source.cclmsy.cc/posts/papers/2305.20062/1.png" alt="ChatIR"></p><p>è€ƒè™‘ä¸‰ä¸ªé—®é¢˜ï¼š</p><ol><li>ä½¿ç”¨ä»€ä¹ˆæ•°æ®é›†è®­ç»ƒï¼Ÿæ˜¯å¦éœ€è¦æ–°åˆ›å»ºå’Œæ ‡æ³¨æ•°æ®é›†ï¼Ÿ<ul><li>ä½¿ç”¨VisDialæ•°æ®é›†</li><li>é—®é¢˜ï¼šVisDialæ˜¯ä¸€ä¸ªç”¨äºâ€œåˆ›å»ºå…³äºå›¾åƒçš„èŠå¤©â€çš„æ•°æ®é›†ï¼Œæ²¡æœ‰æ£€ç´¢ç›®æ ‡</li><li>è§£å†³ï¼šè¾“å…¥è¾“å‡ºåç½®ï¼Œå¯¹è¯ä½œä¸ºè¾“å…¥ã€å›¾åƒä½œä¸ºè¾“å‡º</li></ul></li><li>å¦‚ä½•ç‹¬ç«‹è¯„ä¼°ChatIRç³»ç»Ÿçš„ä¸åŒç»„ä»¶ï¼Ÿ <ul><li>æµ‹è¯•ä½¿ç”¨ä¸åŒçš„<code>Fè®­ç»ƒç­–ç•¥</code>å’Œ<code>æé—®æ¨¡å‹G</code>å¯¹æ£€ç´¢æ€§èƒ½çš„å½±å“</li><li>ä½¿ç”¨äº†BLIPæ›¿ä»£ç”¨æˆ·å›ç­”é—®é¢˜</li></ul></li><li>å¦‚ä½•å®šä¹‰è¯„ä¼°æŒ‡æ ‡ï¼Ÿ<ul><li>æ¯ä¸€è½®å¯¹è¯çš„æˆåŠŸæ£€ç´¢æ¦‚ç‡Hit@10</li></ul></li></ol><h2 id="2-Related-Work"><a href="#2-Related-Work" class="headerlink" title="2. Related Work"></a>2. Related Work</h2><ol><li>è§†è§‰å¯¹è¯ï¼ˆVisual Conversationï¼‰é¢†åŸŸ<ul><li>å½“å‰è§†è§‰é¢†åŸŸå·¥ä½œçš„é‡ç‚¹åœ¨äºå›¾åƒç†è§£å’Œç”Ÿæˆæ¨¡å‹ï¼Œè€Œä¸æ˜¯æ£€ç´¢</li><li>ç”Ÿæˆå¼è§†è§‰å¯¹è¯ä¸­ï¼Œè¿‘æœŸçš„åŸºç¡€æ¨¡å‹V&amp;Læ€§èƒ½ä¼˜è¶Šï¼Œå› æ­¤ChatIRç³»ç»Ÿåœ¨æ­¤åŸºç¡€ä¸Šæ„å»º</li></ul></li><li>è§†è§‰æœç´¢ï¼ˆVisual Searchï¼‰é¢†åŸŸ<ul><li>CoIRï¼šä½¿ç”¨å¤šæ¨¡æ€è¯¢é—®æŸ¥æ‰¾ç›®æ ‡å›¾åƒ</li><li>ä¸€äº›ç ”ç©¶åŸºäºCoIRï¼Œåˆ©ç”¨ç”¨æˆ·åé¦ˆç»†åŒ–æŸ¥è¯¢ç»“æœ</li><li>ä½†æ˜¯ï¼Œæ²¡æœ‰è€ƒè™‘ç”¨æˆ·äº¤äº’ï¼ˆåªæœ‰ç”¨æˆ·åé¦ˆï¼Œæ²¡æœ‰æœºå™¨æé—®ï¼‰ã€æ²¡æœ‰æ˜ç¡®åˆ©ç”¨å¯¹è¯å†å²</li></ul></li></ol><h2 id="3-Method"><a href="#3-Method" class="headerlink" title="3. Method"></a>3. Method</h2><h3 id="3-1-Dialog-Builder-Model-å¯¹è¯ç”Ÿæˆæ¨¡å‹"><a href="#3-1-Dialog-Builder-Model-å¯¹è¯ç”Ÿæˆæ¨¡å‹" class="headerlink" title="3.1 Dialog Builder Model å¯¹è¯ç”Ÿæˆæ¨¡å‹"></a>3.1 Dialog Builder Model å¯¹è¯ç”Ÿæˆæ¨¡å‹</h3><p>å¯¹è¯è®°å½•è¡¨ç¤ºï¼š$D_i = (C, Q_1, A_1, â€¦, Q_i)$</p><ul><li>$C$ï¼šç›®æ ‡å›¾åƒçš„åˆå§‹æ–‡æœ¬æè¿°ï¼ˆæ ‡é¢˜ï¼‰</li><li>$Q_i$ï¼šç¬¬iä¸ªé—®é¢˜</li><li>$A_i$ï¼šç¬¬iä¸ªå›ç­”</li></ul><p>å¯¹è¯ç”Ÿæˆæ¨¡å‹åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>é—®é¢˜ç”Ÿæˆå™¨Gï¼šä¸€ä¸ªLLMï¼Œæ ¹æ®å¯¹è¯è®°å½•ç”Ÿæˆä¸‹ä¸€ä¸ªé—®é¢˜<ul><li>$G: D<em>i \rightarrow Q</em>{i+1}$</li><li>Gä¸çŸ¥é“ç›®æ ‡å›¾åƒTæ˜¯ä»€ä¹ˆï¼ŒåªçŸ¥é“å¯¹è¯å†å²</li></ul></li><li>ç­”æ¡ˆæä¾›è€…Aï¼šåœ¨å®è·µä¸­ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªè„‘æµ·ä¸­æœ‰å¤§è‡´ç›®æ ‡å›¾åƒçš„äººç±»<ul><li>ç”±äºéœ€è¦å¤§è§„æ¨¡å®éªŒï¼Œä¸èƒ½ä¾èµ–ç”¨æˆ·æä¾›ç­”æ¡ˆ</li><li>å› æ­¤ï¼Œä½¿ç”¨äº†ä¸€ä¸ªç°æˆçš„æ¨¡å‹BLIP2æ¥å›ç­”</li></ul></li></ul><h3 id="3-2-Image-Retrieval-Model-å›¾åƒæ£€ç´¢æ¨¡å‹"><a href="#3-2-Image-Retrieval-Model-å›¾åƒæ£€ç´¢æ¨¡å‹" class="headerlink" title="3.2 Image Retrieval Model å›¾åƒæ£€ç´¢æ¨¡å‹"></a>3.2 Image Retrieval Model å›¾åƒæ£€ç´¢æ¨¡å‹</h3><p>å›¾åƒæœç´¢è¿‡ç¨‹ï¼šåœ¨<code>æŸ¥è¯¢</code>å’Œ<code>ç›®æ ‡å›¾åƒ</code>å…±äº«çš„è§†è§‰åµŒå…¥ç©ºé—´ä¸­ï¼Œæœç´¢åŒ¹é…é¡¹ã€‚</p><ul><li>æ‰€æœ‰çš„ç›®æ ‡å›¾åƒå…ˆç»è¿‡å›¾åƒåµŒå…¥æ¨¡å—è¿›è¡Œç¼–ç ï¼Œç”±ä¸€ä¸ª$d$ç»´çš„ç‰¹å¾å‘é‡$f\in \mathbb R^d$è¡¨ç¤ºã€‚</li><li>å›¾åƒæ£€ç´¢æ¨¡å—Få°†å¯¹è¯å†å²$D_i$æ˜ å°„åˆ°è§†è§‰åµŒå…¥ç©ºé—´ï¼Œ$F: D_i \rightarrow \mathbb R^d$ï¼Œ</li><li>å€™é€‰å¯¹è±¡æ ¹æ®ç›¸ä¼¼åº¦è¿›è¡Œæ’åºã€‚</li></ul><p>å¼•å…¥åˆ†éš”ç¬¦[SEP]å’Œæ·»åŠ ç¬¦[CLS]ï¼Œè¡¨ç¤ºæ•´ä¸ªå¯¹è¯åºåˆ—ï¼ŒæŠ•å°„åˆ°è§†è§‰åµŒå…¥ç©ºé—´ã€‚</p><p>Fé‡‡ç”¨ï¼ˆä½¿ç”¨BLIPï¼‰é¢„è®­ç»ƒçš„å›¾åƒ/æ–‡æœ¬ç¼–ç å™¨ï¼Œå¹¶é€šè¿‡å¯¹æ¯”å­¦ä¹ ï¼Œå¯¹åŸºäºå¯¹è¯çš„æ£€ç´¢è¿›è¡Œå¾®è°ƒã€‚</p><p>é€šè¿‡æå–VisDialæ•°æ®é›†ä¸­çš„å›¾åƒå’Œç›¸åº”å¯¹è¯ï¼Œæ‰‹åŠ¨æ ‡æ³¨ï¼Œè®­ç»ƒFã€‚</p><h2 id="4-Evaluation"><a href="#4-Evaluation" class="headerlink" title="4. Evaluation"></a>4. Evaluation</h2><p>åœ¨è¯„ä¼°ç¯èŠ‚ï¼ŒåŸæ–‡ä½¿ç”¨äº†Hit@10æŒ‡æ ‡ï¼Œå³ç›®æ ‡å›¾åƒåœ¨å‰10ä¸ªæ£€ç´¢ç»“æœä¸­çš„è¯•éªŒå æ¯”ã€‚</p><p>åŸæ–‡ä»ä¸‰ä¸ªæ–¹é¢è¿›è¡Œäº†å¯¹æ¯”ï¼š</p><ol><li>ä¸ç°æœ‰æ–‡æœ¬åˆ°å›¾åƒï¼ˆText to Image,TTIï¼‰æ£€ç´¢æ–¹æ³•çš„æ¯”è¾ƒ<ol><li>ChatIRä½¿ç”¨ChatGPTä½œä¸ºæé—®è€…Gï¼ŒBLIP2ä½œä¸ºå›ç­”è€…A</li><li>ä¸Zero-shotçš„BLIPã€CLIPä»¥åŠfine-tuned SoTA TTI BLIPè¿›è¡Œæ¯”è¾ƒ</li><li>ç»“è®ºï¼šChatIRåœ¨å¤šè½®å¯¹è¯ç¯å¢ƒä¸­ï¼Œç›¸æ¯”ä¼ ç»Ÿå•è·³ TTI æ–¹æ³•è¡¨ç°æ›´ä¼˜</li></ol></li><li>ä¸åŒæé—®è€…Gçš„æ¯”è¾ƒ<ol><li>ä½¿ç”¨ChatGPTã€FLAN-ALPACA-XXLã€äººç±»ç­‰8ä¸­ä¸åŒæé—®è€…</li><li>ChatGPTè¡¨ç°æœ€å¥½</li></ol></li><li>äººç±»å‚ä¸å¯¹è¯çš„å½±å“<ol><li>ChatGPTæé—®ï¼Œäººç±»å›ç­”ï¼›ChatGPTæé—®ï¼ŒBLIP2å›ç­”ï¼›äººç±»æé—®ï¼Œäººç±»å›ç­”</li><li>ç”±äºäººç±»ç”Ÿæˆçš„ç­”æ¡ˆè´¨é‡æ˜æ˜¾ä¼˜äºBLIP2ï¼Œå› æ­¤äººç±»å‚ä¸å¯¹è¯æ—¶ï¼Œæ£€ç´¢æ€§èƒ½ä¼šæ¯”æµ‹è¯•çš„æ•°æ®æ›´å¥½</li></ol></li></ol><h2 id="æ€»ç»“å’Œå®ç°"><a href="#æ€»ç»“å’Œå®ç°" class="headerlink" title="æ€»ç»“å’Œå®ç°"></a>æ€»ç»“å’Œå®ç°</h2><ul><li>ChatIRç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºå¯¹è¯çš„å›¾åƒæ£€ç´¢ç³»ç»Ÿï¼ŒåŒ…å«å¯¹è¯æ„å»ºå’Œå›¾åƒæœç´¢ä¸¤ä¸ªéƒ¨åˆ†</li><li>å¯¹è¯æ„å»ºï¼šä½¿ç”¨é—®é¢˜ç”Ÿæˆå™¨Gï¼Œè€ƒè™‘å½“å‰å¯¹è¯å†å²ï¼Œç”Ÿæˆä¸‹ä¸€ä¸ªé—®é¢˜<ul><li>åŸæ–‡æµ‹è¯•äº†ä¸åŒçš„é—®é¢˜ç”Ÿæˆå™¨ï¼Œå…¶ä¸­ChatGPTè¡¨ç°æœ€å¥½</li></ul></li><li>å›¾åƒæœç´¢ï¼šä½¿ç”¨æ¨¡å‹Fï¼Œå°†ä¸åŒé•¿åº¦çš„å¯¹è¯åºåˆ—æ˜ å°„åˆ°è§†è§‰åµŒå…¥ç©ºé—´<ul><li>æˆ‘ä½¿ç”¨äº†è®ºæ–‡ä»“åº“æä¾›çš„é¢„è®­ç»ƒBLIP_ITMæ¨¡å‹</li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset, DataLoader</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"><span class="keyword">from</span> torchvision.transforms.functional <span class="keyword">import</span> InterpolationMode</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os.path</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> multiprocessing <span class="comment"># å¤šè¿›ç¨‹å¤„ç†</span></span><br><span class="line">multiprocessing.set_start_method(<span class="string">&#x27;spawn&#x27;</span>, force=<span class="literal">True</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> OpenAI <span class="keyword">import</span> request_chat <span class="comment"># è‡ªå·±å®ç°çš„è°ƒç”¨APIå‡½æ•° request_chat(dialog:list) -&gt; new_question:str</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys <span class="comment"># æ·»åŠ importè·¯å¾„</span></span><br><span class="line">sys.path.insert(<span class="number">0</span>, <span class="string">&#x27;./BLIP&#x27;</span>)</span><br><span class="line"><span class="keyword">from</span> BLIP.models.blip_itm <span class="keyword">import</span> blip_itm <span class="comment"># BLIPç”¨äºå›¾åƒæ–‡æœ¬åŒ¹é…çš„é¢„è®­ç»ƒæ¨¡å‹</span></span><br><span class="line"></span><br><span class="line">config = &#123;</span><br><span class="line">    <span class="string">&quot;corpus_path&quot;</span>: <span class="string">&quot;VisualDial/search_space.json&quot;</span>, <span class="comment"># å›¾åƒåº“è·¯å¾„</span></span><br><span class="line">    <span class="string">&quot;queries_path&quot;</span>: <span class="string">&quot;dialogues/ChatGPT4oMini_BLIP2.json&quot;</span>, <span class="comment"># æµ‹è¯•å¯¹è¯æ•°æ®è·¯å¾„</span></span><br><span class="line">    <span class="string">&quot;corpus_cache&quot;</span>: <span class="string">&quot;VisualDial/corpus_cache.pth&quot;</span>, <span class="comment"># å¤„ç†å¥½çš„å›¾åƒåº“ç¼“å­˜çš„è·¯å¾„</span></span><br><span class="line">    <span class="string">&quot;device&quot;</span>: <span class="string">&quot;cuda&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sep&quot;</span>: <span class="string">&quot;, &quot;</span>, <span class="comment"># å¯¹è¯åˆ†éš”ç¬¦</span></span><br><span class="line">    <span class="string">&quot;batch_size&quot;</span>: <span class="number">100</span>, <span class="comment"># æ‰¹å¤„ç†å¤§å°</span></span><br><span class="line">    <span class="string">&quot;num_workers&quot;</span>: <span class="number">8</span>, <span class="comment"># å¤šè¿›ç¨‹å¤„ç†æ•°</span></span><br><span class="line">    <span class="string">&quot;image_size&quot;</span> : <span class="number">224</span> <span class="comment"># å›¾åƒå¤§å°</span></span><br><span class="line">&#125;</span><br><span class="line">corpus = <span class="literal">None</span> <span class="comment"># å¤„ç†å¥½çš„å›¾åƒåº“ </span></span><br><span class="line">dialog = [] <span class="comment"># å¯¹è¯</span></span><br><span class="line">images = [] <span class="comment"># å›¾åƒåº“è·¯å¾„ list[å›¾åƒè·¯å¾„]</span></span><br></pre></td></tr></table></figure><h3 id="å›¾åƒæ•°æ®é›†ç±»"><a href="#å›¾åƒæ•°æ®é›†ç±»" class="headerlink" title="å›¾åƒæ•°æ®é›†ç±»"></a>å›¾åƒæ•°æ®é›†ç±»</h3><p>ç»§æ‰¿è‡ªDatasetï¼Œç”¨äºåŠ è½½å›¾åƒæ•°æ®é›†</p><p>corpus_pathï¼šå›¾åƒæ•°æ®é›†.jsonï¼ŒåŒ…å«ä¸€ä¸ªlist[str]ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå›¾åƒçš„è·¯å¾„</p><p>å»ºç«‹è·¯å¾„å­—ç¬¦ä¸²åˆ°ç´¢å¼•çš„æ˜ å°„ï¼Œä¾¿äºèµ‹å€¼ä¼ é€’å’ŒæŸ¥è¯¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Corpus</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å›¾åƒæ•°æ®é›†&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, corpus_path, preprocessor</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;åŠ è½½å›¾åƒæ•°æ®é›†</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            corpus_path: å›¾ç‰‡è·¯å¾„åˆ—è¡¨</span></span><br><span class="line"><span class="string">            preprocessor: å›¾åƒé¢„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(corpus_path, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            self.corpus = json.load(f)</span><br><span class="line">            f.close()</span><br><span class="line">        self.preprocessor = preprocessor</span><br><span class="line">        <span class="comment"># å›¾ç‰‡è·¯å¾„åˆ°ç´¢å¼•çš„æ˜ å°„ï¼Œç”¨äºå¿«é€ŸæŸ¥æ‰¾</span></span><br><span class="line">        self.path2idx = &#123;self.corpus[i]:i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(self.corpus))&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.corpus)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, idx</span>):</span><br><span class="line">        image = self.preprocessor(self.corpus[idx])</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;idx&quot;</span>: idx, <span class="string">&quot;image&quot;</span>: image&#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">path_to_index</span>(<span class="params">self, path</span>):</span><br><span class="line">        <span class="keyword">return</span> self.path2idx[path]</span><br></pre></td></tr></table></figure><h3 id="å›¾åƒé¢„å¤„ç†å‡½æ•°"><a href="#å›¾åƒé¢„å¤„ç†å‡½æ•°" class="headerlink" title="å›¾åƒé¢„å¤„ç†å‡½æ•°"></a>å›¾åƒé¢„å¤„ç†å‡½æ•°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">image_preprocessor</span>(<span class="params">image_path</span>):</span><br><span class="line">    transform_prep = transforms.Compose([ </span><br><span class="line">        transforms.Resize((config[<span class="string">&quot;image_size&quot;</span>], config[<span class="string">&quot;image_size&quot;</span>]), </span><br><span class="line">                          interpolation=InterpolationMode.BICUBIC),</span><br><span class="line">        transforms.ToTensor(),</span><br><span class="line">        transforms.Normalize((<span class="number">0.48145466</span>, <span class="number">0.4578275</span>, <span class="number">0.40821073</span>), </span><br><span class="line">                             (<span class="number">0.26862954</span>, <span class="number">0.26130258</span>, <span class="number">0.27577711</span>)) <span class="comment"># å‚æ•°å‚è€ƒBLIPçš„demo</span></span><br><span class="line">    ])</span><br><span class="line">    raw = Image.<span class="built_in">open</span>(image_path).convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line">    img = transform_prep(raw)</span><br><span class="line">    <span class="keyword">return</span> img</span><br></pre></td></tr></table></figure><h3 id="BLIP-ITMæ¨¡å‹çš„å›¾åƒç¼–ç å™¨å’Œå¯¹è¯ç¼–ç å™¨"><a href="#BLIP-ITMæ¨¡å‹çš„å›¾åƒç¼–ç å™¨å’Œå¯¹è¯ç¼–ç å™¨" class="headerlink" title="BLIP_ITMæ¨¡å‹çš„å›¾åƒç¼–ç å™¨å’Œå¯¹è¯ç¼–ç å™¨"></a>BLIP_ITMæ¨¡å‹çš„å›¾åƒç¼–ç å™¨å’Œå¯¹è¯ç¼–ç å™¨</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_funcs</span>():</span><br><span class="line">    <span class="comment"># model_url = &#x27;https://storage.googleapis.com/sfr-vision-language-research/BLIP/models/model_base_retrieval_coco.pth&#x27;</span></span><br><span class="line">    model = blip_itm(pretrained=<span class="string">&#x27;chatir_weights.ckpt&#x27;</span>, <span class="comment"># è®ºæ–‡ä»“åº“ä¸­çš„é¢„è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">                    med_config=<span class="string">&quot;BLIP/configs/med_config.json&quot;</span>, </span><br><span class="line">                    image_size=config[<span class="string">&quot;image_size&quot;</span>],</span><br><span class="line">                    vit=<span class="string">&quot;base&quot;</span>)</span><br><span class="line">    device = config[<span class="string">&quot;device&quot;</span>]</span><br><span class="line">    model = model.to(device).<span class="built_in">eval</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">image_encoder</span>(<span class="params">img</span>):</span><br><span class="line">        embeddings = model.visual_encoder(img) <span class="comment"># embedding</span></span><br><span class="line">        <span class="comment"># print(embeddings.shape) # (æ‰¹æ¬¡å¤§å°, patchä¸ªæ•°+1, éšå±‚ç»´åº¦)</span></span><br><span class="line">        vision_proj = model.vision_proj(embeddings[:, <span class="number">0</span>, :]) <span class="comment"># å–[CLS] tokenï¼Œæå–å…¨å±€ç‰¹å¾</span></span><br><span class="line">        <span class="keyword">return</span> F.normalize(vision_proj, dim=-<span class="number">1</span>) <span class="comment"># æ­£åˆ™åŒ–</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dialog_encoder</span>(<span class="params">dialog</span>):</span><br><span class="line">        text = model.tokenizer(dialog, padding=<span class="string">&#x27;longest&#x27;</span>, truncation=<span class="literal">True</span>, max_length=<span class="number">200</span>, <span class="comment"># å¡«å……åˆ°æœ€é•¿ï¼Œæˆªæ–­åˆ°200</span></span><br><span class="line">                            return_tensors=<span class="string">&quot;pt&quot;</span>).to(device)  <span class="comment"># è¿”å›PyTorchå¼ é‡</span></span><br><span class="line">        text_out = model.text_encoder(text.input_ids, attention_mask=text.attention_mask, </span><br><span class="line">                                    return_dict=<span class="literal">True</span>, mode=<span class="string">&#x27;text&#x27;</span>) <span class="comment"># embedding</span></span><br><span class="line">        shift = model.text_proj(text_out.last_hidden_state[:, <span class="number">0</span>, :]) <span class="comment"># åŒ</span></span><br><span class="line">        <span class="keyword">return</span> F.normalize(shift, dim=-<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> image_encoder, dialog_encoder</span><br></pre></td></tr></table></figure><h3 id="å¤„ç†å›¾åƒåº“"><a href="#å¤„ç†å›¾åƒåº“" class="headerlink" title="å¤„ç†å›¾åƒåº“"></a>å¤„ç†å›¾åƒåº“</h3><p>ç”±äºåŠ è½½æ—¶é—´é•¿ï¼Œä¸€æ¬¡åŠ è½½åå°†æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ï¼Œä¾¿äºäºŒæ¬¡è°ƒç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">corpus_dataset = Corpus(config[<span class="string">&quot;corpus_path&quot;</span>], image_preprocessor)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prepare_corpus</span>(<span class="params">image_encoder</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å¤„ç†å›¾åƒåº“</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        corpus: tuple[torch.Tensor, torch.Tensor] å›¾åƒåº“ç´¢å¼•å’Œå¯¹åº”çš„å›¾åƒç‰¹å¾å‘é‡</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">global</span> corpus</span><br><span class="line">    corpus_cache = config[<span class="string">&quot;corpus_cache&quot;</span>]</span><br><span class="line">    <span class="keyword">if</span> corpus_cache <span class="keyword">and</span> os.path.exists(corpus_cache): <span class="comment"># è¯»å–ç¼“å­˜</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;-----Loading corpus from <span class="subst">&#123;corpus_cache&#125;</span>-----&quot;</span>)</span><br><span class="line">        corpus = torch.load(corpus_cache)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-----Preparing corpus-----&quot;</span>)</span><br><span class="line">    corpus_dataloader = DataLoader( <span class="comment"># å›¾åƒåº“çš„DataLoader</span></span><br><span class="line">        corpus_dataset,</span><br><span class="line">        batch_size=config[<span class="string">&quot;batch_size&quot;</span>],</span><br><span class="line">        shuffle=<span class="literal">False</span>,</span><br><span class="line">        num_workers=config[<span class="string">&quot;num_workers&quot;</span>],</span><br><span class="line">        pin_memory=<span class="literal">True</span>,</span><br><span class="line">        drop_last=<span class="literal">False</span></span><br><span class="line">    )</span><br><span class="line">    corpus_vectors = []</span><br><span class="line">    corpus_ids = []</span><br><span class="line">    <span class="keyword">for</span> batch <span class="keyword">in</span> tqdm(corpus_dataloader): <span class="comment"># é¢„å¤„ç†å›¾åƒåº“</span></span><br><span class="line">        batch_vectors = F.normalize(image_encoder(batch[<span class="string">&quot;image&quot;</span>].to(config[<span class="string">&quot;device&quot;</span>])), dim=-<span class="number">1</span>) <span class="comment"># æ­£åˆ™åŒ–</span></span><br><span class="line">        corpus_vectors.append(batch_vectors)</span><br><span class="line">        corpus_ids.append(batch[<span class="string">&quot;idx&quot;</span>].to(config[<span class="string">&quot;device&quot;</span>]))</span><br><span class="line"></span><br><span class="line">    corpus_vectors = torch.cat(corpus_vectors)</span><br><span class="line">    corpus_ids = torch.cat(corpus_ids)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æŒ‰ç…§ç´¢å¼•æ’åº</span></span><br><span class="line">    arg_ids = torch.argsort(corpus_ids)</span><br><span class="line">    corpus_vectors = corpus_vectors[arg_ids]</span><br><span class="line">    corpus_ids = corpus_ids[arg_ids]</span><br><span class="line"></span><br><span class="line">    corpus = corpus_ids, corpus_vectors</span><br><span class="line">    <span class="keyword">if</span> config[<span class="string">&quot;corpus_cache&quot;</span>]:</span><br><span class="line">        torch.save(corpus, config[<span class="string">&quot;corpus_cache&quot;</span>]) </span><br></pre></td></tr></table></figure><h3 id="æé—®ä¸åŒ¹é…å‡½æ•°"><a href="#æé—®ä¸åŒ¹é…å‡½æ•°" class="headerlink" title="æé—®ä¸åŒ¹é…å‡½æ•°"></a>æé—®ä¸åŒ¹é…å‡½æ•°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ask_for_caption</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è¯¢é—®ç”¨æˆ·æè¿°&quot;&quot;&quot;</span></span><br><span class="line">    caption = <span class="built_in">input</span>(<span class="string">&quot;Describe the image: &quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> caption</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ask_question</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è¯¢é—®ç”¨æˆ·é—®é¢˜ï¼Œè·å–å›ç­”&quot;&quot;&quot;</span></span><br><span class="line">    question = request_chat(dialog)</span><br><span class="line">    answer = <span class="built_in">input</span>(<span class="string">f&quot;Q: <span class="subst">&#123;question&#125;</span>\nA: &quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> question+<span class="string">&#x27; &#x27;</span>+answer</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_top_results</span>(<span class="params">dialog, dialog_encoder, n=<span class="number">1</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è·å–å‰næœ€ä½³åŒ¹é…ç»“æœ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        dialog: str å¯¹è¯</span></span><br><span class="line"><span class="string">        dialog_encoder: å¯¹è¯ç¼–ç å™¨</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        tops: list[int] å‰nä¸ªåŒ¹é…ç»“æœçš„ç´¢å¼•</span></span><br><span class="line"><span class="string">        topscores: list[float] å‰nä¸ªåŒ¹é…ç»“æœçš„å¾—åˆ†</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    dialog = config[<span class="string">&quot;sep&quot;</span>].join(dialog)</span><br><span class="line">    dialog_vector = dialog_encoder(dialog) <span class="comment"># æå–ç‰¹å¾&amp;æ­£åˆ™åŒ–</span></span><br><span class="line">    scores = dialog_vector @ corpus[<span class="number">1</span>].T <span class="comment"># è®¡ç®—ç‚¹ç§¯ç›¸ä¼¼åº¦</span></span><br><span class="line">    top_id = torch.argsort(scores, descending=<span class="literal">True</span>) <span class="comment"># æ’åº</span></span><br><span class="line">    tops = top_id.tolist()[<span class="number">0</span>][:n]</span><br><span class="line">    topscores = scores[<span class="number">0</span>][tops].tolist()</span><br><span class="line">    <span class="keyword">return</span> tops, topscores</span><br></pre></td></tr></table></figure><h3 id="ä¸»å‡½æ•°"><a href="#ä¸»å‡½æ•°" class="headerlink" title="ä¸»å‡½æ•°"></a>ä¸»å‡½æ•°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    image_encoder, dialog_encoder = get_funcs()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(config[<span class="string">&quot;corpus_path&quot;</span>], <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        images = json.load(f)</span><br><span class="line">        f.close()</span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        prepare_corpus(image_encoder)</span><br><span class="line">    </span><br><span class="line">        dialog.append(ask_for_caption())</span><br><span class="line">        tops,topscores = get_top_results(dialog, dialog_encoder)</span><br><span class="line">        best_image = images[tops[<span class="number">0</span>]]</span><br><span class="line">        best_score = topscores[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Best image: <span class="subst">&#123;best_image&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Best score: <span class="subst">&#123;best_score&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># display(Image.open(best_image))</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            dialog.append(ask_question())</span><br><span class="line">            tops,topscores = get_top_results(dialog, dialog_encoder)</span><br><span class="line">            best_image = images[tops[<span class="number">0</span>]]</span><br><span class="line">            best_score = topscores[<span class="number">0</span>]</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Best image: <span class="subst">&#123;best_image&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Best score: <span class="subst">&#123;best_score&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> i==<span class="number">1</span>:</span><br><span class="line">                display(Image.<span class="built_in">open</span>(best_image))</span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•å’Œè¯„ä¼°"><a href="#æµ‹è¯•å’Œè¯„ä¼°" class="headerlink" title="æµ‹è¯•å’Œè¯„ä¼°"></a>æµ‹è¯•å’Œè¯„ä¼°</h2><p>åŸæ–‡è¯„ä¼°ChatIRæ€§èƒ½çš„æŒ‡æ ‡æ˜¯Hit@10ï¼Œå³ç›®æ ‡å›¾åƒå‡ºç°åœ¨æœ€åŒ¹é…çš„10ä¸ªå€™é€‰å›¾åƒä¸­çš„æ¦‚ç‡ï¼Œæˆ‘é‡‡ç”¨ç›¸åŒçš„è¯„ä¼°æ–¹å¼</p><h3 id="å¯¹è¯æ•°æ®é›†ç±»"><a href="#å¯¹è¯æ•°æ®é›†ç±»" class="headerlink" title="å¯¹è¯æ•°æ®é›†ç±»"></a>å¯¹è¯æ•°æ®é›†ç±»</h3><p>å•ä¸ªæµ‹è¯•å¯¹è¯æ•°æ®ç»“æ„ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;image&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image_path&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dialog&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;caption&quot;</span><span class="punctuation">,</span> <span class="string">&quot;question1? answer1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;question2? answer2&quot;</span><span class="punctuation">,</span> ...<span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Queries</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å¯¹è¯-å›¾åƒæ•°æ®é›†&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, queries_path, sep</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;åŠ è½½å¯¹è¯-å›¾åƒæ•°æ®é›†</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            queries_path: str æŸ¥è¯¢æ•°æ®é›†è·¯å¾„</span></span><br><span class="line"><span class="string">            sep: str åˆ†éš”ç¬¦</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(queries_path, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            self.queries = json.load(f)</span><br><span class="line">            f.close()</span><br><span class="line">        self.dialog_length = <span class="literal">None</span></span><br><span class="line">        self.sep = sep</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.queries)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, idx</span>):</span><br><span class="line">        <span class="keyword">assert</span> self.dialog_length <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span></span><br><span class="line">        target_path = self.queries[idx][<span class="string">&quot;img&quot;</span>]</span><br><span class="line">        <span class="comment"># ä¿ç•™å¯¹è¯çš„å‰dialog_lengthè½®</span></span><br><span class="line">        text = self.sep.join(self.queries[idx][<span class="string">&quot;dialog&quot;</span>][:self.dialog_length + <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;text&quot;</span>: text, <span class="string">&quot;target_path&quot;</span>: target_path&#125;</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•ä»£ç "><a href="#æµ‹è¯•ä»£ç " class="headerlink" title="æµ‹è¯•ä»£ç "></a>æµ‹è¯•ä»£ç </h3><p>ä½¿ç”¨äº†è®ºæ–‡ä»“åº“æä¾›çš„æµ‹è¯•ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">corpus_dataset = Corpus(config[<span class="string">&quot;corpus_path&quot;</span>], image_preprocessor)</span><br><span class="line">query_dataset = Queries(config[<span class="string">&quot;queries_path&quot;</span>], config[<span class="string">&quot;sep&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_get_recalls</span>(<span class="params">dataloader, dialog_length, dialog_encoder</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; è®¡ç®—dataloaderä¸­é•¿åº¦ä¸ºdialog_lengthçš„å¯¹è¯çš„å¬å›ç»“æœ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        dataloader: æ•°æ®åŠ è½½å™¨</span></span><br><span class="line"><span class="string">        dialog_length: å¯¹è¯é•¿åº¦</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    dataloader.dataset.dialog_length = dialog_length  <span class="comment"># è®¾ç½®å¯¹è¯é•¿åº¦</span></span><br><span class="line">    recalls = []  <span class="comment"># æ¯ä¸ªå¯¹è¯çš„å¬å›ç»“æœ</span></span><br><span class="line">    <span class="keyword">for</span> batch <span class="keyword">in</span> tqdm(dataloader):</span><br><span class="line">        target_ids = torch.tensor(</span><br><span class="line">            [corpus_dataset.path_to_index(p) <span class="keyword">for</span> p <span class="keyword">in</span> batch[<span class="string">&#x27;target_path&#x27;</span>]]</span><br><span class="line">            ).unsqueeze(<span class="number">1</span>).to(config[<span class="string">&#x27;device&#x27;</span>]) <span class="comment"># å›¾ç‰‡è·¯å¾„è½¬æ¢ä¸ºç´¢å¼•</span></span><br><span class="line">        pred_vec = F.normalize(dialog_encoder(batch[<span class="string">&#x27;text&#x27;</span>]), dim=-<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        scores = pred_vec @ corpus[<span class="number">1</span>].T <span class="comment"># è®¡ç®—ç‚¹ç§¯ï¼Œå¾—åˆ°ç›¸ä¼¼åº¦åˆ†æ•°</span></span><br><span class="line">        arg_ranks = torch.argsort(scores, descending=<span class="literal">True</span>, dim=<span class="number">1</span>).long() <span class="comment"># å¯¹åˆ†æ•°è¿›è¡Œæ’åº</span></span><br><span class="line">        </span><br><span class="line">        target_recall = ((arg_ranks - target_ids) == <span class="number">0</span>).nonzero()[:, <span class="number">1</span>] <span class="comment"># ç›®æ ‡å›¾åƒåœ¨æ£€ç´¢æ’åä¸­å‡ºç°çš„ä½ç½®</span></span><br><span class="line">        recalls.append(target_recall)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> torch.cat(recalls)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_first_hitting_time</span>(<span class="params">target_recall, hitting_recall=<span class="number">10</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; è¿”å›(11, n)å¼ é‡ï¼Œå…¶ä¸­åŒ…å«æ¯è½®ï¼ˆ0, 11ï¼‰çš„å‘½ä¸­æ—¶é—´ã€‚infè¡¨ç¤ºæœªå‘½ä¸­ï¼ˆ10è½®åæ²¡æœ‰å‘½ä¸­ï¼‰ &quot;&quot;&quot;</span></span><br><span class="line">    target_recalls = target_recall.view(<span class="number">11</span>, -<span class="number">1</span>).T <span class="comment"># è½¬ç½®</span></span><br><span class="line">    hits = (target_recalls &lt; hitting_recall) <span class="comment"># ç›®æ ‡å›¾åƒæ˜¯å¦åœ¨å‰ hitting_recall è½®å†…å‡ºç°</span></span><br><span class="line"></span><br><span class="line">    final_hits = torch.inf * torch.ones(target_recalls.shape[<span class="number">0</span>]) <span class="comment"># åˆå§‹åŒ–ä¸ºinf</span></span><br><span class="line"></span><br><span class="line">    hitting_times = [] <span class="comment"># æ¯è½®çš„å‘½ä¸­æ—¶é—´</span></span><br><span class="line">    <span class="keyword">for</span> ro_i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">        rh = hits[:, ro_i]</span><br><span class="line">        final_hits[rh] = torch.<span class="built_in">min</span>(final_hits[rh], torch.ones(final_hits[rh].shape) * ro_i)</span><br><span class="line">        hitting_times.append(final_hits.clone())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> torch.stack(hitting_times)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cumulative_hits_per_round</span>(<span class="params">target_recall, hitting_recall=<span class="number">10</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; è¿”å›ç›´åˆ°ç¬¬xè½®çš„å¹³å‡å‘½ä¸­æ¬¡æ•° &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(hitting_recall) <span class="keyword">is</span> <span class="built_in">tuple</span>:</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(hitting_recall) == <span class="number">1</span></span><br><span class="line">        hitting_recall = hitting_recall[<span class="number">0</span>]</span><br><span class="line">    ht_times = get_first_hitting_time(target_recall, hitting_recall)</span><br><span class="line">    <span class="keyword">return</span> ((ht_times &lt; torch.inf).<span class="built_in">sum</span>(dim=-<span class="number">1</span>) * <span class="number">100</span> / ht_times[<span class="number">0</span>].shape[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">eval</span>(<span class="params">image_encoder, dialog_encoder, hits_at=<span class="number">10</span></span>):</span><br><span class="line">    prepare_corpus(image_encoder)</span><br><span class="line">    query_dataloader = torch.utils.data.DataLoader(query_dataset, <span class="comment"># è¯¢é—®æ•°æ®é›†</span></span><br><span class="line">                                             batch_size=config[<span class="string">&#x27;batch_size&#x27;</span>], <span class="comment"># æ‰¹å¤§å°</span></span><br><span class="line">                                             shuffle=<span class="literal">False</span>, <span class="comment"># ä¸æ‰“ä¹±</span></span><br><span class="line">                                             num_workers=config[<span class="string">&#x27;num_workers&#x27;</span>], <span class="comment"># å¤šçº¿ç¨‹</span></span><br><span class="line">                                             pin_memory=<span class="literal">True</span>, <span class="comment"># é”é¡µå†…å­˜</span></span><br><span class="line">                                             drop_last=<span class="literal">False</span></span><br><span class="line">                                             )</span><br><span class="line">    hits_results = []</span><br><span class="line">    <span class="keyword">for</span> dl <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>): <span class="comment"># å¯¹è¯é•¿åº¦ä»0åˆ°10</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Calculate recalls for each dialogues of length <span class="subst">&#123;dl&#125;</span>...&quot;</span>)</span><br><span class="line">        dialog_recalls = _get_recalls(query_dataloader, dialog_length=dl, dialog_encoder=dialog_encoder)</span><br><span class="line">        hits_results.append(dialog_recalls)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä½¿ç”¨cumulative_hits_per_roundè®¡ç®—æœ€ç»ˆçš„Hits@10ç»“æœ</span></span><br><span class="line">    <span class="comment"># Hits@10ï¼š`åœ¨é¢„æµ‹çš„å‰ 10 ä¸ªå€™é€‰é¡¹ä¸­ï¼ŒåŒ…å«äº†æ­£ç¡®ç­”æ¡ˆ`çš„æ¯”ä¾‹</span></span><br><span class="line">    hits_results = cumulative_hits_per_round(torch.cat(hits_results).cpu(), hitting_recall=<span class="number">10</span>).tolist()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;====== Results for Hits@10 ====== &quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> dl <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\t Dialog Length: <span class="subst">&#123;dl&#125;</span>: <span class="subst">&#123;<span class="built_in">round</span>(hits_results[dl], <span class="number">2</span>)&#125;</span>%&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    image_encoder, dialog_encoder = get_funcs()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(config[<span class="string">&quot;corpus_path&quot;</span>], <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        images = json.load(f)</span><br><span class="line">        f.close()</span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        <span class="built_in">eval</span>(image_encoder, dialog_encoder)</span><br></pre></td></tr></table></figure><h3 id="å¯¹è¯æ•°æ®ç”Ÿæˆ"><a href="#å¯¹è¯æ•°æ®ç”Ÿæˆ" class="headerlink" title="å¯¹è¯æ•°æ®ç”Ÿæˆ"></a>å¯¹è¯æ•°æ®ç”Ÿæˆ</h3><p>åŸæ–‡ä¸­ï¼Œä¸ºäº†è‡ªåŠ¨è·å–æµ‹è¯•æ•°æ®ï¼Œå…é™¤äººå·¥å›ç­”ï¼Œä½¿ç”¨äº†BLIP2æ¨¡å‹å›ç­”é—®é¢˜</p><p>æˆ‘å‚è€ƒåŸæ–‡çš„æ–¹æ³•ï¼Œä½¿ç”¨BLIP2ç”Ÿæˆå¯¹è¯æ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lavis.models <span class="keyword">import</span> load_model_and_preprocess <span class="comment"># BLIP2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> OpenAI <span class="keyword">import</span> request_chat</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">st,ed = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>]), <span class="built_in">int</span>(sys.argv[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;../dialogues/ChatGPT_BLIP2.json&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = json.load(f)</span><br><span class="line">    f.close()</span><br><span class="line"></span><br><span class="line">images = [d[<span class="string">&quot;img&quot;</span>] <span class="keyword">for</span> d <span class="keyword">in</span> data][st:ed]</span><br><span class="line">captions = [d[<span class="string">&quot;dialog&quot;</span>][<span class="number">0</span>] <span class="keyword">for</span> d <span class="keyword">in</span> data][st:ed]</span><br><span class="line"></span><br><span class="line">config = &#123;</span><br><span class="line">    <span class="string">&quot;device&quot;</span>: <span class="string">&quot;cuda&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>,</span><br><span class="line">    <span class="string">&quot;image_size&quot;</span> : <span class="number">224</span>,</span><br><span class="line">    <span class="string">&quot;sep&quot;</span>: <span class="string">&quot;, &quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> config[<span class="string">&quot;device&quot;</span>] == <span class="string">&quot;cuda&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Using GPU&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_image</span>(<span class="params">image_path</span>):</span><br><span class="line">    raw_image = Image.<span class="built_in">open</span>(image_path).convert(<span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line">    image = vis_processors[<span class="string">&quot;eval&quot;</span>](raw_image).unsqueeze(<span class="number">0</span>).to(config[<span class="string">&quot;device&quot;</span>])</span><br><span class="line">    <span class="keyword">return</span> image</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">visual_qa</span>(<span class="params">image, question, model</span>):</span><br><span class="line">    answer = model.generate(&#123;<span class="string">&quot;image&quot;</span>: image, <span class="string">&quot;prompt&quot;</span>: <span class="string">f&quot;Question: <span class="subst">&#123;question&#125;</span> Answer:&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">return</span> answer[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ask_question</span>(<span class="params">dialog</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è¯¢é—®ç”¨æˆ·é—®é¢˜&quot;&quot;&quot;</span></span><br><span class="line">    question = request_chat(dialog)</span><br><span class="line">    <span class="keyword">return</span> question</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_dialog</span>(<span class="params">idx, model</span>):</span><br><span class="line">    image = load_image(images[idx])</span><br><span class="line">    caption = captions[idx]</span><br><span class="line">    dialog = [caption]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        question = ask_question(dialog)</span><br><span class="line">        answer = visual_qa(image, question, model)</span><br><span class="line">        dialog.append(question+answer)</span><br><span class="line">    ret = &#123;</span><br><span class="line">        <span class="string">&quot;img&quot;</span>: images[idx],</span><br><span class="line">        <span class="string">&quot;dialog&quot;</span>: dialog</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    model, vis_processors, _ = load_model_and_preprocess(</span><br><span class="line">        name=<span class="string">&quot;blip2_opt&quot;</span>, model_type=<span class="string">&quot;caption_coco_opt6.7b&quot;</span>, is_eval=<span class="literal">True</span>, device=config[<span class="string">&quot;device&quot;</span>]</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;ChatGPT4oMini_BLIP2.txt&quot;</span>, <span class="string">&quot;a&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> idx <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="built_in">len</span>(images))):</span><br><span class="line">                dialog = generate_dialog(idx, model)</span><br><span class="line">                json.dump(dialog, f)</span><br><span class="line">                f.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">            f.close()</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•æ—¥å¿—"><a href="#æµ‹è¯•æ—¥å¿—" class="headerlink" title="æµ‹è¯•æ—¥å¿—"></a>æµ‹è¯•æ—¥å¿—</h3><ol><li>ç”±äºOpenAIçš„tokené™åˆ¶ï¼Œæˆ‘ä½¿ç”¨äº†è®¯é£æ˜Ÿç«APIä½œä¸ºæé—®æ¨¡å‹G</li><li>è®ºæ–‡æ²¡è¯»ä»”ç»†ï¼Œä¸€å¼€å§‹ä»¥ä¸ºç”Ÿæˆå¯¹è¯æ•°æ®æ—¶ï¼Œä»£æ›¿äººç±»å›ç­”çš„æ¨¡å‹å’Œç¼–ç ç”¨çš„æ¨¡å‹ä¸€æ ·ï¼Œæ˜¯BLIP</li><li>åœ¨ä»¥ä¸ŠåŸºç¡€ä¸Šï¼Œæµ‹è¯•çš„Hit@10ç»“æœï¼ˆ40%~60%ï¼‰ä¸åŸæ–‡ï¼ˆ63%~80%ï¼‰æœ‰è¾ƒå¤§å·®è·</li><li>åŸæœ¬è®¤ä¸ºæ˜¯æé—®æ¨¡å‹Gæ²¡æœ‰ç”¨ChatGPTçš„åŸå› ï¼Œå¾®æ°ªtokenï¼Œè°ƒæ•´ä¸ºChatGPT4o-miniï¼Œä½†ç»“æœä¾ç„¶ä¸ç†æƒ³ï¼ˆ40%~67%ï¼‰</li><li>æ³¨æ„åˆ°ï¼Œ40%æ˜¯$D_0$ï¼Œä¹Ÿå°±æ˜¯åªæœ‰ç”¨BLIPç”Ÿæˆçš„ç¬¬ä¸€å¥æè¿°æ—¶çš„å‡†ç¡®ç‡ï¼Œå’Œæé—®æ¨¡å‹Gæ— å…³</li><li>å¯¹æ¯”åŸæ–‡ï¼Œå‘ç°å›ç­”æ¨¡å‹åº”è¯¥æ˜¯å¦ä¸€ç¯‡paperä¸­çš„BLIP2ï¼Œè€Œä¸æ˜¯BLIP</li><li>ä¿®æ”¹æ•°æ®ç”Ÿæˆä»£ç ï¼Œä½¿ç”¨BLIP2ç”Ÿæˆå¯¹è¯æ•°æ®ï¼Œæµ‹è¯•ç»“æœä¸åŸæ–‡æ¥è¿‘ï¼ˆ60%~80%ï¼‰</li></ol><p>å®¢è§‚é—®é¢˜ï¼šç”±äºç¡¬ä»¶æ¡ä»¶æœ‰é™ï¼Œè·‘å‡ºä¸€æ¡æ•°æ®éœ€è¦3~5åˆ†é’Ÿï¼Œå› æ­¤åªæµ‹è¯•äº†1021æ¡æ•°æ®ï¼Œå¯¹äºæ•´ä½“æ€§èƒ½è¯„ä¼°å¯èƒ½ä¸å¤Ÿå‡†ç¡®</p><h3 id="æµ‹è¯•ç»“æœ"><a href="#æµ‹è¯•ç»“æœ" class="headerlink" title="æµ‹è¯•ç»“æœ"></a>æµ‹è¯•ç»“æœ</h3><p>åœ¨ä½¿ç”¨ChatGPTä½œä¸ºæé—®æ¨¡å‹Gï¼ŒBLIP2ä½œä¸ºå›ç­”æ¨¡å‹Aï¼Œä½¿ç”¨åŒä¸€æµ‹è¯•ä»£ç çš„æƒ…å†µä¸‹ï¼Œæµ‹è¯•ç»“æœå’ŒåŸæ–‡å¯¹æ¯”å¦‚ä¸‹ï¼š</p><div class="table-container"><table><thead><tr><th style="text-align:center">length</th><th style="text-align:center">åŸæ–‡(2064 testcases)</th><th style="text-align:center">å®ç°ï¼ˆ1021 testcasesï¼‰</th></tr></thead><tbody><tr><td style="text-align:center">0</td><td style="text-align:center">63.42%</td><td style="text-align:center">62.98%</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">69.43%</td><td style="text-align:center">70.62%</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">72.38%</td><td style="text-align:center">72.67%</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">74.47%</td><td style="text-align:center">74.53%</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">76.02%</td><td style="text-align:center">75.32%</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">77.47%</td><td style="text-align:center">75.42%</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">78.49%</td><td style="text-align:center">76.00%</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">79.65%</td><td style="text-align:center">76.20%</td></tr><tr><td style="text-align:center">8</td><td style="text-align:center">80.09%</td><td style="text-align:center">76.69%</td></tr><tr><td style="text-align:center">9</td><td style="text-align:center">80.43%</td><td style="text-align:center">76.98%</td></tr><tr><td style="text-align:center">10</td><td style="text-align:center">80.77%</td><td style="text-align:center">77.18%</td></tr></tbody></table></div><p>åœ¨ç¬¬äº”è½®å¯¹è¯åï¼Œå¯¹è¯é•¿åº¦å¢åŠ å¯¹æ£€ç´¢æ€§èƒ½çš„æå‡ä¸å†æ˜æ˜¾</p>]]></content>
    
    
    <summary type="html">å®ç°è®ºæ–‡ã€ŠChatting Makes Perfectï¼šChat-based Image Retrivalã€‹</summary>
    
    
    
    <category term="è®ºæ–‡ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="å›¾åƒæ£€ç´¢" scheme="https://www.cclmsy.cc/tags/%E5%9B%BE%E5%83%8F%E6%A3%80%E7%B4%A2/"/>
    
    <category term="è®ºæ–‡å®ç°" scheme="https://www.cclmsy.cc/tags/%E8%AE%BA%E6%96%87%E5%AE%9E%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>Pretrained BLIP æ¨¡å‹è°ƒç”¨</title>
    <link href="https://www.cclmsy.cc/posts/pretrained_blip.html"/>
    <id>https://www.cclmsy.cc/posts/pretrained_blip.html</id>
    <published>2025-03-02T16:00:00.000Z</published>
    <updated>2025-07-20T12:14:16.220Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/salesforce/BLIP">Github Repo</a></p><p>BLIPå…¨ç§°Bootstrapping Language-Image Pre-trainingï¼Œæ˜¯ä¸€ä¸ªå…¨æ–°çš„ ç»Ÿä¸€è§†è§‰è¯­è¨€ç†è§£ä¸ç”Ÿæˆçš„é¢„è®­ç»ƒæ¨¡å‹</p><p>å®ƒç»Ÿä¸€äº†è§†è§‰è¯­è¨€ä»»åŠ¡çš„ç†è§£ä¸ç”ŸæˆåŠŸèƒ½ï¼Œå¹¶ä¸”é€šè¿‡åµŒå…¥ Captioner å’Œ Filter å»é™¤ç½‘ç»œèµ„æºä¸­çš„æ–‡æœ¬å™ªå£°ï¼Œæé«˜äº†æ¨¡å‹åœ¨ä¸‹æ¸¸è§†è§‰è¯­è¨€ä»»åŠ¡ä¸Šçš„æ€§èƒ½</p><h2 id="Colab-Notebook-è¿è¡Œ"><a href="#Colab-Notebook-è¿è¡Œ" class="headerlink" title="Colab Notebook è¿è¡Œ"></a>Colab Notebook è¿è¡Œ</h2><p>Salesforceåœ¨Colab NoteBookä¸­æä¾›äº†Demoï¼Œå¯ä»¥åœ¨äº‘ç«¯ç›´æ¥è¿è¡Œï¼š<a href="https://colab.research.google.com/github/salesforce/BLIP/blob/main/demo.ipynb">Colab notebook</a></p><p>ç¬¬ä¸€æ­¥é…ç½®ç¯å¢ƒæ—¶å‡ºç°<code>ERROR: Failed building wheel for tokenizers</code>é—®é¢˜ï¼Œåœ¨<a href="https://github.com/salesforce/BLIP/issues/151#issuecomment-1537125671">Issue#151çš„è¯„è®º</a>ä¸­æä¾›äº†è§£å†³æ–¹æ¡ˆï¼šä¿®æ”¹transformersç‰ˆæœ¬<code>4.25.1</code></p><h2 id="æœ¬åœ°è°ƒç”¨"><a href="#æœ¬åœ°è°ƒç”¨" class="headerlink" title="æœ¬åœ°è°ƒç”¨"></a>æœ¬åœ°è°ƒç”¨</h2><p>å­¦ä¹ åœ¨æœ¬åœ°ä½¿ç”¨Pretrained BLIPæ¨¡å‹ï¼Œæµ‹è¯•ä»£ç ç½®äºBLIPç›®å½•ä¸‹</p><p>å®éªŒç¯å¢ƒï¼š</p><ul><li>Python 3.11.11 on conda</li><li>transformers 4.25.1</li><li>timm 0.4.12</li><li>fairscale 0.4.4</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"><span class="keyword">from</span> torchvision.transforms.functional <span class="keyword">import</span> InterpolationMode</span><br><span class="line"></span><br><span class="line">device = torch.device(<span class="string">&#x27;cuda&#x27;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&#x27;cpu&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_demo_image</span>(<span class="params">image_size,device</span>):</span><br><span class="line">    img_url = <span class="string">&#x27;https://storage.googleapis.com/sfr-vision-language-research/BLIP/demo.jpg&#x27;</span> </span><br><span class="line">    raw_image = Image.<span class="built_in">open</span>(requests.get(img_url, stream=<span class="literal">True</span>).raw).convert(<span class="string">&#x27;RGB&#x27;</span>)   </span><br><span class="line"></span><br><span class="line">    w,h = raw_image.size</span><br><span class="line">    <span class="built_in">print</span>(raw_image.resize((w//<span class="number">5</span>,h//<span class="number">5</span>)))</span><br><span class="line">    </span><br><span class="line">    transform = transforms.Compose([</span><br><span class="line">        transforms.Resize((image_size,image_size),interpolation=InterpolationMode.BICUBIC),</span><br><span class="line">        transforms.ToTensor(),</span><br><span class="line">        transforms.Normalize((<span class="number">0.48145466</span>, <span class="number">0.4578275</span>, <span class="number">0.40821073</span>), (<span class="number">0.26862954</span>, <span class="number">0.26130258</span>, <span class="number">0.27577711</span>))</span><br><span class="line">        ]) </span><br><span class="line">    image = transform(raw_image).unsqueeze(<span class="number">0</span>).to(device)   </span><br><span class="line">    <span class="keyword">return</span> image</span><br></pre></td></tr></table></figure><h3 id="Image-Captioning-å›¾åƒæè¿°"><a href="#Image-Captioning-å›¾åƒæè¿°" class="headerlink" title="Image Captioning å›¾åƒæè¿°"></a>Image Captioning å›¾åƒæè¿°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> models.blip <span class="keyword">import</span> blip_decoder</span><br><span class="line"></span><br><span class="line">image_size = <span class="number">384</span></span><br><span class="line">image = load_demo_image(image_size=image_size, device=device)</span><br><span class="line"></span><br><span class="line">model_url = <span class="string">&#x27;https://storage.googleapis.com/sfr-vision-language-research/BLIP/models/model_base_capfilt_large.pth&#x27;</span></span><br><span class="line">    </span><br><span class="line">model = blip_decoder(pretrained=model_url, image_size=image_size, vit=<span class="string">&#x27;base&#x27;</span>)</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line">model = model.to(device)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line">    <span class="comment"># beam search </span></span><br><span class="line">    caption = model.generate(image, sample=<span class="literal">False</span>, num_beams=<span class="number">3</span>, max_length=<span class="number">20</span>, min_length=<span class="number">5</span>)</span><br><span class="line">    <span class="comment"># nucleus sampling</span></span><br><span class="line">    <span class="comment"># caption = model.generate(image, sample=True, top_p=0.9, max_length=20, min_length=5)  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;caption: &#x27;</span>+caption[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><pre><code>The cache for model files in Transformers v4.22.0 has been updated. Migrating your old cache. This is a one-time only operation. You can interrupt this and resume the migration later on by calling `transformers.utils.move_cache()`.Moving 0 files to the new cache system0it [00:00, ?it/s]&lt;PIL.Image.Image image mode=RGB size=409x273 at 0x11139327650&gt;reshape position embedding from 196 to 576load checkpoint from https://storage.googleapis.com/sfr-vision-language-research/BLIP/models/model_base_capfilt_large.pthcaption: a woman and her dog on the beach</code></pre><h3 id="Visual-Question-Answering-è§†è§‰é—®ç­”"><a href="#Visual-Question-Answering-è§†è§‰é—®ç­”" class="headerlink" title="Visual Question Answering è§†è§‰é—®ç­”"></a>Visual Question Answering è§†è§‰é—®ç­”</h3><p>ç”±äºå­˜åœ¨å’ŒImageCaptioningä¸­çš„beam_searchç›¸åŒçš„ç‰ˆæœ¬é—®é¢˜ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> models.blip_vqa <span class="keyword">import</span> blip_vqa</span><br><span class="line"></span><br><span class="line">image_size = <span class="number">480</span></span><br><span class="line">image = load_demo_image(image_size=image_size, device=device)     </span><br><span class="line"></span><br><span class="line">model_url = <span class="string">&#x27;https://storage.googleapis.com/sfr-vision-language-research/BLIP/models/model_base_vqa_capfilt_large.pth&#x27;</span></span><br><span class="line">    </span><br><span class="line">model = blip_vqa(pretrained=model_url, image_size=image_size, vit=<span class="string">&#x27;base&#x27;</span>)</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line">model = model.to(device)</span><br><span class="line"></span><br><span class="line">question = <span class="string">&#x27;where is the woman sitting?&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line">    answer = model(image, question, train=<span class="literal">False</span>, inference=<span class="string">&#x27;generate&#x27;</span>) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;answer: &#x27;</span>+answer[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><pre><code>&lt;PIL.Image.Image image mode=RGB size=409x273 at 0x11139109090&gt;load checkpoint from https://storage.googleapis.com/sfr-vision-language-research/BLIP/models/model_base_vqa_capfilt_large.pthanswer: on beach</code></pre><h3 id="Image-Text-Matching-å›¾æ–‡åŒ¹é…"><a href="#Image-Text-Matching-å›¾æ–‡åŒ¹é…" class="headerlink" title="Image-Text Matching å›¾æ–‡åŒ¹é…"></a>Image-Text Matching å›¾æ–‡åŒ¹é…</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> models.blip_itm <span class="keyword">import</span> blip_itm</span><br><span class="line"></span><br><span class="line">image_size = <span class="number">384</span></span><br><span class="line">image = load_demo_image(image_size=image_size,device=device)</span><br><span class="line"></span><br><span class="line">model_url = <span class="string">&#x27;https://storage.googleapis.com/sfr-vision-language-research/BLIP/models/model_base_retrieval_coco.pth&#x27;</span></span><br><span class="line">    </span><br><span class="line">model = blip_itm(pretrained=model_url, image_size=image_size, vit=<span class="string">&#x27;base&#x27;</span>)</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line">model = model.to(device=device)</span><br><span class="line"></span><br><span class="line">caption = <span class="string">&#x27;a woman sitting on the beach with a dog&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;text: %s&#x27;</span> %caption)</span><br><span class="line"></span><br><span class="line">itm_output = model(image,caption,match_head=<span class="string">&#x27;itm&#x27;</span>)</span><br><span class="line">itm_score = torch.nn.functional.softmax(itm_output,dim=<span class="number">1</span>)[:,<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;The image and text is matched with a probability of %.4f&#x27;</span>%itm_score)</span><br><span class="line"></span><br><span class="line">itc_score = model(image,caption,match_head=<span class="string">&#x27;itc&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;The image feature and text feature has a cosine similarity of %.4f&#x27;</span>%itc_score)</span><br></pre></td></tr></table></figure><pre><code>&lt;PIL.Image.Image image mode=RGB size=409x273 at 0x11130227FD0&gt;load checkpoint from https://storage.googleapis.com/sfr-vision-language-research/BLIP/models/model_base_retrieval_coco.pthtext: a woman sitting on the beach with a dogThe image and text is matched with a probability of 0.9960The image feature and text feature has a cosine similarity of 0.5262</code></pre>]]></content>
    
    
    <summary type="html">Salesforceæä¾›çš„ç»Ÿä¸€è§†è§‰è¯­è¨€ç†è§£ä¸ç”Ÿæˆçš„é¢„è®­ç»ƒæ¨¡å‹</summary>
    
    
    
    <category term="DLç¬”è®°" scheme="https://www.cclmsy.cc/categories/DL%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="æ¨¡å‹è°ƒç”¨" scheme="https://www.cclmsy.cc/tags/%E6%A8%A1%E5%9E%8B%E8%B0%83%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>å¤ç°|æ‰‹æ“Transformeræ¨¡å‹</title>
    <link href="https://www.cclmsy.cc/posts/transformer.html"/>
    <id>https://www.cclmsy.cc/posts/transformer.html</id>
    <published>2025-02-27T16:00:00.000Z</published>
    <updated>2025-10-15T14:20:21.503Z</updated>
    
    <content type="html"><![CDATA[<p>è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/1706.03762">Attention is All You Need</a></p><blockquote><p>2017å¹´Googleåœ¨è®ºæ–‡ã€ŠAttention is All You Needã€‹ä¸­æå‡ºäº†Transformeræ¨¡å‹ï¼Œå¹¶æˆåŠŸåº”ç”¨åˆ°NLPé¢†åŸŸã€‚<br>è¯¥æ¨¡å‹å®Œå…¨åŸºäºè‡ªæ³¨æ„åŠ›æœºåˆ¶Attention mechanismå®ç°ï¼Œå¼¥è¡¥äº†ä¼ ç»Ÿçš„RNNæ¨¡å‹çš„ä¸è¶³ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¨å±€å˜é‡</span></span><br><span class="line">d_model = <span class="number">512</span> <span class="comment"># è¯å‘é‡ç»´åº¦</span></span><br><span class="line">d_ff = <span class="number">2048</span> <span class="comment"># å‰é¦ˆç¥ç»ç½‘ç»œéšå±‚ç»´åº¦</span></span><br><span class="line">src_vocab_size = <span class="number">10</span> <span class="comment"># æºè¯­è¨€è¯è¡¨å¤§å°</span></span><br><span class="line">tgt_vocab_size = <span class="number">10</span> <span class="comment"># ç›®æ ‡è¯­è¨€è¯è¡¨å¤§å°</span></span><br><span class="line">n_layers = <span class="number">6</span> <span class="comment"># ç¼–ç å™¨å’Œè§£ç å™¨å †å åŸºç¡€å—çš„æ•°é‡</span></span><br></pre></td></tr></table></figure><h2 id="0-TransformeråŸç†"><a href="#0-TransformeråŸç†" class="headerlink" title="0.TransformeråŸç†"></a>0.TransformeråŸç†</h2><p>å®è§‚ä¸Šï¼ŒTransformerå¯ä»¥çœ‹ä½œä¸€ä¸ªé»‘ç®±æ“ä½œçš„Seq2Seqæ¨¡å‹ã€‚<br>æ‹†å¼€é»‘ç®±ï¼Œå¯ä»¥çœ‹åˆ°æ¨¡å‹çš„æœ¬è´¨æ˜¯ä¸€ä¸ªEncoder-Decoderç»“æ„ã€‚</p><p><img src="https://source.cclmsy.cc/posts/notes/others/transformer/Transformeræ•´ä½“æ¶æ„.webp" alt="Transformeræ•´ä½“æ¶æ„"></p><ul><li>Embeddingï¼šè¯åµŒå…¥å±‚ï¼Œå°†è¾“å…¥çš„è¯è½¬æ¢ä¸ºè¯å‘é‡</li><li>Positional Encodingï¼šä½ç½®ç¼–ç ï¼Œä¸ºäº†è®©æ¨¡å‹å­¦ä¹ åˆ°åºåˆ—çš„ä½ç½®ä¿¡æ¯</li><li>Multi-Head Attentionï¼šå¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼Œç”¨äºæ•æ‰è¾“å…¥åºåˆ—çš„å…¨å±€ä¾èµ–å…³ç³»</li><li>Add &amp; Normï¼šæ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–ï¼Œç”¨äºåŠ é€Ÿè®­ç»ƒã€ç¼“è§£æ¢¯åº¦æ¶ˆå¤±é—®é¢˜<ul><li>Addæ®‹å·®è¿æ¥ï¼šæŠŠç½‘ç»œçš„è¾“å…¥å’Œè¾“å‡ºç›¸åŠ ï¼Œæœ‰æ•ˆè§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜</li><li>Normå±‚å½’ä¸€åŒ–ï¼šå¯¹ç½‘ç»œçš„è¾“å‡ºè¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼ŒåŠ é€Ÿè®­ç»ƒ</li></ul></li><li>Feed Forwardï¼šå‰é¦ˆç¥ç»ç½‘ç»œï¼Œç”¨äºå¯¹ç‰¹å¾è¿›è¡Œéçº¿æ€§å˜æ¢</li><li>Linearï¼šçº¿æ€§å˜æ¢å±‚ï¼Œç”¨äºå°†ç‰¹å¾æ˜ å°„åˆ°è¾“å‡ºç©ºé—´</li><li>Softmaxï¼šSoftmaxå±‚ï¼Œç”¨äºè¾“å‡ºæ¦‚ç‡åˆ†å¸ƒ</li></ul><h2 id="1-Encoder"><a href="#1-Encoder" class="headerlink" title="1.Encoder"></a>1.Encoder</h2><p><img src="https://source.cclmsy.cc/posts/notes/others/transformer/Transformer_Encoder.webp" alt="Transformer_Encoder"></p><h3 id="1-1-Embedding-è¯åµŒå…¥"><a href="#1-1-Embedding-è¯åµŒå…¥" class="headerlink" title="1.1 Embedding è¯åµŒå…¥"></a>1.1 Embedding è¯åµŒå…¥</h3><p>æ¨¡å‹æ— æ³•ç›´æ¥å¤„ç†æ–‡æœ¬æ•°æ®ï¼Œéœ€è¦æŠŠæ–‡æœ¬æ•°æ®è½¬æ¢æˆè®¡ç®—æœºèƒ½å¤Ÿè¯†åˆ«çš„å‘é‡å½¢å¼ã€‚<br>å°†æ–‡æœ¬è½¬åŒ–ä¸ºå‘é‡é€šå¸¸æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>One-hotç¼–ç ï¼šè¯å…¸å¤§å°ä¸ºNï¼Œæ¯ä¸ªè¯ç”¨ä¸€ä¸ªNç»´å‘é‡è¡¨ç¤ºï¼Œå½“å‰è¯å¯¹åº”çš„ç»´åº¦ä¸º1ï¼Œå…¶ä½™ç»´åº¦ä¸º0<ul><li>ä¼˜ç‚¹ï¼šç®€å•ç›´è§‚</li><li>ç¼ºç‚¹ï¼šå‘é‡ç»´åº¦é«˜ã€ç¨€ç–ã€ç¼ºä¹è¯­ä¹‰ä¹‹é—´çš„è”ç³»</li></ul></li><li>Embeddingè¯åµŒå…¥ï¼šé€šè¿‡è®­ç»ƒå­¦ä¹ åˆ°çš„è¯å‘é‡ï¼Œå°†è¯æ˜ å°„åˆ°ä¸€ä¸ªä½ç»´ç©ºé—´<ul><li>ä¼˜ç‚¹ï¼šä½ç»´ã€ç¨ å¯†ã€èƒ½å¤Ÿè¡¨è¾¾è¯ä¹‹é—´çš„å…³ç³»</li></ul></li></ul><p>è¾“å…¥Imputçš„ç»´åº¦æ˜¯[batch_size, seq_len]ï¼ŒEmbeddingå±‚çš„è¾“å‡ºç»´åº¦æ˜¯[batch_size, seq_len, d_model]ã€‚</p><ul><li>batch_sizeï¼šæ‰¹æ¬¡å¤§å°ï¼ˆå¥å­ä¸ªæ•°ï¼‰</li><li>seq_lenï¼šæœ€é•¿å¥å­é•¿åº¦</li><li>d_modelï¼šè¯å‘é‡ç»´åº¦</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Embeddings</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, vocab_size, d_model</span>):</span><br><span class="line">        <span class="built_in">super</span>(Embeddings, self).__init__()</span><br><span class="line">        <span class="comment"># è°ƒç”¨nn.Embeddingï¼Œè·å¾—å®ä¾‹åŒ–çš„è¯åµŒå…¥å¯¹è±¡lut(look up table)</span></span><br><span class="line">        self.lut = nn.Embedding(vocab_size, d_model)</span><br><span class="line">        self.d_model = d_model <span class="comment"># è¯åµŒå…¥ç»´åº¦</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Embeddingå±‚çš„å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            x: è¾“å…¥çš„è¯ç´¢å¼•å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            è¯åµŒå…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, d_model)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> self.lut(x) * math.sqrt(self.d_model)</span><br></pre></td></tr></table></figure><h3 id="1-2-Positional-Encoding-ä½ç½®ç¼–ç "><a href="#1-2-Positional-Encoding-ä½ç½®ç¼–ç " class="headerlink" title="1.2 Positional Encoding ä½ç½®ç¼–ç "></a>1.2 Positional Encoding ä½ç½®ç¼–ç </h3><p>Embeddingå±‚åªèƒ½è¡¨ç¤ºè¯çš„è¯­ä¹‰ä¿¡æ¯ï¼Œæ— æ³•è¡¨ç¤ºè¯çš„ä½ç½®ä¿¡æ¯ã€‚<br>Transformerä½¿ç”¨çš„æ˜¯è‡ªæ³¨æ„åŠ›æœºåˆ¶æ¥æå–ä¿¡æ¯ï¼Œä¸€ä¸ªå¥å­ä¸­çš„æ¯ä¸ªå­—/è¯æ˜¯å¹¶è¡Œè®¡ç®—ï¼Œè™½ç„¶å¤„ç†æ¯ä¸ªå­—çš„æ—¶å€™è€ƒè™‘åˆ°äº†æ‰€æœ‰å­—å¯¹å…¶çš„å½±å“ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰è€ƒè™‘åˆ°å„ä¸ªå­—ç›¸äº’ä¹‹é—´çš„ä½ç½®ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸‹æ–‡ï¼Œæ‰€ä»¥éœ€è¦å¼•å…¥ä½ç½®ä¿¡æ¯</p><p>ä¸ºäº†è®©æ¨¡å‹å­¦ä¹ åˆ°åºåˆ—çš„ä½ç½®ä¿¡æ¯ï¼Œéœ€è¦åœ¨Embeddingå±‚çš„è¾“å‡ºä¸ŠåŠ ä¸Šä½ç½®ç¼–ç ï¼Œå¾—åˆ°å«æœ‰ä½ç½®ä¿¡æ¯çš„è¯å‘é‡$\alpha$ã€‚</p><p>Transformerä¸­ä½¿ç”¨Positional Encodingè¡¨ç¤ºæ¯ä¸ªå­—ã€è¯çš„ä½ç½®ä¿¡æ¯ï¼Œå…¬å¼å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">PE_{(pos, i)} = \begin{cases}sin(w_k \cdot pos), & i = 2k \\\\cos(w_k \cdot pos), & i = 2k+1\end{cases}</script><script type="math/tex; mode=display">w_k = \dfrac{1}{10000^{2k/d_{model}}} \quad k = 0,1,2,...,d_{model}-1</script><p>å…¶ä¸­ï¼š</p><ul><li>$PE_{(pos, i)}$ï¼šè¡¨ç¤ºç¬¬$pos$ä¸ªå­—/è¯çš„Encodingå‘é‡ç¬¬$i$ç»´çš„ç¼–ç å€¼</li><li>$pos$ï¼šä½ç½®ä¿¡æ¯ï¼Œè¡¨ç¤ºå¥å­ä¸­çš„ç¬¬å‡ ä¸ªå­—/è¯ï¼Œä»0å¼€å§‹</li><li>$i$ï¼šä½ç½®ç¼–ç çš„ç»´åº¦ï¼Œä»0å¼€å§‹</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PositionalEncoding</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, d_model, dropout=<span class="number">0.1</span>, max_len=<span class="number">5000</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(PositionalEncoding, self).__init__()</span><br><span class="line">        self.dropout = nn.Dropout(p=dropout)</span><br><span class="line">        <span class="comment"># åˆå§‹åŒ–ä¸€ä¸ªå½¢çŠ¶ä¸º(max_len, d_model)çš„ä½ç½®ç¼–ç çŸ©é˜µ</span></span><br><span class="line">        pe = torch.zeros(max_len, d_model)</span><br><span class="line">        <span class="comment"># position[i] = i</span></span><br><span class="line">        position = torch.arange(<span class="number">0</span>, max_len).unsqueeze(<span class="number">1</span>).<span class="built_in">float</span>()</span><br><span class="line">        <span class="comment"># w_k=e^(2k*-log10000/d_model)=1/(10000^(2k/d_model))</span></span><br><span class="line">        div_term = torch.exp(torch.arange(<span class="number">0</span>, d_model, <span class="number">2</span>).<span class="built_in">float</span>() * -(math.log(<span class="number">10000.0</span>) / d_model))</span><br><span class="line">        <span class="comment"># å¶æ•°åˆ—ä½¿ç”¨sinå‡½æ•°ç¼–ç ï¼Œå¥‡æ•°åˆ—ä½¿ç”¨coså‡½æ•°ç¼–ç </span></span><br><span class="line">        pe[:, <span class="number">0</span>::<span class="number">2</span>] = torch.sin(position * div_term)</span><br><span class="line">        pe[:, <span class="number">1</span>::<span class="number">2</span>] = torch.cos(position * div_term)</span><br><span class="line">        <span class="comment"># åœ¨ç¬¬0ç»´å¢åŠ ä¸€ä¸ªç»´åº¦ï¼Œå½¢çŠ¶å˜ä¸º(batch_size=1, max_len, d_model)</span></span><br><span class="line">        pe = pe.unsqueeze(<span class="number">0</span>)</span><br><span class="line">        self.register_buffer(<span class="string">&#x27;pe&#x27;</span>, pe)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ä½ç½®ç¼–ç å±‚çš„å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            x: è¾“å…¥çš„è¯åµŒå…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, d_model)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            æ·»åŠ äº†ä½ç½®ç¼–ç çš„è¯åµŒå…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, d_model)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        x = x + self.pe[:, :x.size(<span class="number">1</span>)].clone().detach()</span><br><span class="line">        <span class="keyword">return</span> self.dropout(x)</span><br></pre></td></tr></table></figure><h3 id="1-3-Self-Attention-è‡ªæ³¨æ„åŠ›æœºåˆ¶"><a href="#1-3-Self-Attention-è‡ªæ³¨æ„åŠ›æœºåˆ¶" class="headerlink" title="1.3 Self Attention è‡ªæ³¨æ„åŠ›æœºåˆ¶"></a>1.3 Self Attention è‡ªæ³¨æ„åŠ›æœºåˆ¶</h3><p>ä¸€å¥è¯ä¸­ï¼Œä¸è¯­ä¹‰ç´§å¯†ç›¸å…³çš„å…³é”®è¯éœ€è¦äºˆä»¥æ›´å¤šçš„å…³æ³¨ï¼Œè€Œæ— å…³çš„è¿æ¥è¯å’Œè¾…åŠ©è¯åˆ™å¯ä»¥å¿½ç•¥ã€‚<br>åœ¨æœºå™¨ç¿»è¯‘æ—¶ï¼Œæ›´å¤šçš„æ³¨æ„è¡¨ç°ä¸ºæ›´å¤§çš„æƒé‡ï¼Œè¶Šé‡è¦çš„è¯æƒé‡è¶Šå¤§ã€‚</p><p><img src="https://source.cclmsy.cc/posts/notes/others/transformer/Self_Attention.webp" alt="Self Attention"></p><p>åŒ…å«ä½ç½®ä¿¡æ¯çš„è¯å‘é‡$\alpha^i$ï¼ˆå¥å­çš„ç¬¬i+1ä¸ªè¯çš„è¯å‘é‡ï¼‰ä½œä¸ºSelf Attentionçš„è¾“å…¥ï¼Œåˆ†åˆ«ä¹˜ä»¥ä¸‰ä¸ªæƒé‡çŸ©é˜µ$W^Q$ã€$W^K$ã€$W^V$ï¼Œå¾—åˆ°ï¼š</p><ul><li>$q^i$ï¼šQueryï¼ŒæŸ¥è¯¢å‘é‡</li><li>$k^i$ï¼šKeyï¼Œé”®å‘é‡ï¼Œâ€œè¢«æŸ¥â€æ—¶çš„å‘é‡</li><li>$v^i$ï¼šValueï¼Œå€¼å‘é‡ï¼Œâ€œå†…å®¹â€çš„å‘é‡</li></ul><p>ä»¥4ä¸ªå­—çš„å¥å­â€œæˆ‘æ˜¯å­¦ç”Ÿâ€ä¸ºä¾‹ï¼Œè®¡ç®—ç¬¬0ä¸ªå­—â€œæˆ‘â€çš„Self Attentionï¼š</p><ol><li>è®¡ç®— $q^0$ å’Œ $k^0,k^1,k^2,k^3$ çš„ç‚¹ç§¯ï¼Œå¾—åˆ°4ä¸ªæ³¨æ„åŠ›å€¼ $\alpha<em>{00},\alpha</em>{01},\alpha<em>{02},\alpha</em>{03}$</li></ol><ul><li>ç»è¿‡Softmaxå½’ä¸€åŒ–ï¼Œå¾—åˆ°4ä¸ªæ³¨æ„åŠ›åˆ†æ•° $\hat{\alpha<em>{00}},\hat{\alpha</em>{01}},\hat{\alpha<em>{02}},\hat{\alpha</em>{03}}$ ï¼Œå®ƒä»¬çš„å’Œä¸º1</li><li>å°†è¿™äº›åˆ†æ•°ä½œä¸ºæƒé‡ï¼Œå¯¹ $v^0,v^1,v^2,v^3$ è¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œå¾—åˆ°Self Attentionçš„è¾“å‡º</li><li>$b^0=\hat{\alpha<em>{00}}v^0+\hat{\alpha</em>{01}}v^1+\hat{\alpha<em>{02}}v^2+\hat{\alpha</em>{03}}v^3$</li></ul><p>ä¸ºäº†åŠ é€Ÿè®¡ç®—ï¼Œå¯ä»¥ä½¿ç”¨çŸ©é˜µè¿ç®—ï¼š</p><p><img src="https://source.cclmsy.cc/posts/notes/others/transformer/Self_Attention_Matrix.png" alt="Self AttentionçŸ©é˜µè¿ç®—"></p><ul><li>å…¶ä¸­$\alpha_{ij}=\dfrac{q_i * k_j^T}{\sqrt{d_k}}$ï¼Œ$d_k$æ˜¯è¯å‘é‡çš„ç»´åº¦<ul><li>ä¸ºä»€ä¹ˆè¦é™¤ä»¥$\sqrt{d_k}$ï¼Ÿå› ä¸ºå½“$d_k$å¾ˆå¤§æ—¶ï¼Œç‚¹ç§¯çš„å€¼ä¼šå¾ˆå¤§ï¼Œå¯¼è‡´Softmaxå‡½æ•°çš„æ¢¯åº¦æ¶ˆå¤±ï¼Œå½±å“æ¨¡å‹çš„è®­ç»ƒã€‚</li></ul></li><li>æœ€åè®¡ç®—$b^i=\sum<em>{j=0}^{n-1}\hat{\alpha</em>{ij}}v_j$</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ScaledDotProductAttention</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, scale_factor, dropout=<span class="number">0.0</span></span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.scale_factor = scale_factor <span class="comment"># ç¼©æ”¾å› å­</span></span><br><span class="line">        <span class="comment"># Dropoutç”¨äºé˜²æ­¢è¿‡æ‹Ÿåˆ</span></span><br><span class="line">        self.dropout = nn.Dropout(dropout)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, Q, K, V, mask=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        batch_size: æ‰¹å¤§å°</span></span><br><span class="line"><span class="string">        num_heads: å¤šå¤´æ³¨æ„åŠ›çš„å¤´æ•°ï¼Œè®ºæ–‡é»˜è®¤ä¸º8</span></span><br><span class="line"><span class="string">        seq_len: åºåˆ—é•¿åº¦</span></span><br><span class="line"><span class="string">        d_k, d_v: é”®å’Œå€¼çš„ç»´åº¦ï¼Œé»˜è®¤éƒ½æ˜¯64</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            Q: æŸ¥è¯¢å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, num_heads, seq_len, d_k)</span></span><br><span class="line"><span class="string">            K: é”®å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, num_heads, seq_len, d_k)</span></span><br><span class="line"><span class="string">            V: å€¼å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, num_heads, seq_len, d_v)</span></span><br><span class="line"><span class="string">            mask: æ©ç å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, seq_len)ï¼Œé»˜è®¤ä¸ºNone</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            ä¸Šä¸‹æ–‡å¼ é‡å’Œæ³¨æ„åŠ›å¼ é‡</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        attn = torch.matmul(Q / self.scale_factor, K.transpose(<span class="number">2</span>, <span class="number">3</span>)) <span class="comment"># Kçš„ç¬¬2å’Œç¬¬3ç»´è½¬ç½®</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># if mask is not None:</span></span><br><span class="line">        <span class="comment">#     scores = scores.masked_fill(mask == 0, -1e9)</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Softmaxè®¡ç®—æ³¨æ„åŠ›æƒé‡ï¼ŒDropoutå‡å°‘è¿‡æ‹Ÿåˆ</span></span><br><span class="line">        attn = self.dropout(torch.softmax(attn, dim=-<span class="number">1</span>))</span><br><span class="line">        output = torch.matmul(attn, V)</span><br><span class="line">        <span class="keyword">return</span> output, attn <span class="comment"># è¿”å›ä¸Šä¸‹æ–‡å¼ é‡å’Œæ³¨æ„åŠ›å¼ é‡</span></span><br></pre></td></tr></table></figure><h3 id="1-4-Multi-Head-Attention-å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶"><a href="#1-4-Multi-Head-Attention-å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶" class="headerlink" title="1.4 Multi-Head Attention å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶"></a>1.4 Multi-Head Attention å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶</h3><p>å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶å°±æ˜¯æŠŠ$q^i, k^i, v^i$ä¸‰ä¸ªçŸ©é˜µä»ç‰¹å¾ç»´åº¦ï¼ˆè¯å‘é‡é•¿åº¦ï¼‰æ–¹å‘ä¸Šæ‹†åˆ†æˆä¸ºå½¢çŠ¶ç›¸åŒçš„å°çŸ©é˜µã€‚<br>å†å°†æ¯ä¸ªHead Attentionçš„è¾“å‡ºæ‹¼æ¥èµ·æ¥ï¼Œå¾—åˆ°æœ€ç»ˆçš„Multi-Head Attentionè¾“å‡ºã€‚</p><p>ç†è§£ï¼šå¤šä¸ªå¤´åˆ†åˆ«å…³æ³¨ä¸åŒçš„ç‰¹å¾å­ç©ºé—´ï¼Œæœ€åå†å°†è¿™äº›å­ç©ºé—´çš„ä¿¡æ¯èåˆèµ·æ¥ã€‚</p><p><img src="https://source.cclmsy.cc/posts/notes/others/transformer/Multi_Head_Attention.webp" alt="Multi-Head Attention"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MultiHeadAttention</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n_head=<span class="number">8</span>, d_model=<span class="number">512</span>, d_k=<span class="number">64</span>, d_v=<span class="number">64</span>, droupout=<span class="number">0.1</span></span>):</span><br><span class="line">        <span class="comment"># è®ºæ–‡ä¸­ï¼Œå‚æ•°åˆ†åˆ«ä¸ºï¼š8ã€512ã€64ã€64</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line"></span><br><span class="line">        self.n_head = n_head</span><br><span class="line">        self.d_k = d_k</span><br><span class="line">        self.d_v = d_v</span><br><span class="line"></span><br><span class="line">        self.w_qs = nn.Linear(d_model, n_head * d_k, bias=<span class="literal">False</span>)</span><br><span class="line">        self.w_ks = nn.Linear(d_model, n_head * d_k, bias=<span class="literal">False</span>)</span><br><span class="line">        self.w_vs = nn.Linear(d_model, n_head * d_v, bias=<span class="literal">False</span>)</span><br><span class="line">        self.fc = nn.Linear(n_head * d_v, d_model, bias=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">        self.attention = ScaledDotProductAttention(scale_factor=d_k ** <span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">        self.dropout = nn.Dropout(droupout)</span><br><span class="line">        self.layer_norm = nn.LayerNorm(d_model, eps=<span class="number">1e-6</span>) <span class="comment"># LayerNormå±‚ï¼Œç”¨äºå½’ä¸€åŒ–</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, Q, K, V, mask=<span class="literal">None</span></span>):</span><br><span class="line">        d_k, d_v, n_head = self.d_k, self.d_v, self.n_head</span><br><span class="line">        batch_size, len_q, len_k, len_v = Q.size(<span class="number">0</span>), Q.size(<span class="number">1</span>), K.size(<span class="number">1</span>), V.size(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        residual = Q <span class="comment"># ä¿ç•™è¾“å…¥ç”¨ä½œæ®‹å·®è¿æ¥</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># å°†Qã€Kã€Vå½’ä¸€åŒ–åï¼Œåˆ†åˆ«é€šè¿‡çº¿æ€§æ˜ å°„åˆ°å¤šå¤´</span></span><br><span class="line">        <span class="comment"># Q: (batch_size, len_q, d_model) -&gt; (batch_size, len_q, n_head * d_k) -&gt; (batch_size, n_head, len_q, d_k)</span></span><br><span class="line">        <span class="comment"># Qï¼š(batch_size, len_q, 512) -&gt; (batch_size, len_q, 8*64) -&gt; (batch_size, len_q, 8, 64)</span></span><br><span class="line">        Q = self.layer_norm(Q)</span><br><span class="line">        K = self.layer_norm(K)</span><br><span class="line">        V = self.layer_norm(V)</span><br><span class="line">        Q = self.w_qs(Q).view(batch_size, len_q, n_head, d_k)</span><br><span class="line">        K = self.w_ks(K).view(batch_size, len_k, n_head, d_k)</span><br><span class="line">        V = self.w_vs(V).view(batch_size, len_v, n_head, d_v)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è½¬ç½®ï¼Œä½¿å¾—ç¬¬1å’Œç¬¬2ç»´äº¤æ¢ä½ç½®ï¼Œè¿›è¡ŒAttentionè®¡ç®—</span></span><br><span class="line">        <span class="comment"># Q: (batch_size, len_q, n_head, d_k) -&gt; (batch_size, n_head, len_q, d_k)</span></span><br><span class="line">        <span class="comment"># Qï¼š(batch_size, len_q, 8, 64) -&gt; (batch_size, 8, len_q, 64)</span></span><br><span class="line">        Q, K, V = Q.transpose(<span class="number">1</span>, <span class="number">2</span>), K.transpose(<span class="number">1</span>, <span class="number">2</span>), V.transpose(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> mask <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            mask = mask.unsqueeze(<span class="number">1</span>) <span class="comment"># å¢åŠ ä¸€ä¸ªHeadç»´åº¦</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Q=Softmax(Q*K/d + (1-S)Ïƒ)Vï¼Œattnæ˜¯QK/D</span></span><br><span class="line">        Q, attn = self.attention(Q, K, V, mask=mask) </span><br><span class="line"></span><br><span class="line">        <span class="comment"># Qçš„å½¢çŠ¶ï¼š[batch_size, n_head, len_q, d_v] [2,8,5,64]</span></span><br><span class="line">        Q = Q.transpose(<span class="number">1</span>, <span class="number">2</span>).contiguous().view(batch_size, len_q, -<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        Q = self.dropout(self.fc(Q))</span><br><span class="line"></span><br><span class="line">        Q += residual <span class="comment"># æ®‹å·®è¿æ¥Add</span></span><br><span class="line">        Q = self.layer_norm(Q) <span class="comment"># LayerNorm</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Q, attn</span><br></pre></td></tr></table></figure><h3 id="1-5-Add-amp-Norm-æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–"><a href="#1-5-Add-amp-Norm-æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–" class="headerlink" title="1.5 Add &amp; Norm æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–"></a>1.5 Add &amp; Norm æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–</h3><p>Addæ®‹å·®é“¾æ¥å°±æ˜¯å°†ç½‘ç»œçš„è¾“å…¥å’Œè¾“å‡ºç›´æ¥ç›¸åŠ ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚</p><p>Layer Normalizationæ˜¯å¯¹ç½‘ç»œçš„è¾“å‡ºè¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼ŒåŠ é€Ÿè®­ç»ƒã€‚<br>ä½¿$b$çš„æ¯ä¸€è¡Œï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªå¥å­ï¼Œå½’ä¸€åŒ–ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œè¾“å‡ºä¸º$\hat b$ï¼Œå½’ä¸€åŒ–å…¬å¼å¦‚ä¸‹ï¼š</p><ul><li>å‡å€¼ï¼š$\mu<em>i=\dfrac{1}{d}\sum</em>{j=1}^{d}b_{ij}$</li><li>æ–¹å·®ï¼š$\sigma<em>i^2=\dfrac{1}{d}\sum</em>{j=1}^{d}(b_{ij}-\mu_i)^2$</li><li>å½’ä¸€åŒ–ï¼š$\hat b<em>{ij}=\dfrac{b</em>{ij}-\mu_i}{\sqrt{\sigma_i^2+\epsilon}}*\gamma+\beta$</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LayerNorm</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, d_model, eps=<span class="number">1e-12</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(LayerNorm, self).__init__()</span><br><span class="line">        self.gamma = nn.Parameter(torch.ones(d_model))</span><br><span class="line">        self.beta = nn.Parameter(torch.zeros(d_model))</span><br><span class="line">        self.eps = eps <span class="comment"># é˜²æ­¢åˆ†æ¯ä¸º0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        mean = x.mean(-<span class="number">1</span>, keepdim=<span class="literal">True</span>)</span><br><span class="line">        var = x.var(-<span class="number">1</span>, unbiased=<span class="literal">False</span>, keepdim=<span class="literal">True</span>) <span class="comment"># unbiased=Falseè¡¨ç¤ºæ–¹å·®è®¡ç®—éæ— åä¼°è®¡ï¼ˆé™¤ä»¥Nè€Œä¸æ˜¯N-1ï¼‰</span></span><br><span class="line"></span><br><span class="line">        out = (x - mean) / torch.sqrt(var + self.eps)</span><br><span class="line">        out = self.gamma * out + self.beta</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure><h3 id="1-6-Feed-Forward-å‰é¦ˆç¥ç»ç½‘ç»œ"><a href="#1-6-Feed-Forward-å‰é¦ˆç¥ç»ç½‘ç»œ" class="headerlink" title="1.6 Feed Forward å‰é¦ˆç¥ç»ç½‘ç»œ"></a>1.6 Feed Forward å‰é¦ˆç¥ç»ç½‘ç»œ</h3><p>Add &amp; Normå±‚åæ¥ä¸€ä¸ªå…¨è¿æ¥çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼Œç”¨äºå¯¹ç‰¹å¾è¿›è¡Œéçº¿æ€§å˜æ¢</p><p>å‰é¦ˆç¥ç»ç½‘ç»œçš„ç»“æ„æ˜¯ä¸¤ä¸ªå…¨è¿æ¥å±‚ï¼Œç¬¬ä¸€ä¸ªå…¨è¿æ¥å±‚çš„æ¿€æ´»å‡½æ•°æ˜¯ReLUï¼Œç¬¬äºŒä¸ªå…¨è¿æ¥å±‚æ²¡æœ‰æ¿€æ´»å‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PositionwiseFeedForward</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(PositionwiseFeedForward, self).__init__()</span><br><span class="line">        self.fc = nn.Sequential(</span><br><span class="line">            nn.Linear(d_model, d_ff, bias=<span class="literal">False</span>),</span><br><span class="line">            nn.ReLU(),</span><br><span class="line">            nn.Linear(d_ff, d_model, bias=<span class="literal">False</span>))</span><br><span class="line">        self.layer_norm = nn.LayerNorm(d_model, eps=<span class="number">1e-6</span>) <span class="comment"># LayerNormå±‚ï¼Œç”¨äºå½’ä¸€åŒ–</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, inputs</span>):</span><br><span class="line">        resdual = inputs</span><br><span class="line">        output = self.fc(inputs)</span><br><span class="line">        output = self.layer_norm(output + resdual)</span><br><span class="line">        <span class="keyword">return</span> output</span><br></pre></td></tr></table></figure><h3 id="1-7-Maskæ‰-åœç”¨è¯"><a href="#1-7-Maskæ‰-åœç”¨è¯" class="headerlink" title="1.7 Maskæ‰ åœç”¨è¯"></a>1.7 Maskæ‰ åœç”¨è¯</h3><p>å¥å­ä¸­æ²¡æœ‰æ„ä¹‰çš„å ä½ç¬¦ï¼Œä¾‹å¦‚â€œæˆ‘æ˜¯å­¦ç”ŸPâ€ä¸­çš„Pæ˜¯åœæ­¢ç¬¦ï¼Œæ²¡æœ‰å®é™…æ„ä¹‰ï¼Œéœ€è¦å°†å…¶maskæ‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_attn_pad_mask</span>(<span class="params">seq_q, seq_k</span>):</span><br><span class="line">    batch_size, len_q = seq_q.size()</span><br><span class="line">    batch_size, len_k = seq_k.size()</span><br><span class="line">    <span class="comment"># eq(zero)ç”¨äºåˆ¤æ–­ seq_k ä¸­å“ªäº›ä½ç½®æ˜¯å¡«å……ç¬¦ï¼ˆé€šå¸¸å¡«å……ç¬¦çš„å€¼æ˜¯ 0ï¼‰ï¼Œè¿”å›ä¸€ä¸ªByteTensor</span></span><br><span class="line">    pad_attn_mask = seq_k.data.eq(<span class="number">0</span>).unsqueeze(<span class="number">1</span>)  <span class="comment"># (N, 1, len_k)</span></span><br><span class="line">    <span class="keyword">return</span> pad_attn_mask.expand(batch_size, len_q, len_k)  <span class="comment"># (N, len_q, len_k)</span></span><br></pre></td></tr></table></figure><h3 id="1-8-EncoderLayer"><a href="#1-8-EncoderLayer" class="headerlink" title="1.8 EncoderLayer"></a>1.8 EncoderLayer</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">EncoderLayer</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(EncoderLayer, self).__init__()</span><br><span class="line">        self.enc_self_attn = MultiHeadAttention() <span class="comment"># å¤šå¤´è‡ªæ³¨æ„åŠ›</span></span><br><span class="line">        self.pos_ffn = PositionwiseFeedForward() <span class="comment"># å‰é¦ˆç¥ç»ç½‘ç»œ</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, enc_inputs, enc_self_attn_mask</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            enc_inputs: ç¼–ç å™¨è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, d_model)</span></span><br><span class="line"><span class="string">            enc_self_attn_mask: ç¼–ç å™¨è‡ªæ³¨æ„åŠ›æ©ç ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, seq_len)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            ç¼–ç å™¨è¾“å‡ºå¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, d_model)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        enc_outputs, attn = self.enc_self_attn(enc_inputs, enc_inputs, enc_inputs, enc_self_attn_mask)</span><br><span class="line">        enc_outputs = self.pos_ffn(enc_outputs)</span><br><span class="line">        <span class="keyword">return</span> enc_outputs, attn</span><br></pre></td></tr></table></figure><h3 id="1-9-Encoder"><a href="#1-9-Encoder" class="headerlink" title="1.9 Encoder"></a>1.9 Encoder</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Encoder</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Encoder, self).__init__()</span><br><span class="line"></span><br><span class="line">        self.src_emb = Embeddings(src_vocab_size, d_model)</span><br><span class="line">        self.pos_emb = PositionalEncoding(d_model)</span><br><span class="line">        self.layers = nn.ModuleList([EncoderLayer() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n_layers)])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, enc_inputs</span>):</span><br><span class="line">        <span class="comment"># 1. ä¸­æ–‡å­—ç´¢å¼•è¿›è¡ŒEmbeddingï¼Œè½¬æ¢ä¸º512ç»´çš„è¯å‘é‡</span></span><br><span class="line">        enc_outputs = self.src_emb(enc_inputs)</span><br><span class="line">        <span class="comment"># 2. åŠ ä¸Šä½ç½®ç¼–ç </span></span><br><span class="line">        enc_outputs = self.pos_emb(enc_outputs)</span><br><span class="line">        <span class="comment"># 3. maskæ‰paddingéƒ¨åˆ†</span></span><br><span class="line">        enc_self_attn_mask = get_attn_pad_mask(enc_inputs, enc_inputs)</span><br><span class="line">        enc_self_attns = []</span><br><span class="line">        <span class="comment"># 4. é€šè¿‡6å±‚EncoderLayerï¼Œä¸Šä¸€å±‚çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥</span></span><br><span class="line">        <span class="keyword">for</span> layer <span class="keyword">in</span> self.layers:</span><br><span class="line">            enc_outputs, enc_self_attn = layer(enc_outputs, enc_self_attn_mask)</span><br><span class="line">            enc_self_attns.append(enc_self_attn)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> enc_outputs, enc_self_attns</span><br></pre></td></tr></table></figure><h2 id="2-Decoder"><a href="#2-Decoder" class="headerlink" title="2.Decoder"></a>2.Decoder</h2><p>Masked Multi-Head Attentionï¼šä¸MultiHead Attentionç±»ä¼¼ï¼Œåªæ˜¯åœ¨è®¡ç®—Self Attentionæ—¶ï¼Œéœ€è¦maskæ‰æœªæ¥çš„ä¿¡æ¯</p><p>Multi-Head Attentionï¼šä¸Encoderä¸­çš„MultiHead Attentionç›¸åŒ</p><p>Decoderçš„è¾“å‡ºé¢„æµ‹ï¼šDecoderè¾“å‡ºçŸ©é˜µå½¢çŠ¶æ˜¯[seq_len, word_dim]ï¼Œç»è¿‡nn.Linearå…¨è¿æ¥å±‚ï¼Œå†é€šè¿‡softmaxå‡½æ•°å¾—åˆ°æ¯ä¸ªè¯çš„æ¦‚ç‡ï¼Œç„¶åé€‰æ‹©æ¦‚ç‡æœ€å¤§çš„è¯ä½œä¸ºé¢„æµ‹ç»“æœã€‚</p><h3 id="2-1-Decoder-Input-è¾“å…¥å¤„ç†"><a href="#2-1-Decoder-Input-è¾“å…¥å¤„ç†" class="headerlink" title="2.1 Decoder Input è¾“å…¥å¤„ç†"></a>2.1 Decoder Input è¾“å…¥å¤„ç†</h3><p>Decoderçš„è¾“å…¥æ˜¯æœ€åä¸€ä¸ªEncoderçš„è¾“å‡ºï¼Œåœ¨è®­ç»ƒæ—¶ï¼ŒåŒæ—¶è¾“å…¥ç›®æ ‡å¥å­çš„è¯å‘é‡ï¼Œä»¥ä¾¿è®¡ç®—Lossã€‚</p><p>â€œæˆ‘æ˜¯å­¦ç”ŸEâ€-&gt;â€œS I am a studentâ€</p><ul><li>T0æ—¶åˆ»ï¼šè¾“å…¥å¼€å§‹ç¬¦â€œSâ€ï¼Œè¾“å‡ºé¢„æµ‹çš„ç¬¬ä¸€ä¸ªè¯â€œIâ€</li><li>T1æ—¶åˆ»ï¼šè¾“å…¥â€œS Iâ€ï¼Œè¾“å‡ºé¢„æµ‹çš„ç¬¬äºŒä¸ªè¯â€œamâ€</li><li>â€¦</li></ul><p>è¾“å…¥ä½¿ç”¨ä¸Šä¸‰è§’çŸ©é˜µè¿›è¡Œmaskï¼Œé¿å…Decoderçœ‹åˆ°æœªæ¥çš„ä¿¡æ¯ã€‚</p><p><img src="https://source.cclmsy.cc/posts/notes/others/transformer/Input_Mask.webp" alt="Input Mask"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_attn_subsequent_mask</span>(<span class="params">seq</span>): <span class="comment"># seq: [batch_size, tgt_len]</span></span><br><span class="line">    attn_shape = [seq.size(<span class="number">0</span>), seq.size(<span class="number">1</span>), seq.size(<span class="number">1</span>)]</span><br><span class="line">    subsequent_mask = np.triu(np.ones(attn_shape), k=<span class="number">1</span>) <span class="comment"># è¿”å›ä¸Šä¸‰è§’çŸ©é˜µ</span></span><br><span class="line">    subsequent_mask = torch.from_numpy(subsequent_mask).byte() <span class="comment"># è½¬æ¢ä¸ºByteTensor</span></span><br><span class="line">    <span class="keyword">return</span> subsequent_mask</span><br></pre></td></tr></table></figure><h3 id="2-2-DecoderLayer"><a href="#2-2-DecoderLayer" class="headerlink" title="2.2 DecoderLayer"></a>2.2 DecoderLayer</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">DecoderLayer</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(DecoderLayer, self).__init__()</span><br><span class="line">        self.dec_self_attn = MultiHeadAttention()</span><br><span class="line">        self.dec_enc_attn = MultiHeadAttention() </span><br><span class="line">        self.pos_ffn = PositionwiseFeedForward()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, dec_inputs, enc_outputs, dec_self_attn_mask, dec_enc_attn_mask</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            dec_inputs: è§£ç å™¨è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, tgt_len, d_model)</span></span><br><span class="line"><span class="string">            enc_outputs: ç¼–ç å™¨è¾“å‡ºå¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, d_model)</span></span><br><span class="line"><span class="string">            dec_self_attn_mask: è§£ç å™¨è‡ªæ³¨æ„åŠ›æ©ç ï¼Œå½¢çŠ¶ä¸º(batch_size, tgt_len, tgt_len)</span></span><br><span class="line"><span class="string">            dec_enc_attn_mask: è§£ç å™¨-ç¼–ç å™¨æ³¨æ„åŠ›æ©ç ï¼Œå½¢çŠ¶ä¸º(batch_size, tgt_len, seq_len)</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            è§£ç å™¨è¾“å‡ºå¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, tgt_len, d_model)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        dec_outputs, dec_self_attn = self.dec_self_attn(dec_inputs, dec_inputs, dec_inputs, dec_self_attn_mask)</span><br><span class="line">        dec_outputs, dec_enc_attn = self.dec_enc_attn(dec_outputs, enc_outputs, enc_outputs, dec_enc_attn_mask)</span><br><span class="line">        dec_outputs = self.pos_ffn(dec_outputs)</span><br><span class="line">        <span class="keyword">return</span> dec_outputs, dec_self_attn, dec_enc_attn</span><br></pre></td></tr></table></figure><h3 id="2-3-Decoder"><a href="#2-3-Decoder" class="headerlink" title="2.3 Decoder"></a>2.3 Decoder</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Decoder</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Decoder, self).__init__()</span><br><span class="line">        </span><br><span class="line">        self.tgt_emb = Embeddings(tgt_vocab_size, d_model)</span><br><span class="line">        self.pos_emb = PositionalEncoding(d_model)</span><br><span class="line">        self.layers = nn.ModuleList([DecoderLayer() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n_layers)])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, dec_inputs, enc_inputs, enc_outputs</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            dec_inputs: è§£ç å™¨è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, tgt_len)</span></span><br><span class="line"><span class="string">            enc_inputs: ç¼–ç å™¨è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len)</span></span><br><span class="line"><span class="string">            enc_outputs: ç¼–ç å™¨è¾“å‡ºå¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, d_model)</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            è§£ç å™¨è¾“å‡ºå¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, tgt_len, d_model)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># è‹±æ–‡å­—ç´¢å¼•è¿›è¡ŒEmbeddingï¼Œè½¬æ¢ä¸º512ç»´çš„è¯å‘é‡ï¼ŒåŠ ä¸Šä½ç½®ç¼–ç </span></span><br><span class="line">        dec_outputs = self.tgt_emb(dec_inputs)</span><br><span class="line">        dec_outputs = self.pos_emb(dec_outputs)</span><br><span class="line">        <span class="comment"># maskæ‰paddingéƒ¨åˆ†</span></span><br><span class="line">        dec_self_attn_pad_mask = get_attn_pad_mask(dec_inputs, dec_inputs)</span><br><span class="line">        dec_self_attn_subsequent_mask = get_attn_subsequent_mask(dec_inputs)</span><br><span class="line">        dec_self_attn_mask = torch.gt((dec_self_attn_pad_mask + dec_self_attn_subsequent_mask), <span class="number">0</span>)</span><br><span class="line">        dec_enc_attn_mask = get_attn_pad_mask(dec_inputs, enc_inputs)</span><br><span class="line">        dec_self_attns, dec_enc_attns = [], []</span><br><span class="line">        <span class="comment"># é€šè¿‡6å±‚DecoderLayerï¼Œä¸Šä¸€å±‚çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥</span></span><br><span class="line">        <span class="keyword">for</span> layer <span class="keyword">in</span> self.layers:</span><br><span class="line">            dec_outputs, dec_self_attn, dec_enc_attn = layer(dec_outputs, enc_outputs, dec_self_attn_mask, dec_enc_attn_mask)</span><br><span class="line">            dec_self_attns.append(dec_self_attn)</span><br><span class="line">            dec_enc_attns.append(dec_enc_attn)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> dec_outputs, dec_self_attns, dec_enc_attns</span><br></pre></td></tr></table></figure><h2 id="3-Transformerä»£ç å®ç°"><a href="#3-Transformerä»£ç å®ç°" class="headerlink" title="3. Transformerä»£ç å®ç°"></a>3. Transformerä»£ç å®ç°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Transformer</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Transformer, self).__init__()</span><br><span class="line">        self.encoder = Encoder()</span><br><span class="line">        self.decoder = Decoder()</span><br><span class="line">        <span class="comment"># è§£ç å™¨æœ€åçš„åˆ†ç±»å™¨ï¼Œåˆ†ç±»å™¨çš„è¾“å…¥d_modelæ˜¯è§£ç å±‚æ¯ä¸ªtokençš„è¾“å‡ºç»´åº¦å¤§å°</span></span><br><span class="line">        <span class="comment"># éœ€è¦å°†å…¶è½¬ä¸ºè¯è¡¨å¤§å°ï¼Œå†è®¡ç®—softmaxï¼›è®¡ç®—å“ªä¸ªè¯å‡ºç°çš„æ¦‚ç‡æœ€å¤§</span></span><br><span class="line">        self.projection = nn.Linear(d_model, tgt_vocab_size, bias=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, enc_inputs, dec_inputs</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            enc_inputs: ç¼–ç å™¨è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len)</span></span><br><span class="line"><span class="string">            dec_inputs: è§£ç å™¨è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, tgt_len)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            è§£ç å™¨è¾“å‡ºå¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size * tgt_len, tgt_vocab_size)</span></span><br><span class="line"><span class="string">            enc_self_attns: ç¼–ç å™¨è‡ªæ³¨æ„åŠ›å¼ é‡åˆ—è¡¨</span></span><br><span class="line"><span class="string">            dec_self_attns: è§£ç å™¨è‡ªæ³¨æ„åŠ›å¼ é‡åˆ—è¡¨</span></span><br><span class="line"><span class="string">            dec_enc_attns: è§£ç å™¨-ç¼–ç å™¨æ³¨æ„åŠ›å¼ é‡åˆ—è¡¨</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        enc_outputs, enc_self_attns = self.encoder(enc_inputs)</span><br><span class="line"></span><br><span class="line">        dec_outputs, dec_self_attns, dec_enc_attns = self.decoder(dec_inputs, enc_inputs, enc_outputs)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># dec_logits : [batch_size x src_vocab_size x tgt_vocab_size]</span></span><br><span class="line">        dec_logits = self.projection(dec_outputs) </span><br><span class="line">        <span class="keyword">return</span> dec_logits.view(-<span class="number">1</span>, dec_logits.size(-<span class="number">1</span>)), enc_self_attns, dec_self_attns, dec_enc_attns</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="4-Transformeræ¨¡å‹è®­ç»ƒ"><a href="#4-Transformeræ¨¡å‹è®­ç»ƒ" class="headerlink" title="4. Transformeræ¨¡å‹è®­ç»ƒ"></a>4. Transformeræ¨¡å‹è®­ç»ƒ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¨¡å‹è®­ç»ƒ</span></span><br><span class="line">model = Transformer()</span><br><span class="line">criterion = nn.CrossEntropyLoss()</span><br><span class="line">optimizer = torch.optim.Adam(model.parameters(), lr=<span class="number">0.001</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯å…¸</span></span><br><span class="line">word2idx = &#123;</span><br><span class="line">    <span class="string">&quot;S&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="string">&quot;æˆ‘&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&quot;æ˜¯&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="string">&quot;å­¦&quot;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">&quot;ç”Ÿ&quot;</span>: <span class="number">4</span>,</span><br><span class="line">    <span class="string">&quot;I&quot;</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="string">&quot;am&quot;</span>: <span class="number">6</span>,</span><br><span class="line">    <span class="string">&quot;a&quot;</span>: <span class="number">7</span>,</span><br><span class="line">    <span class="string">&quot;student&quot;</span>: <span class="number">8</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">idx2word = &#123;i: w <span class="keyword">for</span> w, i <span class="keyword">in</span> word2idx.items()&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å…¥æ•°æ®</span></span><br><span class="line">enc_inputs = torch.LongTensor([[word2idx[w] <span class="keyword">for</span> w <span class="keyword">in</span> [<span class="string">&quot;æˆ‘&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;å­¦&quot;</span>, <span class="string">&quot;ç”Ÿ&quot;</span>, <span class="string">&quot;S&quot;</span>]]])</span><br><span class="line">dec_inputs = torch.LongTensor([[word2idx[w] <span class="keyword">for</span> w <span class="keyword">in</span> [<span class="string">&quot;S&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;am&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;student&quot;</span>]]])</span><br><span class="line">target_batch = torch.LongTensor([[word2idx[w] <span class="keyword">for</span> w <span class="keyword">in</span> [<span class="string">&quot;S&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;am&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;student&quot;</span>]]])</span><br><span class="line"><span class="built_in">print</span>(enc_inputs, dec_inputs, target_batch)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è®­ç»ƒ</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    optimizer.zero_grad()</span><br><span class="line">    outputs, enc_self_attns, dec_self_attns, dec_enc_attns = model(enc_inputs, dec_inputs)</span><br><span class="line">    loss = criterion(outputs, target_batch.view(-<span class="number">1</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Epoch:&#x27;</span>, <span class="string">&#x27;%04d&#x27;</span> % (epoch + <span class="number">1</span>), <span class="string">&#x27;cost =&#x27;</span>, <span class="string">&#x27;&#123;:.6f&#125;&#x27;</span>.<span class="built_in">format</span>(loss))</span><br><span class="line">    loss.backward()</span><br><span class="line">    optimizer.step()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹é¢„æµ‹</span></span><br><span class="line">predict, _, _, _ = model(enc_inputs, dec_inputs)</span><br><span class="line">predict = predict.data.<span class="built_in">max</span>(<span class="number">1</span>, keepdim=<span class="literal">True</span>)[<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(enc_inputs, <span class="string">&#x27;-&gt;&#x27;</span>, [idx2word[n.item()] <span class="keyword">for</span> n <span class="keyword">in</span> predict.squeeze()])</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>tensor([[1, 2, 3, 4, 0]]) tensor([[0, 5, 6, 7, 8]]) tensor([[0, 5, 6, 7, 8]])Epoch: 0001 cost = 2.244576Epoch: 0002 cost = 0.970345Epoch: 0003 cost = 2.741649Epoch: 0004 cost = 3.185768Epoch: 0005 cost = 4.521887Epoch: 0006 cost = 3.544580Epoch: 0007 cost = 3.160498Epoch: 0008 cost = 2.823286Epoch: 0009 cost = 0.625107Epoch: 0010 cost = 0.672708Epoch: 0011 cost = 0.561514Epoch: 0012 cost = 0.959138Epoch: 0013 cost = 0.673696Epoch: 0014 cost = 0.326180Epoch: 0015 cost = 0.268545Epoch: 0016 cost = 0.215698Epoch: 0017 cost = 0.168979Epoch: 0018 cost = 0.057510Epoch: 0019 cost = 0.087601Epoch: 0020 cost = 0.056923tensor([[1, 2, 3, 4, 0]]) -&gt; [&#39;S&#39;, &#39;I&#39;, &#39;am&#39;, &#39;a&#39;, &#39;student&#39;]</code></pre>]]></content>
    
    
    <summary type="html">å®ç°ä¸æµ‹è¯•Transformeræ¨¡å‹</summary>
    
    
    
    <category term="DLç¬”è®°" scheme="https://www.cclmsy.cc/categories/DL%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>æ·±åº¦å­¦ä¹ ç¬”è®°4-å¾ªç¯ç¥ç»ç½‘ç»œRNN</title>
    <link href="https://www.cclmsy.cc/posts/deep_learning_4.html"/>
    <id>https://www.cclmsy.cc/posts/deep_learning_4.html</id>
    <published>2025-02-26T16:00:00.000Z</published>
    <updated>2025-08-12T00:19:26.816Z</updated>
    
    <content type="html"><![CDATA[<h2 id="4-1-å¾ªç¯ç¥ç»ç½‘ç»œ"><a href="#4-1-å¾ªç¯ç¥ç»ç½‘ç»œ" class="headerlink" title="4.1 å¾ªç¯ç¥ç»ç½‘ç»œ"></a>4.1 å¾ªç¯ç¥ç»ç½‘ç»œ</h2><h3 id="4-1-1-åºåˆ—æ¨¡å‹"><a href="#4-1-1-åºåˆ—æ¨¡å‹" class="headerlink" title="4.1.1 åºåˆ—æ¨¡å‹"></a>4.1.1 åºåˆ—æ¨¡å‹</h3><p>åºåˆ—æ¨¡å‹ï¼šè‡ªç„¶è¯­è¨€ã€éŸ³é¢‘ã€è§†é¢‘ç­‰åºåˆ—æ•°æ®çš„æ¨¡å‹</p><ul><li>åº”ç”¨ï¼šè¯­éŸ³è¯†åˆ«ã€æƒ…æ„Ÿåˆ†ç±»ã€æœºå™¨ç¿»è¯‘ç­‰</li></ul><p>ä¸ºä»€ä¹ˆä¸ä½¿ç”¨CNNï¼Ÿ</p><ul><li>åºåˆ—æ•°æ®çš„å‰åä¹‹é—´å…·æœ‰å¼ºå…³è”æ€§</li><li>è¾“å…¥è¾“å‡ºé•¿åº¦ä¸å›ºå®š</li></ul><h3 id="4-1-2-å¾ªç¯ç¥ç»ç½‘ç»œ"><a href="#4-1-2-å¾ªç¯ç¥ç»ç½‘ç»œ" class="headerlink" title="4.1.2 å¾ªç¯ç¥ç»ç½‘ç»œ"></a>4.1.2 å¾ªç¯ç¥ç»ç½‘ç»œ</h3><p>å¾ªç¯ï¼ˆé€’å½’ï¼‰ç¥ç»ç½‘ç»œï¼ˆRecurrent Neural Networkï¼ŒRNNï¼‰æ˜¯ç¥ç»ç½‘ç»œçš„ä¸€ç§ï¼Œå°†â€œçŠ¶æ€â€åœ¨è‡ªèº«ç½‘ç»œä¸­å¾ªç¯ä¼ é€’ï¼Œå¯ä»¥æ¥å—æ—¶é—´åºåˆ—ç»“æ„è¾“å…¥</p><h4 id="4-1-2-1-RNNç±»å‹"><a href="#4-1-2-1-RNNç±»å‹" class="headerlink" title="4.1.2.1 RNNç±»å‹"></a>4.1.2.1 RNNç±»å‹</h4><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/RNNç»“æ„.png" alt="RNNç»“æ„"></p><ul><li>ä¸€å¯¹ä¸€ï¼šå›ºå®šè¾“å…¥åˆ°å›ºå®šè¾“å‡ºï¼Œå¦‚å›¾åƒåˆ†ç±»</li><li>ä¸€å¯¹å¤šï¼šå›ºå®šè¾“å…¥åˆ°åºåˆ—è¾“å‡ºï¼Œå¦‚å›¾åƒçš„æ–‡å­—æè¿°</li><li>å¤šå¯¹ä¸€ï¼šåºåˆ—è¾“å…¥åˆ°å›ºå®šè¾“å‡ºï¼Œå¦‚æƒ…æ„Ÿåˆ†ç±»</li><li>ï¼ˆå¼‚æ­¥ï¼‰å¤šå¯¹å¤šï¼šåºåˆ—è¾“å…¥åˆ°åºåˆ—è¾“å‡ºï¼Œå¦‚æœºå™¨ç¿»è¯‘ï¼Œç§°ä¸ºEncoder-Decoderï¼ˆç¼–ç -è§£ç ï¼‰ç»“æ„</li><li>åŒæ­¥å¤šå¯¹å¤šï¼šåŒæ­¥åºåˆ—åˆ°åŒæ­¥è¾“å‡ºï¼Œå¦‚æ–‡æœ¬ç”Ÿæˆã€è§†é¢‘å¸§åˆ†ç±»</li></ul><h4 id="4-1-2-2-åŸºç¡€å¾ªç¯ç¥ç»ç½‘ç»œ"><a href="#4-1-2-2-åŸºç¡€å¾ªç¯ç¥ç»ç½‘ç»œ" class="headerlink" title="4.1.2.2 åŸºç¡€å¾ªç¯ç¥ç»ç½‘ç»œ"></a>4.1.2.2 åŸºç¡€å¾ªç¯ç¥ç»ç½‘ç»œ</h4><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/åŸºç¡€RNNç»“æ„.png" alt="åŸºç¡€RNNç»“æ„"></p><ul><li>$x_t$ï¼štæ—¶åˆ»çš„è¾“å…¥</li><li>$o_t$ï¼štæ—¶åˆ»çš„è¾“å‡º</li><li>$s_t$ï¼štæ—¶åˆ»çš„éšå±‚è¾“å‡º</li><li>æ‰€æœ‰å•å…ƒçš„å‚æ•°$U, V, W$å…±äº«</li></ul><p>ç»Ÿä¸€å…¬å¼ï¼ˆ$f$é‡‡ç”¨TanH/RuLUï¼Œ$g$é‡‡ç”¨Softmax/Sigmoidï¼‰ï¼š</p><script type="math/tex; mode=display">\begin{split}    & s_0 = 0 \\\\    & s_t = f(Ux_t + Ws_{t-1}) \\\\    & o_t = g(Vs_t)\end{split}</script><p>è¾“å‡ºçš„$o<em>t$å—å‰é¢æ—¶åˆ»çš„éšå±‚$s</em>{t-1}$å½±å“ï¼Œå³RNNå…·æœ‰è®°å¿†åŠŸèƒ½</p><h4 id="4-1-2-3-åºåˆ—ç”Ÿæˆæ¡ˆä¾‹"><a href="#4-1-2-3-åºåˆ—ç”Ÿæˆæ¡ˆä¾‹" class="headerlink" title="4.1.2.3 åºåˆ—ç”Ÿæˆæ¡ˆä¾‹"></a>4.1.2.3 åºåˆ—ç”Ÿæˆæ¡ˆä¾‹</h4><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/åºåˆ—ä¾‹å­.png" alt="åºåˆ—ä¾‹å­"></p><ul><li>è¾“å…¥åˆ°ç½‘ç»œå½“ä¸­çš„æ˜¯ä¸€ä¸ªä¸ªçš„åˆ†è¯ç»“æœï¼Œæ¯ä¸€ä¸ªè¯çš„è¾“å…¥æ˜¯ä¸€ä¸ªæ—¶åˆ»</li><li>æ¯ä¸€ä¸ªæ—¶åˆ»æœ‰ä¸€ä¸ªè¾“å‡ºï¼Œè¡¨ç¤ºæœ€å¯èƒ½çš„ä¸‹ä¸€ä¸ªè¯</li></ul><h4 id="4-1-2-4-è¯çš„è¡¨ç¤º"><a href="#4-1-2-4-è¯çš„è¡¨ç¤º" class="headerlink" title="4.1.2.4 è¯çš„è¡¨ç¤º"></a>4.1.2.4 è¯çš„è¡¨ç¤º</h4><p>ä¸ºäº†èƒ½å¤Ÿè®©ç½‘ç»œç†è§£è¾“å…¥ï¼Œéœ€è¦å°†è¯è¿›è¡Œå‘é‡è¡¨ç¤ºã€‚</p><ul><li>å»ºç«‹ä¸€ä¸ªåŒ…å«æ‰€æœ‰åºåˆ—è¯çš„è¯å…¸ï¼Œæ¯ä¸ªè¯åœ¨è¯å…¸ä¸­æœ‰å”¯ä¸€ç¼–å·</li><li>è®°è¯å…¸å¤§å°ä¸º$N$ï¼Œä»»æ„ä¸€ä¸ªè¯éƒ½å¯ä»¥ç”¨ä¸€ä¸ª$N$ç»´çš„One-Hotå‘é‡è¡¨ç¤º</li><li>å¾—åˆ°ä¸€ä¸ªé«˜ç»´ç¨€ç–çŸ©é˜µ</li></ul><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/è¯å‘é‡è¡¨ç¤º.png" alt="è¯å‘é‡è¡¨ç¤º"></p><h4 id="4-1-2-4-è¾“å‡ºçš„è¡¨ç¤º-Softmax"><a href="#4-1-2-4-è¾“å‡ºçš„è¡¨ç¤º-Softmax" class="headerlink" title="4.1.2.4 è¾“å‡ºçš„è¡¨ç¤º-Softmax"></a>4.1.2.4 è¾“å‡ºçš„è¡¨ç¤º-Softmax</h4><p>RNNè¿™ç§æ¨¡å‹ï¼Œæ¯ä¸€ä¸ªæ—¶åˆ»çš„è¾“å‡ºæ˜¯ä¸‹ä¸€ä¸ªæœ€å¯èƒ½çš„è¯ï¼Œå¯ä»¥ç”¨æ¦‚ç‡è¡¨ç¤ºï¼Œæ€»é•¿åº¦ä¸ºè¯çš„æ€»æ•°é•¿åº¦</p><ul><li>æ¯ä¸ªæ—¶åˆ»çš„éšå±‚è¾“å‡º$s_t$ç»è¿‡Softmaxå‡½æ•°ï¼Œå¾—åˆ°æ¦‚ç‡åˆ†å¸ƒ</li></ul><h4 id="4-1-2-5-äº¤å‰ç†µæŸå¤±"><a href="#4-1-2-5-äº¤å‰ç†µæŸå¤±" class="headerlink" title="4.1.2.5 äº¤å‰ç†µæŸå¤±"></a>4.1.2.5 äº¤å‰ç†µæŸå¤±</h4><p>æ€»æŸå¤±å®šä¹‰ï¼šä¸€æ•´ä¸ªåºåˆ—ï¼ˆä¸€ä¸ªå¥å­ï¼‰ä½œä¸ºä¸€ä¸ªè®­ç»ƒå®ä¾‹ï¼Œæ€»è¯¯å·®æ˜¯å„ä¸ªæ—¶åˆ»è¯¯å·®çš„å’Œ</p><script type="math/tex; mode=display">\begin{split}    & E_t(y_t, \hat{y}_t) = -y_t \log(\hat{y}_t) \\\\    & E(y, \hat{y}) = \sum_t E_t(y_t, \hat{y}_t) = -\sum_t y_t \log(\hat{y}_t)\end{split}</script><ul><li>$y_t$ï¼šæ—¶åˆ»tä¸Šæ­£ç¡®çš„è¾“å‡º</li><li>$\hat{y}_t$ï¼šæ—¶åˆ»tä¸Šé¢„æµ‹çš„è¾“å‡º</li></ul><h4 id="4-1-2-6-æ—¶åºåå‘ä¼ æ’­ç®—æ³•ï¼ˆBPTTï¼‰"><a href="#4-1-2-6-æ—¶åºåå‘ä¼ æ’­ç®—æ³•ï¼ˆBPTTï¼‰" class="headerlink" title="4.1.2.6 æ—¶åºåå‘ä¼ æ’­ç®—æ³•ï¼ˆBPTTï¼‰"></a>4.1.2.6 æ—¶åºåå‘ä¼ æ’­ç®—æ³•ï¼ˆBPTTï¼‰</h4><p>Backpropagation Through Timeï¼Œæ—¶åºåå‘ä¼ æ’­ç®—æ³•ï¼šå¯¹äºRNNæœ‰ä¸€ä¸ªæ—¶é—´æ¦‚å¿µï¼Œéœ€è¦æŠŠæ¢¯åº¦æ²¿æ—¶é—´é€šé“è¿›è¡Œåå‘ä¼ æ’­</p><p>éœ€è¦æ›´æ–°çš„å‚æ•°ï¼š$U, V, W, b_x, b_y$</p><ul><li>è®¡ç®—æ¯ä¸ªæ—¶é—´çš„æ¢¯åº¦$dW_t$ï¼Œç›¸åŠ ä½œä¸ºæ¯æ¬¡$W$æ›´æ–°çš„æ¢¯åº¦å€¼</li><li>$s<em>t=tanh(Ux_t+Ws</em>{t-1}+b_x)$ï¼Œ$o_t=Softmax(Vs_t+b_y)$</li><li>åˆ©ç”¨é“¾å¼æ³•åˆ™ï¼Œè®¡ç®—å‡ºæ¯ä¸ªæ—¶é—´ä¸‹å„å‚æ•°çš„æ¢¯åº¦</li></ul><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/RNNåå‘ä¼ æ’­æ€»ç»“.png" alt="RNNåå‘ä¼ æ’­æ€»ç»“"></p><h4 id="4-1-2-7-æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸"><a href="#4-1-2-7-æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸" class="headerlink" title="4.1.2.7 æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸"></a>4.1.2.7 æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸</h4><p>ç”±äºRNNä¸­ä¹Ÿå­˜åœ¨é“¾å¼æ±‚å¯¼æ³•åˆ™ï¼Œå› æ­¤ä¹Ÿä¼šå‘ç”Ÿæ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜</p><h3 id="4-1-8-RNNæ”¹è¿›"><a href="#4-1-8-RNNæ”¹è¿›" class="headerlink" title="4.1.8 RNNæ”¹è¿›"></a>4.1.8 RNNæ”¹è¿›</h3><p>é€šè¿‡é—¨æ§æœºåˆ¶æ§åˆ¶ä¿¡æ¯çš„æµåŠ¨</p><h4 id="4-1-8-1-é—¨æ§å¾ªç¯å•å…ƒGRU"><a href="#4-1-8-1-é—¨æ§å¾ªç¯å•å…ƒGRU" class="headerlink" title="4.1.8.1 é—¨æ§å¾ªç¯å•å…ƒGRU"></a>4.1.8.1 é—¨æ§å¾ªç¯å•å…ƒGRU</h4><p>Gated Recurrent Unitï¼Œé—¨æ§å¾ªç¯å•å…ƒ</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/GRUå•å…ƒ.png" alt="GRUå•å…ƒ"></p><p>GRUå¢åŠ äº†ä¸¤ä¸ªé—¨ï¼Œä¸€ä¸ªé‡ç½®é—¨ï¼ˆreset gateï¼‰å’Œä¸€ä¸ªæ›´æ–°é—¨ï¼ˆupdate gateï¼‰</p><ul><li>é‡ç½®é—¨ï¼šå†³å®šå¦‚ä½•å°†æ–°çš„è¾“å…¥å’Œå‰ä¸€æ—¶åˆ»çš„è¾“å‡ºç›¸ç»“åˆ</li><li>æ›´æ–°é—¨ï¼šå®šä¹‰å‰é¢çš„è®°å¿†ä¿å­˜åˆ°å½“å‰æ—¶é—´çš„é‡</li><li>é‡ç½®é—¨1ï¼Œæ›´æ–°é—¨0ï¼Œå³ä¸ºæ ‡å‡†RNNæ¨¡å‹</li></ul><p>GRUæœ¬è´¨è§£å†³çš„é—®é¢˜ï¼š</p><ul><li>è§£å†³çŸ­æœŸé—®é¢˜ï¼Œæ¯ä¸ªé€’å½’å•å…ƒèƒ½å¤Ÿè‡ªé€‚åº”æ•æ‰ä¸åŒå°ºåº¦çš„ä¾èµ–å…³ç³»</li><li>å¤„ç†äº†éšå±‚è¾“å‡ºï¼Œ$h<em>t=(1-z_t)*h</em>{t-1}+z_t*\tilde{h}_t$ï¼Œè§£å†³äº†æ¢¯åº¦æ¶ˆå¤±é—®é¢˜</li></ul><h4 id="4-1-8-2-é•¿çŸ­æ—¶è®°å¿†ç½‘ç»œLSTM"><a href="#4-1-8-2-é•¿çŸ­æ—¶è®°å¿†ç½‘ç»œLSTM" class="headerlink" title="4.1.8.2 é•¿çŸ­æ—¶è®°å¿†ç½‘ç»œLSTM"></a>4.1.8.2 é•¿çŸ­æ—¶è®°å¿†ç½‘ç»œLSTM</h4><p>Long Short Term Memoryï¼Œé•¿çŸ­è®°å¿†ç½‘ç»œ</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/LSTM.png" alt="LSTM"></p><ul><li>$h_t$ï¼šå½“å‰cellçš„è¾“å‡º</li><li>$c_t$ï¼šéšå±‚çš„è®°å¿†</li><li>ä¸‰ä¸ªé—¨ï¼šé—å¿˜é—¨fï¼Œè¾“å…¥é—¨uï¼Œè¾“å‡ºé—¨o</li></ul><p>ä½œç”¨ï¼šä¾¿äºè®°å¿†é•¿æ›´é•¿è·ç¦»çš„çŠ¶æ€</p><h2 id="4-2-è¯åµŒå…¥ä¸NLP"><a href="#4-2-è¯åµŒå…¥ä¸NLP" class="headerlink" title="4.2 è¯åµŒå…¥ä¸NLP"></a>4.2 è¯åµŒå…¥ä¸NLP</h2><h3 id="4-2-1-åœ¨RNNä¸­ä½¿ç”¨one-hotè¡¨ç¤ºçš„é—®é¢˜"><a href="#4-2-1-åœ¨RNNä¸­ä½¿ç”¨one-hotè¡¨ç¤ºçš„é—®é¢˜" class="headerlink" title="4.2.1 åœ¨RNNä¸­ä½¿ç”¨one-hotè¡¨ç¤ºçš„é—®é¢˜"></a>4.2.1 åœ¨RNNä¸­ä½¿ç”¨one-hotè¡¨ç¤ºçš„é—®é¢˜</h3><ul><li>å‡è®¾æœ‰nä¸ªè¯ï¼Œæ¯ä¸ªè¯çš„one-hotè¡¨ç¤ºæ˜¯nç»´çš„ï¼Œæ•´ä½“å¤§å°ä¸º$n*n$ï¼Œéå¸¸ç¨€ç–</li><li>æ— æ³•è¡¨ç¤ºè¯ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œä¾‹å¦‚Appleå¯¹Bananaçš„ç›¸ä¼¼æ€§è¿œé«˜äºMonkey</li></ul><h3 id="4-2-2-è¯åµŒå…¥ï¼ˆWord-Embeddingï¼‰"><a href="#4-2-2-è¯åµŒå…¥ï¼ˆWord-Embeddingï¼‰" class="headerlink" title="4.2.2 è¯åµŒå…¥ï¼ˆWord Embeddingï¼‰"></a>4.2.2 è¯åµŒå…¥ï¼ˆWord Embeddingï¼‰</h3><p>æŠŠä¸€ä¸ªç»´æ•°ä¸º$N$çš„é«˜ç»´ç©ºé—´åµŒå…¥åˆ°ä¸€ä¸ªç»´æ•°ä½çš„å¤šçš„è¿ç»­å‘é‡ç©ºé—´ä¸­ï¼Œæ¯ä¸ªå•è¯æˆ–è¯ç»„è¢«æ˜ å°„ä¸ºå®æ•°åŸŸä¸Šçš„å‘é‡ï¼Œä¾‹å¦‚ï¼š</p><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">Man</th><th style="text-align:center">Woman</th><th style="text-align:center">King</th><th style="text-align:center">Queen</th><th style="text-align:center">Apple</th><th style="text-align:center">Banana</th></tr></thead><tbody><tr><td style="text-align:center">Gender</td><td style="text-align:center">1</td><td style="text-align:center">-1</td><td style="text-align:center">-0.95</td><td style="text-align:center">0.97</td><td style="text-align:center">0.01</td><td style="text-align:center">-0.02</td></tr><tr><td style="text-align:center">Royal</td><td style="text-align:center">0.01</td><td style="text-align:center">0.02</td><td style="text-align:center">0.98</td><td style="text-align:center">0.99</td><td style="text-align:center">-0.03</td><td style="text-align:center">0.04</td></tr><tr><td style="text-align:center">Age</td><td style="text-align:center">0.01</td><td style="text-align:center">0.02</td><td style="text-align:center">0.75</td><td style="text-align:center">0.69</td><td style="text-align:center">0.03</td><td style="text-align:center">-0.04</td></tr><tr><td style="text-align:center">Food</td><td style="text-align:center">0.01</td><td style="text-align:center">0.02</td><td style="text-align:center">-0.03</td><td style="text-align:center">0.04</td><td style="text-align:center">0.95</td><td style="text-align:center">0.97</td></tr></tbody></table></div><p>è¯åµŒå…¥çš„ç‰¹ç‚¹ï¼šèƒ½å¤Ÿä½“ç°è¯ä¸è¯ä¹‹é—´çš„å…³ç³»</p><p>Man-Womanâ‰ˆKing-?(Queen!) </p><p>ç®—æ³•/å·¥å…·ï¼šSkip-gramã€CBOWã€GenSim</p><h2 id="4-3-Seq2Seqä¸Attentionæœºåˆ¶"><a href="#4-3-Seq2Seqä¸Attentionæœºåˆ¶" class="headerlink" title="4.3 Seq2Seqä¸Attentionæœºåˆ¶"></a>4.3 Seq2Seqä¸Attentionæœºåˆ¶</h2><h3 id="4-3-1-Seq2Seq"><a href="#4-3-1-Seq2Seq" class="headerlink" title="4.3.1 Seq2Seq"></a>4.3.1 Seq2Seq</h3><p>Seq2Seqï¼šSequence to Sequenceï¼Œç”±Google Brainå›¢é˜Ÿå’ŒYoshua Bengio ä¸¤ä¸ªå›¢é˜Ÿå„è‡ªç‹¬ç«‹çš„æå‡ºæ¥</p><h4 id="4-3-1-1-å®šä¹‰"><a href="#4-3-1-1-å®šä¹‰" class="headerlink" title="4.3.1.1 å®šä¹‰"></a>4.3.1.1 å®šä¹‰</h4><p>Seq2Seqæ¨¡å‹æ˜¯ä¸€ä¸ªEncoder-Decoderç»“æ„çš„æ¨¡å‹ï¼Œè¾“å…¥æ˜¯ä¸€ä¸ªåºåˆ—ï¼Œè¾“å‡ºä¹Ÿæ˜¯ä¸€ä¸ªåºåˆ—</p><p>Encoderä¸­å°†ä¸€ä¸ªå¯å˜é•¿åº¦çš„ä¿¡å·åºåˆ—å˜ä¸ºå›ºå®šé•¿åº¦çš„å‘é‡è¡¨è¾¾ï¼Œ<br>Decoderä¸­å°†è¿™ä¸ªå›ºå®šé•¿åº¦çš„å‘é‡è¡¨è¾¾å˜ä¸ºå¯å˜é•¿åº¦çš„ç›®æ ‡ä¿¡å·åºåˆ—</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/seq2seq.png" alt="seq2seq"></p><ul><li>ç›¸å½“äºæŠŠRNNæ¨¡å‹çš„$s_0$è¾“å…¥å˜æˆä¸€ä¸ªEncoder</li></ul><h4 id="4-3-1-2-æ¡ä»¶è¯­è¨€æ¨¡å‹"><a href="#4-3-1-2-æ¡ä»¶è¯­è¨€æ¨¡å‹" class="headerlink" title="4.3.1.2 æ¡ä»¶è¯­è¨€æ¨¡å‹"></a>4.3.1.2 æ¡ä»¶è¯­è¨€æ¨¡å‹</h4><p>Encoderç¼–ç å™¨çš„ä½œç”¨ï¼š</p><ul><li>å°†ä¸€ä¸ªè¾¹é•¿è¾“å…¥åºåˆ—è¾“å‡ºåˆ°ä¸€ä¸ªç¼–ç çŠ¶æ€$C$</li><li>è§£ç å™¨è¾“å‡º$y<em>t$çš„æ¡ä»¶æ¦‚ç‡åŸºäºä¹‹å‰çš„è¾“å‡ºåºåˆ—$y_1y_2â€¦y</em>{t-1}$å’Œç¼–ç çŠ¶æ€$C$</li><li>$argmaxP(y_1,y_2,â€¦,y_T|x_1,x_2,â€¦,x_T)$ï¼Œç»™å®šè¾“å…¥çš„åºåˆ—ï¼Œæœ€å¤§åŒ–è¾“å‡ºåºåˆ—çš„æ¦‚ç‡</li></ul><p>æ ¹æ®æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œæœ€å¤§åŒ–è¾“å‡ºåºåˆ—çš„æ¦‚ç‡</p><script type="math/tex; mode=display">\begin{split}    & P(y_1,y_2,...,y_T|x_1,x_2,...,x_T) \\\\    & = \prod_{t=1}^T P(y_t|y_1,y_2,...,y_{t-1},x_1,x_2,...,x_T) \\\\    & = \prod_{t=1}^T P(y_t|y_1,y_2,...,y_{t-1},C)\end{split}</script><p>è¿™ä¸ªå…¬å¼éœ€è¦æ±‚å‡º$P(y<em>1|C),P(y_2|y_1,C),â€¦,P(y_T|y_1,y_2,â€¦,y</em>{T-1},C)$ï¼Œæ¦‚ç‡è¿ä¹˜æå°ï¼Œä¸åˆ©äºå­˜å‚¨ï¼Œå› æ­¤å–å¯¹æ•°è¿›è¡Œè®¡ç®—ï¼Œè¿™æ ·å°±å°†è¿ä¹˜å¼è½¬æ¢ä¸ºç´¯åŠ å¼</p><script type="math/tex; mode=display">\log P(y_1,y_2,...,y_T|x_1,x_2,...,x_T) = \sum_{t=1}^T \log P(y_t|y_1,y_2,...,y_{t-1},C)</script><p>åº”ç”¨åœºæ™¯ï¼šæœºå™¨ç¿»è¯‘ï¼ˆNMTï¼‰</p><h3 id="4-3-2-Attentionæœºåˆ¶"><a href="#4-3-2-Attentionæœºåˆ¶" class="headerlink" title="4.3.2 Attentionæœºåˆ¶"></a>4.3.2 Attentionæœºåˆ¶</h3><h4 id="4-3-2-1-é•¿å¥å­é—®é¢˜"><a href="#4-3-2-1-é•¿å¥å­é—®é¢˜" class="headerlink" title="4.3.2.1 é•¿å¥å­é—®é¢˜"></a>4.3.2.1 é•¿å¥å­é—®é¢˜</h4><p>å¯¹äºé•¿å¥å­ï¼ŒSeq2Seqæ¨¡å‹çš„æ€§èƒ½ä¼šä¸‹é™ï¼Œæ— æ³•åšåˆ°å‡†ç¡®ç¿»è¯‘ã€‚<br>å¥å­éå¸¸é•¿æ—¶ï¼ŒBLEUï¼ˆBilingual Evaluation Understudyï¼‰è¯„ä»·å¾—åˆ†ä¼šå¾ˆä½</p><p>æœ¬è´¨åŸå› ï¼šåœ¨Encoder-Decoderç»“æ„ä¸­ï¼ŒEncoderæŠŠæ‰€æœ‰çš„è¾“å…¥åºåˆ—éƒ½ç¼–ç æˆä¸€ä¸ªç»Ÿä¸€çš„è¯­ä¹‰ç‰¹å¾$C$å†è§£ç ï¼Œ$C$ä¸­å¿…é¡»åŒ…å«åŸå§‹åºåˆ—ä¸­çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå®ƒçš„é•¿åº¦å°±æˆäº†æ¨¡å‹æ€§èƒ½çš„ç“¶é¢ˆã€‚<br>å½“éœ€è¦ç¿»è¯‘çš„å¥å­å¾ˆé•¿æ—¶ï¼Œä¸€ä¸ª$C$å¯èƒ½å­˜ä¸ä¸‹é‚£ä¹ˆå¤šä¿¡æ¯ï¼Œå°±ä¼šé€ æˆç¿»è¯‘ç²¾åº¦çš„ä¸‹é™ã€‚</p><h4 id="4-3-2-2-Attentionæœºåˆ¶"><a href="#4-3-2-2-Attentionæœºåˆ¶" class="headerlink" title="4.3.2.2 Attentionæœºåˆ¶"></a>4.3.2.2 Attentionæœºåˆ¶</h4><ul><li>æŠŠEncoderçš„æ‰€æœ‰éšå±‚è¾“å‡º$s_1,s_2,â€¦,s_T$éƒ½ä¿ç•™ä¸‹æ¥ï¼Œä¸å†åªä¿ç•™æœ€åä¸€ä¸ªéšå±‚è¾“å‡º$C$</li><li>å°†è¿™äº›ä¿¡æ¯æä¾›ç»™Decoder</li></ul><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/Attentionæœºåˆ¶.png" alt="Attentionæœºåˆ¶"></p><h4 id="4-3-2-3-Attentionæœºåˆ¶çš„è®¡ç®—"><a href="#4-3-2-3-Attentionæœºåˆ¶çš„è®¡ç®—" class="headerlink" title="4.3.2.3 Attentionæœºåˆ¶çš„è®¡ç®—"></a>4.3.2.3 Attentionæœºåˆ¶çš„è®¡ç®—</h4><p>å‡è®¾Encoderçš„æ—¶åˆ»ä¸º$t$ï¼ŒDecoderçš„æ—¶åˆ»ä¸º$tâ€™$</p><ol><li>$c<em>{tâ€™}=\sum</em>{t=1}^T \alpha_{tâ€™t}s_t$<ul><li>$\alpha_{tâ€™t}$ï¼šå‚æ•°ï¼Œè®­ç»ƒå¾—åˆ°ï¼Œè¡¨ç¤ºDecoderçš„$tâ€™$æ—¶åˆ»å¯¹Encoderçš„$t$æ—¶åˆ»çš„æ³¨æ„åŠ›æƒé‡</li><li>ç†è§£ï¼šEncoderçš„æ¯ä¸ªæ—¶åˆ»åŠ æƒæ±‚å’Œï¼Œå¾—åˆ°Decoderçš„$tâ€™$æ—¶åˆ»çš„è¾“å…¥</li><li>$c<em>4=\alpha</em>{41}s<em>1+\alpha</em>{42}s<em>2+â€¦+\alpha</em>{4T}s_T$</li></ul></li><li>$\alpha_{tâ€™t}$çš„$N$ä¸ªæƒé‡ç³»æ•°çš„ç”±æ¥<ul><li>æƒé‡ç³»æ•°é€šè¿‡Softmaxå‡½æ•°å¾—åˆ°ï¼Œ$\alpha<em>{tâ€™t}=\frac{exp(e</em>{tâ€™t})}{\sum<em>{k=1}^T exp(e</em>{tâ€™k})}$</li><li>$e<em>{tâ€™t}=g(s</em>{tâ€™-1},h_t)=v^T \tanh(W_ss+W_hh)$<ul><li>$e_{tâ€™t}$ï¼šç”±tæ—¶åˆ»çš„ç¼–ç å™¨éšå±‚çŠ¶æ€è¾“å‡ºå’Œtâ€™-1æ—¶åˆ»çš„è§£ç å™¨éšå±‚çŠ¶æ€è¾“å‡ºè®¡ç®—å¾—åˆ°çš„ä¸€ä¸ªå€¼</li><li>sä¸ºDecoderçš„éšå±‚è¾“å‡ºï¼Œhä¸ºEncoderçš„éšå±‚è¾“å‡º</li><li>$W_s, W_h, v$ï¼šå‚æ•°ï¼Œè®­ç»ƒå¾—åˆ°</li></ul></li></ul></li></ol>]]></content>
    
    
    <summary type="html">æŠŠè¾“å‡ºå’Œæ–°çš„è¾“å…¥æ··åˆæ¥å¤„ç†åºåˆ—æ•°æ®çš„ç½‘ç»œ</summary>
    
    
    
    <category term="DLç¬”è®°" scheme="https://www.cclmsy.cc/categories/DL%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>DLç¬”è®°3|å·ç§¯ç¥ç»ç½‘ç»œCNN</title>
    <link href="https://www.cclmsy.cc/posts/deep_learning_3.html"/>
    <id>https://www.cclmsy.cc/posts/deep_learning_3.html</id>
    <published>2025-02-21T16:00:00.000Z</published>
    <updated>2025-08-12T00:19:29.652Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€å·ç§¯ç¥ç»ç½‘ç»œåŸºç¡€"><a href="#ä¸€ã€å·ç§¯ç¥ç»ç½‘ç»œåŸºç¡€" class="headerlink" title="ä¸€ã€å·ç§¯ç¥ç»ç½‘ç»œåŸºç¡€"></a>ä¸€ã€å·ç§¯ç¥ç»ç½‘ç»œåŸºç¡€</h2><h3 id="1-1-è®¡ç®—æœºè§†è§‰ï¼ˆComputer-Visionï¼ŒCVï¼‰"><a href="#1-1-è®¡ç®—æœºè§†è§‰ï¼ˆComputer-Visionï¼ŒCVï¼‰" class="headerlink" title="1.1 è®¡ç®—æœºè§†è§‰ï¼ˆComputer Visionï¼ŒCVï¼‰"></a>1.1 è®¡ç®—æœºè§†è§‰ï¼ˆComputer Visionï¼ŒCVï¼‰</h3><p>åœ¨CVé¢†åŸŸï¼Œé€šå¸¸è¦åšçš„æ˜¯ç”¨æœºå™¨ç¨‹åºä»£æ›¿äººçœ¼å¯¹ç›®æ ‡å›¾åƒè¿›è¡Œè¯†åˆ«ã€åˆ†æã€å¤„ç†ã€‚<br>æ·±åº¦å­¦ä¹ åœ¨CVé¢†åŸŸçš„åº”ç”¨éå¸¸å¹¿æ³›ã€‚</p><p>å‡è®¾éœ€è¦å¤„ç†1024x1024çš„å½©è‰²å›¾åƒï¼Œæ¯ä¸ªåƒç´ æœ‰RGBä¸‰ä¸ªé€šé“ï¼Œå…±æœ‰1024x1024x3=3,145,728ä¸ªç‰¹å¾ã€‚<br>å‡è®¾ç¬¬ä¸€ä¸ªéšè—å±‚æœ‰10ä¸ªç¥ç»å…ƒï¼Œé‚£ä¹ˆç¬¬ä¸€å±‚çš„æƒé‡çŸ©é˜µæœ‰3,145,728x10=31,457,280ä¸ªå‚æ•°ï¼Œè®¡ç®—é‡æå¤§ï¼Œéš¾ä»¥è¾¾åˆ°å¥½çš„æ•ˆæœã€‚</p><p>ç›¸æ¯”å¤šå±‚ç¥ç»ç½‘ç»œï¼Œå·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰æ›´é€‚åˆå¤„ç†å›¾åƒæ•°æ®ã€‚</p><p>1962å¹´Hubelå’ŒWieselé€šè¿‡å¯¹çŒ«è§†è§‰çš®å±‚ç»†èƒçš„ç ”ç©¶ï¼Œæå‡ºäº†æ„Ÿå—é‡çš„æ¦‚å¿µã€‚<br>FukushimaåŸºäºæ„Ÿå—é‡æ¦‚å¿µæå‡ºçš„ç¥ç»è®¤çŸ¥æœº(Neocognitron)å¯ä»¥çœ‹ä½œæ˜¯å·ç§¯ç¥ç»ç½‘ç»œçš„ç¬¬ä¸€ä¸ªå®ç°ç½‘ç»œã€‚</p><p>å•ä¸ªæ„Ÿå—å™¨ä¸è®¸å¤šæ„Ÿè§‰ç¥ç»çº¤ç»´ç›¸è”ç³»ï¼Œæ„Ÿè§‰ä¿¡æ¯æ˜¯é€šè¿‡è®¸å¤šæ„Ÿå—ç¥ç»çº¤ç»´å‘æ”¾æ€»å’Œæ€§çš„ç©ºé—´ä¸æ—¶é—´ç±»å‹ä¸åŒçš„å†²åŠ¨ï¼Œç›¸å½“äºç»è¿‡ç¼–ç æ¥ä¼ é€’ã€‚</p><h3 id="1-2-è¾¹ç¼˜æ£€æµ‹"><a href="#1-2-è¾¹ç¼˜æ£€æµ‹" class="headerlink" title="1.2 è¾¹ç¼˜æ£€æµ‹"></a>1.2 è¾¹ç¼˜æ£€æµ‹</h3><p>ä¸ºäº†ä½¿ç”¨æ›´å°‘çš„å‚æ•°æ£€æµ‹å‡ºæ›´å¤šçš„ä¿¡æ¯ï¼Œé€šå¸¸ç¥ç»ç½‘ç»œéœ€è¦æ£€æµ‹å‡ºç‰©ä½“æœ€æ˜æ˜¾çš„å‚ç›´å’Œæ°´å¹³è¾¹ç¼˜æ¥åŒºåˆ†ç‰©ä½“ã€‚</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/è¾¹ç¼˜æ£€æµ‹.png" alt="è¾¹ç¼˜æ£€æµ‹"></p><p>éšç€æ·±åº¦å­¦ä¹ çš„å‘å±•ï¼Œæˆ‘ä»¬éœ€è¦æ£€æµ‹æ›´å¤æ‚çš„å›¾åƒä¸­çš„è¾¹ç¼˜ã€‚<br>ä¸å…¶ä½¿ç”¨ç”±äººæ‰‹å·¥è®¾è®¡çš„è¿‡æ»¤å™¨ï¼Œè¿˜å¯ä»¥å°†è¿‡æ»¤å™¨ä¸­çš„æ•°å€¼ä½œä¸ºå‚æ•°ï¼Œé€šè¿‡åå‘ä¼ æ’­æ¥å­¦ä¹ å¾—åˆ°ã€‚</p><p>ç®—æ³•å¯ä»¥æ ¹æ®å®é™…æ•°æ®æ¥é€‰æ‹©åˆé€‚çš„æ£€æµ‹ç›®æ ‡ï¼Œæ— è®ºæ˜¯æ£€æµ‹æ°´å¹³è¾¹ç¼˜ã€å‚ç›´è¾¹ç¼˜è¿˜æ˜¯å…¶ä»–è§’åº¦çš„è¾¹ç¼˜ï¼Œå¹¶ä¹ å¾—å›¾åƒçš„ä½å±‚ç‰¹å¾ã€‚</p><h2 id="äºŒã€å·ç§¯ç¥ç»ç½‘ç»œåŸç†"><a href="#äºŒã€å·ç§¯ç¥ç»ç½‘ç»œåŸç†" class="headerlink" title="äºŒã€å·ç§¯ç¥ç»ç½‘ç»œåŸç†"></a>äºŒã€å·ç§¯ç¥ç»ç½‘ç»œåŸç†</h2><h3 id="2-1-å·ç§¯ç¥ç»ç½‘ç»œçš„ç»„æˆ"><a href="#2-1-å·ç§¯ç¥ç»ç½‘ç»œçš„ç»„æˆ" class="headerlink" title="2.1 å·ç§¯ç¥ç»ç½‘ç»œçš„ç»„æˆ"></a>2.1 å·ç§¯ç¥ç»ç½‘ç»œçš„ç»„æˆ</h3><p>CNNç”±ä¸€ä¸ªæˆ–å¤šä¸ªå·ç§¯å±‚ï¼ˆConvolutionsï¼‰ã€æ± åŒ–å±‚ï¼ˆPoolingï¼‰ã€å…¨è¿æ¥å±‚ï¼ˆFull Connectionï¼‰ç»„æˆã€‚</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/CNNç»“æ„.png" alt="CNNç»“æ„"></p><p>ä¸å…¶ä»–æ·±åº¦å­¦ä¹ ç»“æ„ç›¸æ¯”ï¼ŒCNNåœ¨å›¾åƒç­‰æ–¹é¢èƒ½å¤Ÿç»™å‡ºæ›´å¥½çš„ç»“æœã€‚<br>CNNä¹Ÿå¯ä»¥ç”¨åå‘ä¼ æ’­ç®—æ³•è¿›è¡Œè®­ç»ƒã€‚<br>ä¸å…¶ä»–æµ…å±‚æˆ–æ·±å±‚ç¥ç»ç½‘ç»œç›¸æ¯”ï¼ŒCNNçš„å‚æ•°æ›´å°‘ï¼Œæ›´å®¹æ˜“è®­ç»ƒã€‚</p><h3 id="2-2-å·ç§¯å±‚ï¼ˆConvolutionsï¼‰"><a href="#2-2-å·ç§¯å±‚ï¼ˆConvolutionsï¼‰" class="headerlink" title="2.2 å·ç§¯å±‚ï¼ˆConvolutionsï¼‰"></a>2.2 å·ç§¯å±‚ï¼ˆConvolutionsï¼‰</h3><ul><li>ç›®çš„ï¼šæå–è¾“å…¥çš„ä¸åŒç‰¹å¾<ul><li>æŸäº›å·ç§¯å±‚å¯èƒ½åªèƒ½æå–ä¸€äº›ä½çº§ç‰¹å¾ï¼Œå¦‚çº¿æ¡ã€è¾¹ç¼˜ç­‰ï¼Œæ›´å¤šå±‚çš„ç½‘ç»œèƒ½ä»ä½çº§ç‰¹å¾ä¸­æå–æ›´é«˜çº§æ›´å¤æ‚çš„ç‰¹å¾ã€‚</li></ul></li><li>å‚æ•°<ul><li>sizeï¼šå·ç§¯æ ¸ï¼ˆfilterï¼‰å¤§å°ï¼Œå¦‚3x3ã€5x5ç­‰</li><li>paddingï¼š0å¡«å……ï¼Œä¿æŒè¾“å‡ºå’Œè¾“å…¥çš„å¤§å°ä¸€è‡´ï¼ŒValid/Same</li><li>strideï¼šæ­¥é•¿ï¼Œå·ç§¯æ ¸æ¯æ¬¡ç§»åŠ¨çš„è·ç¦»ï¼Œé€šå¸¸ä¸º1</li></ul></li><li>è®¡ç®—å…¬å¼<ul><li>å››ä¸ªè¶…å‚æ•°ï¼šFilteræ•°é‡$K$ã€Filterå¤§å°$F$ã€æ­¥é•¿$S$ã€0å¡«å……å¤§å°$P$</li><li>è¾“å…¥ä½“ç§¯ï¼š$H_1 \times W_1 \times D_1$</li><li>è¾“å‡ºä½“ç§¯ï¼š$H_2 \times W_2 \times D_2$<ul><li>$H_2 = \dfrac{H_1-F+2P}{S}+1$</li><li>$W_2 = \dfrac{W_1-F+2P}{S}+1$</li><li>$D_2 = K$</li></ul></li></ul></li></ul><h4 id="2-2-1-å·ç§¯è¿ç®—"><a href="#2-2-1-å·ç§¯è¿ç®—" class="headerlink" title="2.2.1 å·ç§¯è¿ç®—"></a>2.2.1 å·ç§¯è¿ç®—</h4><p>å·ç§¯è¿ç®—ï¼ˆç¬¦å·$\ast$ï¼‰ï¼šå°†ä¸€ä¸ªçŸ©é˜µï¼ˆå·ç§¯æ ¸ï¼‰åº”ç”¨åˆ°å¦ä¸€ä¸ªçŸ©é˜µçš„æ‰€æœ‰ä½ç½®ï¼Œæ±‚å‡ºæ¯ä¸ªä½ç½®çš„ç‚¹ç§¯ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„çŸ©é˜µã€‚</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/å·ç§¯è¿ç®—.png" alt="å·ç§¯è¿ç®—"></p><p>åœ¨è¿™ä¸ª6x6çš„çŸ©é˜µä¸­ï¼Œå·¦è¾¹ä¸€åŠéƒ½æ˜¯1ï¼Œå³è¾¹ä¸€åŠéƒ½æ˜¯0ï¼Œä¸­é—´æ˜¯ä¸€æ¡éå¸¸æ˜æ˜¾çš„å‚ç›´è¾¹ç¼˜ã€‚<br>ç»è¿‡å·ç§¯åï¼Œå¾—åˆ°ä¸€ä¸ª4x4çš„çŸ©é˜µï¼Œä¸­é—´çš„å€¼éå¸¸å¤§ï¼Œå…¶ä»–å€¼éå¸¸å°ï¼Œè¡¨æ˜æ£€æµ‹åˆ°äº†å‚ç›´è¾¹ç¼˜ã€‚</p><p>å·ç§¯è¿ç®—çš„äº§ç”Ÿçš„é—®é¢˜ï¼šè¾¹ç¼˜åƒç´ çš„ä¿¡æ¯ä¸¢å¤±ã€è¾“å‡ºçš„å›¾åƒå°ºå¯¸å˜å°</p><h4 id="2-2-2-padding-é›¶å¡«å……"><a href="#2-2-2-padding-é›¶å¡«å……" class="headerlink" title="2.2.2 padding-é›¶å¡«å……"></a>2.2.2 padding-é›¶å¡«å……</h4><p>åœ¨å›¾ç‰‡åƒç´ çš„æœ€å¤–å±‚åŠ ä¸Š$P$å±‚0ï¼Œä½¿å¾—å·ç§¯åçš„è¾“å‡ºå’Œè¾“å…¥çš„å°ºå¯¸ä¸€è‡´ã€‚</p><p>0å¯¹æœ€ç»ˆç»“æœä¸äº§ç”Ÿå½±å“ï¼Œé¿å…å›¾ç‰‡å¢åŠ å™ªå£°ã€‚</p><ul><li>Validå·ç§¯ï¼šä¸å¡«å……ï¼Œè¾“å‡ºå°ºå¯¸å‡å°</li><li>Sameå·ç§¯ï¼ˆä¸€èˆ¬é‡‡ç”¨ï¼‰ï¼šå¡«å……0ä»¥ç»´æŒè¾“å‡ºå°ºå¯¸ä¸åŸå›¾ä¸€è‡´</li></ul><h4 id="2-2-3-size-å·ç§¯æ ¸å¤§å°"><a href="#2-2-3-size-å·ç§¯æ ¸å¤§å°" class="headerlink" title="2.2.3 size-å·ç§¯æ ¸å¤§å°"></a>2.2.3 size-å·ç§¯æ ¸å¤§å°</h4><p>å·ç§¯æ ¸å¤§å°$F$é€šå¸¸ä¸º3x3ã€5x5ã€7x7ç­‰å¥‡æ•°ï¼Œä¿è¯èƒ½å¤Ÿç¡®å®šä¸€ä¸ªä¸­å¿ƒç‚¹ã€‚</p><p>å°å·ç§¯æ ¸å¯ä»¥ä¿ç•™æ›´å¤šçš„ä¿¡æ¯ï¼Œå¤§å·ç§¯æ ¸å¯ä»¥æ£€æµ‹æ›´å¤§çš„ç‰¹å¾ã€‚</p><h4 id="2-2-4-stride-æ­¥é•¿"><a href="#2-2-4-stride-æ­¥é•¿" class="headerlink" title="2.2.4 stride-æ­¥é•¿"></a>2.2.4 stride-æ­¥é•¿</h4><p>æ­¥é•¿$S$é€šå¸¸ä¸º1ï¼Œå³å·ç§¯æ ¸æ¯æ¬¡ç§»åŠ¨ä¸€ä¸ªåƒç´ ã€‚</p><p>æ­¥é•¿ä¸º2æ—¶ï¼Œå·ç§¯æ ¸æ¯æ¬¡ç§»åŠ¨ä¸¤ä¸ªåƒç´ ï¼Œè¾“å‡ºå°ºå¯¸å‡å°ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/2æ­¥é•¿å·ç§¯.png" alt="2æ­¥é•¿å·ç§¯"></p><h4 id="2-2-5-å¤šé€šé“å·ç§¯"><a href="#2-2-5-å¤šé€šé“å·ç§¯" class="headerlink" title="2.2.5 å¤šé€šé“å·ç§¯"></a>2.2.5 å¤šé€šé“å·ç§¯</h4><p>å½“è¾“å…¥æœ‰å¤šä¸ªé€šé“ï¼ˆChannelï¼‰æ—¶ï¼ˆä¾‹å¦‚å›¾ç‰‡å¯ä»¥æœ‰ RGB ä¸‰ä¸ªé€šé“ï¼‰ï¼Œå·ç§¯æ ¸éœ€è¦æ‹¥æœ‰ç›¸åŒçš„é€šé“æ•°</p><p>ä½†æœ€ç»ˆçš„è¾“å‡ºåªæœ‰ä¸€ä¸ªé€šé“ï¼Œå…¶ç»“æœæ˜¯å¤šä¸ªé€šé“çš„å·ç§¯ç»“æœçš„å’Œã€‚</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/å¤šé€šé“å·ç§¯.png" alt="å¤šé€šé“å·ç§¯"></p><h4 id="2-2-6-å¤šå·ç§¯æ ¸"><a href="#2-2-6-å¤šå·ç§¯æ ¸" class="headerlink" title="2.2.6 å¤šå·ç§¯æ ¸"></a>2.2.6 å¤šå·ç§¯æ ¸</h4><p>å½“æœ‰å¤šä¸ªå·ç§¯æ ¸æ—¶ï¼Œå¯ä»¥å­¦ä¹ åˆ°å¤šç§ä¸åŒçš„ç‰¹å¾ï¼Œè¾“å‡ºç»“æœçš„é€šé“æ•°ç­‰äºå·ç§¯æ ¸çš„æ•°é‡ï¼Œå¤šå·ç§¯æ ¸å¯ä»¥ç†è§£ä¸ºå¤šç¥ç»å…ƒ</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/å¤šå·ç§¯æ ¸.png" alt="å¤šå·ç§¯æ ¸"></p><h4 id="2-2-7-å·ç§¯å±‚çš„è¿ç®—ç»“æœ"><a href="#2-2-7-å·ç§¯å±‚çš„è¿ç®—ç»“æœ" class="headerlink" title="2.2.7 å·ç§¯å±‚çš„è¿ç®—ç»“æœ"></a>2.2.7 å·ç§¯å±‚çš„è¿ç®—ç»“æœ</h4><script type="math/tex; mode=display">\begin{split}&Z^{[l]} = W^{[l]} \ast A^{[l-1]} + b^{[l]} \\\\&A^{[l]} = g(Z^{[l]}) \end{split}</script><h3 id="2-3-æ± åŒ–å±‚ï¼ˆPoolingï¼‰"><a href="#2-3-æ± åŒ–å±‚ï¼ˆPoolingï¼‰" class="headerlink" title="2.3 æ± åŒ–å±‚ï¼ˆPoolingï¼‰"></a>2.3 æ± åŒ–å±‚ï¼ˆPoolingï¼‰</h3><p>æ± åŒ–å±‚ä¸»è¦å¯¹å·ç§¯å±‚çš„è¾“å‡ºè¿›è¡Œä¸‹é‡‡æ ·ï¼ˆSubsamplingï¼‰å¤„ç†ï¼Œä¸»è¦åˆ†ä¸ºï¼š</p><ul><li>æœ€å¤§æ± åŒ–ï¼ˆMax Poolingï¼‰ï¼šå–æ± åŒ–çª—å£ä¸­çš„æœ€å¤§å€¼</li><li>å¹³å‡æ± åŒ–ï¼ˆAverage Poolingï¼‰ï¼šå–æ± åŒ–çª—å£ä¸­çš„å¹³å‡å€¼</li></ul><p>æ± åŒ–é€šå¸¸ä¸º2x2çš„filterï¼Œæ­¥é•¿ä¸º2ï¼Œå³æ¯æ¬¡å–2x2çš„çª—å£ä¸­çš„æœ€å¤§å€¼æˆ–å¹³å‡å€¼ã€‚</p><p>ç‰¹ç‚¹ï¼šæ²¡æœ‰å‚æ•°ï¼Œä¸éœ€è¦å­¦ä¹ ï¼Œåªæ˜¯å¯¹è¾“å…¥æ•°æ®è¿›è¡Œç®€å•çš„å¤„ç†ã€‚</p><p>ç›®çš„ï¼šé™ä½æ•°æ®ç»´åº¦ï¼›å‡å°‘è®¡ç®—é‡ã€æé«˜è®¡ç®—é€Ÿåº¦ï¼›é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œæé«˜äº†é²æ£’æ€§ã€‚</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/æ± åŒ–å±‚.png" alt="æ± åŒ–å±‚"></p><h3 id="2-4-å…¨è¿æ¥å±‚ï¼ˆFully-Connectedï¼‰ä¸CNNç»“æ„"><a href="#2-4-å…¨è¿æ¥å±‚ï¼ˆFully-Connectedï¼‰ä¸CNNç»“æ„" class="headerlink" title="2.4 å…¨è¿æ¥å±‚ï¼ˆFully Connectedï¼‰ä¸CNNç»“æ„"></a>2.4 å…¨è¿æ¥å±‚ï¼ˆFully Connectedï¼‰ä¸CNNç»“æ„</h3><p>å…¨è¿æ¥å±‚å³æ­¤å‰æåˆ°çš„å¤šå±‚ç¥ç»ç½‘ç»œï¼Œæ¯ä¸ªç¥ç»å…ƒä¸ä¸Šä¸€å±‚çš„æ‰€æœ‰ç¥ç»å…ƒç›¸è¿ã€‚</p><p>å·ç§¯å±‚+æ¿€æ´»å±‚+æ± åŒ–å±‚å¯ä»¥çœ‹æˆæ˜¯CNNçš„ç‰¹å¾å­¦ä¹ /ç‰¹å¾æå–å±‚ï¼Œå­¦ä¹ åˆ°çš„ç‰¹å¾ï¼ˆFeature Mapï¼‰æœ€ç»ˆåº”ç”¨äºæ¨¡å‹ä»»åŠ¡ï¼ˆåˆ†ç±»ã€å›å½’ï¼‰</p><ul><li>å…ˆå¯¹æ‰€æœ‰Feature Mapè¿›è¡Œæ‰å¹³åŒ–ï¼ˆFlattenï¼‰ï¼Œå³è½¬åŒ–ä¸ºä¸€ç»´å‘é‡</li><li>å†è¿æ¥åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªå…¨è¿æ¥å±‚ï¼Œè¿›è¡Œåˆ†ç±»æˆ–å›å½’ä»»åŠ¡</li></ul><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/CNNç»“æ„2.png" alt="CNNç»“æ„2"></p><h2 id="ä¸‰ã€ç»å…¸åˆ†ç±»ç½‘ç»œç»“æ„"><a href="#ä¸‰ã€ç»å…¸åˆ†ç±»ç½‘ç»œç»“æ„" class="headerlink" title="ä¸‰ã€ç»å…¸åˆ†ç±»ç½‘ç»œç»“æ„"></a>ä¸‰ã€ç»å…¸åˆ†ç±»ç½‘ç»œç»“æ„</h2><p>é€šå¸¸é‡‡ç”¨ä»ç°æˆçš„ç»å…¸ç½‘ç»œç»“æ„è¿›è¡Œä¼˜åŒ–ï¼Œè€Œä¸æ˜¯ä»å¤´å¼€å§‹è®¾è®¡ç½‘ç»œç»“æ„ã€‚</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/ç»å…¸ç½‘ç»œç»“æ„.png" alt="ç»å…¸ç½‘ç»œç»“æ„"></p><ul><li>NINï¼šå¼•å…¥äº†1x1å·ç§¯æ ¸</li><li>VGGï¼šå‚æ•°é‡å·¨å¤§ï¼ˆ1.4äº¿ï¼‰ï¼Œ19å±‚ç½‘ç»œ</li><li>GoogleNetï¼š500ä¸‡å‚æ•°ï¼Œ22å±‚ç½‘ç»œ<ul><li>2014å¹´æ¯”èµ›å† å†›çš„modelï¼Œè¯æ˜äº†ç”¨æ›´å¤šçš„å·ç§¯ã€æ›´æ·±çš„å±‚æ¬¡å¯ä»¥å¾—åˆ°æ›´å¥½çš„ç»“æ„</li><li>å¼•å…¥äº†Inceptionæ¨¡å—ï¼Œå¤šä¸ªä¸åŒå¤§å°çš„å·ç§¯æ ¸</li></ul></li></ul><h3 id="3-1-LeNet-5"><a href="#3-1-LeNet-5" class="headerlink" title="3.1 LeNet-5"></a>3.1 LeNet-5</h3><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/LeNet5.png" alt="LeNet-5"></p><p>LeNet-5æœ€åˆçš„ç›®çš„ç”¨äºæ‰‹å†™æ•°å­—è¯†åˆ«ï¼Œå½“æ—¶ä½¿ç”¨çš„æ¿€æ´»å‡½æ•°æ˜¯Sigmoidå’ŒTanhï¼Œè¿˜æ²¡æœ‰å‡ºç°Relu</p><h4 id="å‚æ•°å½¢çŠ¶"><a href="#å‚æ•°å½¢çŠ¶" class="headerlink" title="å‚æ•°å½¢çŠ¶"></a>å‚æ•°å½¢çŠ¶</h4><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">Shape</th><th style="text-align:center">Size</th><th style="text-align:center">Params</th></tr></thead><tbody><tr><td style="text-align:center">Input</td><td style="text-align:center">(32, 32, 1)</td><td style="text-align:center">1024</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">Conv1(f=5,s=1)</td><td style="text-align:center">(28, 28, 6)</td><td style="text-align:center">4704</td><td style="text-align:center">5x5ï¼ˆå·ç§¯æ ¸å¤§å°ï¼‰x3ï¼ˆé€šé“æ•°ï¼‰x6ï¼ˆå·ç§¯æ ¸æ•°é‡ï¼‰+6ï¼ˆåç½®ï¼‰=456</td></tr><tr><td style="text-align:center">Pool1</td><td style="text-align:center">(14, 14, 6)</td><td style="text-align:center">1176</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">Conv2(f=5,s=1)</td><td style="text-align:center">(10, 10, 16)</td><td style="text-align:center">1600</td><td style="text-align:center">5x5x6x16+16=2416</td></tr><tr><td style="text-align:center">Pool2</td><td style="text-align:center">(5, 5, 16)</td><td style="text-align:center">400</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">FC3</td><td style="text-align:center">(120, 1)</td><td style="text-align:center">120</td><td style="text-align:center">400x120+120=48120</td></tr><tr><td style="text-align:center">FC4</td><td style="text-align:center">(84, 1)</td><td style="text-align:center">84</td><td style="text-align:center">120x84+84=10164</td></tr><tr><td style="text-align:center">Output:Sofmax</td><td style="text-align:center">(10, 1)</td><td style="text-align:center">10</td><td style="text-align:center">84x10+10=850</td></tr></tbody></table></div><ul><li>ä¸­é—´ç‰¹å¾å€¼çš„å¤§å°å˜åŒ–ä¸å®œè¿‡å¤§ï¼Œå¦åˆ™ä¼šå¯¼è‡´ä¿¡æ¯ä¸¢å¤±</li></ul><h3 id="3-2-AlexNet"><a href="#3-2-AlexNet" class="headerlink" title="3.2 AlexNet"></a>3.2 AlexNet</h3><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/AlexNet.png" alt="AlexNet"></p><ul><li>æ€»å‚æ•°é‡ï¼š6000ä¸‡ï¼Œ8å±‚ç¥ç»ç½‘ç»œï¼Œ5ä¸ªå·ç§¯å±‚+3ä¸ªå…¨è¿æ¥å±‚</li><li>ä½¿ç”¨äº†éçº¿æ€§æ¿€æ´»å‡½æ•°ReLU</li><li>ä½¿ç”¨Dropouté˜²æ­¢è¿‡æ‹Ÿåˆï¼Œæ•°æ®æ‰©å……</li><li>ä½¿ç”¨æ‰¹æ ‡å‡†åŒ–ï¼ˆBatch Normalizationï¼‰åŠ é€Ÿè®­ç»ƒ</li></ul><h4 id="å‚æ•°å½¢çŠ¶-1"><a href="#å‚æ•°å½¢çŠ¶-1" class="headerlink" title="å‚æ•°å½¢çŠ¶"></a>å‚æ•°å½¢çŠ¶</h4><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">Shape</th><th style="text-align:center">Size</th><th style="text-align:center">Params</th></tr></thead><tbody><tr><td style="text-align:center">Input</td><td style="text-align:center">(227, 227, 3)</td><td style="text-align:center">154,587</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">Conv1(f=11,s=4)</td><td style="text-align:center">(55, 55, 96)</td><td style="text-align:center">290,400</td><td style="text-align:center">11Ã—11Ã—3Ã—96 + 96 = 34,944</td></tr><tr><td style="text-align:center">Pool1</td><td style="text-align:center">(27, 27, 96)</td><td style="text-align:center">69,984</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">Conv2(f=5,s=1)</td><td style="text-align:center">(27, 27, 256)</td><td style="text-align:center">186,624</td><td style="text-align:center">5Ã—5Ã—48Ã—256 + 256 = 307,456ï¼ˆgroupå·ç§¯ï¼‰</td></tr><tr><td style="text-align:center">Pool2</td><td style="text-align:center">(13, 13, 256)</td><td style="text-align:center">43,264</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">Conv3(f=3,s=1)</td><td style="text-align:center">(13, 13, 384)</td><td style="text-align:center">64,896</td><td style="text-align:center">3Ã—3Ã—256Ã—384 + 384 = 885,120</td></tr><tr><td style="text-align:center">Conv4(f=3,s=1)</td><td style="text-align:center">(13, 13, 384)</td><td style="text-align:center">64,896</td><td style="text-align:center">3Ã—3Ã—192Ã—384 + 384 = 663,936ï¼ˆgroupå·ç§¯ï¼‰</td></tr><tr><td style="text-align:center">Conv5(f=3,s=1)</td><td style="text-align:center">(13, 13, 256)</td><td style="text-align:center">43,264</td><td style="text-align:center">3Ã—3Ã—192Ã—256 + 256 = 442,624ï¼ˆgroupå·ç§¯ï¼‰</td></tr><tr><td style="text-align:center">Pool3</td><td style="text-align:center">(6, 6, 256)</td><td style="text-align:center">9,216</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">FC6</td><td style="text-align:center">(4096, 1)</td><td style="text-align:center">4096</td><td style="text-align:center">6Ã—6Ã—256Ã—4096 + 4096 = 37,752,832</td></tr><tr><td style="text-align:center">FC7</td><td style="text-align:center">(4096, 1)</td><td style="text-align:center">4096</td><td style="text-align:center">4096Ã—4096 + 4096 = 16,781,312</td></tr><tr><td style="text-align:center">FC8</td><td style="text-align:center">(1000, 1)</td><td style="text-align:center">1000</td><td style="text-align:center">4096Ã—1000 + 1000 = 4,097,000</td></tr><tr><td style="text-align:center">Output:Softmax</td><td style="text-align:center">(1000, 1)</td><td style="text-align:center">1000</td><td style="text-align:center">0</td></tr></tbody></table></div><h3 id="3-3-Inceptionç»“æ„"><a href="#3-3-Inceptionç»“æ„" class="headerlink" title="3.3 Inceptionç»“æ„"></a>3.3 Inceptionç»“æ„</h3><p>Inceptionç»“æ„æ˜¯GoogleNetä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œç”±å¤šä¸ªä¸åŒå¤§å°çš„å·ç§¯æ ¸ç»„æˆï¼Œå¯ä»¥æå–ä¸åŒå°ºåº¦çš„ç‰¹å¾ã€‚</p><h4 id="3-1-MLPå·ç§¯ï¼ˆ1x1å·ç§¯ï¼‰"><a href="#3-1-MLPå·ç§¯ï¼ˆ1x1å·ç§¯ï¼‰" class="headerlink" title="3.1 MLPå·ç§¯ï¼ˆ1x1å·ç§¯ï¼‰"></a>3.1 MLPå·ç§¯ï¼ˆ1x1å·ç§¯ï¼‰</h4><p>ä¸€ç§æ–°çš„æ·±åº¦ç½‘ç»œç»“æ„Network in Networkï¼ˆNINï¼‰æå‡ºäº†MLPå·ç§¯å–ä»£ä¼ ç»Ÿçº¿æ€§å·ç§¯æ ¸</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/MLPå·ç§¯.png" alt="MLPå·ç§¯"></p><ul><li>1x1å·ç§¯æ ¸å¯¹æ¯ä¸ªåƒç´ ç‚¹çš„æ‰€æœ‰é€šé“è¿›è¡Œäº†çº¿æ€§ç»„åˆ</li><li>æ¿€æ´»å‡½æ•°å°†feature mapç”±å¤šé€šé“çš„çº¿æ€§ç»„åˆå˜ä¸ºéçº¿æ€§ç»„åˆï¼ˆä¿¡æ¯æ•´åˆï¼‰</li><li>æé«˜ç‰¹å¾æŠ½è±¡èƒ½åŠ›ï¼ˆMultilayer Perceptronï¼Œç¼©å†™MLPï¼Œå°±æ˜¯ä¸€ä¸ªå¤šå±‚ç¥ç»ç½‘ç»œï¼‰</li><li>ä¸»è¦ä½œç”¨ï¼šè°ƒæ•´é€šé“æ•°ï¼ˆå‡ç»´é™ç»´ï¼‰ã€å‡å°‘å‚æ•°é‡</li></ul><h4 id="3-2-Inceptionå±‚"><a href="#3-2-Inceptionå±‚" class="headerlink" title="3.2 Inceptionå±‚"></a>3.2 Inceptionå±‚</h4><p>ä¹Ÿç§°ç›—æ¢¦ç©ºé—´ç»“æ„ï¼‰</p><p>ç›®çš„ï¼šä»£æ›¿äººå†³å®šï¼Œä½¿ç”¨å“ªç§å·ç§¯æ ¸ï¼Œæˆ–æ˜¯éœ€è¦MaxPoolå±‚ï¼Œç”±ç½‘ç»œè‡ªå·±å­¦ä¹ å¯»æ‰¾åˆé€‚çš„ç»“æ„ï¼ŒèŠ‚çœè®¡ç®—</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/Inceptionå±‚.png" alt="Inceptionå±‚"></p><p>æä¾›ä»¥ä¸‹4ç§ä¸åŒçš„å·ç§¯æ ¸ï¼š</p><ul><li>1x1å·ç§¯æ ¸ï¼ˆ64ä¸ªï¼‰</li><li>3x3å·ç§¯æ ¸ï¼ˆ128ä¸ªï¼‰ï¼Œpadding=same</li><li>5x5å·ç§¯æ ¸ï¼ˆ32ä¸ªï¼‰ï¼Œpadding=same</li><li>2x2æœ€å¤§æ± åŒ–ï¼ˆ32ä¸ªï¼‰ï¼Œstride=1ï¼Œpadding=same</li><li>æœ€ç»ˆç»“æœä¸ºè¿™4ç§å·ç§¯æ ¸çš„æ‹¼æ¥ï¼Œ27x27x256ï¼Œä½¿ç”¨æ›´å°‘çš„å‚æ•°è¾¾åˆ°å’ŒAlexNetç›¸å½“çš„æ•ˆæœ</li></ul><h4 id="3-3-Inceptionæ”¹è¿›"><a href="#3-3-Inceptionæ”¹è¿›" class="headerlink" title="3.3 Inceptionæ”¹è¿›"></a>3.3 Inceptionæ”¹è¿›</h4><p>ä¸Šä¸€èŠ‚ä¸­ï¼Œè®¡ç®—é‡è¿˜æ˜¯å¤ªå¤§ï¼Œå‚æ•°è¿˜æ˜¯å¤ªå¤šï¼Œéœ€è¦è¿›ä¸€æ­¥æ”¹è¿›ã€‚ä»¥5x5å·ç§¯æ ¸ä¸ºä¾‹ï¼š</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/Inceptionæ”¹è¿›.png" alt="Inceptionæ”¹è¿›"></p><ul><li>ä¸Šé¢ä¸ºåŸæ–¹æ³•ï¼Œå‚æ•°ï¼š$5\times5\times192\times32=153600$</li><li>ä¸‹é¢ä¸ºæ”¹è¿›æ–¹æ³•ï¼Œç½‘ç»œç¼©å°åå†æ‰©å¤§ï¼Œå‚æ•°ï¼š$1\times1\times192\times16+5\times5\times16\times32=15872$</li></ul><h4 id="3-4-GoogleNet"><a href="#3-4-GoogleNet" class="headerlink" title="3.4 GoogleNet"></a>3.4 GoogleNet</h4><p>Inceptionæ¨¡å—çš„å †å ï¼Œå½¢æˆGoogleNetç½‘ç»œç»“æ„</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/Inceptionæ¨¡å—.png" alt="Inceptionæ¨¡å—"></p><p>è¯¦ç»†ç»“æ„ç•¥</p><h2 id="å››ã€å·ç§¯ç¥ç»ç½‘ç»œå®æˆ˜æŠ€å·§"><a href="#å››ã€å·ç§¯ç¥ç»ç½‘ç»œå®æˆ˜æŠ€å·§" class="headerlink" title="å››ã€å·ç§¯ç¥ç»ç½‘ç»œå®æˆ˜æŠ€å·§"></a>å››ã€å·ç§¯ç¥ç»ç½‘ç»œå®æˆ˜æŠ€å·§</h2><h3 id="4-1-å­¦ä¹ ç‰¹å¾å¯è§†åŒ–"><a href="#4-1-å­¦ä¹ ç‰¹å¾å¯è§†åŒ–" class="headerlink" title="4.1 å­¦ä¹ ç‰¹å¾å¯è§†åŒ–"></a>4.1 å­¦ä¹ ç‰¹å¾å¯è§†åŒ–</h3><p>å¯ä»¥å°†ç½‘ç»œå­¦ä¹ è¿‡ç¨‹ä¸­äº§ç”Ÿçš„ç‰¹å¾å›¾å¯è§†åŒ–å‡ºæ¥ï¼Œå¹¶ä¸”å¯¹æ¯”åŸå›¾æ¥çœ‹çœ‹æ¯ä¸€å±‚éƒ½å¹²äº†ä»€ä¹ˆ</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/LeNet5ä¾‹.webp" alt="LeNet5ä¾‹"></p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/å­¦ä¹ ç‰¹å¾å¯è§†åŒ–.png" alt="å­¦ä¹ ç‰¹å¾å¯è§†åŒ–"></p><ul><li>Layer1,2ï¼šé¢œè‰²ã€è¾¹ç¼˜ç­‰åŸºæœ¬ç‰¹å¾</li><li>Layer3ï¼šçº¹ç†ã€å½¢çŠ¶ç­‰ä¸­çº§ç‰¹å¾</li><li>Layer4ï¼šç¨å¤æ‚çš„ç‰¹å¾ï¼Œå¦‚ç‹—çš„å¤´éƒ¨å½¢çŠ¶</li><li>Layer5ï¼šé«˜çº§ç‰¹å¾ï¼Œå¦‚å…³é”®æ€§åŒºåˆ†ç‰¹å¾</li></ul><h3 id="4-2-è¿ç§»å­¦ä¹ ï¼ˆTransfer-Learningï¼‰"><a href="#4-2-è¿ç§»å­¦ä¹ ï¼ˆTransfer-Learningï¼‰" class="headerlink" title="4.2 è¿ç§»å­¦ä¹ ï¼ˆTransfer Learningï¼‰"></a>4.2 è¿ç§»å­¦ä¹ ï¼ˆTransfer Learningï¼‰</h3><p>å¦‚æœéœ€è¦åšä¸€ä¸ªå…·ä½“åœºæ™¯çš„è®¡ç®—æœºè§†è§‰ä»»åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨å·²ç»è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œç„¶ååœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œå¾®è°ƒã€‚</p><h4 id="4-2-1-ä»‹ç»"><a href="#4-2-1-ä»‹ç»" class="headerlink" title="4.2.1 ä»‹ç»"></a>4.2.1 ä»‹ç»</h4><p>è¿ç§»å­¦ä¹ å°±æ˜¯åˆ©ç”¨æ•°æ®ã€ä»»åŠ¡æˆ–æ¨¡å‹ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼ˆä¾‹å¦‚éƒ½æ˜¯å›¾åƒåˆ†ç±»ä»»åŠ¡ï¼‰ï¼Œå°†åœ¨æ—§çš„é¢†åŸŸå­¦ä¹ è¿‡æˆ–è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œåº”ç”¨äºæ–°çš„é¢†åŸŸçš„è¿‡ç¨‹ã€‚</p><p>ä»ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢è€ƒè™‘è®­ç»ƒæ¨¡å‹çš„ç°å®é—®é¢˜ï¼š</p><ol><li>æ•°æ®é›†å¤§å°ï¼šå¦‚æœæ–°ä»»åŠ¡çš„æ•°æ®é›†å¾ˆå°ï¼Œè¿ç§»å­¦ä¹ å¯ä»¥å¸®åŠ©æé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›<ul><li>å¦‚æœæœ‰æµ·é‡çš„æ•°æ®é›†æ”¯æŒï¼Œå¯ä»¥ä¸éœ€è¦è¿ç§»å­¦ä¹ ï¼Œç›´æ¥ä»æµ·é‡æ•°æ®ä¸­è®­ç»ƒå‡ºä¸€ä¸ªå­¦ä¹ åˆ°ä¸€ä¸ªé²æ£’æ€§å¾ˆå¼ºçš„æ¨¡å‹</li><li>ä½†æ˜¯ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œéœ€è¦ç ”ç©¶çš„é¢†åŸŸæ•°æ®é›†éå¸¸æœ‰é™ï¼Œå¯¼è‡´æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›æå·®</li></ul></li><li>è®­ç»ƒæˆæœ¬ï¼šä»å¤´å¼€å§‹è®­ç»ƒä¸€ä¸ªCNNæ¨¡å‹éœ€è¦å¤§é‡çš„æ—¶é—´å’Œè®¡ç®—èµ„æº</li></ol><h4 id="4-2-2-å¾®è°ƒï¼ˆFine-tuningï¼‰"><a href="#4-2-2-å¾®è°ƒï¼ˆFine-tuningï¼‰" class="headerlink" title="4.2.2 å¾®è°ƒï¼ˆFine-tuningï¼‰"></a>4.2.2 å¾®è°ƒï¼ˆFine-tuningï¼‰</h4><p>åœ¨ä¸€ä¸ªå·²ç»è®­ç»ƒå¥½çš„æ¨¡å‹ï¼ˆPre-trained Modelï¼‰ä¸Šè¿›è¡Œé’ˆå¯¹æ€§ä¼˜åŒ–ï¼Œä»¥æå‡æ¨¡å‹åœ¨ç‰¹å®šä»»åŠ¡ä¸Šçš„æ€§èƒ½ã€‚</p><p>å‡è®¾æœ‰ä¸¤ä¸ªä»»åŠ¡$A$å’Œ$B$ã€‚<br>ä»»åŠ¡$A$æ‹¥æœ‰æµ·é‡æ•°æ®ï¼Œä»¥$a$ä¸ºæ¡ä»¶åŒºåˆ†1000ä¸ªç±»åˆ«ï¼Œå·²ç»è®­ç»ƒå¥½äº†ä¸€ä¸ªæ¨¡å‹ã€‚<br>ç›®æ ‡ä»»åŠ¡ä¸º$B$ï¼Œä»¥$b$ä¸ºæ¡ä»¶åŒºåˆ†250ä¸ªç±»åˆ«ï¼Œæ•°æ®é›†å¾ˆå°ã€‚</p><p>æ­¥éª¤ï¼š</p><ol><li>åœ¨$A$æ¨¡å‹çš„åŸºç¡€ä¸Šï¼Œå°†æœ€åä¸€å±‚çš„è¾“å‡ºå±‚æ›¿æ¢ä¸º250ä¸ªç±»åˆ«çš„è¾“å‡ºå±‚ï¼Œä¿æŒå‰é¢çš„å‚æ•°ä¸å˜</li><li>æ ¹æ®æ•°æ®é‡ï¼Œå†³å®šæ˜¯å¦å†»ç»“ï¼ˆFreezeï¼‰å‰é¢çš„å±‚ï¼ˆæƒé‡ä¸å˜ï¼‰ï¼Œåªè®­ç»ƒæœ€åè‹¥å¹²å±‚å¹¶æ›´æ–°å‚æ•°<ul><li>æ•°æ®è¶Šå¤šï¼Œå°±ä¿ç•™è¶Šå¤šçš„å±‚ï¼Œä»åå¾€å‰é€æ¸è§£å†»</li><li>æ•°æ®å¾ˆå°‘ï¼Œåªä¿ç•™è¾“å‡ºå±‚ï¼Œå…¶ä»–å±‚å…¨éƒ¨è§£å†»</li></ul></li><li>é‡æ–°è®­ç»ƒæ¨¡å‹</li></ol>]]></content>
    
    
    <summary type="html">åˆ©ç”¨å·ç§¯è¿ç®—å¤„ç†å›¾åƒæ•°æ®æå–ç‰¹å¾çš„ç½‘ç»œ</summary>
    
    
    
    <category term="DLç¬”è®°" scheme="https://www.cclmsy.cc/categories/DL%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>Pytorch|Dataset&amp;DataLoader</title>
    <link href="https://www.cclmsy.cc/posts/dataset&amp;dataloader.html"/>
    <id>https://www.cclmsy.cc/posts/dataset&amp;dataloader.html</id>
    <published>2025-02-21T16:00:00.000Z</published>
    <updated>2025-07-18T12:42:11.061Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Dataset-æ•°æ®é›†"><a href="#Dataset-æ•°æ®é›†" class="headerlink" title="Dataset æ•°æ®é›†"></a>Dataset æ•°æ®é›†</h2><p>Pytorchä¸­è¡¨ç¤ºæ•°æ®é›†çš„æŠ½è±¡ç±»//</p><p>ä»»ä½•è‡ªå®šä¹‰çš„æ•°æ®é›†éƒ½éœ€è¦ç»§æ‰¿è¿™ä¸ªç±»å¹¶è¦†å†™ç›¸å…³æ–¹æ³•</p><p>Datasetçš„æè¿°ï¼š</p><blockquote><p>æ‰€æœ‰è¡¨ç¤ºä»é”®åˆ°æ•°æ®æ ·æœ¬çš„æ˜ å°„çš„æ•°æ®é›†éƒ½åº”ç»§æ‰¿å®ƒã€‚<br>æ‰€æœ‰å­ç±»éƒ½åº”è¦†å†™<strong>getitem</strong>ï¼Œä»¥æ”¯æŒè·å–ç»™å®šé”®çš„æ•°æ®æ ·æœ¬ã€‚<br>å­ç±»è¿˜å¯ä»¥é€‰æ‹©æ€§åœ°è¦†ç›–<strong>len</strong>ï¼Œè®¸å¤š~torch.utils.data.Samplerç±»å®ç°å’Œ~torch.utils.data.DataLoaderç±»çš„é»˜è®¤é€‰é¡¹éƒ½å¸Œæœ›å®ƒè¿”å›æ•°æ®é›†çš„å¤§å°ã€‚<br>å­ç±»ä¹Ÿå¯ä»¥é€‰æ‹©å®ç°<strong>getitems</strong>ï¼Œä»¥åŠ å¿«æˆæ‰¹æ ·æœ¬çš„åŠ è½½é€Ÿåº¦ã€‚<br>æ­¤æ–¹æ³•æ¥å—æ‰¹æ¬¡æ ·æœ¬çš„ç´¢å¼•åˆ—è¡¨ï¼Œå¹¶è¿”å›æ ·æœ¬åˆ—è¡¨ã€‚</p></blockquote><p>å‡è®¾éœ€è¦åŠ è½½çš„æ˜¯å½“å‰ç›®å½•ä¸‹<code>images</code>æ–‡ä»¶å¤¹ä¸­çš„42å¼ pngå›¾ç‰‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset, DataLoader</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyDataset</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, path, processor=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Datasetç±»çš„åˆå§‹åŒ–æ–¹æ³•</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            path: æ•°æ®è·¯å¾„åˆ—è¡¨</span></span><br><span class="line"><span class="string">            processor: æ•°æ®é¢„å¤„ç†çš„å‡½æ•°ï¼Œf:æ•°æ®è·¯å¾„-&gt;ç›®æ ‡æ•°æ®</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        self.path = path</span><br><span class="line">        self.processor = processor</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;è¿”å›æ•°æ®é›†çš„å¤§å°&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.path)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, idx</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ ¹æ®ç´¢å¼•è¿”å›å¤„ç†åçš„æ•°æ®&quot;&quot;&quot;</span></span><br><span class="line">        data_path = self.path[idx]</span><br><span class="line">        data = self.processor(data_path)</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">processor</span>(<span class="params">data_path</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;é¢„å¤„ç†å‡½æ•°ï¼Œè¿™é‡Œ&quot;&quot;&quot;</span></span><br><span class="line">    img = Image.<span class="built_in">open</span>(data_path).size</span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_images_path</span>(<span class="params">data_dir</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è·å–data_dirç›®å½•ä¸‹æ‰€æœ‰pngå›¾ç‰‡çš„è·¯å¾„ï¼Œä¸å«å­ç›®å½•&quot;&quot;&quot;</span></span><br><span class="line">    images_path = [os.path.join(data_dir,image)</span><br><span class="line">                   <span class="keyword">for</span> image <span class="keyword">in</span> os.listdir(data_dir)</span><br><span class="line">                   <span class="keyword">if</span> image.endswith(<span class="string">&#x27;.png&#x27;</span>)]</span><br><span class="line">    <span class="keyword">return</span> images_path</span><br><span class="line"></span><br><span class="line">data_dir = <span class="string">&#x27;images&#x27;</span> <span class="comment"># æ•°æ®ç›®å½•</span></span><br><span class="line">images_path = get_images_path(data_dir) <span class="comment"># è·å–æ•°æ®è·¯å¾„</span></span><br><span class="line">dataset = MyDataset(images_path, processor=processor) <span class="comment"># åˆ›å»ºæ•°æ®é›†</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dataset[<span class="number">0</span>]) <span class="comment"># æ‰“å°ç¬¬ä¸€ä¸ªæ•°æ®</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(dataset)) <span class="comment"># æ‰“å°æ•°æ®é›†å¤§å°</span></span><br></pre></td></tr></table></figure><pre><code>(367, 126)42</code></pre><h2 id="DataLoader-æ•°æ®è¿­ä»£å™¨"><a href="#DataLoader-æ•°æ®è¿­ä»£å™¨" class="headerlink" title="DataLoader æ•°æ®è¿­ä»£å™¨"></a>DataLoader æ•°æ®è¿­ä»£å™¨</h2><p>PytorchåŠ è½½å’Œå¤„ç†æ•°æ®é›†çš„å¯è¿­ä»£å¯¹è±¡//</p><div class="table-container"><table><thead><tr><th style="text-align:center">å‚æ•°</th><th style="text-align:center">Default</th><th style="text-align:center">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center">dataset</td><td style="text-align:center">å¿…é€‰</td><td style="text-align:center">ç”¨äºåŠ è½½æ•°æ®çš„æ•°æ®é›†<br>å¿…é¡»æ˜¯torch.utils.data.Datasetçš„å­ç±»å®ä¾‹</td></tr><tr><td style="text-align:center">batch_size</td><td style="text-align:center">1</td><td style="text-align:center">æ¯ä¸ªbatchçš„æ ·æœ¬æ•°</td></tr><tr><td style="text-align:center">shuffle</td><td style="text-align:center">False</td><td style="text-align:center">æ˜¯å¦åœ¨æ¯ä¸ªepochå¼€å§‹æ—¶æ‰“ä¹±æ•°æ®</td></tr><tr><td style="text-align:center">sampler</td><td style="text-align:center">None</td><td style="text-align:center">å®šä¹‰ä»æ•°æ®é›†ä¸­æå–æ ·æœ¬çš„ç­–ç•¥<br>å¦‚æœæŒ‡å®šè¿™ä¸ªå‚æ•°ï¼Œåˆ™å¿½ç•¥shuffleå‚æ•°</td></tr><tr><td style="text-align:center">batch_sampler</td><td style="text-align:center">None</td><td style="text-align:center">ä¸samplerç±»ä¼¼ï¼Œä½†è¿”å›çš„æ˜¯ä¸€ä¸ªbatchçš„ç´¢å¼•<br>ä¸èƒ½ä¸batch_sizeã€shuffleã€sampleråŒæ—¶ä½¿ç”¨</td></tr><tr><td style="text-align:center">num_workers</td><td style="text-align:center">0</td><td style="text-align:center">ç”¨äºæ•°æ®åŠ è½½çš„å­è¿›ç¨‹æ•°</td></tr><tr><td style="text-align:center">collate_fn</td><td style="text-align:center">None</td><td style="text-align:center">å°†å¤šä¸ªæ ·æœ¬ç»„åˆæˆä¸€ä¸ªmini-batchçš„å‡½æ•°</td></tr><tr><td style="text-align:center">drop_last</td><td style="text-align:center">False</td><td style="text-align:center">å¦‚æœæ•°æ®é›†å¤§å°ä¸èƒ½è¢«batch_sizeæ•´é™¤ï¼Œæ˜¯å¦ä¸¢å¼ƒæœ€åä¸€ä¸ªä¸å®Œæ•´çš„batch</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line">data_loader = DataLoader(dataset,batch_size=<span class="number">5</span>,shuffle=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">for</span> data <span class="keyword">in</span> data_loader:</span><br><span class="line">        <span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure><pre><code>[tensor([1866,  439,  970, 1378, 1416]), tensor([660, 159, 354, 554, 498])][tensor([2018, 1116, 1720,  812, 1500]), tensor([ 968,  556, 1302,  465, 1168])][tensor([2260, 1378, 1046, 1774, 1521]), tensor([648, 612, 514, 524, 375])][tensor([ 956,  962,  412, 1700,  978]), tensor([530, 542, 640, 904, 465])][tensor([1202, 1434, 1686, 1583, 3873]), tensor([1006,  598,  540,  844, 5041])][tensor([1402, 1824, 1580, 1422, 1638]), tensor([1414, 1454,  630,  570, 1044])][tensor([1944, 1390, 1408,  367, 1320]), tensor([592, 568, 864, 126, 364])][tensor([1983, 1844,  912, 1400, 1564]), tensor([482, 866, 501, 602, 514])][tensor([1144, 1594]), tensor([718, 494])]</code></pre>]]></content>
    
    
    <summary type="html">Pytorchä¸­çš„æ•°æ®å¤„ç†ç±»</summary>
    
    
    
    <category term="DLç¬”è®°" scheme="https://www.cclmsy.cc/categories/DL%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Pytorch" scheme="https://www.cclmsy.cc/tags/Pytorch/"/>
    
  </entry>
  
  <entry>
    <title>DLç¬”è®°2|æ”¹å–„æ·±å±‚ç¥ç»ç½‘ç»œ</title>
    <link href="https://www.cclmsy.cc/posts/deep_learning_2.html"/>
    <id>https://www.cclmsy.cc/posts/deep_learning_2.html</id>
    <published>2025-02-20T16:00:00.000Z</published>
    <updated>2025-07-20T12:54:24.596Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€ç¥ç»ç½‘ç»œå®è·µç›¸å…³"><a href="#ä¸€ã€ç¥ç»ç½‘ç»œå®è·µç›¸å…³" class="headerlink" title="ä¸€ã€ç¥ç»ç½‘ç»œå®è·µç›¸å…³"></a>ä¸€ã€ç¥ç»ç½‘ç»œå®è·µç›¸å…³</h2><h3 id="1-1-æ•°æ®é›†åˆ’åˆ†"><a href="#1-1-æ•°æ®é›†åˆ’åˆ†" class="headerlink" title="1.1 æ•°æ®é›†åˆ’åˆ†"></a>1.1 æ•°æ®é›†åˆ’åˆ†</h3><p>æ•°æ®é›†ï¼š</p><ul><li>è®­ç»ƒé›†ï¼ˆTraining Setï¼‰ï¼šç”¨äºæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹</li><li>éªŒè¯é›†ï¼ˆValidation Setï¼‰ï¼šåˆ©ç”¨éªŒè¯é›†ï¼ˆåˆç§°ä¸ºç®€å•äº¤å‰éªŒè¯é›†ï¼Œhold-out cross validation setï¼‰è¿›è¡Œäº¤å‰éªŒè¯ï¼Œé€‰æ‹©å‡ºæœ€å¥½çš„æ¨¡å‹</li><li>æµ‹è¯•é›†ï¼ˆTest Setï¼‰ï¼šç”¨äºè¯„ä¼°æ¨¡å‹çš„èƒ½åŠ›</li></ul><p>æ•°æ®é›†åˆ’åˆ†æ¯”ä¾‹ï¼š</p><ul><li>å°æ•°æ®é‡ï¼ˆå°äº10ä¸‡ï¼‰æ¯”ä¾‹ï¼šæ— éªŒè¯é›†7:3ï¼Œæœ‰éªŒè¯é›†6:2:2</li><li>å¤§æ•°æ®é‡æ¯”ä¾‹ï¼š98:1:1ã€99.5:0.25:0.25ã€99.5:0.4:0.1</li></ul><h3 id="1-2-åå·®å’Œæ–¹å·®"><a href="#1-2-åå·®å’Œæ–¹å·®" class="headerlink" title="1.2 åå·®å’Œæ–¹å·®"></a>1.2 åå·®å’Œæ–¹å·®</h3><p>â€œåå·®-æ–¹å·®åˆ†è§£â€ï¼ˆbias-variance decompositionï¼‰æ˜¯è§£é‡Šå­¦ä¹ ç®—æ³•æ³›åŒ–æ€§èƒ½çš„ä¸€ç§é‡è¦å·¥å…·ã€‚</p><p>æ³›åŒ–è¯¯å·®å¯åˆ†è§£ä¸ºåå·®ã€æ–¹å·®ä¸å™ªå£°ï¼Œæ³›åŒ–æ€§èƒ½æ˜¯ç”±å­¦ä¹ ç®—æ³•çš„èƒ½åŠ›ã€æ•°æ®çš„å……åˆ†æ€§ä»¥åŠå­¦ä¹ ä»»åŠ¡æœ¬èº«çš„éš¾åº¦æ‰€å…±åŒå†³å®šçš„ã€‚</p><ul><li>åå·®ï¼ˆBiasï¼‰ï¼šåº¦é‡å­¦ä¹ ç®—æ³•çš„æœŸæœ›é¢„æµ‹ä¸çœŸå®ç»“æœçš„åç¦»ç¨‹åº¦ï¼Œåæ˜ äº†<strong>æ¨¡å‹æœ¬èº«çš„æ‹Ÿåˆèƒ½åŠ›</strong></li><li>æ–¹å·®ï¼ˆVarianceï¼‰ï¼šåº¦é‡åŒæ ·å¤§å°çš„è®­ç»ƒé›†çš„å˜åŠ¨æ‰€å¯¼è‡´çš„å­¦ä¹ æ€§èƒ½çš„å˜åŒ–ï¼Œåæ˜ äº†<strong>æ¨¡å‹çš„ç¨³å®šæ€§</strong></li><li>å™ªå£°ï¼šå½“å‰ä»»åŠ¡ä¸‹ä»»ä½•å­¦ä¹ ç®—æ³•æ‰€èƒ½è¾¾åˆ°çš„æœŸæœ›æ³›åŒ–è¯¯å·®çš„ä¸‹ç•Œï¼Œåæ˜ äº†<strong>é—®é¢˜æœ¬èº«çš„éš¾åº¦</strong></li></ul><p>åå·®ã€æ–¹å·®ä¸æ•°æ®é›†åˆ’åˆ†çš„å…³ç³»åŠè§£å†³æ–¹æ³•ï¼š</p><ol><li>è®­ç»ƒé›†é”™è¯¯ç‡å°ã€æµ‹è¯•é›†é”™è¯¯ç‡å¤§ï¼šé«˜æ–¹å·®ï¼Œå¯èƒ½å‡ºç°äº†<strong>è¿‡æ‹Ÿåˆ</strong><ul><li>å¢å¤§æ•°æ®é›†ï¼Œä½¿è®­ç»ƒå°½å¯èƒ½åŒ…å«æ‰€æœ‰æƒ…å†µ</li><li>å¯»æ‰¾æ›´åˆé€‚çš„ç½‘ç»œç»“æ„</li><li>æ­£åˆ™åŒ–</li></ul></li><li>è®­ç»ƒé›†é”™è¯¯ç‡å¤§ã€æµ‹è¯•é›†é”™è¯¯ç‡å¤§ï¼šé«˜åå·®ï¼Œå¯èƒ½å‡ºç°äº†<strong>æ¬ æ‹Ÿåˆ</strong><ul><li>æ‰©å¤§ç½‘ç»œè§„æ¨¡ï¼Œä¾‹å¦‚å¢åŠ éšè—å±‚æˆ–ç¥ç»å…ƒæ•°é‡</li><li>å¯»æ‰¾æ›´åˆé€‚çš„ç½‘ç»œç»“æ„ï¼Œä½¿ç”¨æ›´å¤§çš„ç½‘ç»œ</li><li>å¢åŠ è®­ç»ƒæ—¶é—´ã€è¿­ä»£æ¬¡æ•°</li></ul></li><li>è®­ç»ƒé›†é”™è¯¯ç‡å°ã€æµ‹è¯•é›†é”™è¯¯ç‡å°ï¼šæ–¹å·®å’Œåå·®éƒ½å°ï¼Œæ¨¡å‹æ•ˆæœè¾ƒå¥½</li></ol><h3 id="1-3-é€»è¾‘å›å½’çš„L1å’ŒL2æ­£åˆ™åŒ–"><a href="#1-3-é€»è¾‘å›å½’çš„L1å’ŒL2æ­£åˆ™åŒ–" class="headerlink" title="1.3 é€»è¾‘å›å½’çš„L1å’ŒL2æ­£åˆ™åŒ–"></a>1.3 é€»è¾‘å›å½’çš„L1å’ŒL2æ­£åˆ™åŒ–</h3><p><strong>æ­£åˆ™åŒ–ï¼ˆRegularizationï¼‰</strong>ï¼šåœ¨æˆæœ¬å‡½æ•°ä¸­åŠ å…¥ä¸€ä¸ªæ­£åˆ™åŒ–é¡¹ï¼ˆæƒ©ç½šé¡¹ï¼‰ï¼Œæƒ©ç½šæ¨¡å‹çš„å¤æ‚åº¦ï¼Œé˜²æ­¢ç½‘ç»œè¿‡æ‹Ÿåˆ</p><p>é€»è¾‘å›å½’ä¸­ï¼Œå‚æ•°$W$çš„æ•°é‡ç”±ç‰¹å¾æ•°å†³å®šï¼Œæ­£åˆ™åŒ–å¦‚ä¸‹ï¼š</p><ul><li>L1æ­£åˆ™åŒ–ï¼š$J(W,b) = \dfrac{1}{m}\sum\limits_{i=1}^{m}L(\hat{y}^{(i)},y^{(i)})+\dfrac{\lambda}{2m}||W||_1$</li><li>L2æ­£åˆ™åŒ–ï¼š$J(W,b) = \dfrac{1}{m}\sum\limits_{i=1}^{m}L(\hat{y}^{(i)},y^{(i)})+\dfrac{\lambda}{2m}||W||_2^2$<ul><li>L2èŒƒæ•°ï¼š$\dfrac{\lambda}{2m}||W||<em>2^2 = \dfrac{\lambda}{2m}\sum\limits</em>{i=1}^{n}W_i^2=\dfrac{\lambda}{2m}W^TW$</li><li>è§£é‡Šï¼šæ‰€æœ‰Wå‚æ•°çš„å¹³æ–¹å’Œ</li></ul></li></ul><p>æ­£åˆ™åŒ–å› å­$\lambda$ï¼šè¶…å‚æ•°ï¼Œæ§åˆ¶æ­£åˆ™åŒ–é¡¹çš„æƒé‡ï¼Œ$\lambda$è¶Šå¤§ï¼Œæ­£åˆ™åŒ–é¡¹çš„å½±å“è¶Šå¤§ï¼Œæ¨¡å‹è¶Šç®€å•ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</p><p>L1æ­£åˆ™åŒ–åï¼Œ$W$çš„æŸäº›å‚æ•°ä¼šå˜ä¸º0ï¼Œä½¿æ¨¡å‹å˜ç¨€ç–ï¼Œå› æ­¤L2æ­£åˆ™åŒ–æ›´å¸¸ç”¨ã€‚</p><p>æ¢¯åº¦ä¸‹é™çš„ç›®çš„æ˜¯å‡å°æŸå¤±å‡½æ•°$J(W,b)$å€¼çš„å¤§å°ã€‚<br>åœ¨æŸå¤±å‡½æ•°ä¸­å¢åŠ äº†ä¸€é¡¹ï¼Œå¯¼è‡´$dW$å¢å¤§ï¼Œ$W$å‡å°çš„æ›´å¤šï¼ˆå¤šå‡å»ä¸€é¡¹ï¼‰ï¼Œå› æ­¤L2èŒƒæ•°ä¹Ÿç§°ä¸ºæƒé‡è¡°å‡ï¼ˆWeight Decayï¼‰ã€‚</p><h3 id="1-4-ç¥ç»ç½‘ç»œä¸­çš„L2æ­£åˆ™åŒ–ã€FrobeniusèŒƒæ•°"><a href="#1-4-ç¥ç»ç½‘ç»œä¸­çš„L2æ­£åˆ™åŒ–ã€FrobeniusèŒƒæ•°" class="headerlink" title="1.4 ç¥ç»ç½‘ç»œä¸­çš„L2æ­£åˆ™åŒ–ã€FrobeniusèŒƒæ•°"></a>1.4 ç¥ç»ç½‘ç»œä¸­çš„L2æ­£åˆ™åŒ–ã€FrobeniusèŒƒæ•°</h3><p>å¯¹æ¯ä¸€å±‚çš„æƒé‡çŸ©é˜µ$W^{[l]}$è¿›è¡Œæ­£åˆ™åŒ–ï¼Œæ¯ä¸€å±‚éƒ½æœ‰è‹¥å¹²ä¸ªæƒé‡ï¼Œå¯ä»¥ç†è§£ä¸ºçŸ©é˜µ</p><script type="math/tex; mode=display">J(W^{[1]},b^{[1]},...,W^{[L]},b^{[L]}) = \dfrac{1}{m}\sum\limits_{i=1}^{m}L(\hat{y}^{(i)},y^{(i)})+\dfrac{\lambda}{2m}\sum\limits_{l=1}^{L}||W^{[l]}||_F^2</script><p>å…¶ä¸­ï¼Œ$||W^{[l]}||_F^2$ä¸ºFrobeniusèŒƒæ•°ï¼Œè¡¨ç¤ºçŸ©é˜µçš„æ‰€æœ‰å…ƒç´ çš„å¹³æ–¹å’Œã€‚</p><h3 id="1-5-æ­£åˆ™åŒ–å‡å°‘è¿‡æ‹Ÿåˆçš„åŸç†"><a href="#1-5-æ­£åˆ™åŒ–å‡å°‘è¿‡æ‹Ÿåˆçš„åŸç†" class="headerlink" title="1.5 æ­£åˆ™åŒ–å‡å°‘è¿‡æ‹Ÿåˆçš„åŸç†"></a>1.5 æ­£åˆ™åŒ–å‡å°‘è¿‡æ‹Ÿåˆçš„åŸç†</h3><p>æ­£åˆ™åŒ–å› å­è®¾ç½®çš„è¶³å¤Ÿå¤§çš„æƒ…å†µä¸‹ï¼Œä¸ºäº†ä½¿æŸå¤±å‡½æ•°æœ€å°åŒ–ï¼Œæƒé‡çŸ©é˜µä¼šè¶‹å‘äº0ï¼Œå‰Šå¼±éšè—å±‚å½±å“ï¼Œä½¿å¾—æ¨¡å‹å˜å¾—ç®€å•ã€‚</p><p>é€‰å–ä¸€ä¸ªé€‚åˆçš„$\lambda$ï¼Œå¯ä»¥ä½¿å¾—æ¨¡å‹çš„å¤æ‚åº¦é€‚ä¸­ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</p><h3 id="1-6-Dropoutæ­£åˆ™åŒ–"><a href="#1-6-Dropoutæ­£åˆ™åŒ–" class="headerlink" title="1.6 Dropoutæ­£åˆ™åŒ–"></a>1.6 Dropoutæ­£åˆ™åŒ–</h3><p>Dropoutæ­£åˆ™åŒ–ï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œéšæœºå…³é—­ä¸€äº›ç¥ç»å…ƒï¼Œå‡å°‘ç¥ç»å…ƒä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</p><p>Inverted Dropoutï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå¯¹æ¯ä¸€å±‚çš„ç¥ç»å…ƒï¼Œä»¥æ¦‚ç‡$keep_prob$ä¿ç•™ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">keep_prob = <span class="number">0.8</span>  <span class="comment"># ä¿ç•™æ¦‚ç‡</span></span><br><span class="line">dl = np.random.rand(A.shape[<span class="number">0</span>], A.shape[<span class="number">1</span>]) &lt; keep_prob  </span><br><span class="line">A = np.multiply(A, dl)  <span class="comment"># ä¿ç•™ç¥ç»å…ƒ</span></span><br><span class="line"></span><br><span class="line"> éƒ¨åˆ†ç¥ç»å…ƒè¢«å…³é—­ï¼ŒæœŸæœ›å€¼é¢„è®¡ä¸‹é™ä¸ºåŸæ¥çš„$keep_prob$ï¼Œéœ€è¦ç¼©æ”¾æ¿€æ´»å€¼ä¿æŒæœŸæœ›å€¼ä¸å˜</span><br><span class="line">A = A / keep_prob </span><br></pre></td></tr></table></figure><p>åŠ å…¥äº†Droupoutåï¼Œè¾“å…¥çš„ç‰¹å¾éƒ½å­˜åœ¨è¢«éšæœºæ¸…é™¤çš„å¯èƒ½ï¼Œæ‰€ä»¥è¯¥ç¥ç»å…ƒä¸ä¼šå†ç‰¹åˆ«ä¾èµ–äºä»»ä½•ä¸€ä¸ªè¾“å…¥ç‰¹å¾ã€‚<br>é€šè¿‡ä¼ æ’­è¿‡ç¨‹ï¼ŒDropoutå°†äº§ç”Ÿå’ŒL2æ­£åˆ™åŒ–ç›¸åŒçš„æ”¶ç¼©æƒé‡çš„æ•ˆæœã€‚</p><p>å¯¹äºç¥ç»å…ƒè¾ƒå¤šçš„å±‚ï¼Œè®¾ç½®è¾ƒå°çš„keep_probï¼Œå¯¹äºç¥ç»å…ƒè¾ƒå°‘çš„å±‚ï¼Œè®¾ç½®keep_prob=1ã€‚</p><p>åœ¨CVé¢†åŸŸï¼Œå›¾åƒå…·æœ‰æ›´å¤šçš„ç‰¹å¾ï¼ŒDropoutæ˜¯ä¸€ç§éå¸¸æœ‰æ•ˆçš„æ­£åˆ™åŒ–æ–¹æ³•ã€‚</p><p>ç¼ºç‚¹ï¼š</p><ol><li>å› ä¸ºæ¯æ¬¡ä¼šéšæœºæ¶ˆé™¤ä¸€éƒ¨åˆ†ç¥ç»å…ƒï¼Œæˆæœ¬å‡½æ•°æ— æ³•è¢«æ˜ç¡®å®šä¹‰</li><li>å‚æ•°æ— æ³•ç¡®å®šå…·ä½“æ˜¯å“ªäº›ï¼Œåœ¨åå‘ä¼ æ’­çš„æ—¶å€™å¸¦æ¥è®¡ç®—ä¸Šçš„éº»çƒ¦ï¼Œæ— æ³•ä¿è¯å½“å‰ç½‘ç»œæ˜¯å¦æŸå¤±å‡½æ•°ä¸‹é™çš„</li></ol><h3 id="1-7-å…¶ä»–æ­£åˆ™åŒ–æ–¹æ³•"><a href="#1-7-å…¶ä»–æ­£åˆ™åŒ–æ–¹æ³•" class="headerlink" title="1.7 å…¶ä»–æ­£åˆ™åŒ–æ–¹æ³•"></a>1.7 å…¶ä»–æ­£åˆ™åŒ–æ–¹æ³•</h3><h4 id="æ—©åœæ­¢æ³•ï¼ˆEarly-Stoppingï¼‰"><a href="#æ—©åœæ­¢æ³•ï¼ˆEarly-Stoppingï¼‰" class="headerlink" title="æ—©åœæ­¢æ³•ï¼ˆEarly Stoppingï¼‰"></a>æ—©åœæ­¢æ³•ï¼ˆEarly Stoppingï¼‰</h4><p>å¦‚æœè®­ç»ƒè¿­ä»£çš„æ¬¡æ•°è¿‡é«˜ï¼Œä¼šå‘ç”Ÿè¿‡æ‹Ÿåˆï¼ŒæŸå¤±å‡½æ•°å›¾åƒå¦‚ä¸‹ï¼š</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/æ—©åœæ­¢æ³•.png" alt="æ—©åœæ­¢æ³•"></p><p>æ—©åœæ­¢æ³•ï¼šåœ¨æµ‹è¯•é›†ä¸Šçš„æŸå¤±å‡å°‘åˆ°ä¸€å®šç¨‹åº¦åï¼Œåœæ­¢è®­ç»ƒï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</p><p>è¿™ç§æ–¹æ³•æ²»æ ‡ä¸æ²»æœ¬ï¼Œè¿˜æ˜¯éœ€è¦ä»æ ¹æœ¬ä¸Šè§£å†³æ•°æ®æˆ–æ¨¡å‹çš„é—®é¢˜ã€‚</p><h4 id="æ•°æ®å¢å¼ºï¼ˆData-Augmentationï¼‰"><a href="#æ•°æ®å¢å¼ºï¼ˆData-Augmentationï¼‰" class="headerlink" title="æ•°æ®å¢å¼ºï¼ˆData Augmentationï¼‰"></a>æ•°æ®å¢å¼ºï¼ˆData Augmentationï¼‰</h4><p>ç®—æ³•åœ¨å­¦ä¹ åŒºåˆ†ä¸¤ç§ç±»åˆ«æ—¶ï¼Œå¯èƒ½ä¼šå¯»æ‰¾åˆ°ä¸€ä¸ªæœ€æ˜æ˜¾çš„ç‰¹å¾ã€‚</p><p>ä¾‹å¦‚åœ¨åŒºåˆ†ä¸¤ç§ä¸åŒå‹å·çš„è½¦æ—¶ï¼Œå¦‚æœè®­ç»ƒé›†ä¸­ï¼Œå‹å·1çš„è½¦éƒ½æœå·¦ï¼Œå‹å·2çš„è½¦éƒ½æœå³ï¼Œé‚£ä¹ˆæ¨¡å‹å¯èƒ½ä¼šè®¤ä¸ºè½¦çš„æœå‘æ˜¯åŒºåˆ†ä¸¤ç§è½¦çš„æœ€é‡è¦ç‰¹å¾ã€‚<br>åœ¨æµ‹è¯•é›†ä¸­ï¼Œå¦‚æœå‡ºç°äº†æœå³çš„å‹å·1è½¦ï¼Œæ¨¡å‹å¯èƒ½è®¤ä¸ºæ˜¯å‹å·2è½¦ã€‚<br>å› æ­¤ï¼Œéœ€è¦å‡å°‘æ•°æ®é›†ä¸­ä¸ç›¸å…³çš„ç‰¹å¾çš„æ•°é‡ã€‚</p><p>æ•°æ®å¢å¼ºï¼šé€šè¿‡å¯¹è®­ç»ƒé›†è¿›è¡Œä¸€ç³»åˆ—çš„éšæœºå˜æ¢ï¼ˆå¦‚å‰ªåˆ‡ã€æ—‹è½¬ã€ç¿»è½¬ã€ç¼©æ”¾ç­‰ï¼‰ï¼Œå¢åŠ è®­ç»ƒé›†çš„æ ·æœ¬æ•°é‡ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚</p><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¯ä»¥é€šè¿‡æ°´å¹³ç¿»è½¬å›¾åƒï¼Œä»¥é˜²æ­¢æ¨¡å‹å­¦ä¹ åˆ°ä¸ç›¸å…³çš„æ¨¡å¼ã€‚</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/æ•°æ®å¢å¼º.png" alt="æ•°æ®å¢å¼º"></p><ul><li>ç¦»çº¿å¢å¼ºï¼šé¢„å…ˆè¿›è¡Œæ‰€æœ‰çš„å¿…è¦è½¬æ¢ï¼Œä»æ ¹æœ¬ä¸Šå¢å¤§æ•°æ®é›†è§„æ¨¡ï¼ˆå¦‚æ°´å¹³ç¿»è½¬åï¼Œä¿å­˜ä¸ºæ–°çš„å›¾åƒï¼Œæ•°æ®é›†å¢å¤§ä¸ºåŸæ¥çš„ä¸¤å€ï¼‰</li><li>åœ¨çº¿å¢å¼ºï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå¯¹å³å°†è¾“å…¥æ¨¡å‹çš„å°æ‰¹é‡æ•°æ®è¿›è¡Œç›¸åº”å˜æ¢ï¼ŒåŒä¸€å¼ å›¾æ¯æ¬¡è®­ç»ƒè¢«éšæœºæ‰§è¡Œä¸€äº›å˜åŒ–æ“ä½œï¼Œç›¸å½“äºä¸åŒæ•°æ®é›†</li></ul><p>æ•°æ®å¢å¼ºçš„æ•ˆæœå¦‚ä¸‹</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/æ•°æ®å¢å¼ºçš„æ•ˆæœ.png" alt="æ•°æ®å¢å¼ºçš„æ•ˆæœ"></p><h3 id="1-8-æ­£åˆ™åŒ–è¾“å…¥"><a href="#1-8-æ­£åˆ™åŒ–è¾“å…¥" class="headerlink" title="1.8 æ­£åˆ™åŒ–è¾“å…¥"></a>1.8 æ­£åˆ™åŒ–è¾“å…¥</h3><p>å¯¹äºè¾“å…¥æ•°æ®è¿›è¡Œæ­£åˆ™åŒ–å¤„ç†ï¼Œä½¿æ•°æ®éƒ½æœä»åŒä¸€åˆ†å¸ƒï¼Œèƒ½å¤Ÿç¼“è§£æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸é—®é¢˜ï¼Œå¹¶ä¸”åŠ é€Ÿç®—æ³•çš„æ”¶æ•›ã€‚</p><ul><li>æ­£åˆ™åŒ–å…¬å¼ï¼š$X = \dfrac{X-\mu}{\sigma}$ï¼Œå…¶ä¸­$\mu$ä¸ºå‡å€¼ï¼Œ$\sigma$ä¸ºæ ‡å‡†å·®</li></ul><h3 id="1-9-æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸"><a href="#1-9-æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸" class="headerlink" title="1.9 æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸"></a>1.9 æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸</h3><p>ç”±äºé“¾å¼æ³•åˆ™æ˜¯ä¸€ä¸ªè¿ä¹˜çš„è¿‡ç¨‹ï¼Œå½“å±‚æ•°è¶Šæ·±æ—¶ï¼Œæ¢¯åº¦ä»¥æŒ‡æ•°é€Ÿåº¦å¢é•¿ä¼ æ’­ã€‚</p><ul><li>æ¢¯åº¦æ¶ˆå¤±ï¼šæ¢¯åº¦å°äº1ï¼Œå¤šæ¬¡è¿ä¹˜åï¼Œæ¢¯åº¦è¶‹è¿‘äº0ï¼Œå¯¼è‡´å‚æ•°å‡ ä¹ä¸æ›´æ–°ã€æ¨¡å‹éš¾æ”¶æ•›</li><li>æ¢¯åº¦çˆ†ç‚¸ï¼šæ¢¯åº¦å¤§äº1ï¼Œå¤šæ¬¡è¿ä¹˜åï¼Œæ¢¯åº¦è¶‹è¿‘äºæ— ç©·ï¼Œå¯¼è‡´å‚æ•°æ›´æ–°è¿‡å¤§ç”šè‡³æº¢å‡º</li></ul><p>å±€éƒ¨æœ€ä¼˜è§£ï¼šæŸå¤±å‡½æ•°å¯èƒ½å­˜åœ¨éç‚¹/å±€éƒ¨æœ€å°å€¼</p><ul><li>è¾ƒå¤§çš„ç¥ç»ç½‘ç»œï¼Œå±€éƒ¨æœ€ä¼˜è§£çš„å¯èƒ½æ€§è¾ƒå°</li><li>éç‚¹é™„è¿‘çš„å¹³ç¨³æ®µä¼šä½¿å¾—å­¦ä¹ éå¸¸ç¼“æ…¢ï¼Œéœ€è¦ä¼˜åŒ–ç®—æ³•åŠ é€Ÿå­¦ä¹ </li></ul><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/å±€éƒ¨æœ€ä¼˜è§£.gif" alt="å±€éƒ¨æœ€ä¼˜è§£"></p><p>è§£å†³æ–¹æ³•ï¼š</p><ol><li>åˆå§‹åŒ–å‚æ•°ç­–ç•¥ï¼šå°†æƒé‡åˆå§‹åŒ–ä¸ºè¾ƒå°çš„éšæœºæ•°</li><li>æ‰¹æ¢¯åº¦ä¸‹é™ã€Mini-batchæ¢¯åº¦ä¸‹é™ã€éšæœºæ¢¯åº¦ä¸‹é™</li><li>æ¢¯åº¦ä¸‹é™ç®—æ³•å†…éƒ¨ä¼˜åŒ–ï¼šåŠ¨é‡æ¢¯åº¦ä¸‹é™ã€RMSPropç®—æ³•ã€Adamç®—æ³•</li><li>å­¦ä¹ ç‡è¡°å‡</li><li>æ ‡å‡†åŒ–è¾“å…¥</li></ol><h3 id="1-10-æƒé‡åˆå§‹åŒ–"><a href="#1-10-æƒé‡åˆå§‹åŒ–" class="headerlink" title="1.10 æƒé‡åˆå§‹åŒ–"></a>1.10 æƒé‡åˆå§‹åŒ–</h3><p>ä¸ºäº†é¿å…å¯¹ç§°æ€§ï¼Œæƒé‡åˆå§‹åŒ–ä¸èƒ½å…¨ä¸º0ï¼Œé€šå¸¸ä½¿ç”¨è¾ƒå°çš„éšæœºæ•°è¿›è¡Œåˆå§‹åŒ–ã€‚</p><p>åœ¨é€»è¾‘å›å½’çš„ç¬”è®°ä¸­ï¼Œæƒé‡åˆå§‹åŒ–ä¸º<code>np.random.randn(k, n) * 0.01</code>ã€‚</p><p>Xavieråˆå§‹åŒ–ï¼š$w^{[l]} = np.random.randn(k, n) \times \sqrt{\dfrac{1}{n^{[l-1]}}}$ï¼Œå…¶ä¸­$n^{[l-1]}$ä¸ºä¸Šä¸€å±‚çš„ç¥ç»å…ƒæ•°é‡ã€‚</p><p>å¦‚æœä½¿ç”¨ReLUæ¿€æ´»å‡½æ•°ï¼Œæƒé‡åˆå§‹åŒ–ä¸º $w^{[l]} = np.random.randn(k, n) \times \sqrt{\dfrac{2}{n^{[l-1]}}}$ã€‚</p><h2 id="äºŒã€ä¼˜åŒ–ç®—æ³•"><a href="#äºŒã€ä¼˜åŒ–ç®—æ³•" class="headerlink" title="äºŒã€ä¼˜åŒ–ç®—æ³•"></a>äºŒã€ä¼˜åŒ–ç®—æ³•</h2><h3 id="2-1-æ‰¹æ¢¯åº¦ä¸‹é™ã€Mini-batchæ¢¯åº¦ä¸‹é™ã€éšæœºæ¢¯åº¦ä¸‹é™"><a href="#2-1-æ‰¹æ¢¯åº¦ä¸‹é™ã€Mini-batchæ¢¯åº¦ä¸‹é™ã€éšæœºæ¢¯åº¦ä¸‹é™" class="headerlink" title="2.1 æ‰¹æ¢¯åº¦ä¸‹é™ã€Mini-batchæ¢¯åº¦ä¸‹é™ã€éšæœºæ¢¯åº¦ä¸‹é™"></a>2.1 æ‰¹æ¢¯åº¦ä¸‹é™ã€Mini-batchæ¢¯åº¦ä¸‹é™ã€éšæœºæ¢¯åº¦ä¸‹é™</h3><p>æ‰¹æ¢¯åº¦ä¸‹é™ï¼ˆBatch Gradient Descentï¼‰ï¼šåŒæ—¶å¤„ç†æ•´ä¸ªè®­ç»ƒé›†</p><ul><li>åœ¨æ›´æ–°å‚æ•°å‰ï¼Œå¿…é¡»å…ˆå¤„ç†æ•´ä¸ªè®­ç»ƒå‚æ•°é›†ï¼Œæ‰èƒ½è¿›è¡Œä¸€æ­¥æ¢¯åº¦ä¸‹é™</li><li>å¦‚æœè®­ç»ƒé›†å¾ˆå¤§ï¼Œè®¡ç®—é‡ä¼šå¾ˆå¤§ï¼Œè®­ç»ƒé€Ÿåº¦å¾ˆæ…¢</li><li>å™ªå£°ä½ï¼Œä»£ä»·å‡½æ•°å€¼å¹³æ»‘å‡å°</li><li>è®­ç»ƒæ ·æœ¬çš„å¤§å°è¾ƒå°ï¼ˆå°äº2048ï¼‰æ—¶ï¼Œé€‰æ‹©Batchæ¢¯åº¦ä¸‹é™</li></ul><p>Mini-batchæ¢¯åº¦ä¸‹é™ï¼šå°†è®­ç»ƒé›†åˆ†ä¸ºå¤šä¸ªå›ºå®šå¤§å°çš„æ‰¹æ¬¡ï¼Œæ¯æ¬¡åªå¤„ç†ä¸€ä¸ªæ‰¹æ¬¡çš„æ•°æ®</p><ul><li>è®­ç»ƒæ ·æœ¬çš„å¤§å°è¾ƒå¤§æ—¶ï¼Œé€‰æ‹©Mini-batchæ¢¯åº¦ä¸‹é™ï¼Œé€šå¸¸ä¸º64ã€128ã€256ã€512ç­‰</li></ul><p>éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆStochastic Gradient Descent, SGDï¼‰ï¼šmini-batchå¤§å°ä¸º1ï¼Œæ¯æ¬¡åªå¤„ç†ä¸€ä¸ªæ ·æœ¬</p><ul><li>è®­ç»ƒé€Ÿåº¦å¿«ï¼Œä½†ä¸¢å¤±äº†å‘é‡åŒ–ç¼–ç¨‹çš„ä¼˜åŠ¿</li><li>ä»£ä»·å‡½æ•°å€¼æ³¢åŠ¨å¤§ï¼Œå™ªå£°å¤§ï¼Œæ€»ä½“å‘å…¨å±€æœ€å°å€¼é è¿‘ï¼Œä½†éš¾ä»¥æ”¶æ•›ï¼Œå®¹æ˜“åœ¨éç‚¹éœ‡è¡</li></ul><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/æ¢¯åº¦ä¸‹é™ä»£ä»·å‡½æ•°å€¼å˜åŒ–è¶‹åŠ¿.png" alt="æ¢¯åº¦ä¸‹é™ä»£ä»·å‡½æ•°å€¼å˜åŒ–è¶‹åŠ¿"></p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/æ¢¯åº¦ä¸‹é™ä»£ä»·å‡½æ•°å€¼å˜åŒ–è¶‹åŠ¿2.png" alt="æ¢¯åº¦ä¸‹é™ä»£ä»·å‡½æ•°å€¼å˜åŒ–è¶‹åŠ¿2"></p><h3 id="2-2-æŒ‡æ•°åŠ æƒå¹³å‡"><a href="#2-2-æŒ‡æ•°åŠ æƒå¹³å‡" class="headerlink" title="2.2 æŒ‡æ•°åŠ æƒå¹³å‡"></a>2.2 æŒ‡æ•°åŠ æƒå¹³å‡</h3><p>æŒ‡æ•°åŠ æƒå¹³å‡ï¼ˆExponentially Weight Averageï¼‰æ˜¯ä¸€ç§å¸¸ç”¨çš„åºåˆ—æ•°æ®å¤„ç†æ–¹å¼ï¼Œé€šå¸¸ç”¨åœ¨åºåˆ—åœºæ™¯ï¼Œå¦‚é‡‘èåºåˆ—åˆ†æã€æ¸©åº¦å˜åŒ–åºåˆ—åˆ†æã€‚</p><script type="math/tex; mode=display">S_t = \begin{cases}x_t &, t=1 \\\\ \beta S_{t-1}+(1-\beta)x_t &, t>1\end{cases}</script><p>ç†è§£ï¼šä¸Šä¸€ç»“æœçš„æƒé‡ä¸º$\beta$ï¼Œå½“å‰æ•°æ®çš„æƒé‡ä¸º$1-\beta$ã€‚</p><p>ä¸‹å›¾ï¼Œé»„è‰²$\beta=0.5$ï¼Œçº¢è‰²$\beta=0.9$ï¼Œç»¿è‰²$\beta=0.98$</p><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/æŒ‡æ•°åŠ æƒå¹³å‡.png" alt="æŒ‡æ•°åŠ æƒå¹³å‡"></p><h3 id="2-3-åŠ¨é‡æ¢¯åº¦ä¸‹é™"><a href="#2-3-åŠ¨é‡æ¢¯åº¦ä¸‹é™" class="headerlink" title="2.3 åŠ¨é‡æ¢¯åº¦ä¸‹é™"></a>2.3 åŠ¨é‡æ¢¯åº¦ä¸‹é™</h3><p>åŠ¨é‡æ¢¯åº¦ä¸‹é™ï¼ˆMomentum Gradient Descentï¼‰ï¼šåˆ©ç”¨æ¢¯åº¦çš„æŒ‡æ•°åŠ æƒå¹³å‡æ¥æ›´æ–°å‚æ•°</p><script type="math/tex; mode=display">\begin{split}&S_{dW} = \beta S_{dW}+(1-\beta)dW \\\\ &S_{db} = \beta S_{db}+(1-\beta)db \\\\ &W = W-\alpha S_{dW} \\\\ &b = b-\alpha S_{db}\end{split}</script><p>åˆ©ç”¨ç´¯åŠ çš„æ¢¯åº¦å€¼ï¼Œå‡å°‘æ¢¯åº¦ä¸‹é™çš„éœ‡è¡ï¼ŒåŠ é€Ÿæ”¶æ•›</p><ul><li>å‰åæ¢¯åº¦æ–¹å‘ä¸ä¸€è‡´æ—¶ï¼Œæ¢¯åº¦å€¼å‡å°ï¼Œå‡å°‘éœ‡è¡</li><li>å‰åæ¢¯åº¦æ–¹å‘ä¸€è‡´æ—¶ï¼Œæ¢¯åº¦å€¼å¢å¤§ï¼ŒåŠ é€Ÿæ”¶æ•›</li></ul><h3 id="2-2-5-RMSPropç®—æ³•"><a href="#2-2-5-RMSPropç®—æ³•" class="headerlink" title="2.2.5 RMSPropç®—æ³•"></a>2.2.5 RMSPropç®—æ³•</h3><p>RMSPropç®—æ³•ï¼ˆRoot Mean Square Propagationï¼‰ï¼šå†å¯¹æ¢¯åº¦è¿›è¡ŒæŒ‡æ•°åŠ æƒå¹³å‡çš„åŸºç¡€ä¸Šï¼Œå¼•å…¥å¹³æ–¹å’Œå¹³æ–¹æ ¹</p><script type="math/tex; mode=display">\begin{split}&S_{dW} = \beta S_{dW}+(1-\beta)dW^2 \\\\ &S_{db} = \beta S_{db}+(1-\beta)db^2 \\\\ &W = W-\alpha \dfrac{dW}{\sqrt{S_{dW}+\epsilon}} \\\\ &b = b-\alpha \dfrac{db}{\sqrt{S_{db}+\epsilon}}\end{split}</script><p>å…¶ä¸­ï¼Œ$\epsilon$æ˜¯ä¸€ä¸ªå¾ˆå°çš„æ•°ï¼Œé¿å…åˆ†æ¯è¿‡å°å¯¼è‡´æ•°å€¼ä¸ç¨³å®šã€‚</p><p>RMSProp æœ‰åŠ©äºå‡å°‘æŠµè¾¾æœ€å°å€¼è·¯å¾„ä¸Šçš„æ‘†åŠ¨ï¼Œå¹¶å…è®¸ä½¿ç”¨ä¸€ä¸ªæ›´å¤§çš„å­¦ä¹ ç‡$\alpha$ï¼ŒåŠ å¿«ç®—æ³•å­¦ä¹ é€Ÿåº¦ã€‚</p><h3 id="2-2-6-Adamç®—æ³•"><a href="#2-2-6-Adamç®—æ³•" class="headerlink" title="2.2.6 Adamç®—æ³•"></a>2.2.6 Adamç®—æ³•</h3><p>Adamç®—æ³•ï¼ˆAdaptive Moment Estimationï¼Œè‡ªé€‚åº”çŸ©ä¼°è®¡ï¼‰ï¼šç»“åˆäº†Momentumå’ŒRMSPropç®—æ³•ï¼ŒåŒæ—¶è€ƒè™‘æ¢¯åº¦çš„ä¸€é˜¶çŸ©ä¼°è®¡å’ŒäºŒé˜¶çŸ©ä¼°è®¡</p><p>å‡è®¾ç”¨ä¸€ä¸ªmini-batchè®¡ç®—$dW$å’Œ$db$ï¼Œç¬¬$t$æ¬¡è¿­ä»£æ—¶ï¼Œè®¡ç®—åŠ¨é‡æ¢¯åº¦ç»“æœï¼š</p><script type="math/tex; mode=display">\begin{split}&V_{dW} = \beta_1 V_{dW}+(1-\beta_1)dW \\\\ &V_{db} = \beta_1 V_{db}+(1-\beta_1)db \\\\ &V_{dW}^{corrected} = \dfrac{V_{dW}}{1-\beta_1^t} \end{split}</script><p>è®¡ç®—RMSPropç»“æœï¼š</p><script type="math/tex; mode=display">\begin{split}&S_{dW} = \beta_2 S_{dW}+(1-\beta_2)dW^2 \\\\ &S_{db} = \beta_2 S_{db}+(1-\beta_2)db^2 \\\\ &S_{dW}^{corrected} = \dfrac{S_{dW}}{1-\beta_2^t}\end{split}</script><p>è®¡ç®—ç§»åŠ¨å¹³å‡æ•°æ—¶ï¼Œä½¿ç”¨ç³»æ•°$\dfrac{1}{1-\beta_1^t}$è¿›è¡Œä¿®æ­£ã€‚<br>ä¾‹å¦‚$m_0=0,m_1=0.9m_0+0.1m_1$ï¼Œå¯¼è‡´$m_1$çš„å€¼è¿‡å°ï¼Œä¿®æ­£åæ°å¥½ä¸º$m_1$çš„å€¼ã€‚<br>éšç€è¿­ä»£æ¬¡æ•°å¢åŠ ï¼Œä¿®æ­£ç³»æ•°è¶‹è¿‘äº1ï¼Œä¿è¯äº†ç§»åŠ¨å¹³å‡æ•°çš„å‡†ç¡®æ€§ã€‚</p><p>Adamç®—æ³•æ›´æ–°å‚æ•°ï¼š</p><script type="math/tex; mode=display">\begin{split}&W = W-\alpha \dfrac{V_{dW}^{corrected}}{\sqrt{S_{dW}^{corrected}}+\epsilon} \\\\ &b = b-\alpha \dfrac{V_{db}^{corrected}}{\sqrt{S_{db}^{corrected}}+\epsilon}\end{split}</script><h3 id="2-2-7-å­¦ä¹ ç‡è¡°å‡"><a href="#2-2-7-å­¦ä¹ ç‡è¡°å‡" class="headerlink" title="2.2.7 å­¦ä¹ ç‡è¡°å‡"></a>2.2.7 å­¦ä¹ ç‡è¡°å‡</h3><p>å¦‚æœéšç€æ—¶é—´æ…¢æ…¢å‡å°‘å­¦ä¹ ç‡$\alpha$çš„å¤§å°ï¼Œåœ¨åˆæœŸ$\alpha$è¾ƒå¤§æ—¶ï¼Œä¸‹é™çš„æ­¥é•¿è¾ƒå¤§ï¼Œèƒ½ä»¥è¾ƒå¿«çš„é€Ÿåº¦è¿›è¡Œæ¢¯åº¦ä¸‹é™ï¼›è€ŒåæœŸé€æ­¥å‡å°$\alpha$çš„å€¼ï¼Œå³å‡å°æ­¥é•¿ï¼Œæœ‰åŠ©äºç®—æ³•çš„æ”¶æ•›ï¼Œæ›´å®¹æ˜“æ¥è¿‘æœ€ä¼˜è§£ã€‚</p><p>æœ€å¸¸ç”¨çš„å­¦ä¹ ç‡è¡°å‡æ–¹æ³•ï¼š$\alpha = \dfrac{1}{1+decay_ rate \times epoch_ num} \times \alpha_0$</p><ul><li>$\alpha_0$ï¼šåˆå§‹å­¦ä¹ ç‡</li><li>$decay_ rate$ï¼šè¡°å‡ç‡ï¼Œè¶…å‚æ•°</li><li>$epoch_ num$ï¼šè¿­ä»£æ¬¡æ•°</li></ul><p>ä¸€ç§æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡ï¼š$\alpha = 0.95^{epoch_ num} \times \alpha_0$</p><h2 id="ä¸‰ã€è¶…å‚æ•°è°ƒè¯•ã€Batchæ­£åˆ™åŒ–å’Œç¼–ç¨‹æ¡†æ¶"><a href="#ä¸‰ã€è¶…å‚æ•°è°ƒè¯•ã€Batchæ­£åˆ™åŒ–å’Œç¼–ç¨‹æ¡†æ¶" class="headerlink" title="ä¸‰ã€è¶…å‚æ•°è°ƒè¯•ã€Batchæ­£åˆ™åŒ–å’Œç¼–ç¨‹æ¡†æ¶"></a>ä¸‰ã€è¶…å‚æ•°è°ƒè¯•ã€Batchæ­£åˆ™åŒ–å’Œç¼–ç¨‹æ¡†æ¶</h2><h3 id="3-1-ç¥ç»ç½‘ç»œè°ƒä¼˜"><a href="#3-1-ç¥ç»ç½‘ç»œè°ƒä¼˜" class="headerlink" title="3.1 ç¥ç»ç½‘ç»œè°ƒä¼˜"></a>3.1 ç¥ç»ç½‘ç»œè°ƒä¼˜</h3><p>ç®—æ³•å±‚é¢ï¼š</p><ul><li>å­¦ä¹ ç‡$\alpha$</li><li>$\beta_1,\beta_2,\epsilon$ï¼šAdamç®—æ³•çš„è¶…å‚æ•°ï¼Œå¸¸ç”¨å€¼$\beta_1=0.9,\beta_2=0.999,\epsilon=10^{-8}$</li><li>æ­£åˆ™åŒ–å‚æ•°$\lambda$</li></ul><p>æ¨¡å‹å±‚é¢ï¼š</p><ul><li>hidden unitsï¼šéšè—å±‚ç¥ç»å…ƒæ•°</li><li>layersï¼šéšè—å±‚å±‚æ•°</li></ul><p>è°ƒå‚æŠ€å·§</p><ul><li>ç½‘æ ¼æœç´¢ï¼šéå†æ‰€æœ‰å¯èƒ½çš„å‚æ•°ç»„åˆï¼Œæµ‹è¯•æ¯ä¸€ç»„çš„æ•ˆæœï¼Œé€‰æ‹©æ•ˆæœæœ€å¥½çš„å‚æ•°ç»„åˆã€‚</li><li>å°½é‡è®©æ¯ä¸€ç»„å·®åˆ«æ˜æ˜¾ï¼Œé¿å…é‡å¤æµ‹è¯•</li><li>åˆç†çš„å‚æ•°è®¾ç½®ï¼šä¸ºè¶…å‚æ•°é€‰æ‹©åˆé€‚çš„èŒƒå›´<ul><li>å­¦ä¹ ç‡$\alpha$ï¼šé€šå¸¸è®¾ç½®ä¸º0.0001ã€0.001ã€0.01ã€0.1ç­‰</li><li>åŠ¨é‡æ¢¯åº¦å› å­$\beta$: é€šå¸¸è®¾ç½®ä¸º0.999ã€0.9995ã€0.9999ç­‰ï¼Œå°½å¯èƒ½æ¥è¿‘1ï¼ˆæŒ‡æ•°å¢åŠ æ•ˆåº”ï¼‰</li></ul></li></ul><p>é—®é¢˜ï¼šè°ƒå‚è¿‡ç¨‹éº»çƒ¦ã€è®­ç»ƒæ—¶é—´é•¿</p><h3 id="2-4-2-æ‰¹æ ‡å‡†åŒ–ï¼ˆæ‰¹æ ‡å‡†åŒ–ï¼‰"><a href="#2-4-2-æ‰¹æ ‡å‡†åŒ–ï¼ˆæ‰¹æ ‡å‡†åŒ–ï¼‰" class="headerlink" title="2.4.2 æ‰¹æ ‡å‡†åŒ–ï¼ˆæ‰¹æ ‡å‡†åŒ–ï¼‰"></a>2.4.2 æ‰¹æ ‡å‡†åŒ–ï¼ˆæ‰¹æ ‡å‡†åŒ–ï¼‰</h3><p>è®ºæ–‡åœ°å€ï¼š<a href="https://arxiv.org/abs/1502.03167">æ‰¹æ ‡å‡†åŒ–: Accelerating Deep Network Training by Reducing Internal Covariate Shift</a></p><blockquote><p>è®­ç»ƒæ·±åº¦ç¥ç»ç½‘ç»œå¾ˆå¤æ‚ï¼Œå› ä¸ºåœ¨è®­ç»ƒæœŸé—´æ¯å±‚è¾“å…¥çš„åˆ†å¸ƒå‘ç”Ÿå˜åŒ–ï¼Œå› ä¸ºå‰ä¸€å±‚çš„å‚æ•°å‘ç”Ÿäº†å˜åŒ–ã€‚<br>è¿™é€šè¿‡è¦æ±‚è¾ƒä½çš„å­¦ä¹ ç‡å’Œä»”ç»†çš„å‚æ•°åˆå§‹åŒ–æ¥å‡æ…¢è®­ç»ƒé€Ÿåº¦ï¼Œå¹¶ä¸”ä½¿å¾—è®­ç»ƒå…·æœ‰é¥±å’Œéçº¿æ€§çš„æ¨¡å‹å˜å¾—éå¸¸å›°éš¾ã€‚<br>æˆ‘ä»¬å°†è¿™ç§ç°è±¡ç§°ä¸º<strong>å†…éƒ¨åå˜é‡åç§»</strong>ï¼Œå¹¶é€šè¿‡<strong>æ ‡å‡†åŒ–å±‚</strong>è¾“å…¥æ¥è§£å†³é—®é¢˜ã€‚<br>æˆ‘ä»¬çš„æ–¹æ³•çš„ä¼˜åŠ¿åœ¨äºä½¿æ ‡å‡†åŒ–æˆä¸ºæ¨¡å‹ä½“ç³»ç»“æ„çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸ºæ¯ä¸ªåŸ¹è®­å°æ‰¹é‡æ‰§è¡Œæ ‡å‡†åŒ–ã€‚<br>æ‰¹æ ‡å‡†åŒ–å…è®¸æˆ‘ä»¬ä½¿ç”¨æ›´é«˜çš„å­¦ä¹ ç‡å¹¶ä¸”ä¸å¤ªå…³å¿ƒåˆå§‹åŒ–ã€‚<br>å®ƒè¿˜å¯ä»¥å……å½“è°ƒèŠ‚å™¨ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥æ¶ˆé™¤å¯¹Dropoutçš„éœ€æ±‚ã€‚<br>åº”ç”¨äºæœ€å…ˆè¿›çš„å›¾åƒåˆ†ç±»æ¨¡å‹ï¼Œæ‰¹é‡æ ‡å‡†åŒ–å®ç°äº†ç›¸åŒçš„ç²¾åº¦ï¼ŒåŸ¹è®­æ­¥éª¤å‡å°‘äº†14å€ï¼Œå¹¶ä¸”æ˜¾ç€åœ°è¶…è¿‡äº†åŸå§‹æ¨¡å‹ã€‚<br>ä½¿ç”¨æ‰¹é‡æ ‡å‡†åŒ–ç½‘ç»œçš„é›†åˆï¼Œæˆ‘ä»¬æ”¹è¿›äº†ImageNetåˆ†ç±»çš„æœ€ä½³å‘å¸ƒç»“æœï¼šè¾¾åˆ°4.9ï¼…çš„å‰5ä¸ªéªŒè¯é”™è¯¯ï¼ˆå’Œ4.8ï¼…çš„æµ‹è¯•é”™è¯¯ï¼‰ï¼Œè¶…å‡ºäº†äººç±»è¯„ä¼°è€…çš„å‡†ç¡®æ€§ã€‚</p></blockquote><p>æ‰¹æ ‡å‡†åŒ–ï¼šåœ¨ç¥ç»ç½‘ç»œçš„æ¯ä¸€å±‚çš„<strong>æ¿€æ´»å‡½æ•°ä¹‹å‰</strong>ï¼Œå¯¹æ¯ä¸€å±‚çš„<strong>è¾“å…¥</strong>è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ï¼Œä½¿å¾—æ¯ä¸€å±‚çš„è¾“å…¥æ•°æ®æœä»å‡å€¼ä¸º0ã€æ–¹å·®ä¸º1çš„æ­£æ€åˆ†å¸ƒã€‚</p><p>æ‰¹æ ‡å‡†åŒ–å…¬å¼ï¼š</p><script type="math/tex; mode=display">\begin{split}&\mu = \dfrac{1}{m}\sum\limits_{i=1}^{m}Z^{(i)} \\\\ &\sigma^2 = \dfrac{1}{m}\sum\limits_{i=1}^{m}(Z^{(i)}-\mu)^2 \\\\ &Z_{norm}^{(i)} = \dfrac{Z^{(i)}-\mu}{\sqrt{\sigma^2+\epsilon}}\end{split}</script><p>å…¶ä¸­ï¼Œ$\mu$ä¸ºå‡å€¼ï¼Œ$\sigma^2$ä¸ºæ–¹å·®ï¼Œ$\epsilon$ä¸ºä¸€ä¸ªå¾ˆå°çš„æ•°ï¼Œé¿å…åˆ†æ¯ä¸º0ã€‚</p><p>å¦‚æœå„éšè—å±‚çš„è¾“å…¥å‡å€¼åœ¨é è¿‘0çš„åŒºåŸŸï¼Œå³å¤„äºæ¿€æ´»å‡½æ•°çš„çº¿æ€§åŒºåŸŸï¼Œä¸åˆ©äºè®­ç»ƒéçº¿æ€§ç¥ç»ç½‘ç»œï¼Œä»è€Œå¾—åˆ°æ•ˆæœè¾ƒå·®çš„æ¨¡å‹ã€‚<br>å› æ­¤æ·»åŠ ä¸¤ä¸ªå¯å­¦ä¹ çš„å‚æ•°$\gamma$å’Œ$\beta$ï¼Œå¯¹æ ‡å‡†åŒ–åçš„æ•°æ®è¿›è¡Œç¼©æ”¾å’Œå¹³ç§»ã€‚</p><script type="math/tex; mode=display">\tilde{Z}^{(i)} = \gamma Z_{norm}^{(i)}+\beta</script><p><img src="https://source.cclmsy.cc/posts/notes/deep_learning/æ‰¹æ ‡å‡†åŒ–è¿‡ç¨‹.png" alt="æ‰¹æ ‡å‡†åŒ–è¿‡ç¨‹"></p><p>æ‰¹æ ‡å‡†åŒ–ä¼˜åŒ–è®­ç»ƒè¿‡ç¨‹çš„åŸç†ï¼š</p><p>æ•°æ®çš„åˆ†å¸ƒä¼šéšç€ä¸åŒæ•°æ®é›†æ”¹å˜ã€‚<br>ç½‘ç»œçš„å‚æ•°ä¼šå› è®­ç»ƒé›†æ•°æ®åˆ†å¸ƒçš„å˜åŒ–è€Œå˜åŒ–ï¼›æµ‹è¯•çš„æ•°æ®åˆ†å¸ƒä¸è®­ç»ƒé›†çš„æ•°æ®åˆ†å¸ƒä¸åŒï¼Œä¹Ÿä¼šå¯¼è‡´å‡†ç¡®æ€§ä¸‹é™ã€‚</p><p>æ‰¹æ ‡å‡†åŒ–çš„ä½œç”¨å°±æ˜¯å‡å°äº†æ•°æ®åˆ†å¸ƒçš„å˜åŒ–å¸¦æ¥çš„å½±å“ï¼Œè®©æ¨¡å‹æ›´å¥å£®ï¼Œé²æ£’æ€§æ›´å¼ºã€‚<br>å³ä½¿è¾“å…¥çš„å€¼æ”¹å˜ï¼Œç”±äºæ‰¹æ ‡å‡†åŒ–çš„ä½œç”¨ï¼Œå‡å€¼å’Œæ–¹å·®çš„å˜åŒ–ä¼šè¢«æ¶ˆé™¤ï¼Œåç»­çš„å­¦ä¹ æ›´åŠ å®¹æ˜“ã€‚<br>æ‰¹æ ‡å‡†åŒ–å‡å°‘äº†å„å±‚Wå’Œbä¹‹é—´çš„è€¦åˆæ€§ï¼Œè®©å„å±‚æ›´åŠ ç‹¬ç«‹ï¼Œå®ç°è‡ªæˆ‘è®­ç»ƒå­¦ä¹ çš„æ•ˆæœ</p><p>æ‰¹æ ‡å‡†åŒ–ä¹Ÿèµ·åˆ°å¾®å¼±çš„æ­£åˆ™åŒ–æ•ˆæœï¼Œä½†æ˜¯ä¸èƒ½å°†æ‰¹æ ‡å‡†åŒ–ä½œä¸ºæ­£åˆ™åŒ–çš„æ‰‹æ®µï¼Œè€Œæ˜¯å½“ä½œåŠ é€Ÿå­¦ä¹ çš„æ–¹å¼ã€‚<br>æ‰¹æ ‡å‡†åŒ– ä¸»è¦è§£å†³çš„è¿˜æ˜¯åå‘ä¼ æ’­è¿‡ç¨‹ä¸­çš„æ¢¯åº¦é—®é¢˜ï¼ˆæ¢¯åº¦æ¶ˆå¤±å’Œçˆ†ç‚¸ï¼‰ã€‚</p>]]></content>
    
    
    <summary type="html">è¶…å‚æ•°è°ƒè¯•ã€æ­£åˆ™åŒ–ä»¥åŠä¼˜åŒ–</summary>
    
    
    
    <category term="DLç¬”è®°" scheme="https://www.cclmsy.cc/categories/DL%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
</feed>
