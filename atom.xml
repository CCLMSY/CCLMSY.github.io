<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>CCLMSYğŸ’«</title>
  
  
  <link href="https://www.cclmsy.cc/atom.xml" rel="self"/>
  
  <link href="https://www.cclmsy.cc/"/>
  <updated>2025-03-09T07:47:39.103Z</updated>
  <id>https://www.cclmsy.cc/</id>
  
  <author>
    <name>æ·±ç¿¼ğŸ’«</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å¤ç°|ChatIRï¼šåŸºäºå¯¹è¯çš„å›¾åƒæ£€ç´¢ç³»ç»Ÿ</title>
    <link href="https://www.cclmsy.cc/posts/ChatIR.html"/>
    <id>https://www.cclmsy.cc/posts/ChatIR.html</id>
    <published>2025-03-07T04:00:00.000Z</published>
    <updated>2025-03-09T07:47:39.103Z</updated>
    
    <content type="html"><![CDATA[<p>è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/2305.20062">Chatting Makes Perfect: Chat-based Image Retrival</a></p><h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h2><p>ChatIRç³»ç»ŸåŒ…å«2ä¸ªéƒ¨åˆ†ï¼šå¯¹è¯æ„å»ºï¼ˆDialog Buildingï¼‰å’Œå›¾åƒæœç´¢ï¼ˆImage Searchï¼‰</p><ul><li>å¯¹è¯æ„å»ºï¼šä½¿ç”¨é—®é¢˜ç”Ÿæˆå™¨Gï¼Œè€ƒè™‘å½“å‰å¯¹è¯å†å²ï¼Œç”Ÿæˆä¸‹ä¸€ä¸ªé—®é¢˜</li><li>å›¾åƒæœç´¢ï¼šä½¿ç”¨æ¨¡å‹Fï¼Œå°†ä¸åŒé•¿åº¦çš„å¯¹è¯åºåˆ—æ˜ å°„åˆ°è§†è§‰åµŒå…¥ç©ºé—´</li><li>ä¸¤ä¸ªç»„æˆéƒ¨åˆ†å»ºç«‹åœ¨Instructional LLMså’Œfundation Vision and Language Modelsä¸Š</li></ul><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/ChatIR.png" alt="Figure1"></p><p>è€ƒè™‘ä¸‰ä¸ªé—®é¢˜ï¼š</p><ol><li>ä½¿ç”¨ä»€ä¹ˆæ•°æ®é›†è®­ç»ƒï¼Ÿæ˜¯å¦éœ€è¦æ–°åˆ›å»ºå’Œæ ‡æ³¨æ•°æ®é›†ï¼Ÿ<ul><li>ä½¿ç”¨VisDialæ•°æ®é›†</li><li>é—®é¢˜ï¼šVisDialæ˜¯ä¸€ä¸ªç”¨äºâ€œåˆ›å»ºå…³äºå›¾åƒçš„èŠå¤©â€çš„æ•°æ®é›†ï¼Œæ²¡æœ‰æ£€ç´¢ç›®æ ‡</li><li>è§£å†³ï¼šè¾“å…¥è¾“å‡ºåç½®ï¼Œå¯¹è¯ä½œä¸ºè¾“å…¥ã€å›¾åƒä½œä¸ºè¾“å‡º</li></ul></li><li>å¦‚ä½•ç‹¬ç«‹è¯„ä¼°ChatIRç³»ç»Ÿçš„ä¸åŒç»„ä»¶ï¼Ÿ <ul><li>æµ‹è¯•ä½¿ç”¨ä¸åŒçš„<code>Fè®­ç»ƒç­–ç•¥</code>å’Œ<code>æé—®æ¨¡å‹G</code>å¯¹æ£€ç´¢æ€§èƒ½çš„å½±å“</li><li>ä½¿ç”¨äº†BLIPæ›¿ä»£ç”¨æˆ·å›ç­”é—®é¢˜</li></ul></li><li>å¦‚ä½•å®šä¹‰è¯„ä¼°æŒ‡æ ‡ï¼Ÿ<ul><li>æ¯ä¸€è½®å¯¹è¯çš„æˆåŠŸæ£€ç´¢æ¦‚ç‡Hit@10</li></ul></li></ol><h2 id="2-Related-Work"><a href="#2-Related-Work" class="headerlink" title="2. Related Work"></a>2. Related Work</h2><ol><li>è§†è§‰å¯¹è¯ï¼ˆVisual Conversationï¼‰é¢†åŸŸ<ul><li>å½“å‰è§†è§‰é¢†åŸŸå·¥ä½œçš„é‡ç‚¹åœ¨äºå›¾åƒç†è§£å’Œç”Ÿæˆæ¨¡å‹ï¼Œè€Œä¸æ˜¯æ£€ç´¢</li><li>ç”Ÿæˆå¼è§†è§‰å¯¹è¯ä¸­ï¼Œè¿‘æœŸçš„åŸºç¡€æ¨¡å‹V&amp;Læ€§èƒ½ä¼˜è¶Šï¼Œå› æ­¤ChatIRç³»ç»Ÿåœ¨æ­¤åŸºç¡€ä¸Šæ„å»º</li></ul></li><li>è§†è§‰æœç´¢ï¼ˆVisual Searchï¼‰é¢†åŸŸ<ul><li>CoIRï¼šä½¿ç”¨å¤šæ¨¡æ€è¯¢é—®æŸ¥æ‰¾ç›®æ ‡å›¾åƒ</li><li>ä¸€äº›ç ”ç©¶åŸºäºCoIRï¼Œåˆ©ç”¨ç”¨æˆ·åé¦ˆç»†åŒ–æŸ¥è¯¢ç»“æœ</li><li>ä½†æ˜¯ï¼Œæ²¡æœ‰è€ƒè™‘ç”¨æˆ·äº¤äº’ï¼ˆåªæœ‰ç”¨æˆ·åé¦ˆï¼Œæ²¡æœ‰æœºå™¨æé—®ï¼‰ã€æ²¡æœ‰æ˜ç¡®åˆ©ç”¨å¯¹è¯å†å²</li></ul></li></ol><h2 id="3-Method"><a href="#3-Method" class="headerlink" title="3. Method"></a>3. Method</h2><p>å¯¹è¯è®°å½•è¡¨ç¤ºï¼š$D_i = (C, Q_1, A_1, â€¦, Q_i)$</p><ul><li>$C$ï¼šç›®æ ‡å›¾åƒçš„åˆå§‹æ–‡æœ¬æè¿°ï¼ˆæ ‡é¢˜ï¼‰</li><li>$Q_i$ï¼šç¬¬iä¸ªé—®é¢˜</li><li>$A_i$ï¼šç¬¬iä¸ªå›ç­”</li></ul><h3 id="3-1-Dialog-Builder-Model-å¯¹è¯ç”Ÿæˆæ¨¡å‹"><a href="#3-1-Dialog-Builder-Model-å¯¹è¯ç”Ÿæˆæ¨¡å‹" class="headerlink" title="3.1 Dialog Builder Model å¯¹è¯ç”Ÿæˆæ¨¡å‹"></a>3.1 Dialog Builder Model å¯¹è¯ç”Ÿæˆæ¨¡å‹</h3><p>å¯¹è¯ç”Ÿæˆæ¨¡å‹åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>é—®é¢˜ç”Ÿæˆå™¨Gï¼šä¸€ä¸ªLLMï¼Œæ ¹æ®å¯¹è¯è®°å½•ç”Ÿæˆä¸‹ä¸€ä¸ªé—®é¢˜<ul><li>$G: D<em>i \rightarrow Q</em>{i+1}$</li><li>Gä¸çŸ¥é“ç›®æ ‡å›¾åƒTæ˜¯ä»€ä¹ˆï¼ŒåªçŸ¥é“å¯¹è¯å†å²</li></ul></li><li>ç­”æ¡ˆæä¾›è€…Aï¼šåœ¨å®è·µä¸­ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªè„‘æµ·ä¸­æœ‰å¤§è‡´ç›®æ ‡å›¾åƒçš„äººç±»<ul><li>ç”±äºéœ€è¦å¤§è§„æ¨¡å®éªŒï¼Œä¸èƒ½ä¾èµ–ç”¨æˆ·æä¾›ç­”æ¡ˆ</li><li>å› æ­¤ï¼Œä½¿ç”¨äº†ä¸€ä¸ªç°æˆçš„æ¨¡å‹BLIPæ¥å›ç­”</li></ul></li></ul><h3 id="3-2-Image-Retrieval-Model-å›¾åƒæ£€ç´¢æ¨¡å‹"><a href="#3-2-Image-Retrieval-Model-å›¾åƒæ£€ç´¢æ¨¡å‹" class="headerlink" title="3.2 Image Retrieval Model å›¾åƒæ£€ç´¢æ¨¡å‹"></a>3.2 Image Retrieval Model å›¾åƒæ£€ç´¢æ¨¡å‹</h3><p>å›¾åƒæœç´¢è¿‡ç¨‹ï¼šåœ¨<code>æŸ¥è¯¢</code>å’Œ<code>ç›®æ ‡å›¾åƒ</code>å…±äº«çš„è§†è§‰åµŒå…¥ç©ºé—´ä¸­ï¼Œæœç´¢åŒ¹é…é¡¹ã€‚</p><ul><li>æ‰€æœ‰çš„ç›®æ ‡å›¾åƒå…ˆç»è¿‡å›¾åƒåµŒå…¥æ¨¡å—è¿›è¡Œç¼–ç ï¼Œç”±ä¸€ä¸ª$d$ç»´çš„ç‰¹å¾å‘é‡$f\in \mathbb R^d$è¡¨ç¤ºã€‚</li><li>å›¾åƒæ£€ç´¢æ¨¡å—Få°†å¯¹è¯å†å²$D_i$æ˜ å°„åˆ°è§†è§‰åµŒå…¥ç©ºé—´ï¼Œ$F: D_i \rightarrow \mathbb R^d$ï¼Œ</li><li>å€™é€‰å¯¹è±¡æ ¹æ®ä½™å¼¦ç›¸ä¼¼åº¦è·ç¦»ï¼ˆæŸ¥è¯¢åµŒå…¥ï¼‰è¿›è¡Œæ’åºã€‚</li></ul><p>å¼•å…¥åˆ†éš”ç¬¦[SEP]å’Œæ·»åŠ ç¬¦[CLS]ï¼Œè¡¨ç¤ºæ•´ä¸ªå¯¹è¯åºåˆ—ï¼ŒæŠ•å°„åˆ°è§†è§‰åµŒå…¥ç©ºé—´ã€‚</p><p>Fé‡‡ç”¨ï¼ˆä½¿ç”¨BLIPï¼‰é¢„è®­ç»ƒçš„å›¾åƒ/æ–‡æœ¬ç¼–ç å™¨ï¼Œå¹¶é€šè¿‡å¯¹æ¯”å­¦ä¹ ï¼Œå¯¹åŸºäºå¯¹è¯çš„æ£€ç´¢è¿›è¡Œå¾®è°ƒã€‚<br>é€šè¿‡æå–VisDialæ•°æ®é›†ä¸­çš„å›¾åƒå’Œç›¸åº”å¯¹è¯ï¼Œæ‰‹åŠ¨æ ‡æ³¨ï¼Œè®­ç»ƒFã€‚</p><h2 id="æ€»ç»“å’Œå¤ç°"><a href="#æ€»ç»“å’Œå¤ç°" class="headerlink" title="æ€»ç»“å’Œå¤ç°"></a>æ€»ç»“å’Œå¤ç°</h2><ul><li>ChatIRç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºå¯¹è¯çš„å›¾åƒæ£€ç´¢ç³»ç»Ÿï¼ŒåŒ…å«å¯¹è¯æ„å»ºå’Œå›¾åƒæœç´¢ä¸¤ä¸ªéƒ¨åˆ†</li><li>å¯¹è¯æ„å»ºï¼šä½¿ç”¨é—®é¢˜ç”Ÿæˆå™¨Gï¼Œè€ƒè™‘å½“å‰å¯¹è¯å†å²ï¼Œç”Ÿæˆä¸‹ä¸€ä¸ªé—®é¢˜<ul><li>åŸæ–‡æµ‹è¯•äº†ä¸åŒçš„é—®é¢˜ç”Ÿæˆå™¨ï¼Œå…¶ä¸­ChatGPTè¡¨ç°æœ€å¥½</li></ul></li><li>å›¾åƒæœç´¢ï¼šä½¿ç”¨æ¨¡å‹Fï¼Œå°†ä¸åŒé•¿åº¦çš„å¯¹è¯åºåˆ—æ˜ å°„åˆ°è§†è§‰åµŒå…¥ç©ºé—´<ul><li>æˆ‘ä½¿ç”¨äº†è®ºæ–‡ä»“åº“æä¾›çš„é¢„è®­ç»ƒBLIP_ITMæ¨¡å‹</li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset, DataLoader</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"><span class="keyword">from</span> torchvision.transforms.functional <span class="keyword">import</span> InterpolationMode</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os.path</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> multiprocessing <span class="comment"># å¤šè¿›ç¨‹å¤„ç†</span></span><br><span class="line">multiprocessing.set_start_method(<span class="string">&#x27;spawn&#x27;</span>, force=<span class="literal">True</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> OpenAI <span class="keyword">import</span> request_chat <span class="comment"># è‡ªå·±å®ç°çš„è°ƒç”¨APIå‡½æ•° request_chat(dialog:list) -&gt; new_question:str</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys <span class="comment"># æ·»åŠ importè·¯å¾„</span></span><br><span class="line">sys.path.insert(<span class="number">0</span>, <span class="string">&#x27;./BLIP&#x27;</span>)</span><br><span class="line"><span class="keyword">from</span> BLIP.models.blip_itm <span class="keyword">import</span> blip_itm <span class="comment"># BLIPç”¨äºå›¾åƒæ–‡æœ¬åŒ¹é…çš„é¢„è®­ç»ƒæ¨¡å‹</span></span><br><span class="line"></span><br><span class="line">config = &#123;</span><br><span class="line">    <span class="string">&quot;corpus_path&quot;</span>: <span class="string">&quot;VisualDial/search_space.json&quot;</span>, <span class="comment"># å›¾åƒåº“è·¯å¾„</span></span><br><span class="line">    <span class="string">&quot;queries_path&quot;</span>: <span class="string">&quot;dialogues/ChatGPT4oMini_BLIP2.json&quot;</span>, <span class="comment"># æµ‹è¯•å¯¹è¯æ•°æ®è·¯å¾„</span></span><br><span class="line">    <span class="string">&quot;corpus_cache&quot;</span>: <span class="string">&quot;VisualDial/corpus_cache.pth&quot;</span>, <span class="comment"># å¤„ç†å¥½çš„å›¾åƒåº“ç¼“å­˜çš„è·¯å¾„</span></span><br><span class="line">    <span class="string">&quot;device&quot;</span>: <span class="string">&quot;cuda&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sep&quot;</span>: <span class="string">&quot;, &quot;</span>, <span class="comment"># å¯¹è¯åˆ†éš”ç¬¦</span></span><br><span class="line">    <span class="string">&quot;batch_size&quot;</span>: <span class="number">100</span>, <span class="comment"># æ‰¹å¤„ç†å¤§å°</span></span><br><span class="line">    <span class="string">&quot;num_workers&quot;</span>: <span class="number">8</span>, <span class="comment"># å¤šè¿›ç¨‹å¤„ç†æ•°</span></span><br><span class="line">    <span class="string">&quot;image_size&quot;</span> : <span class="number">224</span> <span class="comment"># å›¾åƒå¤§å°</span></span><br><span class="line">&#125;</span><br><span class="line">corpus = <span class="literal">None</span> <span class="comment"># å¤„ç†å¥½çš„å›¾åƒåº“ </span></span><br><span class="line">dialog = [] <span class="comment"># å¯¹è¯</span></span><br><span class="line">images = [] <span class="comment"># å›¾åƒåº“è·¯å¾„ list[å›¾åƒè·¯å¾„]</span></span><br></pre></td></tr></table></figure><h3 id="å›¾åƒæ•°æ®é›†ç±»"><a href="#å›¾åƒæ•°æ®é›†ç±»" class="headerlink" title="å›¾åƒæ•°æ®é›†ç±»"></a>å›¾åƒæ•°æ®é›†ç±»</h3><p>ç»§æ‰¿è‡ªDatasetï¼Œç”¨äºåŠ è½½å›¾åƒæ•°æ®é›†</p><p>corpus_pathï¼šå›¾åƒæ•°æ®é›†.jsonï¼ŒåŒ…å«ä¸€ä¸ªlist[str]ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå›¾åƒçš„è·¯å¾„</p><p>å»ºç«‹è·¯å¾„å­—ç¬¦ä¸²åˆ°ç´¢å¼•çš„æ˜ å°„ï¼Œä¾¿äºèµ‹å€¼ä¼ é€’å’ŒæŸ¥è¯¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Corpus</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å›¾åƒæ•°æ®é›†&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, corpus_path, preprocessor</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;åŠ è½½å›¾åƒæ•°æ®é›†</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            corpus_path: å›¾ç‰‡è·¯å¾„åˆ—è¡¨</span></span><br><span class="line"><span class="string">            preprocessor: å›¾åƒé¢„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(corpus_path, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            self.corpus = json.load(f)</span><br><span class="line">            f.close()</span><br><span class="line">        self.preprocessor = preprocessor</span><br><span class="line">        <span class="comment"># å›¾ç‰‡è·¯å¾„åˆ°ç´¢å¼•çš„æ˜ å°„ï¼Œç”¨äºå¿«é€ŸæŸ¥æ‰¾</span></span><br><span class="line">        self.path2idx = &#123;self.corpus[i]:i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(self.corpus))&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.corpus)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, idx</span>):</span><br><span class="line">        image = self.preprocessor(self.corpus[idx])</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;idx&quot;</span>: idx, <span class="string">&quot;image&quot;</span>: image&#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">path_to_index</span>(<span class="params">self, path</span>):</span><br><span class="line">        <span class="keyword">return</span> self.path2idx[path]</span><br></pre></td></tr></table></figure><h3 id="å›¾åƒé¢„å¤„ç†å‡½æ•°"><a href="#å›¾åƒé¢„å¤„ç†å‡½æ•°" class="headerlink" title="å›¾åƒé¢„å¤„ç†å‡½æ•°"></a>å›¾åƒé¢„å¤„ç†å‡½æ•°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">image_preprocessor</span>(<span class="params">image_path</span>):</span><br><span class="line">    transform_prep = transforms.Compose([ </span><br><span class="line">        transforms.Resize((config[<span class="string">&quot;image_size&quot;</span>], config[<span class="string">&quot;image_size&quot;</span>]), interpolation=InterpolationMode.BICUBIC),</span><br><span class="line">        transforms.ToTensor(),</span><br><span class="line">        transforms.Normalize((<span class="number">0.48145466</span>, <span class="number">0.4578275</span>, <span class="number">0.40821073</span>), (<span class="number">0.26862954</span>, <span class="number">0.26130258</span>, <span class="number">0.27577711</span>)) <span class="comment"># æ­£åˆ™åŒ–å‚æ•°å‚è€ƒBLIPçš„demo</span></span><br><span class="line">    ])</span><br><span class="line">    raw = Image.<span class="built_in">open</span>(image_path).convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line">    img = transform_prep(raw)</span><br><span class="line">    <span class="keyword">return</span> img</span><br></pre></td></tr></table></figure><h3 id="BLIP-ITMæ¨¡å‹çš„å›¾åƒç¼–ç å™¨å’Œå¯¹è¯ç¼–ç å™¨"><a href="#BLIP-ITMæ¨¡å‹çš„å›¾åƒç¼–ç å™¨å’Œå¯¹è¯ç¼–ç å™¨" class="headerlink" title="BLIP_ITMæ¨¡å‹çš„å›¾åƒç¼–ç å™¨å’Œå¯¹è¯ç¼–ç å™¨"></a>BLIP_ITMæ¨¡å‹çš„å›¾åƒç¼–ç å™¨å’Œå¯¹è¯ç¼–ç å™¨</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_funcs</span>():</span><br><span class="line">    <span class="comment"># model_url = &#x27;https://storage.googleapis.com/sfr-vision-language-research/BLIP/models/model_base_retrieval_coco.pth&#x27;</span></span><br><span class="line">    model = blip_itm(pretrained=<span class="string">&#x27;chatir_weights.ckpt&#x27;</span>, <span class="comment"># è®ºæ–‡ä»“åº“ä¸­çš„é¢„è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">                    med_config=<span class="string">&quot;BLIP/configs/med_config.json&quot;</span>, </span><br><span class="line">                    image_size=config[<span class="string">&quot;image_size&quot;</span>],</span><br><span class="line">                    vit=<span class="string">&quot;base&quot;</span>)</span><br><span class="line">    device = config[<span class="string">&quot;device&quot;</span>]</span><br><span class="line">    model = model.to(device).<span class="built_in">eval</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">image_encoder</span>(<span class="params">img</span>):</span><br><span class="line">        embeddings = model.visual_encoder(img) <span class="comment"># embedding</span></span><br><span class="line">        vision_proj = model.vision_proj(embeddings[:, <span class="number">0</span>, :]) <span class="comment"># å›¾åƒç‰¹å¾æŠ•å½±åˆ°ä½ç»´ç©ºé—´</span></span><br><span class="line">        <span class="keyword">return</span> F.normalize(vision_proj, dim=-<span class="number">1</span>) <span class="comment"># æ­£åˆ™åŒ–</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dialog_encoder</span>(<span class="params">dialog</span>):</span><br><span class="line">        text = model.tokenizer(dialog, padding=<span class="string">&#x27;longest&#x27;</span>, truncation=<span class="literal">True</span>, max_length=<span class="number">200</span>, <span class="comment"># å¡«å……åˆ°æœ€é•¿ï¼Œæˆªæ–­åˆ°200</span></span><br><span class="line">                            return_tensors=<span class="string">&quot;pt&quot;</span>).to(device)  <span class="comment"># è¿”å›PyTorchå¼ é‡</span></span><br><span class="line">        text_out = model.text_encoder(text.input_ids, attention_mask=text.attention_mask, <span class="comment"># embedding</span></span><br><span class="line">                                    return_dict=<span class="literal">True</span>, mode=<span class="string">&#x27;text&#x27;</span>) </span><br><span class="line">        shift = model.text_proj(text_out.last_hidden_state[:, <span class="number">0</span>, :]) <span class="comment"># æ–‡æœ¬ç‰¹å¾æŠ•å½±åˆ°ä½ç»´ç©ºé—´</span></span><br><span class="line">        <span class="keyword">return</span> F.normalize(shift, dim=-<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> image_encoder, dialog_encoder</span><br></pre></td></tr></table></figure><h3 id="å¤„ç†å›¾åƒåº“"><a href="#å¤„ç†å›¾åƒåº“" class="headerlink" title="å¤„ç†å›¾åƒåº“"></a>å¤„ç†å›¾åƒåº“</h3><p>ç”±äºåŠ è½½æ—¶é—´é•¿ï¼Œä¸€æ¬¡åŠ è½½åå°†æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ï¼Œä¾¿äºäºŒæ¬¡è°ƒç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">corpus_dataset = Corpus(config[<span class="string">&quot;corpus_path&quot;</span>], image_preprocessor)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prepare_corpus</span>(<span class="params">image_encoder</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å¤„ç†å›¾åƒåº“</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        corpus: tuple[torch.Tensor, torch.Tensor] å›¾åƒåº“ç´¢å¼•å’Œå¯¹åº”çš„å›¾åƒç‰¹å¾å‘é‡</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">global</span> corpus</span><br><span class="line">    corpus_cache = config[<span class="string">&quot;corpus_cache&quot;</span>]</span><br><span class="line">    <span class="keyword">if</span> corpus_cache <span class="keyword">and</span> os.path.exists(corpus_cache): <span class="comment"># è¯»å–ç¼“å­˜</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;-----Loading corpus from <span class="subst">&#123;corpus_cache&#125;</span>-----&quot;</span>)</span><br><span class="line">        corpus = torch.load(corpus_cache)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-----Preparing corpus-----&quot;</span>)</span><br><span class="line">    corpus_dataloader = DataLoader( <span class="comment"># å›¾åƒåº“çš„DataLoader</span></span><br><span class="line">        corpus_dataset,</span><br><span class="line">        batch_size=config[<span class="string">&quot;batch_size&quot;</span>],</span><br><span class="line">        shuffle=<span class="literal">False</span>,</span><br><span class="line">        num_workers=config[<span class="string">&quot;num_workers&quot;</span>],</span><br><span class="line">        pin_memory=<span class="literal">True</span>,</span><br><span class="line">        drop_last=<span class="literal">False</span></span><br><span class="line">    )</span><br><span class="line">    corpus_vectors = []</span><br><span class="line">    corpus_ids = []</span><br><span class="line">    <span class="keyword">for</span> batch <span class="keyword">in</span> tqdm(corpus_dataloader): <span class="comment"># é¢„å¤„ç†å›¾åƒåº“</span></span><br><span class="line">        batch_vectors = F.normalize(image_encoder(batch[<span class="string">&quot;image&quot;</span>].to(config[<span class="string">&quot;device&quot;</span>])), dim=-<span class="number">1</span>) <span class="comment"># æ­£åˆ™åŒ–</span></span><br><span class="line">        corpus_vectors.append(batch_vectors)</span><br><span class="line">        corpus_ids.append(batch[<span class="string">&quot;idx&quot;</span>].to(config[<span class="string">&quot;device&quot;</span>]))</span><br><span class="line"></span><br><span class="line">    corpus_vectors = torch.cat(corpus_vectors)</span><br><span class="line">    corpus_ids = torch.cat(corpus_ids)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æŒ‰ç…§ç´¢å¼•æ’åº</span></span><br><span class="line">    arg_ids = torch.argsort(corpus_ids)</span><br><span class="line">    corpus_vectors = corpus_vectors[arg_ids]</span><br><span class="line">    corpus_ids = corpus_ids[arg_ids]</span><br><span class="line"></span><br><span class="line">    corpus = corpus_ids, corpus_vectors</span><br><span class="line">    <span class="keyword">if</span> config[<span class="string">&quot;corpus_cache&quot;</span>]:</span><br><span class="line">        torch.save(corpus, config[<span class="string">&quot;corpus_cache&quot;</span>]) </span><br></pre></td></tr></table></figure><h3 id="æé—®ä¸åŒ¹é…å‡½æ•°"><a href="#æé—®ä¸åŒ¹é…å‡½æ•°" class="headerlink" title="æé—®ä¸åŒ¹é…å‡½æ•°"></a>æé—®ä¸åŒ¹é…å‡½æ•°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ask_for_caption</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è¯¢é—®ç”¨æˆ·æè¿°&quot;&quot;&quot;</span></span><br><span class="line">    caption = <span class="built_in">input</span>(<span class="string">&quot;Describe the image: &quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> caption</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ask_question</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è¯¢é—®ç”¨æˆ·é—®é¢˜ï¼Œè·å–å›ç­”&quot;&quot;&quot;</span></span><br><span class="line">    question = request_chat(dialog)</span><br><span class="line">    answer = <span class="built_in">input</span>(<span class="string">f&quot;Q: <span class="subst">&#123;question&#125;</span>\nA: &quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> question+<span class="string">&#x27; &#x27;</span>+answer</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_top_results</span>(<span class="params">dialog, dialog_encoder, n=<span class="number">1</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è·å–å‰næœ€ä½³åŒ¹é…ç»“æœ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        dialog: str å¯¹è¯</span></span><br><span class="line"><span class="string">        dialog_encoder: å¯¹è¯ç¼–ç å™¨</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        tops: list[int] å‰nä¸ªåŒ¹é…ç»“æœçš„ç´¢å¼•</span></span><br><span class="line"><span class="string">        topscores: list[float] å‰nä¸ªåŒ¹é…ç»“æœçš„å¾—åˆ†</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    dialog = config[<span class="string">&quot;sep&quot;</span>].join(dialog)</span><br><span class="line">    dialog_vector = dialog_encoder(dialog) <span class="comment"># ç¼–ç å¹¶æ­£åˆ™åŒ–</span></span><br><span class="line">    scores = dialog_vector @ corpus[<span class="number">1</span>].T <span class="comment"># è®¡ç®—å¾—åˆ†</span></span><br><span class="line">    top_id = torch.argsort(scores, descending=<span class="literal">True</span>) <span class="comment"># æ’åº</span></span><br><span class="line">    tops = top_id.tolist()[<span class="number">0</span>][:n]</span><br><span class="line">    topscores = scores[<span class="number">0</span>][tops].tolist()</span><br><span class="line">    <span class="keyword">return</span> tops, topscores</span><br></pre></td></tr></table></figure><h3 id="ä¸»å‡½æ•°"><a href="#ä¸»å‡½æ•°" class="headerlink" title="ä¸»å‡½æ•°"></a>ä¸»å‡½æ•°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    image_encoder, dialog_encoder = get_funcs()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(config[<span class="string">&quot;corpus_path&quot;</span>], <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        images = json.load(f)</span><br><span class="line">        f.close()</span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        prepare_corpus(image_encoder)</span><br><span class="line">    </span><br><span class="line">        dialog.append(ask_for_caption())</span><br><span class="line">        tops,topscores = get_top_results(dialog, dialog_encoder)</span><br><span class="line">        best_image = images[tops[<span class="number">0</span>]]</span><br><span class="line">        best_score = topscores[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Best image: <span class="subst">&#123;best_image&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Best score: <span class="subst">&#123;best_score&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># display(Image.open(best_image))</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">            dialog.append(ask_question())</span><br><span class="line">            tops,topscores = get_top_results(dialog, dialog_encoder)</span><br><span class="line">            best_image = images[tops[<span class="number">0</span>]]</span><br><span class="line">            best_score = topscores[<span class="number">0</span>]</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Best image: <span class="subst">&#123;best_image&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Best score: <span class="subst">&#123;best_score&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> i==<span class="number">1</span>:</span><br><span class="line">                display(Image.<span class="built_in">open</span>(best_image))</span><br></pre></td></tr></table></figure><pre><code>load checkpoint from chatir_weights.ckpt-----Loading corpus from VisualDial/corpus_cache.pth-----Best image: unlabeled2017/000000216870.jpgBest score: 0.32035425305366516[&#39;apples in a basket&#39;]Best image: unlabeled2017/000000216870.jpgBest score: 0.303086519241333[&#39;apples in a basket&#39;, &#39;how many apples are in the basket? 10s&#39;]Best image: unlabeled2017/000000216870.jpgBest score: 0.3046420216560364</code></pre><h2 id="æµ‹è¯•å’Œè¯„ä¼°"><a href="#æµ‹è¯•å’Œè¯„ä¼°" class="headerlink" title="æµ‹è¯•å’Œè¯„ä¼°"></a>æµ‹è¯•å’Œè¯„ä¼°</h2><p>åŸæ–‡è¯„ä¼°ChatIRæ€§èƒ½çš„æŒ‡æ ‡æ˜¯Hit@10ï¼Œå³ç›®æ ‡å›¾åƒå‡ºç°åœ¨æœ€åŒ¹é…çš„10ä¸ªå€™é€‰å›¾åƒä¸­çš„æ¦‚ç‡ï¼Œæˆ‘é‡‡ç”¨ç›¸åŒçš„è¯„ä¼°æ–¹å¼</p><h3 id="å¯¹è¯æ•°æ®é›†ç±»"><a href="#å¯¹è¯æ•°æ®é›†ç±»" class="headerlink" title="å¯¹è¯æ•°æ®é›†ç±»"></a>å¯¹è¯æ•°æ®é›†ç±»</h3><p>å•ä¸ªæµ‹è¯•å¯¹è¯æ•°æ®ç»“æ„ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;image&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image_path&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dialog&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;caption&quot;</span><span class="punctuation">,</span> <span class="string">&quot;question1? answer1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;question2? answer2&quot;</span><span class="punctuation">,</span> ...<span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Queries</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å¯¹è¯-å›¾åƒæ•°æ®é›†&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, queries_path, sep</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;åŠ è½½å¯¹è¯-å›¾åƒæ•°æ®é›†</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            queries_path: str æŸ¥è¯¢æ•°æ®é›†è·¯å¾„</span></span><br><span class="line"><span class="string">            sep: str åˆ†éš”ç¬¦</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(queries_path, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            self.queries = json.load(f)</span><br><span class="line">            f.close()</span><br><span class="line">        self.dialog_length = <span class="literal">None</span></span><br><span class="line">        self.sep = sep</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.queries)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, idx</span>):</span><br><span class="line">        <span class="keyword">assert</span> self.dialog_length <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span></span><br><span class="line">        target_path = self.queries[idx][<span class="string">&quot;img&quot;</span>]</span><br><span class="line">        <span class="comment"># ä¿ç•™å¯¹è¯çš„å‰dialog_lengthè½®</span></span><br><span class="line">        text = self.sep.join(self.queries[idx][<span class="string">&quot;dialog&quot;</span>][:self.dialog_length + <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;text&quot;</span>: text, <span class="string">&quot;target_path&quot;</span>: target_path&#125;</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•ä»£ç "><a href="#æµ‹è¯•ä»£ç " class="headerlink" title="æµ‹è¯•ä»£ç "></a>æµ‹è¯•ä»£ç </h3><p>ä½¿ç”¨äº†è®ºæ–‡ä»“åº“æä¾›çš„æµ‹è¯•ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">corpus_dataset = Corpus(config[<span class="string">&quot;corpus_path&quot;</span>], image_preprocessor)</span><br><span class="line">query_dataset = Queries(config[<span class="string">&quot;queries_path&quot;</span>], config[<span class="string">&quot;sep&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_get_recalls</span>(<span class="params">dataloader, dialog_length, dialog_encoder</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; è®¡ç®—dataloaderä¸­é•¿åº¦ä¸ºdialog_lengthçš„å¯¹è¯çš„å¬å›ç»“æœ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        dataloader: æ•°æ®åŠ è½½å™¨</span></span><br><span class="line"><span class="string">        dialog_length: å¯¹è¯é•¿åº¦</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    dataloader.dataset.dialog_length = dialog_length  <span class="comment"># è®¾ç½®å¯¹è¯é•¿åº¦</span></span><br><span class="line">    recalls = []  <span class="comment"># æ¯ä¸ªå¯¹è¯çš„å¬å›ç»“æœ</span></span><br><span class="line">    <span class="keyword">for</span> batch <span class="keyword">in</span> tqdm(dataloader):</span><br><span class="line">        target_ids = torch.tensor([corpus_dataset.path_to_index(p) <span class="keyword">for</span> p <span class="keyword">in</span> batch[<span class="string">&#x27;target_path&#x27;</span>]]).unsqueeze(<span class="number">1</span>).to(config[<span class="string">&#x27;device&#x27;</span>]) <span class="comment"># å›¾ç‰‡è·¯å¾„è½¬æ¢ä¸ºç´¢å¼•</span></span><br><span class="line">        pred_vec = F.normalize(dialog_encoder(batch[<span class="string">&#x27;text&#x27;</span>]), dim=-<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        scores = pred_vec @ corpus[<span class="number">1</span>].T <span class="comment"># è®¡ç®—ç‚¹ç§¯ï¼Œå¾—åˆ°ç›¸ä¼¼åº¦åˆ†æ•°</span></span><br><span class="line">        arg_ranks = torch.argsort(scores, descending=<span class="literal">True</span>, dim=<span class="number">1</span>).long() <span class="comment"># å¯¹åˆ†æ•°è¿›è¡Œæ’åº</span></span><br><span class="line">        </span><br><span class="line">        target_recall = ((arg_ranks - target_ids) == <span class="number">0</span>).nonzero()[:, <span class="number">1</span>] <span class="comment"># æ£€æŸ¥ç›®æ ‡å›¾åƒæ˜¯å¦å‡ºç°åœ¨æ’åçš„å‰å‡ ä¸ªå›¾åƒä¸­</span></span><br><span class="line">        recalls.append(target_recall)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> torch.cat(recalls)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_first_hitting_time</span>(<span class="params">target_recall, hitting_recall=<span class="number">10</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; è¿”å›(11, n)å¼ é‡ï¼Œå…¶ä¸­åŒ…å«æ¯è½®ï¼ˆ0, 11ï¼‰çš„å‘½ä¸­æ—¶é—´ã€‚infè¡¨ç¤ºæœªå‘½ä¸­ï¼ˆ11è½®åæ²¡æœ‰å‘½ä¸­ï¼‰ &quot;&quot;&quot;</span></span><br><span class="line">    target_recalls = target_recall.view(<span class="number">11</span>, -<span class="number">1</span>).T</span><br><span class="line">    hits = (target_recalls &lt; hitting_recall)</span><br><span class="line"></span><br><span class="line">    final_hits = torch.inf * torch.ones(target_recalls.shape[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    hitting_times = []</span><br><span class="line">    <span class="keyword">for</span> ro_i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">        rh = hits[:, ro_i]</span><br><span class="line">        final_hits[rh] = torch.<span class="built_in">min</span>(final_hits[rh], torch.ones(final_hits[rh].shape) * ro_i)</span><br><span class="line">        hitting_times.append(final_hits.clone())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> torch.stack(hitting_times)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cumulative_hits_per_round</span>(<span class="params">target_recall, hitting_recall=<span class="number">10</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; è¿”å›ç›´åˆ°ç¬¬xè½®çš„å¹³å‡å‘½ä¸­æ¬¡æ•° &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(hitting_recall) <span class="keyword">is</span> <span class="built_in">tuple</span>:</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(hitting_recall) == <span class="number">1</span></span><br><span class="line">        hitting_recall = hitting_recall[<span class="number">0</span>]</span><br><span class="line">    ht_times = get_first_hitting_time(target_recall, hitting_recall)</span><br><span class="line">    <span class="keyword">return</span> ((ht_times &lt; torch.inf).<span class="built_in">sum</span>(dim=-<span class="number">1</span>) * <span class="number">100</span> / ht_times[<span class="number">0</span>].shape[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">eval</span>(<span class="params">image_encoder, dialog_encoder, hits_at=<span class="number">10</span></span>):</span><br><span class="line">    prepare_corpus(image_encoder)</span><br><span class="line">    query_dataloader = torch.utils.data.DataLoader(query_dataset, <span class="comment"># è¯¢é—®æ•°æ®é›†</span></span><br><span class="line">                                             batch_size=config[<span class="string">&#x27;batch_size&#x27;</span>], <span class="comment"># æ‰¹å¤§å°</span></span><br><span class="line">                                             shuffle=<span class="literal">False</span>, <span class="comment"># ä¸æ‰“ä¹±</span></span><br><span class="line">                                             num_workers=config[<span class="string">&#x27;num_workers&#x27;</span>], <span class="comment"># å¤šçº¿ç¨‹</span></span><br><span class="line">                                             pin_memory=<span class="literal">True</span>, <span class="comment"># é”é¡µå†…å­˜</span></span><br><span class="line">                                             drop_last=<span class="literal">False</span></span><br><span class="line">                                             )</span><br><span class="line">    hits_results = []</span><br><span class="line">    <span class="keyword">for</span> dl <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>): <span class="comment"># å¯¹è¯é•¿åº¦ä»0åˆ°10</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Calculate recalls for each dialogues of length <span class="subst">&#123;dl&#125;</span>...&quot;</span>)</span><br><span class="line">        dialog_recalls = _get_recalls(query_dataloader, dialog_length=dl, dialog_encoder=dialog_encoder)</span><br><span class="line">        hits_results.append(dialog_recalls)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä½¿ç”¨cumulative_hits_per_roundè®¡ç®—æœ€ç»ˆçš„Hits@10ç»“æœ</span></span><br><span class="line">    <span class="comment"># Hits@10ï¼š`åœ¨é¢„æµ‹çš„å‰ 10 ä¸ªå€™é€‰é¡¹ä¸­ï¼ŒåŒ…å«äº†æ­£ç¡®ç­”æ¡ˆ`çš„æ¯”ä¾‹</span></span><br><span class="line">    hits_results = cumulative_hits_per_round(torch.cat(hits_results).cpu(), hitting_recall=<span class="number">10</span>).tolist()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;====== Results for Hits@10 ====== &quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> dl <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\t Dialog Length: <span class="subst">&#123;dl&#125;</span>: <span class="subst">&#123;<span class="built_in">round</span>(hits_results[dl], <span class="number">2</span>)&#125;</span>%&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    image_encoder, dialog_encoder = get_funcs()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(config[<span class="string">&quot;corpus_path&quot;</span>], <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        images = json.load(f)</span><br><span class="line">        f.close()</span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        <span class="built_in">eval</span>(image_encoder, dialog_encoder)</span><br></pre></td></tr></table></figure><h3 id="å¯¹è¯æ•°æ®ç”Ÿæˆ"><a href="#å¯¹è¯æ•°æ®ç”Ÿæˆ" class="headerlink" title="å¯¹è¯æ•°æ®ç”Ÿæˆ"></a>å¯¹è¯æ•°æ®ç”Ÿæˆ</h3><p>åŸæ–‡ä¸­ï¼Œä¸ºäº†è‡ªåŠ¨è·å–æµ‹è¯•æ•°æ®ï¼Œå…é™¤äººå·¥å›ç­”ï¼Œä½¿ç”¨äº†BLIP2æ¨¡å‹å›ç­”é—®é¢˜</p><p>æˆ‘å‚è€ƒåŸæ–‡çš„æ–¹æ³•ï¼Œä½¿ç”¨BLIP2ç”Ÿæˆå¯¹è¯æ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lavis.models <span class="keyword">import</span> load_model_and_preprocess <span class="comment"># BLIP2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> OpenAI <span class="keyword">import</span> request_chat</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">st,ed = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>]), <span class="built_in">int</span>(sys.argv[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;../dialogues/ChatGPT_BLIP2.json&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = json.load(f)</span><br><span class="line">    f.close()</span><br><span class="line"></span><br><span class="line">images = [d[<span class="string">&quot;img&quot;</span>] <span class="keyword">for</span> d <span class="keyword">in</span> data][st:ed]</span><br><span class="line">captions = [d[<span class="string">&quot;dialog&quot;</span>][<span class="number">0</span>] <span class="keyword">for</span> d <span class="keyword">in</span> data][st:ed]</span><br><span class="line"></span><br><span class="line">config = &#123;</span><br><span class="line">    <span class="string">&quot;device&quot;</span>: <span class="string">&quot;cuda&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>,</span><br><span class="line">    <span class="string">&quot;image_size&quot;</span> : <span class="number">224</span>,</span><br><span class="line">    <span class="string">&quot;sep&quot;</span>: <span class="string">&quot;, &quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> config[<span class="string">&quot;device&quot;</span>] == <span class="string">&quot;cuda&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Using GPU&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_demo_image</span>(<span class="params">image_path</span>):</span><br><span class="line">    raw_image = Image.<span class="built_in">open</span>(image_path).convert(<span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line">    image = vis_processors[<span class="string">&quot;eval&quot;</span>](raw_image).unsqueeze(<span class="number">0</span>).to(config[<span class="string">&quot;device&quot;</span>])</span><br><span class="line">    <span class="keyword">return</span> image</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">visual_qa</span>(<span class="params">image, question, model</span>):</span><br><span class="line">    answer = model.generate(&#123;<span class="string">&quot;image&quot;</span>: image, <span class="string">&quot;prompt&quot;</span>: <span class="string">f&quot;Question: <span class="subst">&#123;question&#125;</span> Answer:&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">return</span> answer[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ask_question</span>(<span class="params">dialog</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è¯¢é—®ç”¨æˆ·é—®é¢˜&quot;&quot;&quot;</span></span><br><span class="line">    question = request_chat(dialog)</span><br><span class="line">    <span class="keyword">return</span> question</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_dialog</span>(<span class="params">idx, model</span>):</span><br><span class="line">    image = load_demo_image(images[idx])</span><br><span class="line">    caption = captions[idx]</span><br><span class="line">    dialog = [caption]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        question = ask_question(dialog)</span><br><span class="line">        answer = visual_qa(image, question, model)</span><br><span class="line">        dialog.append(question+answer)</span><br><span class="line">    ret = &#123;</span><br><span class="line">        <span class="string">&quot;img&quot;</span>: images[idx],</span><br><span class="line">        <span class="string">&quot;dialog&quot;</span>: dialog</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    model, vis_processors, _ = load_model_and_preprocess(</span><br><span class="line">        name=<span class="string">&quot;blip2_opt&quot;</span>, model_type=<span class="string">&quot;caption_coco_opt6.7b&quot;</span>, is_eval=<span class="literal">True</span>, device=config[<span class="string">&quot;device&quot;</span>]</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;ChatGPT4oMini_BLIP2.txt&quot;</span>, <span class="string">&quot;a&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> idx <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="built_in">len</span>(images))):</span><br><span class="line">                dialog = generate_dialog(idx, model)</span><br><span class="line">                json.dump(dialog, f)</span><br><span class="line">                f.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">            f.close()</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•ä¿®æ­£æ—¥å¿—"><a href="#æµ‹è¯•ä¿®æ­£æ—¥å¿—" class="headerlink" title="æµ‹è¯•ä¿®æ­£æ—¥å¿—"></a>æµ‹è¯•ä¿®æ­£æ—¥å¿—</h3><ol><li>ç”±äºOpenAIçš„tokené™åˆ¶ï¼Œæˆ‘ä½¿ç”¨äº†è®¯é£æ˜Ÿç«APIä½œä¸ºæé—®æ¨¡å‹G</li><li>è®ºæ–‡æ²¡è¯»ä»”ç»†ï¼Œä¸€å¼€å§‹ä»¥ä¸ºç”Ÿæˆå¯¹è¯æ•°æ®æ—¶ï¼Œä»£æ›¿äººç±»å›ç­”çš„æ¨¡å‹å’Œç¼–ç ç”¨çš„æ¨¡å‹ä¸€æ ·ï¼Œæ˜¯BLIP</li><li>åœ¨ä»¥ä¸ŠåŸºç¡€ä¸Šï¼Œæµ‹è¯•çš„Hit@10ç»“æœï¼ˆ40%~60%ï¼‰ä¸åŸæ–‡ï¼ˆ63%~80%ï¼‰æœ‰è¾ƒå¤§å·®è·</li><li>åŸæœ¬è®¤ä¸ºæ˜¯æé—®æ¨¡å‹Gæ²¡æœ‰ç”¨ChatGPTçš„åŸå› ï¼Œå¾®æ°ªtokenï¼Œè°ƒæ•´ä¸ºChatGPT4o-miniï¼Œä½†ç»“æœä¾ç„¶ä¸ç†æƒ³ï¼ˆ40%~67%ï¼‰</li><li>æ³¨æ„åˆ°ï¼Œ40%æ˜¯$D_0$ï¼Œä¹Ÿå°±æ˜¯åªæœ‰ç”¨BLIPç”Ÿæˆçš„ç¬¬ä¸€å¥æè¿°æ—¶çš„å‡†ç¡®ç‡ï¼Œå’Œæé—®æ¨¡å‹Gæ— å…³</li><li>å¯¹æ¯”åŸæ–‡ï¼Œå‘ç°å›ç­”æ¨¡å‹åº”è¯¥æ˜¯å¦ä¸€ç¯‡paperä¸­çš„BLIP2ï¼Œè€Œä¸æ˜¯BLIP</li><li>ä¿®æ”¹æ•°æ®ç”Ÿæˆä»£ç ï¼Œä½¿ç”¨BLIP2ç”Ÿæˆå¯¹è¯æ•°æ®ï¼Œæµ‹è¯•ç»“æœä¸åŸæ–‡æ¥è¿‘ï¼ˆ60%~80%ï¼‰</li></ol><p>å®¢è§‚é—®é¢˜ï¼šç”±äºç¡¬ä»¶æ¡ä»¶æœ‰é™ï¼Œè·‘å‡ºä¸€æ¡æ•°æ®éœ€è¦3~5åˆ†é’Ÿï¼Œå› æ­¤åªæµ‹è¯•äº†1021æ¡æ•°æ®ï¼Œå¯¹äºæ•´ä½“æ€§èƒ½è¯„ä¼°å¯èƒ½ä¸å¤Ÿå‡†ç¡®</p><h3 id="æµ‹è¯•ç»“æœ"><a href="#æµ‹è¯•ç»“æœ" class="headerlink" title="æµ‹è¯•ç»“æœ"></a>æµ‹è¯•ç»“æœ</h3><p>åœ¨ä½¿ç”¨ChatGPTä½œä¸ºæé—®æ¨¡å‹Gï¼ŒBLIP2ä½œä¸ºå›ç­”æ¨¡å‹Aï¼Œä½¿ç”¨åŒä¸€æµ‹è¯•ä»£ç çš„æƒ…å†µä¸‹ï¼Œæµ‹è¯•ç»“æœå’ŒåŸæ–‡å¯¹æ¯”å¦‚ä¸‹ï¼š</p><div class="table-container"><table><thead><tr><th style="text-align:center">length</th><th style="text-align:center">åŸæ–‡(2064 testcases)</th><th style="text-align:center">å¤ç°ï¼ˆ1021 testcasesï¼‰</th></tr></thead><tbody><tr><td style="text-align:center">0</td><td style="text-align:center">63.42%</td><td style="text-align:center">62.98%</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">69.43%</td><td style="text-align:center">70.62%</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">72.38%</td><td style="text-align:center">72.67%</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">74.47%</td><td style="text-align:center">74.53%</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">76.02%</td><td style="text-align:center">75.32%</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">77.47%</td><td style="text-align:center">75.42%</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">78.49%</td><td style="text-align:center">76.00%</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">79.65%</td><td style="text-align:center">76.20%</td></tr><tr><td style="text-align:center">8</td><td style="text-align:center">80.09%</td><td style="text-align:center">76.69%</td></tr><tr><td style="text-align:center">9</td><td style="text-align:center">80.43%</td><td style="text-align:center">76.98%</td></tr><tr><td style="text-align:center">10</td><td style="text-align:center">80.77%</td><td style="text-align:center">77.18%</td></tr></tbody></table></div><p>åœ¨ç¬¬äº”è½®å¯¹è¯åï¼Œå¯¹è¯é•¿åº¦å¢åŠ å¯¹æ£€ç´¢æ€§èƒ½çš„æå‡ä¸å†æ˜æ˜¾</p>]]></content>
    
    
    <summary type="html">å¤ç°è®ºæ–‡ã€ŠChatting Makes Perfectï¼šChat-based Image Retrivalã€‹</summary>
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>Pretrained BLIP è°ƒç”¨ç¬”è®°</title>
    <link href="https://www.cclmsy.cc/posts/Pretrained_BLIP.html"/>
    <id>https://www.cclmsy.cc/posts/Pretrained_BLIP.html</id>
    <published>2025-03-03T04:00:00.000Z</published>
    <updated>2025-03-02T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/salesforce/BLIP">Github Repo</a></p><p>BLIPå…¨ç§°Bootstrapping Language-Image Pre-trainingï¼Œæ˜¯ä¸€ä¸ªå…¨æ–°çš„ ç»Ÿä¸€è§†è§‰è¯­è¨€ç†è§£ä¸ç”Ÿæˆçš„é¢„è®­ç»ƒæ¨¡å‹</p><p>å®ƒç»Ÿä¸€äº†è§†è§‰è¯­è¨€ä»»åŠ¡çš„ç†è§£ä¸ç”ŸæˆåŠŸèƒ½ï¼Œå¹¶ä¸”é€šè¿‡åµŒå…¥ Captioner å’Œ Filter å»é™¤ç½‘ç»œèµ„æºä¸­çš„æ–‡æœ¬å™ªå£°ï¼Œæé«˜äº†æ¨¡å‹åœ¨ä¸‹æ¸¸è§†è§‰è¯­è¨€ä»»åŠ¡ä¸Šçš„æ€§èƒ½</p><h2 id="Colab-Notebook-è¿è¡Œ"><a href="#Colab-Notebook-è¿è¡Œ" class="headerlink" title="Colab Notebook è¿è¡Œ"></a>Colab Notebook è¿è¡Œ</h2><p>Salesforceåœ¨Colab NoteBookä¸­æä¾›äº†Demoï¼Œå¯ä»¥åœ¨äº‘ç«¯ç›´æ¥è¿è¡Œï¼š<a href="https://colab.research.google.com/github/salesforce/BLIP/blob/main/demo.ipynb">Colab notebook</a></p><p>ç¬¬ä¸€æ­¥é…ç½®ç¯å¢ƒæ—¶å‡ºç°<code>ERROR: Failed building wheel for tokenizers</code>é—®é¢˜ï¼Œåœ¨<a href="https://github.com/salesforce/BLIP/issues/151#issuecomment-1537125671">Issue#151çš„è¯„è®º</a>ä¸­æä¾›äº†è§£å†³æ–¹æ¡ˆï¼šä¿®æ”¹transformersç‰ˆæœ¬<code>4.25.1</code></p><h2 id="æœ¬åœ°è°ƒç”¨"><a href="#æœ¬åœ°è°ƒç”¨" class="headerlink" title="æœ¬åœ°è°ƒç”¨"></a>æœ¬åœ°è°ƒç”¨</h2><p>å­¦ä¹ åœ¨æœ¬åœ°ä½¿ç”¨Pretrained BLIPæ¨¡å‹ï¼Œæµ‹è¯•ä»£ç ç½®äºBLIPç›®å½•ä¸‹</p><p>å®éªŒç¯å¢ƒï¼š</p><ul><li>Python 3.11.11 on conda</li><li>transformers 4.25.1</li><li>timm 0.4.12</li><li>fairscale 0.4.4</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"><span class="keyword">from</span> torchvision.transforms.functional <span class="keyword">import</span> InterpolationMode</span><br><span class="line"></span><br><span class="line">device = torch.device(<span class="string">&#x27;cuda&#x27;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&#x27;cpu&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_demo_image</span>(<span class="params">image_size,device</span>):</span><br><span class="line">    img_url = <span class="string">&#x27;https://storage.googleapis.com/sfr-vision-language-research/BLIP/demo.jpg&#x27;</span> </span><br><span class="line">    raw_image = Image.<span class="built_in">open</span>(requests.get(img_url, stream=<span class="literal">True</span>).raw).convert(<span class="string">&#x27;RGB&#x27;</span>)   </span><br><span class="line"></span><br><span class="line">    w,h = raw_image.size</span><br><span class="line">    <span class="built_in">print</span>(raw_image.resize((w//<span class="number">5</span>,h//<span class="number">5</span>)))</span><br><span class="line">    </span><br><span class="line">    transform = transforms.Compose([</span><br><span class="line">        transforms.Resize((image_size,image_size),interpolation=InterpolationMode.BICUBIC),</span><br><span class="line">        transforms.ToTensor(),</span><br><span class="line">        transforms.Normalize((<span class="number">0.48145466</span>, <span class="number">0.4578275</span>, <span class="number">0.40821073</span>), (<span class="number">0.26862954</span>, <span class="number">0.26130258</span>, <span class="number">0.27577711</span>))</span><br><span class="line">        ]) </span><br><span class="line">    image = transform(raw_image).unsqueeze(<span class="number">0</span>).to(device)   </span><br><span class="line">    <span class="keyword">return</span> image</span><br></pre></td></tr></table></figure><h3 id="Image-Captioning-å›¾åƒæè¿°"><a href="#Image-Captioning-å›¾åƒæè¿°" class="headerlink" title="Image Captioning å›¾åƒæè¿°"></a>Image Captioning å›¾åƒæè¿°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> models.blip <span class="keyword">import</span> blip_decoder</span><br><span class="line"></span><br><span class="line">image_size = <span class="number">384</span></span><br><span class="line">image = load_demo_image(image_size=image_size, device=device)</span><br><span class="line"></span><br><span class="line">model_url = <span class="string">&#x27;https://storage.googleapis.com/sfr-vision-language-research/BLIP/models/model_base_capfilt_large.pth&#x27;</span></span><br><span class="line">    </span><br><span class="line">model = blip_decoder(pretrained=model_url, image_size=image_size, vit=<span class="string">&#x27;base&#x27;</span>)</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line">model = model.to(device)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line">    <span class="comment"># beam search </span></span><br><span class="line">    caption = model.generate(image, sample=<span class="literal">False</span>, num_beams=<span class="number">3</span>, max_length=<span class="number">20</span>, min_length=<span class="number">5</span>)</span><br><span class="line">    <span class="comment"># nucleus sampling</span></span><br><span class="line">    <span class="comment"># caption = model.generate(image, sample=True, top_p=0.9, max_length=20, min_length=5)  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;caption: &#x27;</span>+caption[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><pre><code>The cache for model files in Transformers v4.22.0 has been updated. Migrating your old cache. This is a one-time only operation. You can interrupt this and resume the migration later on by calling `transformers.utils.move_cache()`.Moving 0 files to the new cache system0it [00:00, ?it/s]&lt;PIL.Image.Image image mode=RGB size=409x273 at 0x11139327650&gt;reshape position embedding from 196 to 576load checkpoint from https://storage.googleapis.com/sfr-vision-language-research/BLIP/models/model_base_capfilt_large.pthcaption: a woman and her dog on the beach</code></pre><h3 id="Visual-Question-Answering-è§†è§‰é—®ç­”"><a href="#Visual-Question-Answering-è§†è§‰é—®ç­”" class="headerlink" title="Visual Question Answering è§†è§‰é—®ç­”"></a>Visual Question Answering è§†è§‰é—®ç­”</h3><p>ç”±äºå­˜åœ¨å’ŒImageCaptioningä¸­çš„beam_searchç›¸åŒçš„ç‰ˆæœ¬é—®é¢˜ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> models.blip_vqa <span class="keyword">import</span> blip_vqa</span><br><span class="line"></span><br><span class="line">image_size = <span class="number">480</span></span><br><span class="line">image = load_demo_image(image_size=image_size, device=device)     </span><br><span class="line"></span><br><span class="line">model_url = <span class="string">&#x27;https://storage.googleapis.com/sfr-vision-language-research/BLIP/models/model_base_vqa_capfilt_large.pth&#x27;</span></span><br><span class="line">    </span><br><span class="line">model = blip_vqa(pretrained=model_url, image_size=image_size, vit=<span class="string">&#x27;base&#x27;</span>)</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line">model = model.to(device)</span><br><span class="line"></span><br><span class="line">question = <span class="string">&#x27;where is the woman sitting?&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line">    answer = model(image, question, train=<span class="literal">False</span>, inference=<span class="string">&#x27;generate&#x27;</span>) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;answer: &#x27;</span>+answer[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><pre><code>&lt;PIL.Image.Image image mode=RGB size=409x273 at 0x11139109090&gt;load checkpoint from https://storage.googleapis.com/sfr-vision-language-research/BLIP/models/model_base_vqa_capfilt_large.pthanswer: on beach</code></pre><h3 id="Image-Text-Matching-å›¾æ–‡åŒ¹é…"><a href="#Image-Text-Matching-å›¾æ–‡åŒ¹é…" class="headerlink" title="Image-Text Matching å›¾æ–‡åŒ¹é…"></a>Image-Text Matching å›¾æ–‡åŒ¹é…</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> models.blip_itm <span class="keyword">import</span> blip_itm</span><br><span class="line"></span><br><span class="line">image_size = <span class="number">384</span></span><br><span class="line">image = load_demo_image(image_size=image_size,device=device)</span><br><span class="line"></span><br><span class="line">model_url = <span class="string">&#x27;https://storage.googleapis.com/sfr-vision-language-research/BLIP/models/model_base_retrieval_coco.pth&#x27;</span></span><br><span class="line">    </span><br><span class="line">model = blip_itm(pretrained=model_url, image_size=image_size, vit=<span class="string">&#x27;base&#x27;</span>)</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line">model = model.to(device=device)</span><br><span class="line"></span><br><span class="line">caption = <span class="string">&#x27;a woman sitting on the beach with a dog&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;text: %s&#x27;</span> %caption)</span><br><span class="line"></span><br><span class="line">itm_output = model(image,caption,match_head=<span class="string">&#x27;itm&#x27;</span>)</span><br><span class="line">itm_score = torch.nn.functional.softmax(itm_output,dim=<span class="number">1</span>)[:,<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;The image and text is matched with a probability of %.4f&#x27;</span>%itm_score)</span><br><span class="line"></span><br><span class="line">itc_score = model(image,caption,match_head=<span class="string">&#x27;itc&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;The image feature and text feature has a cosine similarity of %.4f&#x27;</span>%itc_score)</span><br></pre></td></tr></table></figure><pre><code>&lt;PIL.Image.Image image mode=RGB size=409x273 at 0x11130227FD0&gt;load checkpoint from https://storage.googleapis.com/sfr-vision-language-research/BLIP/models/model_base_retrieval_coco.pthtext: a woman sitting on the beach with a dogThe image and text is matched with a probability of 0.9960The image feature and text feature has a cosine similarity of 0.5262</code></pre>]]></content>
    
    
    <summary type="html">Salesforceæä¾›çš„ç»Ÿä¸€è§†è§‰è¯­è¨€ç†è§£ä¸ç”Ÿæˆçš„é¢„è®­ç»ƒæ¨¡å‹</summary>
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>å¤ç°|æ‰‹æ“Transformeræ¨¡å‹</title>
    <link href="https://www.cclmsy.cc/posts/Transformer.html"/>
    <id>https://www.cclmsy.cc/posts/Transformer.html</id>
    <published>2025-02-28T13:00:00.000Z</published>
    <updated>2025-02-27T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/1706.03762">Attention is All You Need</a></p><blockquote><p>2017å¹´Googleåœ¨è®ºæ–‡ã€ŠAttention is All You Needã€‹ä¸­æå‡ºäº†Transformeræ¨¡å‹ï¼Œå¹¶æˆåŠŸåº”ç”¨åˆ°NLPé¢†åŸŸã€‚<br>è¯¥æ¨¡å‹å®Œå…¨åŸºäºè‡ªæ³¨æ„åŠ›æœºåˆ¶Attention mechanismå®ç°ï¼Œå¼¥è¡¥äº†ä¼ ç»Ÿçš„RNNæ¨¡å‹çš„ä¸è¶³ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¨å±€å˜é‡</span></span><br><span class="line">d_model = <span class="number">512</span> <span class="comment"># è¯å‘é‡ç»´åº¦</span></span><br><span class="line">d_ff = <span class="number">2048</span> <span class="comment"># å‰é¦ˆç¥ç»ç½‘ç»œéšå±‚ç»´åº¦</span></span><br><span class="line">src_vocab_size = <span class="number">10</span> <span class="comment"># æºè¯­è¨€è¯è¡¨å¤§å°</span></span><br><span class="line">tgt_vocab_size = <span class="number">10</span> <span class="comment"># ç›®æ ‡è¯­è¨€è¯è¡¨å¤§å°</span></span><br><span class="line">n_layers = <span class="number">6</span> <span class="comment"># ç¼–ç å™¨å’Œè§£ç å™¨å †å åŸºç¡€å—çš„æ•°é‡</span></span><br></pre></td></tr></table></figure><h2 id="0-TransformeråŸç†"><a href="#0-TransformeråŸç†" class="headerlink" title="0.TransformeråŸç†"></a>0.TransformeråŸç†</h2><p>å®è§‚ä¸Šï¼ŒTransformerå¯ä»¥çœ‹ä½œä¸€ä¸ªé»‘ç®±æ“ä½œçš„Seq2Seqæ¨¡å‹ã€‚<br>æ‹†å¼€é»‘ç®±ï¼Œå¯ä»¥çœ‹åˆ°æ¨¡å‹çš„æœ¬è´¨æ˜¯ä¸€ä¸ªEncoder-Decoderç»“æ„ã€‚</p><p><img src="https://source.cclmsy.cc/Images/Posts/Transformer/Transformeræ•´ä½“æ¶æ„.webp" alt="Transformeræ•´ä½“æ¶æ„"></p><ul><li>Embeddingï¼šè¯åµŒå…¥å±‚ï¼Œå°†è¾“å…¥çš„è¯è½¬æ¢ä¸ºè¯å‘é‡</li><li>Positional Encodingï¼šä½ç½®ç¼–ç ï¼Œä¸ºäº†è®©æ¨¡å‹å­¦ä¹ åˆ°åºåˆ—çš„ä½ç½®ä¿¡æ¯</li><li>Multi-Head Attentionï¼šå¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼Œç”¨äºæ•æ‰è¾“å…¥åºåˆ—çš„å…¨å±€ä¾èµ–å…³ç³»</li><li>Add &amp; Normï¼šæ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–ï¼Œç”¨äºåŠ é€Ÿè®­ç»ƒã€ç¼“è§£æ¢¯åº¦æ¶ˆå¤±é—®é¢˜<ul><li>Addæ®‹å·®è¿æ¥ï¼šæŠŠç½‘ç»œçš„è¾“å…¥å’Œè¾“å‡ºç›¸åŠ ï¼Œæœ‰æ•ˆè§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜</li><li>Normå±‚å½’ä¸€åŒ–ï¼šå¯¹ç½‘ç»œçš„è¾“å‡ºè¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼ŒåŠ é€Ÿè®­ç»ƒ</li></ul></li><li>Feed Forwardï¼šå‰é¦ˆç¥ç»ç½‘ç»œï¼Œç”¨äºå¯¹ç‰¹å¾è¿›è¡Œéçº¿æ€§å˜æ¢</li><li>Linearï¼šçº¿æ€§å˜æ¢å±‚ï¼Œç”¨äºå°†ç‰¹å¾æ˜ å°„åˆ°è¾“å‡ºç©ºé—´</li><li>Softmaxï¼šSoftmaxå±‚ï¼Œç”¨äºè¾“å‡ºæ¦‚ç‡åˆ†å¸ƒ</li></ul><h2 id="1-Encoder"><a href="#1-Encoder" class="headerlink" title="1.Encoder"></a>1.Encoder</h2><p><img src="https://source.cclmsy.cc/Images/Posts/Transformer/Transformer_Encoder.webp" alt="Transformer_Encoder"></p><h3 id="1-1-Embedding-è¯åµŒå…¥"><a href="#1-1-Embedding-è¯åµŒå…¥" class="headerlink" title="1.1 Embedding è¯åµŒå…¥"></a>1.1 Embedding è¯åµŒå…¥</h3><p>æ¨¡å‹æ— æ³•ç›´æ¥å¤„ç†æ–‡æœ¬æ•°æ®ï¼Œéœ€è¦æŠŠæ–‡æœ¬æ•°æ®è½¬æ¢æˆè®¡ç®—æœºèƒ½å¤Ÿè¯†åˆ«çš„å‘é‡å½¢å¼ã€‚<br>å°†æ–‡æœ¬è½¬åŒ–ä¸ºå‘é‡é€šå¸¸æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>One-hotç¼–ç ï¼šè¯å…¸å¤§å°ä¸ºNï¼Œæ¯ä¸ªè¯ç”¨ä¸€ä¸ªNç»´å‘é‡è¡¨ç¤ºï¼Œå½“å‰è¯å¯¹åº”çš„ç»´åº¦ä¸º1ï¼Œå…¶ä½™ç»´åº¦ä¸º0<ul><li>ä¼˜ç‚¹ï¼šç®€å•ç›´è§‚</li><li>ç¼ºç‚¹ï¼šå‘é‡ç»´åº¦é«˜ã€ç¨€ç–ã€ç¼ºä¹è¯­ä¹‰ä¹‹é—´çš„è”ç³»</li></ul></li><li>Embeddingè¯åµŒå…¥ï¼šé€šè¿‡è®­ç»ƒå­¦ä¹ åˆ°çš„è¯å‘é‡ï¼Œå°†è¯æ˜ å°„åˆ°ä¸€ä¸ªä½ç»´ç©ºé—´<ul><li>ä¼˜ç‚¹ï¼šä½ç»´ã€ç¨ å¯†ã€èƒ½å¤Ÿè¡¨è¾¾è¯ä¹‹é—´çš„å…³ç³»</li></ul></li></ul><p>è¾“å…¥Imputçš„ç»´åº¦æ˜¯[batch_size, seq_len]ï¼ŒEmbeddingå±‚çš„è¾“å‡ºç»´åº¦æ˜¯[batch_size, seq_len, d_model]ã€‚</p><ul><li>batch_sizeï¼šæ‰¹æ¬¡å¤§å°ï¼ˆå¥å­ä¸ªæ•°ï¼‰</li><li>seq_lenï¼šæœ€é•¿å¥å­é•¿åº¦</li><li>d_modelï¼šè¯å‘é‡ç»´åº¦</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Embeddings</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, vocab_size, d_model</span>):</span><br><span class="line">        <span class="built_in">super</span>(Embeddings, self).__init__()</span><br><span class="line">        <span class="comment"># è°ƒç”¨nn.Embeddingï¼Œè·å¾—å®ä¾‹åŒ–çš„è¯åµŒå…¥å¯¹è±¡lut(look up table)</span></span><br><span class="line">        self.lut = nn.Embedding(vocab_size, d_model)</span><br><span class="line">        self.d_model = d_model <span class="comment"># è¯åµŒå…¥ç»´åº¦</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Embeddingå±‚çš„å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            x: è¾“å…¥çš„è¯ç´¢å¼•å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            è¯åµŒå…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, d_model)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> self.lut(x) * math.sqrt(self.d_model)</span><br></pre></td></tr></table></figure><h3 id="1-2-Positional-Encoding-ä½ç½®ç¼–ç "><a href="#1-2-Positional-Encoding-ä½ç½®ç¼–ç " class="headerlink" title="1.2 Positional Encoding ä½ç½®ç¼–ç "></a>1.2 Positional Encoding ä½ç½®ç¼–ç </h3><p>Embeddingå±‚åªèƒ½è¡¨ç¤ºè¯çš„è¯­ä¹‰ä¿¡æ¯ï¼Œæ— æ³•è¡¨ç¤ºè¯çš„ä½ç½®ä¿¡æ¯ã€‚<br>Transformerä½¿ç”¨çš„æ˜¯è‡ªæ³¨æ„åŠ›æœºåˆ¶æ¥æå–ä¿¡æ¯ï¼Œä¸€ä¸ªå¥å­ä¸­çš„æ¯ä¸ªå­—/è¯æ˜¯å¹¶è¡Œè®¡ç®—ï¼Œè™½ç„¶å¤„ç†æ¯ä¸ªå­—çš„æ—¶å€™è€ƒè™‘åˆ°äº†æ‰€æœ‰å­—å¯¹å…¶çš„å½±å“ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰è€ƒè™‘åˆ°å„ä¸ªå­—ç›¸äº’ä¹‹é—´çš„ä½ç½®ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸‹æ–‡ï¼Œæ‰€ä»¥éœ€è¦å¼•å…¥ä½ç½®ä¿¡æ¯</p><p>ä¸ºäº†è®©æ¨¡å‹å­¦ä¹ åˆ°åºåˆ—çš„ä½ç½®ä¿¡æ¯ï¼Œéœ€è¦åœ¨Embeddingå±‚çš„è¾“å‡ºä¸ŠåŠ ä¸Šä½ç½®ç¼–ç ï¼Œå¾—åˆ°å«æœ‰ä½ç½®ä¿¡æ¯çš„è¯å‘é‡$\alpha$ã€‚</p><p>Transformerä¸­ä½¿ç”¨Positional Encodingè¡¨ç¤ºæ¯ä¸ªå­—ã€è¯çš„ä½ç½®ä¿¡æ¯ï¼Œå…¬å¼å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">PE_{(pos, i)} = \begin{cases}sin(w_k \cdot pos), & i = 2k \\\\cos(w_k \cdot pos), & i = 2k+1\end{cases}</script><script type="math/tex; mode=display">w_k = \dfrac{1}{10000^{2k/d_{model}}} \quad k = 0,1,2,...,d_{model}-1</script><p>å…¶ä¸­ï¼š</p><ul><li>$PE_{(pos, i)}$ï¼šè¡¨ç¤ºç¬¬$pos$ä¸ªå­—/è¯çš„Encodingå‘é‡ç¬¬$i$ç»´çš„ç¼–ç å€¼</li><li>$pos$ï¼šä½ç½®ä¿¡æ¯ï¼Œè¡¨ç¤ºå¥å­ä¸­çš„ç¬¬å‡ ä¸ªå­—/è¯ï¼Œä»0å¼€å§‹</li><li>$i$ï¼šä½ç½®ç¼–ç çš„ç»´åº¦ï¼Œä»0å¼€å§‹</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PositionalEncoding</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, d_model, dropout=<span class="number">0.1</span>, max_len=<span class="number">5000</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(PositionalEncoding, self).__init__()</span><br><span class="line">        self.dropout = nn.Dropout(p=dropout)</span><br><span class="line">        <span class="comment"># åˆå§‹åŒ–ä¸€ä¸ªå½¢çŠ¶ä¸º(max_len, d_model)çš„ä½ç½®ç¼–ç çŸ©é˜µ</span></span><br><span class="line">        pe = torch.zeros(max_len, d_model)</span><br><span class="line">        <span class="comment"># position[i] = i</span></span><br><span class="line">        position = torch.arange(<span class="number">0</span>, max_len).unsqueeze(<span class="number">1</span>).<span class="built_in">float</span>()</span><br><span class="line">        <span class="comment"># w_k=e^(2k*-log10000/d_model)=1/(10000^(2k/d_model))</span></span><br><span class="line">        div_term = torch.exp(torch.arange(<span class="number">0</span>, d_model, <span class="number">2</span>).<span class="built_in">float</span>() * -(math.log(<span class="number">10000.0</span>) / d_model))</span><br><span class="line">        <span class="comment"># å¶æ•°åˆ—ä½¿ç”¨sinå‡½æ•°ç¼–ç ï¼Œå¥‡æ•°åˆ—ä½¿ç”¨coså‡½æ•°ç¼–ç </span></span><br><span class="line">        pe[:, <span class="number">0</span>::<span class="number">2</span>] = torch.sin(position * div_term)</span><br><span class="line">        pe[:, <span class="number">1</span>::<span class="number">2</span>] = torch.cos(position * div_term)</span><br><span class="line">        <span class="comment"># åœ¨ç¬¬0ç»´å¢åŠ ä¸€ä¸ªç»´åº¦ï¼Œå½¢çŠ¶å˜ä¸º(batch_size=1, max_len, d_model)</span></span><br><span class="line">        pe = pe.unsqueeze(<span class="number">0</span>)</span><br><span class="line">        self.register_buffer(<span class="string">&#x27;pe&#x27;</span>, pe)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ä½ç½®ç¼–ç å±‚çš„å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            x: è¾“å…¥çš„è¯åµŒå…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, d_model)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            æ·»åŠ äº†ä½ç½®ç¼–ç çš„è¯åµŒå…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, d_model)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        x = x + self.pe[:, :x.size(<span class="number">1</span>)].clone().detach()</span><br><span class="line">        <span class="keyword">return</span> self.dropout(x)</span><br></pre></td></tr></table></figure><h3 id="1-3-Self-Attention-è‡ªæ³¨æ„åŠ›æœºåˆ¶"><a href="#1-3-Self-Attention-è‡ªæ³¨æ„åŠ›æœºåˆ¶" class="headerlink" title="1.3 Self Attention è‡ªæ³¨æ„åŠ›æœºåˆ¶"></a>1.3 Self Attention è‡ªæ³¨æ„åŠ›æœºåˆ¶</h3><p>ä¸€å¥è¯ä¸­ï¼Œä¸è¯­ä¹‰ç´§å¯†ç›¸å…³çš„å…³é”®è¯éœ€è¦äºˆä»¥æ›´å¤šçš„å…³æ³¨ï¼Œè€Œæ— å…³çš„è¿æ¥è¯å’Œè¾…åŠ©è¯åˆ™å¯ä»¥å¿½ç•¥ã€‚<br>åœ¨æœºå™¨ç¿»è¯‘æ—¶ï¼Œæ›´å¤šçš„æ³¨æ„è¡¨ç°ä¸ºæ›´å¤§çš„æƒé‡ï¼Œè¶Šé‡è¦çš„è¯æƒé‡è¶Šå¤§ã€‚</p><p><img src="https://source.cclmsy.cc/Images/Posts/Transformer/Self_Attention.webp" alt="Self Attention"></p><p>åŒ…å«ä½ç½®ä¿¡æ¯çš„è¯å‘é‡$\alpha^i$ï¼ˆå¥å­çš„ç¬¬i+1ä¸ªè¯çš„è¯å‘é‡ï¼‰ä½œä¸ºSelf Attentionçš„è¾“å…¥ï¼Œåˆ†åˆ«ä¹˜ä»¥ä¸‰ä¸ªæƒé‡çŸ©é˜µ$W^Q$ã€$W^K$ã€$W^V$ï¼Œå¾—åˆ°ï¼š</p><ul><li>$q^i$ï¼šQueryï¼ŒæŸ¥è¯¢å‘é‡</li><li>$k^i$ï¼šKeyï¼Œé”®å‘é‡ï¼Œâ€œè¢«æŸ¥â€æ—¶çš„å‘é‡</li><li>$v^i$ï¼šValueï¼Œå€¼å‘é‡ï¼Œâ€œå†…å®¹â€çš„å‘é‡</li></ul><p>ä»¥4ä¸ªå­—çš„å¥å­â€œæˆ‘æ˜¯å­¦ç”Ÿâ€ä¸ºä¾‹ï¼Œè®¡ç®—ç¬¬0ä¸ªå­—â€œæˆ‘â€çš„Self Attentionï¼š</p><ol><li>è®¡ç®— $q^0$ å’Œ $k^0,k^1,k^2,k^3$ çš„ç‚¹ç§¯ï¼Œå¾—åˆ°4ä¸ªæ³¨æ„åŠ›å€¼ $\alpha<em>{00},\alpha</em>{01},\alpha<em>{02},\alpha</em>{03}$</li></ol><ul><li>ç»è¿‡Softmaxå½’ä¸€åŒ–ï¼Œå¾—åˆ°4ä¸ªæ³¨æ„åŠ›åˆ†æ•° $\hat{\alpha<em>{00}},\hat{\alpha</em>{01}},\hat{\alpha<em>{02}},\hat{\alpha</em>{03}}$ ï¼Œå®ƒä»¬çš„å’Œä¸º1</li><li>å°†è¿™äº›åˆ†æ•°ä½œä¸ºæƒé‡ï¼Œå¯¹ $v^0,v^1,v^2,v^3$ è¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œå¾—åˆ°Self Attentionçš„è¾“å‡º</li><li>$b^0=\hat{\alpha<em>{00}}v^0+\hat{\alpha</em>{01}}v^1+\hat{\alpha<em>{02}}v^2+\hat{\alpha</em>{03}}v^3$</li></ul><p>ä¸ºäº†åŠ é€Ÿè®¡ç®—ï¼Œå¯ä»¥ä½¿ç”¨çŸ©é˜µè¿ç®—ï¼š</p><p><img src="https://source.cclmsy.cc/Images/Posts/Transformer/Self_Attention_Matrix.png" alt="Self AttentionçŸ©é˜µè¿ç®—"></p><ul><li>å…¶ä¸­$\alpha_{ij}=\dfrac{q_i * k_j^T}{\sqrt{d_k}}$ï¼Œ$d_k$æ˜¯è¯å‘é‡çš„ç»´åº¦</li><li>æœ€åè®¡ç®—$b^i=\sum<em>{j=0}^{n-1}\hat{\alpha</em>{ij}}v_j$</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ScaledDotProductAttention</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, scale_factor, dropout=<span class="number">0.0</span></span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.scale_factor = scale_factor <span class="comment"># ç¼©æ”¾å› å­</span></span><br><span class="line">        <span class="comment"># Dropoutç”¨äºé˜²æ­¢è¿‡æ‹Ÿåˆ</span></span><br><span class="line">        self.dropout = nn.Dropout(dropout)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, Q, K, V, mask=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        batch_size: æ‰¹å¤§å°</span></span><br><span class="line"><span class="string">        num_heads: å¤šå¤´æ³¨æ„åŠ›çš„å¤´æ•°ï¼Œè®ºæ–‡é»˜è®¤ä¸º8</span></span><br><span class="line"><span class="string">        seq_len: åºåˆ—é•¿åº¦</span></span><br><span class="line"><span class="string">        d_k, d_v: é”®å’Œå€¼çš„ç»´åº¦ï¼Œé»˜è®¤éƒ½æ˜¯64</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            Q: æŸ¥è¯¢å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, num_heads, seq_len, d_k)</span></span><br><span class="line"><span class="string">            K: é”®å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, num_heads, seq_len, d_k)</span></span><br><span class="line"><span class="string">            V: å€¼å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, num_heads, seq_len, d_v)</span></span><br><span class="line"><span class="string">            mask: æ©ç å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, seq_len)ï¼Œé»˜è®¤ä¸ºNone</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            ä¸Šä¸‹æ–‡å¼ é‡å’Œæ³¨æ„åŠ›å¼ é‡</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        attn = torch.matmul(Q / self.scale_factor, K.transpose(<span class="number">2</span>, <span class="number">3</span>)) <span class="comment"># Kçš„ç¬¬2å’Œç¬¬3ç»´è½¬ç½®</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># if mask is not None:</span></span><br><span class="line">        <span class="comment">#     scores = scores.masked_fill(mask == 0, -1e9)</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Softmaxè®¡ç®—æ³¨æ„åŠ›æƒé‡ï¼ŒDropoutå‡å°‘è¿‡æ‹Ÿåˆ</span></span><br><span class="line">        attn = self.dropout(torch.softmax(attn, dim=-<span class="number">1</span>))</span><br><span class="line">        output = torch.matmul(attn, V)</span><br><span class="line">        <span class="keyword">return</span> output, attn <span class="comment"># è¿”å›ä¸Šä¸‹æ–‡å¼ é‡å’Œæ³¨æ„åŠ›å¼ é‡</span></span><br></pre></td></tr></table></figure><h3 id="1-4-Multi-Head-Attention-å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶"><a href="#1-4-Multi-Head-Attention-å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶" class="headerlink" title="1.4 Multi-Head Attention å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶"></a>1.4 Multi-Head Attention å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶</h3><p>å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶å°±æ˜¯æŠŠ$q^i, k^i, v^i$ä¸‰ä¸ªçŸ©é˜µä»ç‰¹å¾ç»´åº¦ï¼ˆè¯å‘é‡é•¿åº¦ï¼‰æ–¹å‘ä¸Šæ‹†åˆ†æˆä¸ºå½¢çŠ¶ç›¸åŒçš„å°çŸ©é˜µã€‚<br>å†å°†æ¯ä¸ªHead Attentionçš„è¾“å‡ºæ‹¼æ¥èµ·æ¥ï¼Œå¾—åˆ°æœ€ç»ˆçš„Multi-Head Attentionè¾“å‡ºã€‚</p><p>ç†è§£ï¼šå¤šä¸ªå¤´åˆ†åˆ«å…³æ³¨ä¸åŒçš„ç‰¹å¾å­ç©ºé—´ï¼Œæœ€åå†å°†è¿™äº›å­ç©ºé—´çš„ä¿¡æ¯èåˆèµ·æ¥ã€‚</p><p><img src="https://source.cclmsy.cc/Images/Posts/Transformer/Multi_Head_Attention.webp" alt="Multi-Head Attention"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MultiHeadAttention</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n_head=<span class="number">8</span>, d_model=<span class="number">512</span>, d_k=<span class="number">64</span>, d_v=<span class="number">64</span>, droupout=<span class="number">0.1</span></span>):</span><br><span class="line">        <span class="comment"># è®ºæ–‡ä¸­ï¼Œå‚æ•°åˆ†åˆ«ä¸ºï¼š8ã€512ã€64ã€64</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line"></span><br><span class="line">        self.n_head = n_head</span><br><span class="line">        self.d_k = d_k</span><br><span class="line">        self.d_v = d_v</span><br><span class="line"></span><br><span class="line">        self.w_qs = nn.Linear(d_model, n_head * d_k, bias=<span class="literal">False</span>)</span><br><span class="line">        self.w_ks = nn.Linear(d_model, n_head * d_k, bias=<span class="literal">False</span>)</span><br><span class="line">        self.w_vs = nn.Linear(d_model, n_head * d_v, bias=<span class="literal">False</span>)</span><br><span class="line">        self.fc = nn.Linear(n_head * d_v, d_model, bias=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">        self.attention = ScaledDotProductAttention(scale_factor=d_k ** <span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">        self.dropout = nn.Dropout(droupout)</span><br><span class="line">        self.layer_norm = nn.LayerNorm(d_model, eps=<span class="number">1e-6</span>) <span class="comment"># LayerNormå±‚ï¼Œç”¨äºå½’ä¸€åŒ–</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, Q, K, V, mask=<span class="literal">None</span></span>):</span><br><span class="line">        d_k, d_v, n_head = self.d_k, self.d_v, self.n_head</span><br><span class="line">        batch_size, len_q, len_k, len_v = Q.size(<span class="number">0</span>), Q.size(<span class="number">1</span>), K.size(<span class="number">1</span>), V.size(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        residual = Q <span class="comment"># ä¿ç•™è¾“å…¥ç”¨ä½œæ®‹å·®è¿æ¥</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># å°†Qã€Kã€Vå½’ä¸€åŒ–åï¼Œåˆ†åˆ«é€šè¿‡çº¿æ€§æ˜ å°„åˆ°å¤šå¤´</span></span><br><span class="line">        <span class="comment"># Q: (batch_size, len_q, d_model) -&gt; (batch_size, len_q, n_head * d_k) -&gt; (batch_size, n_head, len_q, d_k)</span></span><br><span class="line">        <span class="comment"># Qï¼š(batch_size, len_q, 512) -&gt; (batch_size, len_q, 8*64) -&gt; (batch_size, len_q, 8, 64)</span></span><br><span class="line">        Q = self.layer_norm(Q)</span><br><span class="line">        K = self.layer_norm(K)</span><br><span class="line">        V = self.layer_norm(V)</span><br><span class="line">        Q = self.w_qs(Q).view(batch_size, len_q, n_head, d_k)</span><br><span class="line">        K = self.w_ks(K).view(batch_size, len_k, n_head, d_k)</span><br><span class="line">        V = self.w_vs(V).view(batch_size, len_v, n_head, d_v)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è½¬ç½®ï¼Œä½¿å¾—ç¬¬1å’Œç¬¬2ç»´äº¤æ¢ä½ç½®ï¼Œè¿›è¡ŒAttentionè®¡ç®—</span></span><br><span class="line">        <span class="comment"># Q: (batch_size, len_q, n_head, d_k) -&gt; (batch_size, n_head, len_q, d_k)</span></span><br><span class="line">        <span class="comment"># Qï¼š(batch_size, len_q, 8, 64) -&gt; (batch_size, 8, len_q, 64)</span></span><br><span class="line">        Q, K, V = Q.transpose(<span class="number">1</span>, <span class="number">2</span>), K.transpose(<span class="number">1</span>, <span class="number">2</span>), V.transpose(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> mask <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            mask = mask.unsqueeze(<span class="number">1</span>) <span class="comment"># å¢åŠ ä¸€ä¸ªHeadç»´åº¦</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Q=Softmax(Q*K/d + (1-S)Ïƒ)Vï¼Œattnæ˜¯QK/D</span></span><br><span class="line">        Q, attn = self.attention(Q, K, V, mask=mask) </span><br><span class="line"></span><br><span class="line">        <span class="comment"># Qçš„å½¢çŠ¶ï¼š[batch_size, n_head, len_q, d_v] [2,8,5,64]</span></span><br><span class="line">        Q = Q.transpose(<span class="number">1</span>, <span class="number">2</span>).contiguous().view(batch_size, len_q, -<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        Q = self.dropout(self.fc(Q))</span><br><span class="line"></span><br><span class="line">        Q += residual <span class="comment"># æ®‹å·®è¿æ¥Add</span></span><br><span class="line">        Q = self.layer_norm(Q) <span class="comment"># LayerNorm</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Q, attn</span><br></pre></td></tr></table></figure><h3 id="1-5-Add-amp-Norm-æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–"><a href="#1-5-Add-amp-Norm-æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–" class="headerlink" title="1.5 Add &amp; Norm æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–"></a>1.5 Add &amp; Norm æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–</h3><p>Addæ®‹å·®é“¾æ¥å°±æ˜¯å°†ç½‘ç»œçš„è¾“å…¥å’Œè¾“å‡ºç›´æ¥ç›¸åŠ ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚</p><p>Layer Normalizationæ˜¯å¯¹ç½‘ç»œçš„è¾“å‡ºè¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼ŒåŠ é€Ÿè®­ç»ƒã€‚<br>ä½¿$b$çš„æ¯ä¸€è¡Œï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªå¥å­ï¼Œå½’ä¸€åŒ–ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œè¾“å‡ºä¸º$\hat b$ï¼Œå½’ä¸€åŒ–å…¬å¼å¦‚ä¸‹ï¼š</p><ul><li>å‡å€¼ï¼š$\mu<em>i=\dfrac{1}{d}\sum</em>{j=1}^{d}b_{ij}$</li><li>æ–¹å·®ï¼š$\sigma<em>i^2=\dfrac{1}{d}\sum</em>{j=1}^{d}(b_{ij}-\mu_i)^2$</li><li>å½’ä¸€åŒ–ï¼š$\hat b<em>{ij}=\dfrac{b</em>{ij}-\mu_i}{\sqrt{\sigma_i^2+\epsilon}}*\gamma+\beta$</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LayerNorm</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, d_model, eps=<span class="number">1e-12</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(LayerNorm, self).__init__()</span><br><span class="line">        self.gamma = nn.Parameter(torch.ones(d_model))</span><br><span class="line">        self.beta = nn.Parameter(torch.zeros(d_model))</span><br><span class="line">        self.eps = eps <span class="comment"># é˜²æ­¢åˆ†æ¯ä¸º0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        mean = x.mean(-<span class="number">1</span>, keepdim=<span class="literal">True</span>)</span><br><span class="line">        var = x.var(-<span class="number">1</span>, unbiased=<span class="literal">False</span>, keepdim=<span class="literal">True</span>) <span class="comment"># unbiased=Falseè¡¨ç¤ºæ–¹å·®è®¡ç®—éæ— åä¼°è®¡ï¼ˆé™¤ä»¥Nè€Œä¸æ˜¯N-1ï¼‰</span></span><br><span class="line"></span><br><span class="line">        out = (x - mean) / torch.sqrt(var + self.eps)</span><br><span class="line">        out = self.gamma * out + self.beta</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure><h3 id="1-6-Feed-Forward-å‰é¦ˆç¥ç»ç½‘ç»œ"><a href="#1-6-Feed-Forward-å‰é¦ˆç¥ç»ç½‘ç»œ" class="headerlink" title="1.6 Feed Forward å‰é¦ˆç¥ç»ç½‘ç»œ"></a>1.6 Feed Forward å‰é¦ˆç¥ç»ç½‘ç»œ</h3><p>Add &amp; Normå±‚åæ¥ä¸€ä¸ªå…¨è¿æ¥çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼Œç”¨äºå¯¹ç‰¹å¾è¿›è¡Œéçº¿æ€§å˜æ¢</p><p>å‰é¦ˆç¥ç»ç½‘ç»œçš„ç»“æ„æ˜¯ä¸¤ä¸ªå…¨è¿æ¥å±‚ï¼Œç¬¬ä¸€ä¸ªå…¨è¿æ¥å±‚çš„æ¿€æ´»å‡½æ•°æ˜¯ReLUï¼Œç¬¬äºŒä¸ªå…¨è¿æ¥å±‚æ²¡æœ‰æ¿€æ´»å‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PositionwiseFeedForward</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(PositionwiseFeedForward, self).__init__()</span><br><span class="line">        self.fc = nn.Sequential(</span><br><span class="line">            nn.Linear(d_model, d_ff, bias=<span class="literal">False</span>),</span><br><span class="line">            nn.ReLU(),</span><br><span class="line">            nn.Linear(d_ff, d_model, bias=<span class="literal">False</span>))</span><br><span class="line">        self.layer_norm = nn.LayerNorm(d_model, eps=<span class="number">1e-6</span>) <span class="comment"># LayerNormå±‚ï¼Œç”¨äºå½’ä¸€åŒ–</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, inputs</span>):</span><br><span class="line">        resdual = inputs</span><br><span class="line">        output = self.fc(inputs)</span><br><span class="line">        output = self.layer_norm(output + resdual)</span><br><span class="line">        <span class="keyword">return</span> output</span><br></pre></td></tr></table></figure><h3 id="1-7-Maskæ‰-åœç”¨è¯"><a href="#1-7-Maskæ‰-åœç”¨è¯" class="headerlink" title="1.7 Maskæ‰ åœç”¨è¯"></a>1.7 Maskæ‰ åœç”¨è¯</h3><p>å¥å­ä¸­æ²¡æœ‰æ„ä¹‰çš„å ä½ç¬¦ï¼Œä¾‹å¦‚â€œæˆ‘æ˜¯å­¦ç”ŸPâ€ä¸­çš„Pæ˜¯åœæ­¢ç¬¦ï¼Œæ²¡æœ‰å®é™…æ„ä¹‰ï¼Œéœ€è¦å°†å…¶maskæ‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_attn_pad_mask</span>(<span class="params">seq_q, seq_k</span>):</span><br><span class="line">    batch_size, len_q = seq_q.size()</span><br><span class="line">    batch_size, len_k = seq_k.size()</span><br><span class="line">    <span class="comment"># eq(zero)ç”¨äºåˆ¤æ–­ seq_k ä¸­å“ªäº›ä½ç½®æ˜¯å¡«å……ç¬¦ï¼ˆé€šå¸¸å¡«å……ç¬¦çš„å€¼æ˜¯ 0ï¼‰ï¼Œè¿”å›ä¸€ä¸ªByteTensor</span></span><br><span class="line">    pad_attn_mask = seq_k.data.eq(<span class="number">0</span>).unsqueeze(<span class="number">1</span>)  <span class="comment"># (N, 1, len_k)</span></span><br><span class="line">    <span class="keyword">return</span> pad_attn_mask.expand(batch_size, len_q, len_k)  <span class="comment"># (N, len_q, len_k)</span></span><br></pre></td></tr></table></figure><h3 id="1-8-EncoderLayer"><a href="#1-8-EncoderLayer" class="headerlink" title="1.8 EncoderLayer"></a>1.8 EncoderLayer</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">EncoderLayer</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(EncoderLayer, self).__init__()</span><br><span class="line">        self.enc_self_attn = MultiHeadAttention() <span class="comment"># å¤šå¤´è‡ªæ³¨æ„åŠ›</span></span><br><span class="line">        self.pos_ffn = PositionwiseFeedForward() <span class="comment"># å‰é¦ˆç¥ç»ç½‘ç»œ</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, enc_inputs, enc_self_attn_mask</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            enc_inputs: ç¼–ç å™¨è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, d_model)</span></span><br><span class="line"><span class="string">            enc_self_attn_mask: ç¼–ç å™¨è‡ªæ³¨æ„åŠ›æ©ç ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, seq_len)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            ç¼–ç å™¨è¾“å‡ºå¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, d_model)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        enc_outputs, attn = self.enc_self_attn(enc_inputs, enc_inputs, enc_inputs, enc_self_attn_mask)</span><br><span class="line">        enc_outputs = self.pos_ffn(enc_outputs)</span><br><span class="line">        <span class="keyword">return</span> enc_outputs, attn</span><br></pre></td></tr></table></figure><h3 id="1-9-Encoder"><a href="#1-9-Encoder" class="headerlink" title="1.9 Encoder"></a>1.9 Encoder</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Encoder</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Encoder, self).__init__()</span><br><span class="line"></span><br><span class="line">        self.src_emb = Embeddings(src_vocab_size, d_model)</span><br><span class="line">        self.pos_emb = PositionalEncoding(d_model)</span><br><span class="line">        self.layers = nn.ModuleList([EncoderLayer() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n_layers)])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, enc_inputs</span>):</span><br><span class="line">        <span class="comment"># 1. ä¸­æ–‡å­—ç´¢å¼•è¿›è¡ŒEmbeddingï¼Œè½¬æ¢ä¸º512ç»´çš„è¯å‘é‡</span></span><br><span class="line">        enc_outputs = self.src_emb(enc_inputs)</span><br><span class="line">        <span class="comment"># 2. åŠ ä¸Šä½ç½®ç¼–ç </span></span><br><span class="line">        enc_outputs = self.pos_emb(enc_outputs)</span><br><span class="line">        <span class="comment"># 3. maskæ‰paddingéƒ¨åˆ†</span></span><br><span class="line">        enc_self_attn_mask = get_attn_pad_mask(enc_inputs, enc_inputs)</span><br><span class="line">        enc_self_attns = []</span><br><span class="line">        <span class="comment"># 4. é€šè¿‡6å±‚EncoderLayerï¼Œä¸Šä¸€å±‚çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥</span></span><br><span class="line">        <span class="keyword">for</span> layer <span class="keyword">in</span> self.layers:</span><br><span class="line">            enc_outputs, enc_self_attn = layer(enc_outputs, enc_self_attn_mask)</span><br><span class="line">            enc_self_attns.append(enc_self_attn)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> enc_outputs, enc_self_attns</span><br></pre></td></tr></table></figure><h2 id="2-Decoder"><a href="#2-Decoder" class="headerlink" title="2.Decoder"></a>2.Decoder</h2><p>Masked Multi-Head Attentionï¼šä¸MultiHead Attentionç±»ä¼¼ï¼Œåªæ˜¯åœ¨è®¡ç®—Self Attentionæ—¶ï¼Œéœ€è¦maskæ‰æœªæ¥çš„ä¿¡æ¯</p><p>Multi-Head Attentionï¼šä¸Encoderä¸­çš„MultiHead Attentionç›¸åŒ</p><p>Decoderçš„è¾“å‡ºé¢„æµ‹ï¼šDecoderè¾“å‡ºçŸ©é˜µå½¢çŠ¶æ˜¯[seq_len, word_dim]ï¼Œç»è¿‡nn.Linearå…¨è¿æ¥å±‚ï¼Œå†é€šè¿‡softmaxå‡½æ•°å¾—åˆ°æ¯ä¸ªè¯çš„æ¦‚ç‡ï¼Œç„¶åé€‰æ‹©æ¦‚ç‡æœ€å¤§çš„è¯ä½œä¸ºé¢„æµ‹ç»“æœã€‚</p><h3 id="2-1-Decoder-Input-è¾“å…¥å¤„ç†"><a href="#2-1-Decoder-Input-è¾“å…¥å¤„ç†" class="headerlink" title="2.1 Decoder Input è¾“å…¥å¤„ç†"></a>2.1 Decoder Input è¾“å…¥å¤„ç†</h3><p>Decoderçš„è¾“å…¥æ˜¯æœ€åä¸€ä¸ªEncoderçš„è¾“å‡ºï¼Œåœ¨è®­ç»ƒæ—¶ï¼ŒåŒæ—¶è¾“å…¥ç›®æ ‡å¥å­çš„è¯å‘é‡ï¼Œä»¥ä¾¿è®¡ç®—Lossã€‚</p><p>â€œæˆ‘æ˜¯å­¦ç”ŸEâ€-&gt;â€œS I am a studentâ€</p><ul><li>T0æ—¶åˆ»ï¼šè¾“å…¥å¼€å§‹ç¬¦â€œSâ€ï¼Œè¾“å‡ºé¢„æµ‹çš„ç¬¬ä¸€ä¸ªè¯â€œIâ€</li><li>T1æ—¶åˆ»ï¼šè¾“å…¥â€œS Iâ€ï¼Œè¾“å‡ºé¢„æµ‹çš„ç¬¬äºŒä¸ªè¯â€œamâ€</li><li>â€¦</li></ul><p>è¾“å…¥ä½¿ç”¨ä¸Šä¸‰è§’çŸ©é˜µè¿›è¡Œmaskï¼Œé¿å…Decoderçœ‹åˆ°æœªæ¥çš„ä¿¡æ¯ã€‚</p><p><img src="https://source.cclmsy.cc/Images/Posts/Transformer/Input_Mask.webp" alt="Input Mask"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_attn_subsequent_mask</span>(<span class="params">seq</span>): <span class="comment"># seq: [batch_size, tgt_len]</span></span><br><span class="line">    attn_shape = [seq.size(<span class="number">0</span>), seq.size(<span class="number">1</span>), seq.size(<span class="number">1</span>)]</span><br><span class="line">    subsequent_mask = np.triu(np.ones(attn_shape), k=<span class="number">1</span>) <span class="comment"># è¿”å›ä¸Šä¸‰è§’çŸ©é˜µ</span></span><br><span class="line">    subsequent_mask = torch.from_numpy(subsequent_mask).byte() <span class="comment"># è½¬æ¢ä¸ºByteTensor</span></span><br><span class="line">    <span class="keyword">return</span> subsequent_mask</span><br></pre></td></tr></table></figure><h3 id="2-2-DecoderLayer"><a href="#2-2-DecoderLayer" class="headerlink" title="2.2 DecoderLayer"></a>2.2 DecoderLayer</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">DecoderLayer</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(DecoderLayer, self).__init__()</span><br><span class="line">        self.dec_self_attn = MultiHeadAttention()</span><br><span class="line">        self.dec_enc_attn = MultiHeadAttention() </span><br><span class="line">        self.pos_ffn = PositionwiseFeedForward()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, dec_inputs, enc_outputs, dec_self_attn_mask, dec_enc_attn_mask</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            dec_inputs: è§£ç å™¨è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, tgt_len, d_model)</span></span><br><span class="line"><span class="string">            enc_outputs: ç¼–ç å™¨è¾“å‡ºå¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, d_model)</span></span><br><span class="line"><span class="string">            dec_self_attn_mask: è§£ç å™¨è‡ªæ³¨æ„åŠ›æ©ç ï¼Œå½¢çŠ¶ä¸º(batch_size, tgt_len, tgt_len)</span></span><br><span class="line"><span class="string">            dec_enc_attn_mask: è§£ç å™¨-ç¼–ç å™¨æ³¨æ„åŠ›æ©ç ï¼Œå½¢çŠ¶ä¸º(batch_size, tgt_len, seq_len)</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            è§£ç å™¨è¾“å‡ºå¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, tgt_len, d_model)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        dec_outputs, dec_self_attn = self.dec_self_attn(dec_inputs, dec_inputs, dec_inputs, dec_self_attn_mask)</span><br><span class="line">        dec_outputs, dec_enc_attn = self.dec_enc_attn(dec_outputs, enc_outputs, enc_outputs, dec_enc_attn_mask)</span><br><span class="line">        dec_outputs = self.pos_ffn(dec_outputs)</span><br><span class="line">        <span class="keyword">return</span> dec_outputs, dec_self_attn, dec_enc_attn</span><br></pre></td></tr></table></figure><h3 id="2-3-Decoder"><a href="#2-3-Decoder" class="headerlink" title="2.3 Decoder"></a>2.3 Decoder</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Decoder</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Decoder, self).__init__()</span><br><span class="line">        </span><br><span class="line">        self.tgt_emb = Embeddings(tgt_vocab_size, d_model)</span><br><span class="line">        self.pos_emb = PositionalEncoding(d_model)</span><br><span class="line">        self.layers = nn.ModuleList([DecoderLayer() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n_layers)])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, dec_inputs, enc_inputs, enc_outputs</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            dec_inputs: è§£ç å™¨è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, tgt_len)</span></span><br><span class="line"><span class="string">            enc_inputs: ç¼–ç å™¨è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len)</span></span><br><span class="line"><span class="string">            enc_outputs: ç¼–ç å™¨è¾“å‡ºå¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len, d_model)</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            è§£ç å™¨è¾“å‡ºå¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, tgt_len, d_model)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># è‹±æ–‡å­—ç´¢å¼•è¿›è¡ŒEmbeddingï¼Œè½¬æ¢ä¸º512ç»´çš„è¯å‘é‡ï¼ŒåŠ ä¸Šä½ç½®ç¼–ç </span></span><br><span class="line">        dec_outputs = self.tgt_emb(dec_inputs)</span><br><span class="line">        dec_outputs = self.pos_emb(dec_outputs)</span><br><span class="line">        <span class="comment"># maskæ‰paddingéƒ¨åˆ†</span></span><br><span class="line">        dec_self_attn_pad_mask = get_attn_pad_mask(dec_inputs, dec_inputs)</span><br><span class="line">        dec_self_attn_subsequent_mask = get_attn_subsequent_mask(dec_inputs)</span><br><span class="line">        dec_self_attn_mask = torch.gt((dec_self_attn_pad_mask + dec_self_attn_subsequent_mask), <span class="number">0</span>)</span><br><span class="line">        dec_enc_attn_mask = get_attn_pad_mask(dec_inputs, enc_inputs)</span><br><span class="line">        dec_self_attns, dec_enc_attns = [], []</span><br><span class="line">        <span class="comment"># é€šè¿‡6å±‚DecoderLayerï¼Œä¸Šä¸€å±‚çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥</span></span><br><span class="line">        <span class="keyword">for</span> layer <span class="keyword">in</span> self.layers:</span><br><span class="line">            dec_outputs, dec_self_attn, dec_enc_attn = layer(dec_outputs, enc_outputs, dec_self_attn_mask, dec_enc_attn_mask)</span><br><span class="line">            dec_self_attns.append(dec_self_attn)</span><br><span class="line">            dec_enc_attns.append(dec_enc_attn)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> dec_outputs, dec_self_attns, dec_enc_attns</span><br></pre></td></tr></table></figure><h2 id="3-Transformerä»£ç å®ç°"><a href="#3-Transformerä»£ç å®ç°" class="headerlink" title="3. Transformerä»£ç å®ç°"></a>3. Transformerä»£ç å®ç°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Transformer</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Transformer, self).__init__()</span><br><span class="line">        self.encoder = Encoder()</span><br><span class="line">        self.decoder = Decoder()</span><br><span class="line">        <span class="comment"># è§£ç å™¨æœ€åçš„åˆ†ç±»å™¨ï¼Œåˆ†ç±»å™¨çš„è¾“å…¥d_modelæ˜¯è§£ç å±‚æ¯ä¸ªtokençš„è¾“å‡ºç»´åº¦å¤§å°</span></span><br><span class="line">        <span class="comment"># éœ€è¦å°†å…¶è½¬ä¸ºè¯è¡¨å¤§å°ï¼Œå†è®¡ç®—softmaxï¼›è®¡ç®—å“ªä¸ªè¯å‡ºç°çš„æ¦‚ç‡æœ€å¤§</span></span><br><span class="line">        self.projection = nn.Linear(d_model, tgt_vocab_size, bias=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, enc_inputs, dec_inputs</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å‰å‘ä¼ æ’­</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            enc_inputs: ç¼–ç å™¨è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, seq_len)</span></span><br><span class="line"><span class="string">            dec_inputs: è§£ç å™¨è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size, tgt_len)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            è§£ç å™¨è¾“å‡ºå¼ é‡ï¼Œå½¢çŠ¶ä¸º(batch_size * tgt_len, tgt_vocab_size)</span></span><br><span class="line"><span class="string">            enc_self_attns: ç¼–ç å™¨è‡ªæ³¨æ„åŠ›å¼ é‡åˆ—è¡¨</span></span><br><span class="line"><span class="string">            dec_self_attns: è§£ç å™¨è‡ªæ³¨æ„åŠ›å¼ é‡åˆ—è¡¨</span></span><br><span class="line"><span class="string">            dec_enc_attns: è§£ç å™¨-ç¼–ç å™¨æ³¨æ„åŠ›å¼ é‡åˆ—è¡¨</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        enc_outputs, enc_self_attns = self.encoder(enc_inputs)</span><br><span class="line"></span><br><span class="line">        dec_outputs, dec_self_attns, dec_enc_attns = self.decoder(dec_inputs, enc_inputs, enc_outputs)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># dec_logits : [batch_size x src_vocab_size x tgt_vocab_size]</span></span><br><span class="line">        dec_logits = self.projection(dec_outputs) </span><br><span class="line">        <span class="keyword">return</span> dec_logits.view(-<span class="number">1</span>, dec_logits.size(-<span class="number">1</span>)), enc_self_attns, dec_self_attns, dec_enc_attns</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="4-Transformeræ¨¡å‹è®­ç»ƒ"><a href="#4-Transformeræ¨¡å‹è®­ç»ƒ" class="headerlink" title="4. Transformeræ¨¡å‹è®­ç»ƒ"></a>4. Transformeræ¨¡å‹è®­ç»ƒ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¨¡å‹è®­ç»ƒ</span></span><br><span class="line">model = Transformer()</span><br><span class="line">criterion = nn.CrossEntropyLoss()</span><br><span class="line">optimizer = torch.optim.Adam(model.parameters(), lr=<span class="number">0.001</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯å…¸</span></span><br><span class="line">word2idx = &#123;</span><br><span class="line">    <span class="string">&quot;S&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="string">&quot;æˆ‘&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&quot;æ˜¯&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="string">&quot;å­¦&quot;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">&quot;ç”Ÿ&quot;</span>: <span class="number">4</span>,</span><br><span class="line">    <span class="string">&quot;I&quot;</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="string">&quot;am&quot;</span>: <span class="number">6</span>,</span><br><span class="line">    <span class="string">&quot;a&quot;</span>: <span class="number">7</span>,</span><br><span class="line">    <span class="string">&quot;student&quot;</span>: <span class="number">8</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">idx2word = &#123;i: w <span class="keyword">for</span> w, i <span class="keyword">in</span> word2idx.items()&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å…¥æ•°æ®</span></span><br><span class="line">enc_inputs = torch.LongTensor([[word2idx[w] <span class="keyword">for</span> w <span class="keyword">in</span> [<span class="string">&quot;æˆ‘&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;å­¦&quot;</span>, <span class="string">&quot;ç”Ÿ&quot;</span>, <span class="string">&quot;S&quot;</span>]]])</span><br><span class="line">dec_inputs = torch.LongTensor([[word2idx[w] <span class="keyword">for</span> w <span class="keyword">in</span> [<span class="string">&quot;S&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;am&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;student&quot;</span>]]])</span><br><span class="line">target_batch = torch.LongTensor([[word2idx[w] <span class="keyword">for</span> w <span class="keyword">in</span> [<span class="string">&quot;S&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;am&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;student&quot;</span>]]])</span><br><span class="line"><span class="built_in">print</span>(enc_inputs, dec_inputs, target_batch)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è®­ç»ƒ</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    optimizer.zero_grad()</span><br><span class="line">    outputs, enc_self_attns, dec_self_attns, dec_enc_attns = model(enc_inputs, dec_inputs)</span><br><span class="line">    loss = criterion(outputs, target_batch.view(-<span class="number">1</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Epoch:&#x27;</span>, <span class="string">&#x27;%04d&#x27;</span> % (epoch + <span class="number">1</span>), <span class="string">&#x27;cost =&#x27;</span>, <span class="string">&#x27;&#123;:.6f&#125;&#x27;</span>.<span class="built_in">format</span>(loss))</span><br><span class="line">    loss.backward()</span><br><span class="line">    optimizer.step()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹é¢„æµ‹</span></span><br><span class="line">predict, _, _, _ = model(enc_inputs, dec_inputs)</span><br><span class="line">predict = predict.data.<span class="built_in">max</span>(<span class="number">1</span>, keepdim=<span class="literal">True</span>)[<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(enc_inputs, <span class="string">&#x27;-&gt;&#x27;</span>, [idx2word[n.item()] <span class="keyword">for</span> n <span class="keyword">in</span> predict.squeeze()])</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>tensor([[1, 2, 3, 4, 0]]) tensor([[0, 5, 6, 7, 8]]) tensor([[0, 5, 6, 7, 8]])Epoch: 0001 cost = 2.244576Epoch: 0002 cost = 0.970345Epoch: 0003 cost = 2.741649Epoch: 0004 cost = 3.185768Epoch: 0005 cost = 4.521887Epoch: 0006 cost = 3.544580Epoch: 0007 cost = 3.160498Epoch: 0008 cost = 2.823286Epoch: 0009 cost = 0.625107Epoch: 0010 cost = 0.672708Epoch: 0011 cost = 0.561514Epoch: 0012 cost = 0.959138Epoch: 0013 cost = 0.673696Epoch: 0014 cost = 0.326180Epoch: 0015 cost = 0.268545Epoch: 0016 cost = 0.215698Epoch: 0017 cost = 0.168979Epoch: 0018 cost = 0.057510Epoch: 0019 cost = 0.087601Epoch: 0020 cost = 0.056923tensor([[1, 2, 3, 4, 0]]) -&gt; [&#39;S&#39;, &#39;I&#39;, &#39;am&#39;, &#39;a&#39;, &#39;student&#39;]</code></pre>]]></content>
    
    
    <summary type="html">å®ç°ä¸æµ‹è¯•Transformeræ¨¡å‹</summary>
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>æ·±åº¦å­¦ä¹ ç¬”è®°4-å¾ªç¯ç¥ç»ç½‘ç»œRNN</title>
    <link href="https://www.cclmsy.cc/posts/Deep_Learning03.html"/>
    <id>https://www.cclmsy.cc/posts/Deep_Learning03.html</id>
    <published>2025-02-27T10:00:00.000Z</published>
    <updated>2025-02-26T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å››ã€å¾ªç¯ç¥ç»ç½‘ç»œRNN"><a href="#å››ã€å¾ªç¯ç¥ç»ç½‘ç»œRNN" class="headerlink" title="å››ã€å¾ªç¯ç¥ç»ç½‘ç»œRNN"></a>å››ã€å¾ªç¯ç¥ç»ç½‘ç»œRNN</h1><h2 id="4-1-å¾ªç¯ç¥ç»ç½‘ç»œ"><a href="#4-1-å¾ªç¯ç¥ç»ç½‘ç»œ" class="headerlink" title="4.1 å¾ªç¯ç¥ç»ç½‘ç»œ"></a>4.1 å¾ªç¯ç¥ç»ç½‘ç»œ</h2><h3 id="4-1-1-åºåˆ—æ¨¡å‹"><a href="#4-1-1-åºåˆ—æ¨¡å‹" class="headerlink" title="4.1.1 åºåˆ—æ¨¡å‹"></a>4.1.1 åºåˆ—æ¨¡å‹</h3><p>åºåˆ—æ¨¡å‹ï¼šè‡ªç„¶è¯­è¨€ã€éŸ³é¢‘ã€è§†é¢‘ç­‰åºåˆ—æ•°æ®çš„æ¨¡å‹</p><ul><li>åº”ç”¨ï¼šè¯­éŸ³è¯†åˆ«ã€æƒ…æ„Ÿåˆ†ç±»ã€æœºå™¨ç¿»è¯‘ç­‰</li></ul><p>ä¸ºä»€ä¹ˆä¸ä½¿ç”¨CNNï¼Ÿ</p><ul><li>åºåˆ—æ•°æ®çš„å‰åä¹‹é—´å…·æœ‰å¼ºå…³è”æ€§</li><li>è¾“å…¥è¾“å‡ºé•¿åº¦ä¸å›ºå®š</li></ul><h3 id="4-1-2-å¾ªç¯ç¥ç»ç½‘ç»œ"><a href="#4-1-2-å¾ªç¯ç¥ç»ç½‘ç»œ" class="headerlink" title="4.1.2 å¾ªç¯ç¥ç»ç½‘ç»œ"></a>4.1.2 å¾ªç¯ç¥ç»ç½‘ç»œ</h3><p>å¾ªç¯ï¼ˆé€’å½’ï¼‰ç¥ç»ç½‘ç»œï¼ˆRecurrent Neural Networkï¼ŒRNNï¼‰æ˜¯ç¥ç»ç½‘ç»œçš„ä¸€ç§ï¼Œå°†â€œçŠ¶æ€â€åœ¨è‡ªèº«ç½‘ç»œä¸­å¾ªç¯ä¼ é€’ï¼Œå¯ä»¥æ¥å—æ—¶é—´åºåˆ—ç»“æ„è¾“å…¥</p><h4 id="4-1-2-1-RNNç±»å‹"><a href="#4-1-2-1-RNNç±»å‹" class="headerlink" title="4.1.2.1 RNNç±»å‹"></a>4.1.2.1 RNNç±»å‹</h4><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/RNNç»“æ„.png" alt="RNNç»“æ„"></p><ul><li>ä¸€å¯¹ä¸€ï¼šå›ºå®šè¾“å…¥åˆ°å›ºå®šè¾“å‡ºï¼Œå¦‚å›¾åƒåˆ†ç±»</li><li>ä¸€å¯¹å¤šï¼šå›ºå®šè¾“å…¥åˆ°åºåˆ—è¾“å‡ºï¼Œå¦‚å›¾åƒçš„æ–‡å­—æè¿°</li><li>å¤šå¯¹ä¸€ï¼šåºåˆ—è¾“å…¥åˆ°å›ºå®šè¾“å‡ºï¼Œå¦‚æƒ…æ„Ÿåˆ†ç±»</li><li>ï¼ˆå¼‚æ­¥ï¼‰å¤šå¯¹å¤šï¼šåºåˆ—è¾“å…¥åˆ°åºåˆ—è¾“å‡ºï¼Œå¦‚æœºå™¨ç¿»è¯‘ï¼Œç§°ä¸ºEncoder-Decoderï¼ˆç¼–ç -è§£ç ï¼‰ç»“æ„</li><li>åŒæ­¥å¤šå¯¹å¤šï¼šåŒæ­¥åºåˆ—åˆ°åŒæ­¥è¾“å‡ºï¼Œå¦‚æ–‡æœ¬ç”Ÿæˆã€è§†é¢‘å¸§åˆ†ç±»</li></ul><h4 id="4-1-2-2-åŸºç¡€å¾ªç¯ç¥ç»ç½‘ç»œ"><a href="#4-1-2-2-åŸºç¡€å¾ªç¯ç¥ç»ç½‘ç»œ" class="headerlink" title="4.1.2.2 åŸºç¡€å¾ªç¯ç¥ç»ç½‘ç»œ"></a>4.1.2.2 åŸºç¡€å¾ªç¯ç¥ç»ç½‘ç»œ</h4><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/åŸºç¡€RNNç»“æ„.png" alt="åŸºç¡€RNNç»“æ„"></p><ul><li>$x_t$ï¼štæ—¶åˆ»çš„è¾“å…¥</li><li>$o_t$ï¼štæ—¶åˆ»çš„è¾“å‡º</li><li>$s_t$ï¼štæ—¶åˆ»çš„éšå±‚è¾“å‡º</li><li>æ‰€æœ‰å•å…ƒçš„å‚æ•°$U, V, W$å…±äº«</li></ul><p>ç»Ÿä¸€å…¬å¼ï¼ˆ$f$é‡‡ç”¨TanH/RuLUï¼Œ$g$é‡‡ç”¨Softmax/Sigmoidï¼‰ï¼š</p><script type="math/tex; mode=display">\begin{split}    & s_0 = 0 \\\\    & s_t = f(Ux_t + Ws_{t-1}) \\\\    & o_t = g(Vs_t)\end{split}</script><p>è¾“å‡ºçš„$o<em>t$å—å‰é¢æ—¶åˆ»çš„éšå±‚$s</em>{t-1}$å½±å“ï¼Œå³RNNå…·æœ‰è®°å¿†åŠŸèƒ½</p><h4 id="4-1-2-3-åºåˆ—ç”Ÿæˆæ¡ˆä¾‹"><a href="#4-1-2-3-åºåˆ—ç”Ÿæˆæ¡ˆä¾‹" class="headerlink" title="4.1.2.3 åºåˆ—ç”Ÿæˆæ¡ˆä¾‹"></a>4.1.2.3 åºåˆ—ç”Ÿæˆæ¡ˆä¾‹</h4><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/åºåˆ—ä¾‹å­.png" alt="åºåˆ—ä¾‹å­"></p><ul><li>è¾“å…¥åˆ°ç½‘ç»œå½“ä¸­çš„æ˜¯ä¸€ä¸ªä¸ªçš„åˆ†è¯ç»“æœï¼Œæ¯ä¸€ä¸ªè¯çš„è¾“å…¥æ˜¯ä¸€ä¸ªæ—¶åˆ»</li><li>æ¯ä¸€ä¸ªæ—¶åˆ»æœ‰ä¸€ä¸ªè¾“å‡ºï¼Œè¡¨ç¤ºæœ€å¯èƒ½çš„ä¸‹ä¸€ä¸ªè¯</li></ul><h4 id="4-1-2-4-è¯çš„è¡¨ç¤º"><a href="#4-1-2-4-è¯çš„è¡¨ç¤º" class="headerlink" title="4.1.2.4 è¯çš„è¡¨ç¤º"></a>4.1.2.4 è¯çš„è¡¨ç¤º</h4><p>ä¸ºäº†èƒ½å¤Ÿè®©ç½‘ç»œç†è§£è¾“å…¥ï¼Œéœ€è¦å°†è¯è¿›è¡Œå‘é‡è¡¨ç¤ºã€‚</p><ul><li>å»ºç«‹ä¸€ä¸ªåŒ…å«æ‰€æœ‰åºåˆ—è¯çš„è¯å…¸ï¼Œæ¯ä¸ªè¯åœ¨è¯å…¸ä¸­æœ‰å”¯ä¸€ç¼–å·</li><li>è®°è¯å…¸å¤§å°ä¸º$N$ï¼Œä»»æ„ä¸€ä¸ªè¯éƒ½å¯ä»¥ç”¨ä¸€ä¸ª$N$ç»´çš„One-Hotå‘é‡è¡¨ç¤º</li><li>å¾—åˆ°ä¸€ä¸ªé«˜ç»´ç¨€ç–çŸ©é˜µ</li></ul><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/è¯å‘é‡è¡¨ç¤º.png" alt="è¯å‘é‡è¡¨ç¤º"></p><h4 id="4-1-2-4-è¾“å‡ºçš„è¡¨ç¤º-Softmax"><a href="#4-1-2-4-è¾“å‡ºçš„è¡¨ç¤º-Softmax" class="headerlink" title="4.1.2.4 è¾“å‡ºçš„è¡¨ç¤º-Softmax"></a>4.1.2.4 è¾“å‡ºçš„è¡¨ç¤º-Softmax</h4><p>RNNè¿™ç§æ¨¡å‹ï¼Œæ¯ä¸€ä¸ªæ—¶åˆ»çš„è¾“å‡ºæ˜¯ä¸‹ä¸€ä¸ªæœ€å¯èƒ½çš„è¯ï¼Œå¯ä»¥ç”¨æ¦‚ç‡è¡¨ç¤ºï¼Œæ€»é•¿åº¦ä¸ºè¯çš„æ€»æ•°é•¿åº¦</p><ul><li>æ¯ä¸ªæ—¶åˆ»çš„éšå±‚è¾“å‡º$s_t$ç»è¿‡Softmaxå‡½æ•°ï¼Œå¾—åˆ°æ¦‚ç‡åˆ†å¸ƒ</li></ul><h4 id="4-1-2-5-äº¤å‰ç†µæŸå¤±"><a href="#4-1-2-5-äº¤å‰ç†µæŸå¤±" class="headerlink" title="4.1.2.5 äº¤å‰ç†µæŸå¤±"></a>4.1.2.5 äº¤å‰ç†µæŸå¤±</h4><p>æ€»æŸå¤±å®šä¹‰ï¼šä¸€æ•´ä¸ªåºåˆ—ï¼ˆä¸€ä¸ªå¥å­ï¼‰ä½œä¸ºä¸€ä¸ªè®­ç»ƒå®ä¾‹ï¼Œæ€»è¯¯å·®æ˜¯å„ä¸ªæ—¶åˆ»è¯¯å·®çš„å’Œ</p><script type="math/tex; mode=display">\begin{split}    & E_t(y_t, \hat{y}_t) = -y_t \log(\hat{y}_t) \\\\    & E(y, \hat{y}) = \sum_t E_t(y_t, \hat{y}_t) = -\sum_t y_t \log(\hat{y}_t)\end{split}</script><ul><li>$y_t$ï¼šæ—¶åˆ»tä¸Šæ­£ç¡®çš„è¾“å‡º</li><li>$\hat{y}_t$ï¼šæ—¶åˆ»tä¸Šé¢„æµ‹çš„è¾“å‡º</li></ul><h4 id="4-1-2-6-æ—¶åºåå‘ä¼ æ’­ç®—æ³•ï¼ˆBPTTï¼‰"><a href="#4-1-2-6-æ—¶åºåå‘ä¼ æ’­ç®—æ³•ï¼ˆBPTTï¼‰" class="headerlink" title="4.1.2.6 æ—¶åºåå‘ä¼ æ’­ç®—æ³•ï¼ˆBPTTï¼‰"></a>4.1.2.6 æ—¶åºåå‘ä¼ æ’­ç®—æ³•ï¼ˆBPTTï¼‰</h4><p>Backpropagation Through Timeï¼Œæ—¶åºåå‘ä¼ æ’­ç®—æ³•ï¼šå¯¹äºRNNæœ‰ä¸€ä¸ªæ—¶é—´æ¦‚å¿µï¼Œéœ€è¦æŠŠæ¢¯åº¦æ²¿æ—¶é—´é€šé“è¿›è¡Œåå‘ä¼ æ’­</p><p>éœ€è¦æ›´æ–°çš„å‚æ•°ï¼š$U, V, W, b_x, b_y$</p><ul><li>è®¡ç®—æ¯ä¸ªæ—¶é—´çš„æ¢¯åº¦$dW_t$ï¼Œç›¸åŠ ä½œä¸ºæ¯æ¬¡$W$æ›´æ–°çš„æ¢¯åº¦å€¼</li><li>$s<em>t=tanh(Ux_t+Ws</em>{t-1}+b_x)$ï¼Œ$o_t=Softmax(Vs_t+b_y)$</li><li>åˆ©ç”¨é“¾å¼æ³•åˆ™ï¼Œè®¡ç®—å‡ºæ¯ä¸ªæ—¶é—´ä¸‹å„å‚æ•°çš„æ¢¯åº¦</li></ul><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/RNNåå‘ä¼ æ’­æ€»ç»“.png" alt="RNNåå‘ä¼ æ’­æ€»ç»“"></p><h4 id="4-1-2-7-æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸"><a href="#4-1-2-7-æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸" class="headerlink" title="4.1.2.7 æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸"></a>4.1.2.7 æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸</h4><p>ç”±äºRNNä¸­ä¹Ÿå­˜åœ¨é“¾å¼æ±‚å¯¼æ³•åˆ™ï¼Œå› æ­¤ä¹Ÿä¼šå‘ç”Ÿæ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜</p><h3 id="4-1-8-RNNæ”¹è¿›"><a href="#4-1-8-RNNæ”¹è¿›" class="headerlink" title="4.1.8 RNNæ”¹è¿›"></a>4.1.8 RNNæ”¹è¿›</h3><p>é€šè¿‡é—¨æ§æœºåˆ¶æ§åˆ¶ä¿¡æ¯çš„æµåŠ¨</p><h4 id="4-1-8-1-é—¨æ§å¾ªç¯å•å…ƒGRU"><a href="#4-1-8-1-é—¨æ§å¾ªç¯å•å…ƒGRU" class="headerlink" title="4.1.8.1 é—¨æ§å¾ªç¯å•å…ƒGRU"></a>4.1.8.1 é—¨æ§å¾ªç¯å•å…ƒGRU</h4><p>Gated Recurrent Unitï¼Œé—¨æ§å¾ªç¯å•å…ƒ</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/GRUå•å…ƒ.png" alt="GRUå•å…ƒ"></p><p>GRUå¢åŠ äº†ä¸¤ä¸ªé—¨ï¼Œä¸€ä¸ªé‡ç½®é—¨ï¼ˆreset gateï¼‰å’Œä¸€ä¸ªæ›´æ–°é—¨ï¼ˆupdate gateï¼‰</p><ul><li>é‡ç½®é—¨ï¼šå†³å®šå¦‚ä½•å°†æ–°çš„è¾“å…¥å’Œå‰ä¸€æ—¶åˆ»çš„è¾“å‡ºç›¸ç»“åˆ</li><li>æ›´æ–°é—¨ï¼šå®šä¹‰å‰é¢çš„è®°å¿†ä¿å­˜åˆ°å½“å‰æ—¶é—´çš„é‡</li><li>é‡ç½®é—¨1ï¼Œæ›´æ–°é—¨0ï¼Œå³ä¸ºæ ‡å‡†RNNæ¨¡å‹</li></ul><p>GRUæœ¬è´¨è§£å†³çš„é—®é¢˜ï¼š</p><ul><li>è§£å†³çŸ­æœŸé—®é¢˜ï¼Œæ¯ä¸ªé€’å½’å•å…ƒèƒ½å¤Ÿè‡ªé€‚åº”æ•æ‰ä¸åŒå°ºåº¦çš„ä¾èµ–å…³ç³»</li><li>å¤„ç†äº†éšå±‚è¾“å‡ºï¼Œ$h<em>t=(1-z_t)*h</em>{t-1}+z_t*\tilde{h}_t$ï¼Œè§£å†³äº†æ¢¯åº¦æ¶ˆå¤±é—®é¢˜</li></ul><h4 id="4-1-8-2-é•¿çŸ­æ—¶è®°å¿†ç½‘ç»œLSTM"><a href="#4-1-8-2-é•¿çŸ­æ—¶è®°å¿†ç½‘ç»œLSTM" class="headerlink" title="4.1.8.2 é•¿çŸ­æ—¶è®°å¿†ç½‘ç»œLSTM"></a>4.1.8.2 é•¿çŸ­æ—¶è®°å¿†ç½‘ç»œLSTM</h4><p>Long Short Term Memoryï¼Œé•¿çŸ­è®°å¿†ç½‘ç»œ</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/LSTM.png" alt="LSTM"></p><ul><li>$h_t$ï¼šå½“å‰cellçš„è¾“å‡º</li><li>$c_t$ï¼šéšå±‚çš„è®°å¿†</li><li>ä¸‰ä¸ªé—¨ï¼šé—å¿˜é—¨fï¼Œè¾“å…¥é—¨uï¼Œè¾“å‡ºé—¨o</li></ul><p>ä½œç”¨ï¼šä¾¿äºè®°å¿†é•¿æ›´é•¿è·ç¦»çš„çŠ¶æ€</p><h2 id="4-2-è¯åµŒå…¥ä¸NLP"><a href="#4-2-è¯åµŒå…¥ä¸NLP" class="headerlink" title="4.2 è¯åµŒå…¥ä¸NLP"></a>4.2 è¯åµŒå…¥ä¸NLP</h2><h3 id="4-2-1-åœ¨RNNä¸­ä½¿ç”¨one-hotè¡¨ç¤ºçš„é—®é¢˜"><a href="#4-2-1-åœ¨RNNä¸­ä½¿ç”¨one-hotè¡¨ç¤ºçš„é—®é¢˜" class="headerlink" title="4.2.1 åœ¨RNNä¸­ä½¿ç”¨one-hotè¡¨ç¤ºçš„é—®é¢˜"></a>4.2.1 åœ¨RNNä¸­ä½¿ç”¨one-hotè¡¨ç¤ºçš„é—®é¢˜</h3><ul><li>å‡è®¾æœ‰nä¸ªè¯ï¼Œæ¯ä¸ªè¯çš„one-hotè¡¨ç¤ºæ˜¯nç»´çš„ï¼Œæ•´ä½“å¤§å°ä¸º$n*n$ï¼Œéå¸¸ç¨€ç–</li><li>æ— æ³•è¡¨ç¤ºè¯ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œä¾‹å¦‚Appleå¯¹Bananaçš„ç›¸ä¼¼æ€§è¿œé«˜äºMonkey</li></ul><h3 id="4-2-2-è¯åµŒå…¥ï¼ˆWord-Embeddingï¼‰"><a href="#4-2-2-è¯åµŒå…¥ï¼ˆWord-Embeddingï¼‰" class="headerlink" title="4.2.2 è¯åµŒå…¥ï¼ˆWord Embeddingï¼‰"></a>4.2.2 è¯åµŒå…¥ï¼ˆWord Embeddingï¼‰</h3><p>æŠŠä¸€ä¸ªç»´æ•°ä¸º$N$çš„é«˜ç»´ç©ºé—´åµŒå…¥åˆ°ä¸€ä¸ªç»´æ•°ä½çš„å¤šçš„è¿ç»­å‘é‡ç©ºé—´ä¸­ï¼Œæ¯ä¸ªå•è¯æˆ–è¯ç»„è¢«æ˜ å°„ä¸ºå®æ•°åŸŸä¸Šçš„å‘é‡ï¼Œä¾‹å¦‚ï¼š</p><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">Man</th><th style="text-align:center">Woman</th><th style="text-align:center">King</th><th style="text-align:center">Queen</th><th style="text-align:center">Apple</th><th style="text-align:center">Banana</th></tr></thead><tbody><tr><td style="text-align:center">Gender</td><td style="text-align:center">1</td><td style="text-align:center">-1</td><td style="text-align:center">-0.95</td><td style="text-align:center">0.97</td><td style="text-align:center">0.01</td><td style="text-align:center">-0.02</td></tr><tr><td style="text-align:center">Royal</td><td style="text-align:center">0.01</td><td style="text-align:center">0.02</td><td style="text-align:center">0.98</td><td style="text-align:center">0.99</td><td style="text-align:center">-0.03</td><td style="text-align:center">0.04</td></tr><tr><td style="text-align:center">Age</td><td style="text-align:center">0.01</td><td style="text-align:center">0.02</td><td style="text-align:center">0.75</td><td style="text-align:center">0.69</td><td style="text-align:center">0.03</td><td style="text-align:center">-0.04</td></tr><tr><td style="text-align:center">Food</td><td style="text-align:center">0.01</td><td style="text-align:center">0.02</td><td style="text-align:center">-0.03</td><td style="text-align:center">0.04</td><td style="text-align:center">0.95</td><td style="text-align:center">0.97</td></tr></tbody></table></div><p>è¯åµŒå…¥çš„ç‰¹ç‚¹ï¼šèƒ½å¤Ÿä½“ç°è¯ä¸è¯ä¹‹é—´çš„å…³ç³»</p><p>Man-Womanâ‰ˆKing-?(Queen!) </p><p>ç®—æ³•/å·¥å…·ï¼šSkip-gramã€CBOWã€GenSim</p><h2 id="4-3-Seq2Seqä¸Attentionæœºåˆ¶"><a href="#4-3-Seq2Seqä¸Attentionæœºåˆ¶" class="headerlink" title="4.3 Seq2Seqä¸Attentionæœºåˆ¶"></a>4.3 Seq2Seqä¸Attentionæœºåˆ¶</h2><h3 id="4-3-1-Seq2Seq"><a href="#4-3-1-Seq2Seq" class="headerlink" title="4.3.1 Seq2Seq"></a>4.3.1 Seq2Seq</h3><p>Seq2Seqï¼šSequence to Sequenceï¼Œç”±Google Brainå›¢é˜Ÿå’ŒYoshua Bengio ä¸¤ä¸ªå›¢é˜Ÿå„è‡ªç‹¬ç«‹çš„æå‡ºæ¥</p><h4 id="4-3-1-1-å®šä¹‰"><a href="#4-3-1-1-å®šä¹‰" class="headerlink" title="4.3.1.1 å®šä¹‰"></a>4.3.1.1 å®šä¹‰</h4><p>Seq2Seqæ¨¡å‹æ˜¯ä¸€ä¸ªEncoder-Decoderç»“æ„çš„æ¨¡å‹ï¼Œè¾“å…¥æ˜¯ä¸€ä¸ªåºåˆ—ï¼Œè¾“å‡ºä¹Ÿæ˜¯ä¸€ä¸ªåºåˆ—</p><p>Encoderä¸­å°†ä¸€ä¸ªå¯å˜é•¿åº¦çš„ä¿¡å·åºåˆ—å˜ä¸ºå›ºå®šé•¿åº¦çš„å‘é‡è¡¨è¾¾ï¼Œ<br>Decoderä¸­å°†è¿™ä¸ªå›ºå®šé•¿åº¦çš„å‘é‡è¡¨è¾¾å˜ä¸ºå¯å˜é•¿åº¦çš„ç›®æ ‡ä¿¡å·åºåˆ—</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/seq2seq.png" alt="seq2seq"></p><ul><li>ç›¸å½“äºæŠŠRNNæ¨¡å‹çš„$s_0$è¾“å…¥å˜æˆä¸€ä¸ªEncoder</li></ul><h4 id="4-3-1-2-æ¡ä»¶è¯­è¨€æ¨¡å‹"><a href="#4-3-1-2-æ¡ä»¶è¯­è¨€æ¨¡å‹" class="headerlink" title="4.3.1.2 æ¡ä»¶è¯­è¨€æ¨¡å‹"></a>4.3.1.2 æ¡ä»¶è¯­è¨€æ¨¡å‹</h4><p>Encoderç¼–ç å™¨çš„ä½œç”¨ï¼š</p><ul><li>å°†ä¸€ä¸ªè¾¹é•¿è¾“å…¥åºåˆ—è¾“å‡ºåˆ°ä¸€ä¸ªç¼–ç çŠ¶æ€$C$</li><li>è§£ç å™¨è¾“å‡º$y<em>t$çš„æ¡ä»¶æ¦‚ç‡åŸºäºä¹‹å‰çš„è¾“å‡ºåºåˆ—$y_1y_2â€¦y</em>{t-1}$å’Œç¼–ç çŠ¶æ€$C$</li><li>$argmaxP(y_1,y_2,â€¦,y_T|x_1,x_2,â€¦,x_T)$ï¼Œç»™å®šè¾“å…¥çš„åºåˆ—ï¼Œæœ€å¤§åŒ–è¾“å‡ºåºåˆ—çš„æ¦‚ç‡</li></ul><p>æ ¹æ®æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œæœ€å¤§åŒ–è¾“å‡ºåºåˆ—çš„æ¦‚ç‡</p><script type="math/tex; mode=display">\begin{split}    & P(y_1,y_2,...,y_T|x_1,x_2,...,x_T) \\\\    & = \prod_{t=1}^T P(y_t|y_1,y_2,...,y_{t-1},x_1,x_2,...,x_T) \\\\    & = \prod_{t=1}^T P(y_t|y_1,y_2,...,y_{t-1},C)\end{split}</script><p>è¿™ä¸ªå…¬å¼éœ€è¦æ±‚å‡º$P(y<em>1|C),P(y_2|y_1,C),â€¦,P(y_T|y_1,y_2,â€¦,y</em>{T-1},C)$ï¼Œæ¦‚ç‡è¿ä¹˜æå°ï¼Œä¸åˆ©äºå­˜å‚¨ï¼Œå› æ­¤å–å¯¹æ•°è¿›è¡Œè®¡ç®—ï¼Œè¿™æ ·å°±å°†è¿ä¹˜å¼è½¬æ¢ä¸ºç´¯åŠ å¼</p><script type="math/tex; mode=display">\log P(y_1,y_2,...,y_T|x_1,x_2,...,x_T) = \sum_{t=1}^T \log P(y_t|y_1,y_2,...,y_{t-1},C)</script><p>åº”ç”¨åœºæ™¯ï¼šæœºå™¨ç¿»è¯‘ï¼ˆNMTï¼‰</p><h3 id="4-3-2-Attentionæœºåˆ¶"><a href="#4-3-2-Attentionæœºåˆ¶" class="headerlink" title="4.3.2 Attentionæœºåˆ¶"></a>4.3.2 Attentionæœºåˆ¶</h3><h4 id="4-3-2-1-é•¿å¥å­é—®é¢˜"><a href="#4-3-2-1-é•¿å¥å­é—®é¢˜" class="headerlink" title="4.3.2.1 é•¿å¥å­é—®é¢˜"></a>4.3.2.1 é•¿å¥å­é—®é¢˜</h4><p>å¯¹äºé•¿å¥å­ï¼ŒSeq2Seqæ¨¡å‹çš„æ€§èƒ½ä¼šä¸‹é™ï¼Œæ— æ³•åšåˆ°å‡†ç¡®ç¿»è¯‘ã€‚<br>å¥å­éå¸¸é•¿æ—¶ï¼ŒBLEUï¼ˆBilingual Evaluation Understudyï¼‰è¯„ä»·å¾—åˆ†ä¼šå¾ˆä½</p><p>æœ¬è´¨åŸå› ï¼šåœ¨Encoder-Decoderç»“æ„ä¸­ï¼ŒEncoderæŠŠæ‰€æœ‰çš„è¾“å…¥åºåˆ—éƒ½ç¼–ç æˆä¸€ä¸ªç»Ÿä¸€çš„è¯­ä¹‰ç‰¹å¾$C$å†è§£ç ï¼Œ$C$ä¸­å¿…é¡»åŒ…å«åŸå§‹åºåˆ—ä¸­çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå®ƒçš„é•¿åº¦å°±æˆäº†æ¨¡å‹æ€§èƒ½çš„ç“¶é¢ˆã€‚<br>å½“éœ€è¦ç¿»è¯‘çš„å¥å­å¾ˆé•¿æ—¶ï¼Œä¸€ä¸ª$C$å¯èƒ½å­˜ä¸ä¸‹é‚£ä¹ˆå¤šä¿¡æ¯ï¼Œå°±ä¼šé€ æˆç¿»è¯‘ç²¾åº¦çš„ä¸‹é™ã€‚</p><h4 id="4-3-2-2-Attentionæœºåˆ¶"><a href="#4-3-2-2-Attentionæœºåˆ¶" class="headerlink" title="4.3.2.2 Attentionæœºåˆ¶"></a>4.3.2.2 Attentionæœºåˆ¶</h4><ul><li>æŠŠEncoderçš„æ‰€æœ‰éšå±‚è¾“å‡º$s_1,s_2,â€¦,s_T$éƒ½ä¿ç•™ä¸‹æ¥ï¼Œä¸å†åªä¿ç•™æœ€åä¸€ä¸ªéšå±‚è¾“å‡º$C$</li><li>å°†è¿™äº›ä¿¡æ¯æä¾›ç»™Decoder</li></ul><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/Attentionæœºåˆ¶.png" alt="Attentionæœºåˆ¶"></p><h4 id="4-3-2-3-Attentionæœºåˆ¶çš„è®¡ç®—"><a href="#4-3-2-3-Attentionæœºåˆ¶çš„è®¡ç®—" class="headerlink" title="4.3.2.3 Attentionæœºåˆ¶çš„è®¡ç®—"></a>4.3.2.3 Attentionæœºåˆ¶çš„è®¡ç®—</h4><p>å‡è®¾Encoderçš„æ—¶åˆ»ä¸º$t$ï¼ŒDecoderçš„æ—¶åˆ»ä¸º$tâ€™$</p><ol><li>$c<em>{tâ€™}=\sum</em>{t=1}^T \alpha_{tâ€™t}s_t$<ul><li>$\alpha_{tâ€™t}$ï¼šå‚æ•°ï¼Œè®­ç»ƒå¾—åˆ°ï¼Œè¡¨ç¤ºDecoderçš„$tâ€™$æ—¶åˆ»å¯¹Encoderçš„$t$æ—¶åˆ»çš„æ³¨æ„åŠ›æƒé‡</li><li>ç†è§£ï¼šEncoderçš„æ¯ä¸ªæ—¶åˆ»åŠ æƒæ±‚å’Œï¼Œå¾—åˆ°Decoderçš„$tâ€™$æ—¶åˆ»çš„è¾“å…¥</li><li>$c<em>4=\alpha</em>{41}s<em>1+\alpha</em>{42}s<em>2+â€¦+\alpha</em>{4T}s_T$</li></ul></li><li>$\alpha_{tâ€™t}$çš„$N$ä¸ªæƒé‡ç³»æ•°çš„ç”±æ¥<ul><li>æƒé‡ç³»æ•°é€šè¿‡Softmaxå‡½æ•°å¾—åˆ°ï¼Œ$\alpha<em>{tâ€™t}=\frac{exp(e</em>{tâ€™t})}{\sum<em>{k=1}^T exp(e</em>{tâ€™k})}$</li><li>$e<em>{tâ€™t}=g(s</em>{tâ€™-1},h_t)=v^T \tanh(W_ss+W_hh)$<ul><li>$e_{tâ€™t}$ï¼šç”±tæ—¶åˆ»çš„ç¼–ç å™¨éšå±‚çŠ¶æ€è¾“å‡ºå’Œtâ€™-1æ—¶åˆ»çš„è§£ç å™¨éšå±‚çŠ¶æ€è¾“å‡ºè®¡ç®—å¾—åˆ°çš„ä¸€ä¸ªå€¼</li><li>sä¸ºDecoderçš„éšå±‚è¾“å‡ºï¼Œhä¸ºEncoderçš„éšå±‚è¾“å‡º</li><li>$W_s, W_h, v$ï¼šå‚æ•°ï¼Œè®­ç»ƒå¾—åˆ°</li></ul></li></ul></li></ol>]]></content>
    
    
    <summary type="html">æŠŠè¾“å‡ºå’Œæ–°çš„è¾“å…¥æ··åˆæ¥å¤„ç†åºåˆ—æ•°æ®çš„ç½‘ç»œ</summary>
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>æ·±åº¦å­¦ä¹ ç¬”è®°3-å·ç§¯ç¥ç»ç½‘ç»œCNN</title>
    <link href="https://www.cclmsy.cc/posts/Deep_Learning03.html"/>
    <id>https://www.cclmsy.cc/posts/Deep_Learning03.html</id>
    <published>2025-02-22T10:00:00.000Z</published>
    <updated>2025-02-21T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="3-1-å›¾åƒæ•°æ®ä¸è¾¹ç¼˜æ£€æµ‹"><a href="#3-1-å›¾åƒæ•°æ®ä¸è¾¹ç¼˜æ£€æµ‹" class="headerlink" title="3.1 å›¾åƒæ•°æ®ä¸è¾¹ç¼˜æ£€æµ‹"></a>3.1 å›¾åƒæ•°æ®ä¸è¾¹ç¼˜æ£€æµ‹</h2><h3 id="3-1-1-å›¾åƒæ•°æ®"><a href="#3-1-1-å›¾åƒæ•°æ®" class="headerlink" title="3.1.1 å›¾åƒæ•°æ®"></a>3.1.1 å›¾åƒæ•°æ®</h3><p>åœ¨CVé¢†åŸŸï¼Œé€šå¸¸è¦åšçš„æ˜¯ç”¨æœºå™¨ç¨‹åºä»£æ›¿äººçœ¼å¯¹ç›®æ ‡å›¾åƒè¿›è¡Œè¯†åˆ«ã€åˆ†æã€å¤„ç†ã€‚<br>æ·±åº¦å­¦ä¹ åœ¨CVé¢†åŸŸçš„åº”ç”¨éå¸¸å¹¿æ³›ã€‚</p><p>å‡è®¾éœ€è¦å¤„ç†1024x1024çš„å½©è‰²å›¾åƒï¼Œæ¯ä¸ªåƒç´ æœ‰RGBä¸‰ä¸ªé€šé“ï¼Œå…±æœ‰1024x1024x3=3,145,728ä¸ªç‰¹å¾ã€‚<br>å‡è®¾ç¬¬ä¸€ä¸ªéšè—å±‚æœ‰10ä¸ªç¥ç»å…ƒï¼Œé‚£ä¹ˆç¬¬ä¸€å±‚çš„æƒé‡çŸ©é˜µæœ‰3,145,728x10=31,457,280ä¸ªå‚æ•°ï¼Œè®¡ç®—é‡æå¤§ï¼Œéš¾ä»¥è¾¾åˆ°å¥½çš„æ•ˆæœã€‚</p><p>ç›¸æ¯”å¤šå±‚ç¥ç»ç½‘ç»œï¼Œå·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰æ›´é€‚åˆå¤„ç†å›¾åƒæ•°æ®ã€‚</p><h3 id="3-1-2-æ„Ÿå—é‡ï¼ˆReceptive-Fieldï¼‰"><a href="#3-1-2-æ„Ÿå—é‡ï¼ˆReceptive-Fieldï¼‰" class="headerlink" title="3.1.2 æ„Ÿå—é‡ï¼ˆReceptive Fieldï¼‰"></a>3.1.2 æ„Ÿå—é‡ï¼ˆReceptive Fieldï¼‰</h3><p>1962å¹´Hubelå’ŒWieselé€šè¿‡å¯¹çŒ«è§†è§‰çš®å±‚ç»†èƒçš„ç ”ç©¶ï¼Œæå‡ºäº†æ„Ÿå—é‡çš„æ¦‚å¿µã€‚<br>FukushimaåŸºäºæ„Ÿå—é‡æ¦‚å¿µæå‡ºçš„ç¥ç»è®¤çŸ¥æœº(Neocognitron)å¯ä»¥çœ‹ä½œæ˜¯å·ç§¯ç¥ç»ç½‘ç»œçš„ç¬¬ä¸€ä¸ªå®ç°ç½‘ç»œã€‚</p><p>å•ä¸ªæ„Ÿå—å™¨ä¸è®¸å¤šæ„Ÿè§‰ç¥ç»çº¤ç»´ç›¸è”ç³»ï¼Œæ„Ÿè§‰ä¿¡æ¯æ˜¯é€šè¿‡è®¸å¤šæ„Ÿå—ç¥ç»çº¤ç»´å‘æ”¾æ€»å’Œæ€§çš„ç©ºé—´ä¸æ—¶é—´ç±»å‹ä¸åŒçš„å†²åŠ¨ï¼Œç›¸å½“äºç»è¿‡ç¼–ç æ¥ä¼ é€’ã€‚</p><h3 id="3-1-3-è¾¹ç¼˜è¿ç®—"><a href="#3-1-3-è¾¹ç¼˜è¿ç®—" class="headerlink" title="3.1.3 è¾¹ç¼˜è¿ç®—"></a>3.1.3 è¾¹ç¼˜è¿ç®—</h3><p>ä¸ºäº†ä½¿ç”¨æ›´å°‘çš„å‚æ•°æ£€æµ‹å‡ºæ›´å¤šçš„ä¿¡æ¯ï¼Œé€šå¸¸ç¥ç»ç½‘ç»œéœ€è¦æ£€æµ‹å‡ºç‰©ä½“æœ€æ˜æ˜¾çš„å‚ç›´å’Œæ°´å¹³è¾¹ç¼˜æ¥åŒºåˆ†ç‰©ä½“ã€‚</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/è¾¹ç¼˜æ£€æµ‹.png" alt="è¾¹ç¼˜æ£€æµ‹"></p><p>éšç€æ·±åº¦å­¦ä¹ çš„å‘å±•ï¼Œæˆ‘ä»¬éœ€è¦æ£€æµ‹æ›´å¤æ‚çš„å›¾åƒä¸­çš„è¾¹ç¼˜ã€‚<br>ä¸å…¶ä½¿ç”¨ç”±äººæ‰‹å·¥è®¾è®¡çš„è¿‡æ»¤å™¨ï¼Œè¿˜å¯ä»¥å°†è¿‡æ»¤å™¨ä¸­çš„æ•°å€¼ä½œä¸ºå‚æ•°ï¼Œé€šè¿‡åå‘ä¼ æ’­æ¥å­¦ä¹ å¾—åˆ°ã€‚<br>ç®—æ³•å¯ä»¥æ ¹æ®å®é™…æ•°æ®æ¥é€‰æ‹©åˆé€‚çš„æ£€æµ‹ç›®æ ‡ï¼Œæ— è®ºæ˜¯æ£€æµ‹æ°´å¹³è¾¹ç¼˜ã€å‚ç›´è¾¹ç¼˜è¿˜æ˜¯å…¶ä»–è§’åº¦çš„è¾¹ç¼˜ï¼Œå¹¶ä¹ å¾—å›¾åƒçš„ä½å±‚ç‰¹å¾ã€‚</p><h2 id="3-2-å·ç§¯ç¥ç»ç½‘ç»œåŸç†"><a href="#3-2-å·ç§¯ç¥ç»ç½‘ç»œåŸç†" class="headerlink" title="3.2 å·ç§¯ç¥ç»ç½‘ç»œåŸç†"></a>3.2 å·ç§¯ç¥ç»ç½‘ç»œåŸç†</h2><h3 id="3-2-1-å·ç§¯ç¥ç»ç½‘ç»œçš„ç»„æˆ"><a href="#3-2-1-å·ç§¯ç¥ç»ç½‘ç»œçš„ç»„æˆ" class="headerlink" title="3.2.1 å·ç§¯ç¥ç»ç½‘ç»œçš„ç»„æˆ"></a>3.2.1 å·ç§¯ç¥ç»ç½‘ç»œçš„ç»„æˆ</h3><p>CNNç”±ä¸€ä¸ªæˆ–å¤šä¸ªå·ç§¯å±‚ã€æ± åŒ–å±‚ã€å…¨è¿æ¥å±‚ç»„æˆã€‚</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/CNNç»“æ„.png" alt="CNNç»“æ„"></p><p>ä¸å…¶ä»–æ·±åº¦å­¦ä¹ ç»“æ„ç›¸æ¯”ï¼ŒCNNåœ¨å›¾åƒç­‰æ–¹é¢èƒ½å¤Ÿç»™å‡ºæ›´å¥½çš„ç»“æœã€‚<br>CNNä¹Ÿå¯ä»¥ç”¨åå‘ä¼ æ’­ç®—æ³•è¿›è¡Œè®­ç»ƒã€‚<br>ä¸å…¶ä»–æµ…å±‚æˆ–æ·±å±‚ç¥ç»ç½‘ç»œç›¸æ¯”ï¼ŒCNNçš„å‚æ•°æ›´å°‘ï¼Œæ›´å®¹æ˜“è®­ç»ƒã€‚</p><h3 id="3-2-2-å·ç§¯å±‚ï¼ˆConvolutionsï¼‰"><a href="#3-2-2-å·ç§¯å±‚ï¼ˆConvolutionsï¼‰" class="headerlink" title="3.2.2 å·ç§¯å±‚ï¼ˆConvolutionsï¼‰"></a>3.2.2 å·ç§¯å±‚ï¼ˆConvolutionsï¼‰</h3><ul><li>ç›®çš„ï¼šæå–è¾“å…¥çš„ä¸åŒç‰¹å¾<ul><li>æŸäº›å·ç§¯å±‚å¯èƒ½åªèƒ½æå–ä¸€äº›ä½çº§ç‰¹å¾ï¼Œå¦‚çº¿æ¡ã€è¾¹ç¼˜ç­‰ï¼Œæ›´å¤šå±‚çš„ç½‘ç»œèƒ½ä»ä½çº§ç‰¹å¾ä¸­æå–æ›´é«˜çº§æ›´å¤æ‚çš„ç‰¹å¾ã€‚</li></ul></li><li>å‚æ•°<ul><li>sizeï¼šå·ç§¯æ ¸ï¼ˆfilterï¼‰å¤§å°ï¼Œå¦‚3x3ã€5x5ç­‰</li><li>paddingï¼š0å¡«å……ï¼Œä¿æŒè¾“å‡ºå’Œè¾“å…¥çš„å¤§å°ä¸€è‡´ï¼ŒValid/Same</li><li>strideï¼šæ­¥é•¿ï¼Œå·ç§¯æ ¸æ¯æ¬¡ç§»åŠ¨çš„è·ç¦»ï¼Œé€šå¸¸ä¸º1</li></ul></li><li>è®¡ç®—å…¬å¼<ul><li>å››ä¸ªè¶…å‚æ•°ï¼šFilteræ•°é‡$K$ã€Filterå¤§å°$F$ã€æ­¥é•¿$S$ã€0å¡«å……å¤§å°$P$</li><li>è¾“å…¥ä½“ç§¯ï¼š$H_1 \times W_1 \times D_1$</li><li>è¾“å‡ºä½“ç§¯ï¼š$H_2 \times W_2 \times D_2$<ul><li>$H_2 = \dfrac{H_1-F+2P}{S}+1$</li><li>$W_2 = \dfrac{W_1-F+2P}{S}+1$</li><li>$D_2 = K$</li></ul></li></ul></li></ul><h4 id="3-2-2-1-å·ç§¯è¿ç®—"><a href="#3-2-2-1-å·ç§¯è¿ç®—" class="headerlink" title="3.2.2.1 å·ç§¯è¿ç®—"></a>3.2.2.1 å·ç§¯è¿ç®—</h4><p>å·ç§¯è¿ç®—ï¼ˆç¬¦å·$\ast$ï¼‰ï¼šå°†ä¸€ä¸ªçŸ©é˜µï¼ˆå·ç§¯æ ¸ï¼‰åº”ç”¨åˆ°å¦ä¸€ä¸ªçŸ©é˜µçš„æ‰€æœ‰ä½ç½®ï¼Œæ±‚å‡ºæ¯ä¸ªä½ç½®çš„ç‚¹ç§¯ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„çŸ©é˜µã€‚</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/å·ç§¯è¿ç®—.png" alt="å·ç§¯è¿ç®—"></p><p>åœ¨è¿™ä¸ª6x6çš„çŸ©é˜µä¸­ï¼Œå·¦è¾¹ä¸€åŠéƒ½æ˜¯1ï¼Œå³è¾¹ä¸€åŠéƒ½æ˜¯0ï¼Œä¸­é—´æ˜¯ä¸€æ¡éå¸¸æ˜æ˜¾çš„å‚ç›´è¾¹ç¼˜ã€‚<br>ç»è¿‡å·ç§¯åï¼Œå¾—åˆ°ä¸€ä¸ª4x4çš„çŸ©é˜µï¼Œä¸­é—´çš„å€¼éå¸¸å¤§ï¼Œå…¶ä»–å€¼éå¸¸å°ï¼Œè¡¨æ˜æ£€æµ‹åˆ°äº†å‚ç›´è¾¹ç¼˜ã€‚</p><p>å·ç§¯è¿ç®—çš„äº§ç”Ÿçš„é—®é¢˜ï¼šè¾¹ç¼˜åƒç´ çš„ä¿¡æ¯ä¸¢å¤±ã€è¾“å‡ºçš„å›¾åƒå°ºå¯¸å˜å°</p><h4 id="3-2-2-2-padding-é›¶å¡«å……"><a href="#3-2-2-2-padding-é›¶å¡«å……" class="headerlink" title="3.2.2.2 padding-é›¶å¡«å……"></a>3.2.2.2 padding-é›¶å¡«å……</h4><p>åœ¨å›¾ç‰‡åƒç´ çš„æœ€å¤–å±‚åŠ ä¸Š$P$å±‚0ï¼Œä½¿å¾—å·ç§¯åçš„è¾“å‡ºå’Œè¾“å…¥çš„å°ºå¯¸ä¸€è‡´ã€‚</p><p>0å¯¹æœ€ç»ˆç»“æœä¸äº§ç”Ÿå½±å“ï¼Œé¿å…å›¾ç‰‡å¢åŠ å™ªå£°ã€‚</p><ul><li>Validå·ç§¯ï¼šä¸å¡«å……ï¼Œè¾“å‡ºå°ºå¯¸å‡å°</li><li>Sameå·ç§¯ï¼ˆä¸€èˆ¬é‡‡ç”¨ï¼‰ï¼šå¡«å……0ä»¥ç»´æŒè¾“å‡ºå°ºå¯¸ä¸åŸå›¾ä¸€è‡´</li></ul><h4 id="3-2-2-3-size-å·ç§¯æ ¸å¤§å°"><a href="#3-2-2-3-size-å·ç§¯æ ¸å¤§å°" class="headerlink" title="3.2.2.3 size-å·ç§¯æ ¸å¤§å°"></a>3.2.2.3 size-å·ç§¯æ ¸å¤§å°</h4><p>å·ç§¯æ ¸å¤§å°$F$é€šå¸¸ä¸º3x3ã€5x5ã€7x7ç­‰å¥‡æ•°ï¼Œä¿è¯èƒ½å¤Ÿç¡®å®šä¸€ä¸ªä¸­å¿ƒç‚¹ã€‚</p><p>å°å·ç§¯æ ¸å¯ä»¥ä¿ç•™æ›´å¤šçš„ä¿¡æ¯ï¼Œå¤§å·ç§¯æ ¸å¯ä»¥æ£€æµ‹æ›´å¤§çš„ç‰¹å¾ã€‚</p><h4 id="3-2-2-4-stride-æ­¥é•¿"><a href="#3-2-2-4-stride-æ­¥é•¿" class="headerlink" title="3.2.2.4 stride-æ­¥é•¿"></a>3.2.2.4 stride-æ­¥é•¿</h4><p>æ­¥é•¿$S$é€šå¸¸ä¸º1ï¼Œå³å·ç§¯æ ¸æ¯æ¬¡ç§»åŠ¨ä¸€ä¸ªåƒç´ ã€‚</p><p>æ­¥é•¿ä¸º2æ—¶ï¼Œå·ç§¯æ ¸æ¯æ¬¡ç§»åŠ¨ä¸¤ä¸ªåƒç´ ï¼Œè¾“å‡ºå°ºå¯¸å‡å°ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/2æ­¥é•¿å·ç§¯.png" alt="2æ­¥é•¿å·ç§¯"></p><h4 id="3-2-2-5-å¤šé€šé“å·ç§¯"><a href="#3-2-2-5-å¤šé€šé“å·ç§¯" class="headerlink" title="3.2.2.5 å¤šé€šé“å·ç§¯"></a>3.2.2.5 å¤šé€šé“å·ç§¯</h4><p>å½“è¾“å…¥æœ‰å¤šä¸ªé€šé“ï¼ˆChannelï¼‰æ—¶ï¼ˆä¾‹å¦‚å›¾ç‰‡å¯ä»¥æœ‰ RGB ä¸‰ä¸ªé€šé“ï¼‰ï¼Œå·ç§¯æ ¸éœ€è¦æ‹¥æœ‰ç›¸åŒçš„é€šé“æ•°</p><p>ä½†æœ€ç»ˆçš„è¾“å‡ºåªæœ‰ä¸€ä¸ªé€šé“ï¼Œå…¶ç»“æœæ˜¯å¤šä¸ªé€šé“çš„å·ç§¯ç»“æœçš„å’Œã€‚</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/å¤šé€šé“å·ç§¯.png" alt="å¤šé€šé“å·ç§¯"></p><h4 id="3-2-2-6-å¤šå·ç§¯æ ¸"><a href="#3-2-2-6-å¤šå·ç§¯æ ¸" class="headerlink" title="3.2.2.6 å¤šå·ç§¯æ ¸"></a>3.2.2.6 å¤šå·ç§¯æ ¸</h4><p>å½“æœ‰å¤šä¸ªå·ç§¯æ ¸æ—¶ï¼Œå¯ä»¥å­¦ä¹ åˆ°å¤šç§ä¸åŒçš„ç‰¹å¾ï¼Œè¾“å‡ºç»“æœçš„é€šé“æ•°ç­‰äºå·ç§¯æ ¸çš„æ•°é‡ï¼Œå¤šå·ç§¯æ ¸å¯ä»¥ç†è§£ä¸ºå¤šç¥ç»å…ƒ</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/å¤šå·ç§¯æ ¸.png" alt="å¤šå·ç§¯æ ¸"></p><h4 id="3-2-2-7-å·ç§¯å±‚çš„è¿ç®—ç»“æœ"><a href="#3-2-2-7-å·ç§¯å±‚çš„è¿ç®—ç»“æœ" class="headerlink" title="3.2.2.7 å·ç§¯å±‚çš„è¿ç®—ç»“æœ"></a>3.2.2.7 å·ç§¯å±‚çš„è¿ç®—ç»“æœ</h4><script type="math/tex; mode=display">\begin{split}&Z^{[l]} = W^{[l]} \ast A^{[l-1]} + b^{[l]} \\\\&A^{[l]} = g(Z^{[l]}) \end{split}</script><h3 id="3-2-3-æ± åŒ–å±‚ï¼ˆPoolingï¼‰"><a href="#3-2-3-æ± åŒ–å±‚ï¼ˆPoolingï¼‰" class="headerlink" title="3.2.3 æ± åŒ–å±‚ï¼ˆPoolingï¼‰"></a>3.2.3 æ± åŒ–å±‚ï¼ˆPoolingï¼‰</h3><p>æ± åŒ–å±‚ä¸»è¦å¯¹å·ç§¯å±‚çš„è¾“å‡ºè¿›è¡Œä¸‹é‡‡æ ·ï¼ˆSubsamplingï¼‰å¤„ç†ï¼Œä¸»è¦åˆ†ä¸ºï¼š</p><ul><li>æœ€å¤§æ± åŒ–ï¼ˆMax Poolingï¼‰ï¼šå–æ± åŒ–çª—å£ä¸­çš„æœ€å¤§å€¼</li><li>å¹³å‡æ± åŒ–ï¼ˆAverage Poolingï¼‰ï¼šå–æ± åŒ–çª—å£ä¸­çš„å¹³å‡å€¼</li></ul><p>æ± åŒ–é€šå¸¸ä¸º2x2çš„filterï¼Œæ­¥é•¿ä¸º2ï¼Œå³æ¯æ¬¡å–2x2çš„çª—å£ä¸­çš„æœ€å¤§å€¼æˆ–å¹³å‡å€¼ã€‚</p><p>ç‰¹ç‚¹ï¼šæ²¡æœ‰å‚æ•°ï¼Œä¸éœ€è¦å­¦ä¹ ï¼Œåªæ˜¯å¯¹è¾“å…¥æ•°æ®è¿›è¡Œç®€å•çš„å¤„ç†ã€‚</p><p>ç›®çš„ï¼šé™ä½æ•°æ®ç»´åº¦ï¼›å‡å°‘è®¡ç®—é‡ã€æé«˜è®¡ç®—é€Ÿåº¦ï¼›é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œæé«˜äº†é²æ£’æ€§ã€‚</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/æ± åŒ–å±‚.png" alt="æ± åŒ–å±‚"></p><h3 id="3-2-4-å…¨è¿æ¥å±‚ï¼ˆFully-Connectedï¼‰ä¸CNNç»“æ„"><a href="#3-2-4-å…¨è¿æ¥å±‚ï¼ˆFully-Connectedï¼‰ä¸CNNç»“æ„" class="headerlink" title="3.2.4 å…¨è¿æ¥å±‚ï¼ˆFully Connectedï¼‰ä¸CNNç»“æ„"></a>3.2.4 å…¨è¿æ¥å±‚ï¼ˆFully Connectedï¼‰ä¸CNNç»“æ„</h3><p>å…¨è¿æ¥å±‚å³æ­¤å‰æåˆ°çš„å¤šå±‚ç¥ç»ç½‘ç»œï¼Œæ¯ä¸ªç¥ç»å…ƒä¸ä¸Šä¸€å±‚çš„æ‰€æœ‰ç¥ç»å…ƒç›¸è¿ã€‚</p><p>å·ç§¯å±‚+æ¿€æ´»å±‚+æ± åŒ–å±‚å¯ä»¥çœ‹æˆæ˜¯CNNçš„ç‰¹å¾å­¦ä¹ /ç‰¹å¾æå–å±‚ï¼Œå­¦ä¹ åˆ°çš„ç‰¹å¾ï¼ˆFeature Mapï¼‰æœ€ç»ˆåº”ç”¨äºæ¨¡å‹ä»»åŠ¡ï¼ˆåˆ†ç±»ã€å›å½’ï¼‰</p><ul><li>å…ˆå¯¹æ‰€æœ‰Feature Mapè¿›è¡Œæ‰å¹³åŒ–ï¼ˆFlattenï¼‰ï¼Œå³è½¬åŒ–ä¸ºä¸€ç»´å‘é‡</li><li>å†è¿æ¥åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªå…¨è¿æ¥å±‚ï¼Œè¿›è¡Œåˆ†ç±»æˆ–å›å½’ä»»åŠ¡</li></ul><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/CNNç»“æ„2.png" alt="CNNç»“æ„2"></p><h2 id="3-3-ç»å…¸åˆ†ç±»ç½‘ç»œç»“æ„"><a href="#3-3-ç»å…¸åˆ†ç±»ç½‘ç»œç»“æ„" class="headerlink" title="3.3 ç»å…¸åˆ†ç±»ç½‘ç»œç»“æ„"></a>3.3 ç»å…¸åˆ†ç±»ç½‘ç»œç»“æ„</h2><p>é€šå¸¸é‡‡ç”¨ä»ç°æˆçš„ç»å…¸ç½‘ç»œç»“æ„è¿›è¡Œä¼˜åŒ–ï¼Œè€Œä¸æ˜¯ä»å¤´å¼€å§‹è®¾è®¡ç½‘ç»œç»“æ„ã€‚</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/ç»å…¸ç½‘ç»œç»“æ„.png" alt="ç»å…¸ç½‘ç»œç»“æ„"></p><ul><li>NINï¼šå¼•å…¥äº†1x1å·ç§¯æ ¸</li><li>VGGï¼šå‚æ•°é‡å·¨å¤§ï¼ˆ1.4äº¿ï¼‰ï¼Œ19å±‚ç½‘ç»œ</li><li>GoogleNetï¼š500ä¸‡å‚æ•°ï¼Œ22å±‚ç½‘ç»œ<ul><li>2014å¹´æ¯”èµ›å† å†›çš„modelï¼Œè¯æ˜äº†ç”¨æ›´å¤šçš„å·ç§¯ã€æ›´æ·±çš„å±‚æ¬¡å¯ä»¥å¾—åˆ°æ›´å¥½çš„ç»“æ„</li><li>å¼•å…¥äº†Inceptionæ¨¡å—ï¼Œå¤šä¸ªä¸åŒå¤§å°çš„å·ç§¯æ ¸</li></ul></li></ul><h3 id="3-3-1-LeNet-5"><a href="#3-3-1-LeNet-5" class="headerlink" title="3.3.1 LeNet-5"></a>3.3.1 LeNet-5</h3><h4 id="3-3-1-1-LeNet-5-ç½‘ç»œç»“æ„"><a href="#3-3-1-1-LeNet-5-ç½‘ç»œç»“æ„" class="headerlink" title="3.3.1.1 LeNet-5 ç½‘ç»œç»“æ„"></a>3.3.1.1 LeNet-5 ç½‘ç»œç»“æ„</h4><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/LeNet5.png" alt="LeNet-5"></p><p>LeNet-5æœ€åˆçš„ç›®çš„ç”¨äºæ‰‹å†™æ•°å­—è¯†åˆ«ï¼Œå½“æ—¶ä½¿ç”¨çš„æ¿€æ´»å‡½æ•°æ˜¯Sigmoidå’ŒTanhï¼Œè¿˜æ²¡æœ‰å‡ºç°Relu</p><h4 id="3-3-1-2-å‚æ•°å½¢çŠ¶"><a href="#3-3-1-2-å‚æ•°å½¢çŠ¶" class="headerlink" title="3.3.1.2 å‚æ•°å½¢çŠ¶"></a>3.3.1.2 å‚æ•°å½¢çŠ¶</h4><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">Shape</th><th style="text-align:center">Size</th><th style="text-align:center">Params</th></tr></thead><tbody><tr><td style="text-align:center">Input</td><td style="text-align:center">(32, 32, 1)</td><td style="text-align:center">1024</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">Conv1(f=5,s=1)</td><td style="text-align:center">(28, 28, 6)</td><td style="text-align:center">4704</td><td style="text-align:center">5x5ï¼ˆå·ç§¯æ ¸å¤§å°ï¼‰x3ï¼ˆé€šé“æ•°ï¼‰x6ï¼ˆå·ç§¯æ ¸æ•°é‡ï¼‰+6ï¼ˆåç½®ï¼‰=456</td></tr><tr><td style="text-align:center">Pool1</td><td style="text-align:center">(14, 14, 6)</td><td style="text-align:center">1176</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">Conv2(f=5,s=1)</td><td style="text-align:center">(10, 10, 16)</td><td style="text-align:center">1600</td><td style="text-align:center">5x5x6x16+16=2416</td></tr><tr><td style="text-align:center">Pool2</td><td style="text-align:center">(5, 5, 16)</td><td style="text-align:center">400</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">FC3</td><td style="text-align:center">(120, 1)</td><td style="text-align:center">120</td><td style="text-align:center">400x120+120=48120</td></tr><tr><td style="text-align:center">FC4</td><td style="text-align:center">(84, 1)</td><td style="text-align:center">84</td><td style="text-align:center">120x84+84=10164</td></tr><tr><td style="text-align:center">Output:Sofmax</td><td style="text-align:center">(10, 1)</td><td style="text-align:center">10</td><td style="text-align:center">84x10+10=850</td></tr></tbody></table></div><ul><li>ä¸­é—´ç‰¹å¾å€¼çš„å¤§å°å˜åŒ–ä¸å®œè¿‡å¤§ï¼Œå¦åˆ™ä¼šå¯¼è‡´ä¿¡æ¯ä¸¢å¤±</li></ul><h3 id="3-3-2-AlexNet"><a href="#3-3-2-AlexNet" class="headerlink" title="3.3.2 AlexNet"></a>3.3.2 AlexNet</h3><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/AlexNet.png" alt="AlexNet"></p><ul><li>æ€»å‚æ•°é‡ï¼š6000ä¸‡ï¼Œ8å±‚ç¥ç»ç½‘ç»œï¼Œ5ä¸ªå·ç§¯å±‚+3ä¸ªå…¨è¿æ¥å±‚</li><li>ä½¿ç”¨äº†éçº¿æ€§æ¿€æ´»å‡½æ•°ReLU</li><li>ä½¿ç”¨Dropouté˜²æ­¢è¿‡æ‹Ÿåˆï¼Œæ•°æ®æ‰©å……</li><li>ä½¿ç”¨æ‰¹æ ‡å‡†åŒ–ï¼ˆBatch Normalizationï¼‰åŠ é€Ÿè®­ç»ƒ</li></ul><h3 id="3-3-3-Inceptionç»“æ„"><a href="#3-3-3-Inceptionç»“æ„" class="headerlink" title="3.3.3 Inceptionç»“æ„"></a>3.3.3 Inceptionç»“æ„</h3><p>Inceptionç»“æ„æ˜¯GoogleNetä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œç”±å¤šä¸ªä¸åŒå¤§å°çš„å·ç§¯æ ¸ç»„æˆï¼Œå¯ä»¥æå–ä¸åŒå°ºåº¦çš„ç‰¹å¾ã€‚</p><h4 id="3-3-3-1-MLPå·ç§¯ï¼ˆ1x1å·ç§¯ï¼‰"><a href="#3-3-3-1-MLPå·ç§¯ï¼ˆ1x1å·ç§¯ï¼‰" class="headerlink" title="3.3.3.1 MLPå·ç§¯ï¼ˆ1x1å·ç§¯ï¼‰"></a>3.3.3.1 MLPå·ç§¯ï¼ˆ1x1å·ç§¯ï¼‰</h4><p>ä¸€ç§æ–°çš„æ·±åº¦ç½‘ç»œç»“æ„Network in Networkï¼ˆNINï¼‰æå‡ºäº†MLPå·ç§¯å–ä»£ä¼ ç»Ÿçº¿æ€§å·ç§¯æ ¸</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/MLPå·ç§¯.png" alt="MLPå·ç§¯"></p><ul><li>1x1å·ç§¯æ ¸å¯¹æ¯ä¸ªåƒç´ ç‚¹çš„æ‰€æœ‰é€šé“è¿›è¡Œäº†çº¿æ€§ç»„åˆ</li><li>æ¿€æ´»å‡½æ•°å°†feature mapç”±å¤šé€šé“çš„çº¿æ€§ç»„åˆå˜ä¸ºéçº¿æ€§ç»„åˆï¼ˆä¿¡æ¯æ•´åˆï¼‰</li><li>æé«˜ç‰¹å¾æŠ½è±¡èƒ½åŠ›ï¼ˆMultilayer Perceptronï¼Œç¼©å†™MLPï¼Œå°±æ˜¯ä¸€ä¸ªå¤šå±‚ç¥ç»ç½‘ç»œï¼‰</li><li>ä¸»è¦ä½œç”¨ï¼šè°ƒæ•´é€šé“æ•°ï¼ˆå‡ç»´é™ç»´ï¼‰ã€å‡å°‘å‚æ•°é‡</li></ul><h4 id="3-3-3-2-Inceptionå±‚"><a href="#3-3-3-2-Inceptionå±‚" class="headerlink" title="3.3.3.2 Inceptionå±‚"></a>3.3.3.2 Inceptionå±‚</h4><p>ä¹Ÿç§°ç›—æ¢¦ç©ºé—´ç»“æ„ï¼‰</p><p>ç›®çš„ï¼šä»£æ›¿äººå†³å®šï¼Œä½¿ç”¨å“ªç§å·ç§¯æ ¸ï¼Œæˆ–æ˜¯éœ€è¦MaxPoolå±‚ï¼Œç”±ç½‘ç»œè‡ªå·±å­¦ä¹ å¯»æ‰¾åˆé€‚çš„ç»“æ„ï¼ŒèŠ‚çœè®¡ç®—</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/Inceptionå±‚.png" alt="Inceptionå±‚"></p><p>æä¾›ä»¥ä¸‹4ç§ä¸åŒçš„å·ç§¯æ ¸ï¼š</p><ul><li>1x1å·ç§¯æ ¸ï¼ˆ64ä¸ªï¼‰</li><li>3x3å·ç§¯æ ¸ï¼ˆ128ä¸ªï¼‰ï¼Œpadding=same</li><li>5x5å·ç§¯æ ¸ï¼ˆ32ä¸ªï¼‰ï¼Œpadding=same</li><li>2x2æœ€å¤§æ± åŒ–ï¼ˆ32ä¸ªï¼‰ï¼Œstride=1ï¼Œpadding=same</li><li>æœ€ç»ˆç»“æœä¸ºè¿™4ç§å·ç§¯æ ¸çš„æ‹¼æ¥ï¼Œ27x27x256ï¼Œä½¿ç”¨æ›´å°‘çš„å‚æ•°è¾¾åˆ°å’ŒAlexNetç›¸å½“çš„æ•ˆæœ</li></ul><h4 id="3-3-3-3-Inceptionæ”¹è¿›"><a href="#3-3-3-3-Inceptionæ”¹è¿›" class="headerlink" title="3.3.3.3 Inceptionæ”¹è¿›"></a>3.3.3.3 Inceptionæ”¹è¿›</h4><p>ä¸Šä¸€èŠ‚ä¸­ï¼Œè®¡ç®—é‡è¿˜æ˜¯å¤ªå¤§ï¼Œå‚æ•°è¿˜æ˜¯å¤ªå¤šï¼Œéœ€è¦è¿›ä¸€æ­¥æ”¹è¿›ã€‚ä»¥5x5å·ç§¯æ ¸ä¸ºä¾‹ï¼š</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/Inceptionæ”¹è¿›.png" alt="Inceptionæ”¹è¿›"></p><ul><li>ä¸Šé¢ä¸ºåŸæ–¹æ³•ï¼Œå‚æ•°ï¼š$5\times5\times192\times32=153600$</li><li>ä¸‹é¢ä¸ºæ”¹è¿›æ–¹æ³•ï¼Œç½‘ç»œç¼©å°åå†æ‰©å¤§ï¼Œå‚æ•°ï¼š$1\times1\times192\times16+5\times5\times16\times32=15872$</li></ul><h4 id="3-3-3-4-GoogleNet"><a href="#3-3-3-4-GoogleNet" class="headerlink" title="3.3.3.4 GoogleNet"></a>3.3.3.4 GoogleNet</h4><p>Inceptionæ¨¡å—çš„å †å ï¼Œå½¢æˆGoogleNetç½‘ç»œç»“æ„</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/Inceptionæ¨¡å—.png" alt="Inceptionæ¨¡å—"></p><p>è¯¦ç»†ç»“æ„ç•¥</p><h2 id="3-4-å·ç§¯ç¥ç»ç½‘ç»œå®æˆ˜æŠ€å·§"><a href="#3-4-å·ç§¯ç¥ç»ç½‘ç»œå®æˆ˜æŠ€å·§" class="headerlink" title="3.4 å·ç§¯ç¥ç»ç½‘ç»œå®æˆ˜æŠ€å·§"></a>3.4 å·ç§¯ç¥ç»ç½‘ç»œå®æˆ˜æŠ€å·§</h2><h3 id="3-4-1-å­¦ä¹ ç‰¹å¾å¯è§†åŒ–"><a href="#3-4-1-å­¦ä¹ ç‰¹å¾å¯è§†åŒ–" class="headerlink" title="3.4.1 å­¦ä¹ ç‰¹å¾å¯è§†åŒ–"></a>3.4.1 å­¦ä¹ ç‰¹å¾å¯è§†åŒ–</h3><p>å¯ä»¥å°†ç½‘ç»œå­¦ä¹ è¿‡ç¨‹ä¸­äº§ç”Ÿçš„ç‰¹å¾å›¾å¯è§†åŒ–å‡ºæ¥ï¼Œå¹¶ä¸”å¯¹æ¯”åŸå›¾æ¥çœ‹çœ‹æ¯ä¸€å±‚éƒ½å¹²äº†ä»€ä¹ˆ</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/LeNet5ä¾‹.webp" alt="LeNet5ä¾‹"></p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/å­¦ä¹ ç‰¹å¾å¯è§†åŒ–.png" alt="å­¦ä¹ ç‰¹å¾å¯è§†åŒ–"></p><ul><li>Layer1,2ï¼šé¢œè‰²ã€è¾¹ç¼˜ç­‰åŸºæœ¬ç‰¹å¾</li><li>Layer3ï¼šçº¹ç†ã€å½¢çŠ¶ç­‰ä¸­çº§ç‰¹å¾</li><li>Layer4ï¼šç¨å¤æ‚çš„ç‰¹å¾ï¼Œå¦‚ç‹—çš„å¤´éƒ¨å½¢çŠ¶</li><li>Layer5ï¼šé«˜çº§ç‰¹å¾ï¼Œå¦‚å…³é”®æ€§åŒºåˆ†ç‰¹å¾</li></ul><h3 id="3-4-2-è¿ç§»å­¦ä¹ ï¼ˆTransfer-Learningï¼‰"><a href="#3-4-2-è¿ç§»å­¦ä¹ ï¼ˆTransfer-Learningï¼‰" class="headerlink" title="3.4.2 è¿ç§»å­¦ä¹ ï¼ˆTransfer Learningï¼‰"></a>3.4.2 è¿ç§»å­¦ä¹ ï¼ˆTransfer Learningï¼‰</h3><p>å¦‚æœéœ€è¦åšä¸€ä¸ªå…·ä½“åœºæ™¯çš„è®¡ç®—æœºè§†è§‰ä»»åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨å·²ç»è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œç„¶ååœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œå¾®è°ƒã€‚</p><h4 id="3-4-2-1-ä»‹ç»"><a href="#3-4-2-1-ä»‹ç»" class="headerlink" title="3.4.2.1 ä»‹ç»"></a>3.4.2.1 ä»‹ç»</h4><p>è¿ç§»å­¦ä¹ å°±æ˜¯åˆ©ç”¨æ•°æ®ã€ä»»åŠ¡æˆ–æ¨¡å‹ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼ˆä¾‹å¦‚éƒ½æ˜¯å›¾åƒåˆ†ç±»ä»»åŠ¡ï¼‰ï¼Œå°†åœ¨æ—§çš„é¢†åŸŸå­¦ä¹ è¿‡æˆ–è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œåº”ç”¨äºæ–°çš„é¢†åŸŸçš„è¿‡ç¨‹ã€‚</p><p>ä»ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢è€ƒè™‘è®­ç»ƒæ¨¡å‹çš„ç°å®é—®é¢˜ï¼š</p><ol><li>æ•°æ®é›†å¤§å°ï¼šå¦‚æœæ–°ä»»åŠ¡çš„æ•°æ®é›†å¾ˆå°ï¼Œè¿ç§»å­¦ä¹ å¯ä»¥å¸®åŠ©æé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›<ul><li>å¦‚æœæœ‰æµ·é‡çš„æ•°æ®é›†æ”¯æŒï¼Œå¯ä»¥ä¸éœ€è¦è¿ç§»å­¦ä¹ ï¼Œç›´æ¥ä»æµ·é‡æ•°æ®ä¸­è®­ç»ƒå‡ºä¸€ä¸ªå­¦ä¹ åˆ°ä¸€ä¸ªé²æ£’æ€§å¾ˆå¼ºçš„æ¨¡å‹</li><li>ä½†æ˜¯ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œéœ€è¦ç ”ç©¶çš„é¢†åŸŸæ•°æ®é›†éå¸¸æœ‰é™ï¼Œå¯¼è‡´æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›æå·®</li></ul></li><li>è®­ç»ƒæˆæœ¬ï¼šä»å¤´å¼€å§‹è®­ç»ƒä¸€ä¸ªCNNæ¨¡å‹éœ€è¦å¤§é‡çš„æ—¶é—´å’Œè®¡ç®—èµ„æº</li></ol><h4 id="3-4-2-2-å¾®è°ƒï¼ˆFine-tuningï¼‰"><a href="#3-4-2-2-å¾®è°ƒï¼ˆFine-tuningï¼‰" class="headerlink" title="3.4.2.2 å¾®è°ƒï¼ˆFine-tuningï¼‰"></a>3.4.2.2 å¾®è°ƒï¼ˆFine-tuningï¼‰</h4><p>åœ¨ä¸€ä¸ªå·²ç»è®­ç»ƒå¥½çš„æ¨¡å‹ï¼ˆPre-trained Modelï¼‰ä¸Šè¿›è¡Œé’ˆå¯¹æ€§ä¼˜åŒ–ï¼Œä»¥æå‡æ¨¡å‹åœ¨ç‰¹å®šä»»åŠ¡ä¸Šçš„æ€§èƒ½ã€‚</p><p>å‡è®¾æœ‰ä¸¤ä¸ªä»»åŠ¡$A$å’Œ$B$ã€‚<br>ä»»åŠ¡$A$æ‹¥æœ‰æµ·é‡æ•°æ®ï¼Œä»¥$a$ä¸ºæ¡ä»¶åŒºåˆ†1000ä¸ªç±»åˆ«ï¼Œå·²ç»è®­ç»ƒå¥½äº†ä¸€ä¸ªæ¨¡å‹ã€‚<br>ç›®æ ‡ä»»åŠ¡ä¸º$B$ï¼Œä»¥$b$ä¸ºæ¡ä»¶åŒºåˆ†250ä¸ªç±»åˆ«ï¼Œæ•°æ®é›†å¾ˆå°ã€‚</p><p>æ­¥éª¤ï¼š</p><ol><li>åœ¨$A$æ¨¡å‹çš„åŸºç¡€ä¸Šï¼Œå°†æœ€åä¸€å±‚çš„è¾“å‡ºå±‚æ›¿æ¢ä¸º250ä¸ªç±»åˆ«çš„è¾“å‡ºå±‚ï¼Œä¿æŒå‰é¢çš„å‚æ•°ä¸å˜</li><li>æ ¹æ®æ•°æ®é‡ï¼Œå†³å®šæ˜¯å¦å†»ç»“ï¼ˆFreezeï¼‰å‰é¢çš„å±‚ï¼ˆæƒé‡ä¸å˜ï¼‰ï¼Œåªè®­ç»ƒæœ€åè‹¥å¹²å±‚å¹¶æ›´æ–°å‚æ•°<ul><li>æ•°æ®è¶Šå¤šï¼Œå°±ä¿ç•™è¶Šå¤šçš„å±‚ï¼Œä»åå¾€å‰é€æ¸è§£å†»</li><li>æ•°æ®å¾ˆå°‘ï¼Œåªä¿ç•™è¾“å‡ºå±‚ï¼Œå…¶ä»–å±‚å…¨éƒ¨è§£å†»</li></ul></li><li>é‡æ–°è®­ç»ƒæ¨¡å‹</li></ol>]]></content>
    
    
    <summary type="html">åˆ©ç”¨å·ç§¯è¿ç®—å¤„ç†å›¾åƒæ•°æ®æå–ç‰¹å¾çš„ç½‘ç»œ</summary>
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>æ·±åº¦å­¦ä¹ ç¬”è®°2-ç¥ç»ç½‘ç»œä¼˜åŒ–</title>
    <link href="https://www.cclmsy.cc/posts/Deep_Learning02.html"/>
    <id>https://www.cclmsy.cc/posts/Deep_Learning02.html</id>
    <published>2025-02-21T10:00:00.000Z</published>
    <updated>2025-02-20T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="2-1-å¤šåˆ†ç±»ä¸Softmaxå›å½’"><a href="#2-1-å¤šåˆ†ç±»ä¸Softmaxå›å½’" class="headerlink" title="2.1 å¤šåˆ†ç±»ä¸Softmaxå›å½’"></a>2.1 å¤šåˆ†ç±»ä¸Softmaxå›å½’</h2><h3 id="2-1-1-Softmaxå›å½’"><a href="#2-1-1-Softmaxå›å½’" class="headerlink" title="2.1.1 Softmaxå›å½’"></a>2.1.1 Softmaxå›å½’</h3><p>å¯¹äºå¤šåˆ†ç±»é—®é¢˜ï¼Œç§ç±»ä¸ªæ•°Cï¼Œåˆ™è¾“å‡ºå±‚çš„ç¥ç»å…ƒä¸ªæ•°å¿…é¡»ä¸ºCï¼Œæ¯ä¸ªç¥ç»å…ƒçš„è¾“å‡ºä¾æ¬¡å¯¹åº”ä¸ºæ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ã€‚</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/å¤šåˆ†ç±»é—®é¢˜.png" alt="å¤šåˆ†ç±»é—®é¢˜"></p><p>è¾“å‡ºå±‚ï¼š$Z^{[L]}=W^{[L]}A^{[L-1]}+b^{[L]}$$</p><p>Softmaxå…¬å¼ï¼š$a<em>i^{[L]} = \dfrac{e^{Z_i^{[L]}}}{\sum\limits</em>{j=1}^{C}e^{Z<em>j^{[L]}}}$ï¼Œæ»¡è¶³$\sum\limits</em>{i=1}^{C}a_i^{[L]}=1$</p><p>ç†è§£ï¼š$e^{z_i}$çš„å æ¯”</p><h3 id="2-1-2-äº¤å‰ç†µæŸå¤±ä¸One-hotç¼–ç "><a href="#2-1-2-äº¤å‰ç†µæŸå¤±ä¸One-hotç¼–ç " class="headerlink" title="2.1.2 äº¤å‰ç†µæŸå¤±ä¸One-hotç¼–ç "></a>2.1.2 äº¤å‰ç†µæŸå¤±ä¸One-hotç¼–ç </h3><p>å¯¹äºSoftmaxå›å½’ï¼Œä½¿ç”¨äº¤å‰ç†µæŸå¤±ï¼ˆCross Entropy Lossï¼‰å‡½æ•°ï¼š</p><script type="math/tex; mode=display">L(\hat{y},y)=-\sum\limits_{i=1}^{C}y_i\log(\hat{y}_i)</script><p>$C=2$æ—¶ï¼Œå³å¯¹åº”é€»è¾‘å›å½’çš„å¯¹æ•°æŸå¤±å‡½æ•°$L(\hat{y},y)=-(y\log(\hat{y})+(1-y)\log(1-\hat{y}))$</p><p>one-hotç¼–ç ï¼ˆç‹¬çƒ­ç¼–ç ï¼‰ï¼šå°†æ ‡ç­¾è½¬æ¢ä¸ºå‘é‡ï¼Œåªæœ‰ä¸€ä¸ªå…ƒç´ ä¸º1ï¼Œå…¶ä»–å…ƒç´ ä¸º0ã€‚</p><p>ä»¥å›¾2.1.1ä¸ºä¾‹ï¼Œ$y=7$ï¼Œåˆ™one-hotç¼–ç å¯¹åº”ä¸º$y=[0,0,0,0,0,0,0,1,0,0]$ã€‚</p><p>ç”±äºé™¤äº†æ­£ç¡®ç±»åˆ«å¤–ï¼Œå…¶ä»–ç±»åˆ«$y_i=0$ï¼Œå› æ­¤å¯ä»¥ç®€å•è®¡ç®—äº¤å‰ç†µï¼š$L(\hat{y},y)=-1\times\log(0.10)$</p><p>è¿™ä¸€é¡¹çš„é¢„æµ‹å€¼è¶Šæ¥è¿‘1ï¼Œäº¤å‰ç†µè¶Šæ¥è¿‘0ï¼Œæ¨¡å‹æ•ˆæœè¶Šå¥½</p><h2 id="2-2-æ¢¯åº¦ä¸‹é™ç®—æ³•æ”¹è¿›"><a href="#2-2-æ¢¯åº¦ä¸‹é™ç®—æ³•æ”¹è¿›" class="headerlink" title="2.2 æ¢¯åº¦ä¸‹é™ç®—æ³•æ”¹è¿›"></a>2.2 æ¢¯åº¦ä¸‹é™ç®—æ³•æ”¹è¿›</h2><p>æ·±åº¦å­¦ä¹ åœ¨å¤§è§„æ¨¡æ•°æ®é›†ä¸Šçš„è®­ç»ƒé€Ÿåº¦å¾ˆæ…¢ï¼Œéš¾ä»¥åœ¨å¤§æ•°æ®é¢†åŸŸå‘æŒ¥æœ€å¤§æ•ˆæœã€‚</p><p>ä¼˜åŒ–ç®—æ³•èƒ½å¤ŸåŠ é€Ÿè®­ç»ƒæ¨¡å‹ï¼Œæé«˜è®¡ç®—æ•ˆç‡ã€‚</p><h3 id="2-2-1-æ¢¯åº¦ä¸‹é™é‡åˆ°çš„é—®é¢˜"><a href="#2-2-1-æ¢¯åº¦ä¸‹é™é‡åˆ°çš„é—®é¢˜" class="headerlink" title="2.2.1 æ¢¯åº¦ä¸‹é™é‡åˆ°çš„é—®é¢˜"></a>2.2.1 æ¢¯åº¦ä¸‹é™é‡åˆ°çš„é—®é¢˜</h3><p>æ¢¯åº¦æ¶ˆå¤±ä¸æ¢¯åº¦çˆ†ç‚¸ï¼šç”±äºé“¾å¼æ³•åˆ™æ˜¯ä¸€ä¸ªè¿ä¹˜çš„è¿‡ç¨‹ï¼Œå½“å±‚æ•°è¶Šæ·±æ—¶ï¼Œæ¢¯åº¦ä»¥æŒ‡æ•°é€Ÿåº¦å¢é•¿ä¼ æ’­ã€‚</p><ul><li>æ¢¯åº¦æ¶ˆå¤±ï¼šæ¢¯åº¦å°äº1ï¼Œå¤šæ¬¡è¿ä¹˜åï¼Œæ¢¯åº¦è¶‹è¿‘äº0ï¼Œå¯¼è‡´å‚æ•°å‡ ä¹ä¸æ›´æ–°ã€æ¨¡å‹éš¾æ”¶æ•›</li><li>æ¢¯åº¦çˆ†ç‚¸ï¼šæ¢¯åº¦å¤§äº1ï¼Œå¤šæ¬¡è¿ä¹˜åï¼Œæ¢¯åº¦è¶‹è¿‘äºæ— ç©·ï¼Œå¯¼è‡´å‚æ•°æ›´æ–°è¿‡å¤§ç”šè‡³æº¢å‡º</li></ul><p>å±€éƒ¨æœ€ä¼˜è§£ï¼šæŸå¤±å‡½æ•°å¯èƒ½å­˜åœ¨éç‚¹/å±€éƒ¨æœ€å°å€¼</p><ul><li>è¾ƒå¤§çš„ç¥ç»ç½‘ç»œï¼Œå±€éƒ¨æœ€ä¼˜è§£çš„å¯èƒ½æ€§è¾ƒå°</li><li>éç‚¹é™„è¿‘çš„å¹³ç¨³æ®µä¼šä½¿å¾—å­¦ä¹ éå¸¸ç¼“æ…¢ï¼Œéœ€è¦ä¼˜åŒ–ç®—æ³•åŠ é€Ÿå­¦ä¹ </li></ul><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/å±€éƒ¨æœ€ä¼˜è§£.gif" alt="å±€éƒ¨æœ€ä¼˜è§£"></p><p>è§£å†³æ–¹æ³•ï¼š</p><ol><li>åˆå§‹åŒ–å‚æ•°ç­–ç•¥ï¼šæ¯”å¦‚åœ¨<a href="#144-å‚æ•°å’Œè¶…å‚æ•°">1.4.4</a>ä¸­æåˆ°çš„å°†æƒé‡åˆå§‹åŒ–ä¸ºè¾ƒå°çš„éšæœºæ•°</li><li>æ‰¹æ¢¯åº¦ä¸‹é™ã€Mini-batchæ¢¯åº¦ä¸‹é™ã€éšæœºæ¢¯åº¦ä¸‹é™</li><li>æ¢¯åº¦ä¸‹é™ç®—æ³•å†…éƒ¨ä¼˜åŒ–ï¼šåŠ¨é‡æ¢¯åº¦ä¸‹é™ã€RMSPropç®—æ³•ã€Adamç®—æ³•</li><li>å­¦ä¹ ç‡è¡°å‡</li><li>éç®—æ³•ä¼˜åŒ–ï¼šæ ‡å‡†åŒ–è¾“å…¥</li></ol><h3 id="2-2-2-æ‰¹æ¢¯åº¦ä¸‹é™ã€Mini-batchæ¢¯åº¦ä¸‹é™ã€éšæœºæ¢¯åº¦ä¸‹é™"><a href="#2-2-2-æ‰¹æ¢¯åº¦ä¸‹é™ã€Mini-batchæ¢¯åº¦ä¸‹é™ã€éšæœºæ¢¯åº¦ä¸‹é™" class="headerlink" title="2.2.2 æ‰¹æ¢¯åº¦ä¸‹é™ã€Mini-batchæ¢¯åº¦ä¸‹é™ã€éšæœºæ¢¯åº¦ä¸‹é™"></a>2.2.2 æ‰¹æ¢¯åº¦ä¸‹é™ã€Mini-batchæ¢¯åº¦ä¸‹é™ã€éšæœºæ¢¯åº¦ä¸‹é™</h3><p>æ‰¹æ¢¯åº¦ä¸‹é™ï¼ˆBatch Gradient Descentï¼‰ï¼šåŒæ—¶å¤„ç†æ•´ä¸ªè®­ç»ƒé›†</p><ul><li>åœ¨æ›´æ–°å‚æ•°å‰ï¼Œå¿…é¡»å…ˆå¤„ç†æ•´ä¸ªè®­ç»ƒå‚æ•°é›†ï¼Œæ‰èƒ½è¿›è¡Œä¸€æ­¥æ¢¯åº¦ä¸‹é™</li><li>å¦‚æœè®­ç»ƒé›†å¾ˆå¤§ï¼Œè®¡ç®—é‡ä¼šå¾ˆå¤§ï¼Œè®­ç»ƒé€Ÿåº¦å¾ˆæ…¢</li><li>å™ªå£°ä½ï¼Œä»£ä»·å‡½æ•°å€¼å¹³æ»‘å‡å°</li><li>è®­ç»ƒæ ·æœ¬çš„å¤§å°è¾ƒå°ï¼ˆå°äº2048ï¼‰æ—¶ï¼Œé€‰æ‹©Batchæ¢¯åº¦ä¸‹é™</li></ul><p>Mini-batchæ¢¯åº¦ä¸‹é™ï¼šå°†è®­ç»ƒé›†åˆ†ä¸ºå¤šä¸ªå›ºå®šå¤§å°çš„æ‰¹æ¬¡ï¼Œæ¯æ¬¡åªå¤„ç†ä¸€ä¸ªæ‰¹æ¬¡çš„æ•°æ®</p><ul><li>è®­ç»ƒæ ·æœ¬çš„å¤§å°è¾ƒå¤§æ—¶ï¼Œé€‰æ‹©Mini-batchæ¢¯åº¦ä¸‹é™ï¼Œé€šå¸¸ä¸º64ã€128ã€256ã€512ç­‰</li></ul><p>éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆStochastic Gradient Descent, SGDï¼‰ï¼šmini-batchå¤§å°ä¸º1ï¼Œæ¯æ¬¡åªå¤„ç†ä¸€ä¸ªæ ·æœ¬</p><ul><li>è®­ç»ƒé€Ÿåº¦å¿«ï¼Œä½†ä¸¢å¤±äº†å‘é‡åŒ–ç¼–ç¨‹çš„ä¼˜åŠ¿</li><li>ä»£ä»·å‡½æ•°å€¼æ³¢åŠ¨å¤§ï¼Œå™ªå£°å¤§ï¼Œæ€»ä½“å‘å…¨å±€æœ€å°å€¼é è¿‘ï¼Œä½†éš¾ä»¥æ”¶æ•›ï¼Œå®¹æ˜“åœ¨éç‚¹éœ‡è¡</li></ul><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/æ¢¯åº¦ä¸‹é™ä»£ä»·å‡½æ•°å€¼å˜åŒ–è¶‹åŠ¿.png" alt="æ¢¯åº¦ä¸‹é™ä»£ä»·å‡½æ•°å€¼å˜åŒ–è¶‹åŠ¿"></p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/æ¢¯åº¦ä¸‹é™ä»£ä»·å‡½æ•°å€¼å˜åŒ–è¶‹åŠ¿2.png" alt="æ¢¯åº¦ä¸‹é™ä»£ä»·å‡½æ•°å€¼å˜åŒ–è¶‹åŠ¿2"></p><h3 id="2-2-3-æŒ‡æ•°åŠ æƒå¹³å‡"><a href="#2-2-3-æŒ‡æ•°åŠ æƒå¹³å‡" class="headerlink" title="2.2.3 æŒ‡æ•°åŠ æƒå¹³å‡"></a>2.2.3 æŒ‡æ•°åŠ æƒå¹³å‡</h3><p>æŒ‡æ•°åŠ æƒå¹³å‡ï¼ˆExponentially Weight Averageï¼‰æ˜¯ä¸€ç§å¸¸ç”¨çš„åºåˆ—æ•°æ®å¤„ç†æ–¹å¼ï¼Œé€šå¸¸ç”¨åœ¨åºåˆ—åœºæ™¯ï¼Œå¦‚é‡‘èåºåˆ—åˆ†æã€æ¸©åº¦å˜åŒ–åºåˆ—åˆ†æã€‚</p><script type="math/tex; mode=display">S_t = \begin{cases}x_t &, t=1 \\\\ \beta S_{t-1}+(1-\beta)x_t &, t>1\end{cases}</script><p>ç†è§£ï¼šä¸Šä¸€ç»“æœçš„æƒé‡ä¸º$\beta$ï¼Œå½“å‰æ•°æ®çš„æƒé‡ä¸º$1-\beta$ã€‚</p><p>ä¸‹å›¾ï¼Œé»„è‰²$\beta=0.5$ï¼Œçº¢è‰²$\beta=0.9$ï¼Œç»¿è‰²$\beta=0.98$</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/æŒ‡æ•°åŠ æƒå¹³å‡.png" alt="æŒ‡æ•°åŠ æƒå¹³å‡"></p><h3 id="2-2-4-åŠ¨é‡æ¢¯åº¦ä¸‹é™"><a href="#2-2-4-åŠ¨é‡æ¢¯åº¦ä¸‹é™" class="headerlink" title="2.2.4 åŠ¨é‡æ¢¯åº¦ä¸‹é™"></a>2.2.4 åŠ¨é‡æ¢¯åº¦ä¸‹é™</h3><p>åŠ¨é‡æ¢¯åº¦ä¸‹é™ï¼ˆMomentum Gradient Descentï¼‰ï¼šåˆ©ç”¨æ¢¯åº¦çš„æŒ‡æ•°åŠ æƒå¹³å‡æ¥æ›´æ–°å‚æ•°</p><script type="math/tex; mode=display">\begin{split}&S_{dW} = \beta S_{dW}+(1-\beta)dW \\\\ &S_{db} = \beta S_{db}+(1-\beta)db \\\\ &W = W-\alpha S_{dW} \\\\ &b = b-\alpha S_{db}\end{split}</script><p>åˆ©ç”¨ç´¯åŠ çš„æ¢¯åº¦å€¼ï¼Œå‡å°‘æ¢¯åº¦ä¸‹é™çš„éœ‡è¡ï¼ŒåŠ é€Ÿæ”¶æ•›</p><ul><li>å‰åæ¢¯åº¦æ–¹å‘ä¸ä¸€è‡´æ—¶ï¼Œæ¢¯åº¦å€¼å‡å°ï¼Œå‡å°‘éœ‡è¡</li><li>å‰åæ¢¯åº¦æ–¹å‘ä¸€è‡´æ—¶ï¼Œæ¢¯åº¦å€¼å¢å¤§ï¼ŒåŠ é€Ÿæ”¶æ•›</li></ul><h3 id="2-2-5-RMSPropç®—æ³•"><a href="#2-2-5-RMSPropç®—æ³•" class="headerlink" title="2.2.5 RMSPropç®—æ³•"></a>2.2.5 RMSPropç®—æ³•</h3><p>RMSPropç®—æ³•ï¼ˆRoot Mean Square Propagationï¼‰ï¼šå†å¯¹æ¢¯åº¦è¿›è¡ŒæŒ‡æ•°åŠ æƒå¹³å‡çš„åŸºç¡€ä¸Šï¼Œå¼•å…¥å¹³æ–¹å’Œå¹³æ–¹æ ¹</p><script type="math/tex; mode=display">\begin{split}&S_{dW} = \beta S_{dW}+(1-\beta)dW^2 \\\\ &S_{db} = \beta S_{db}+(1-\beta)db^2 \\\\ &W = W-\alpha \dfrac{dW}{\sqrt{S_{dW}+\epsilon}} \\\\ &b = b-\alpha \dfrac{db}{\sqrt{S_{db}+\epsilon}}\end{split}</script><p>å…¶ä¸­ï¼Œ$\epsilon$æ˜¯ä¸€ä¸ªå¾ˆå°çš„æ•°ï¼Œé¿å…åˆ†æ¯è¿‡å°å¯¼è‡´æ•°å€¼ä¸ç¨³å®šã€‚</p><p>RMSProp æœ‰åŠ©äºå‡å°‘æŠµè¾¾æœ€å°å€¼è·¯å¾„ä¸Šçš„æ‘†åŠ¨ï¼Œå¹¶å…è®¸ä½¿ç”¨ä¸€ä¸ªæ›´å¤§çš„å­¦ä¹ ç‡$\alpha$ï¼ŒåŠ å¿«ç®—æ³•å­¦ä¹ é€Ÿåº¦ã€‚</p><h3 id="2-2-6-Adamç®—æ³•"><a href="#2-2-6-Adamç®—æ³•" class="headerlink" title="2.2.6 Adamç®—æ³•"></a>2.2.6 Adamç®—æ³•</h3><p>Adamç®—æ³•ï¼ˆAdaptive Moment Estimationï¼Œè‡ªé€‚åº”çŸ©ä¼°è®¡ï¼‰ï¼šç»“åˆäº†Momentumå’ŒRMSPropç®—æ³•ï¼ŒåŒæ—¶è€ƒè™‘æ¢¯åº¦çš„ä¸€é˜¶çŸ©ä¼°è®¡å’ŒäºŒé˜¶çŸ©ä¼°è®¡</p><p>å‡è®¾ç”¨ä¸€ä¸ªmini-batchè®¡ç®—$dW$å’Œ$db$ï¼Œç¬¬$t$æ¬¡è¿­ä»£æ—¶ï¼Œè®¡ç®—åŠ¨é‡æ¢¯åº¦ç»“æœï¼š</p><script type="math/tex; mode=display">\begin{split}&V_{dW} = \beta_1 V_{dW}+(1-\beta_1)dW \\\\ &V_{db} = \beta_1 V_{db}+(1-\beta_1)db \\\\ &V_{dW}^{corrected} = \dfrac{V_{dW}}{1-\beta_1^t} \end{split}</script><p>è®¡ç®—RMSPropç»“æœï¼š</p><script type="math/tex; mode=display">\begin{split}&S_{dW} = \beta_2 S_{dW}+(1-\beta_2)dW^2 \\\\ &S_{db} = \beta_2 S_{db}+(1-\beta_2)db^2 \\\\ &S_{dW}^{corrected} = \dfrac{S_{dW}}{1-\beta_2^t}\end{split}</script><p>è®¡ç®—ç§»åŠ¨å¹³å‡æ•°æ—¶ï¼Œä½¿ç”¨ç³»æ•°$\dfrac{1}{1-\beta_1^t}$è¿›è¡Œä¿®æ­£ã€‚<br>ä¾‹å¦‚$m_0=0,m_1=0.9m_0+0.1m_1$ï¼Œå¯¼è‡´$m_1$çš„å€¼è¿‡å°ï¼Œä¿®æ­£åæ°å¥½ä¸º$m_1$çš„å€¼ã€‚<br>éšç€è¿­ä»£æ¬¡æ•°å¢åŠ ï¼Œä¿®æ­£ç³»æ•°è¶‹è¿‘äº1ï¼Œä¿è¯äº†ç§»åŠ¨å¹³å‡æ•°çš„å‡†ç¡®æ€§ã€‚</p><p>Adamç®—æ³•æ›´æ–°å‚æ•°ï¼š</p><script type="math/tex; mode=display">\begin{split}&W = W-\alpha \dfrac{V_{dW}^{corrected}}{\sqrt{S_{dW}^{corrected}}+\epsilon} \\\\ &b = b-\alpha \dfrac{V_{db}^{corrected}}{\sqrt{S_{db}^{corrected}}+\epsilon}\end{split}</script><h3 id="2-2-7-å­¦ä¹ ç‡è¡°å‡"><a href="#2-2-7-å­¦ä¹ ç‡è¡°å‡" class="headerlink" title="2.2.7 å­¦ä¹ ç‡è¡°å‡"></a>2.2.7 å­¦ä¹ ç‡è¡°å‡</h3><p>å¦‚æœéšç€æ—¶é—´æ…¢æ…¢å‡å°‘å­¦ä¹ ç‡$\alpha$çš„å¤§å°ï¼Œåœ¨åˆæœŸ$\alpha$è¾ƒå¤§æ—¶ï¼Œä¸‹é™çš„æ­¥é•¿è¾ƒå¤§ï¼Œèƒ½ä»¥è¾ƒå¿«çš„é€Ÿåº¦è¿›è¡Œæ¢¯åº¦ä¸‹é™ï¼›è€ŒåæœŸé€æ­¥å‡å°$\alpha$çš„å€¼ï¼Œå³å‡å°æ­¥é•¿ï¼Œæœ‰åŠ©äºç®—æ³•çš„æ”¶æ•›ï¼Œæ›´å®¹æ˜“æ¥è¿‘æœ€ä¼˜è§£ã€‚</p><p>æœ€å¸¸ç”¨çš„å­¦ä¹ ç‡è¡°å‡æ–¹æ³•ï¼š$\alpha = \dfrac{1}{1+decay_ rate \times epoch_ num} \times \alpha_0$</p><ul><li>$\alpha_0$ï¼šåˆå§‹å­¦ä¹ ç‡</li><li>$decay_ rate$ï¼šè¡°å‡ç‡ï¼Œè¶…å‚æ•°</li><li>$epoch_ num$ï¼šè¿­ä»£æ¬¡æ•°</li></ul><p>ä¸€ç§æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡ï¼š$\alpha = 0.95^{epoch_ num} \times \alpha_0$</p><h3 id="2-2-8-éç®—æ³•ä¼˜åŒ–ï¼šæ ‡å‡†åŒ–è¾“å…¥"><a href="#2-2-8-éç®—æ³•ä¼˜åŒ–ï¼šæ ‡å‡†åŒ–è¾“å…¥" class="headerlink" title="2.2.8 éç®—æ³•ä¼˜åŒ–ï¼šæ ‡å‡†åŒ–è¾“å…¥"></a>2.2.8 éç®—æ³•ä¼˜åŒ–ï¼šæ ‡å‡†åŒ–è¾“å…¥</h3><p>å¯¹äºè¾“å…¥æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ï¼Œèƒ½å¤Ÿç¼“è§£æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸é—®é¢˜ï¼Œå¹¶ä¸”åŠ é€Ÿç®—æ³•çš„æ”¶æ•›ã€‚</p><ul><li>æ ‡å‡†åŒ–å…¬å¼ï¼š$X = \dfrac{X-\mu}{\sigma}$ï¼Œå…¶ä¸­$\mu$ä¸ºå‡å€¼ï¼Œ$\sigma$ä¸ºæ ‡å‡†å·®</li></ul><h2 id="2-3-æ·±åº¦å­¦ä¹ æ­£åˆ™åŒ–"><a href="#2-3-æ·±åº¦å­¦ä¹ æ­£åˆ™åŒ–" class="headerlink" title="2.3 æ·±åº¦å­¦ä¹ æ­£åˆ™åŒ–"></a>2.3 æ·±åº¦å­¦ä¹ æ­£åˆ™åŒ–</h2><p><strong>æ­£åˆ™åŒ–ï¼ˆRegularizationï¼‰</strong>ï¼šåœ¨æˆæœ¬å‡½æ•°ä¸­åŠ å…¥ä¸€ä¸ªæ­£åˆ™åŒ–é¡¹ï¼ˆæƒ©ç½šé¡¹ï¼‰ï¼Œæƒ©ç½šæ¨¡å‹çš„å¤æ‚åº¦ï¼Œé˜²æ­¢ç½‘ç»œè¿‡æ‹Ÿåˆ</p><h3 id="2-3-1-æ•°æ®é›†åˆ’åˆ†"><a href="#2-3-1-æ•°æ®é›†åˆ’åˆ†" class="headerlink" title="2.3.1 æ•°æ®é›†åˆ’åˆ†"></a>2.3.1 æ•°æ®é›†åˆ’åˆ†</h3><ul><li>è®­ç»ƒé›†ï¼ˆTraining Setï¼‰ï¼šç”¨äºæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹</li><li>éªŒè¯é›†ï¼ˆValidation Setï¼‰ï¼šåˆ©ç”¨éªŒè¯é›†ï¼ˆåˆç§°ä¸ºç®€å•äº¤å‰éªŒè¯é›†ï¼Œhold-out cross validation setï¼‰è¿›è¡Œäº¤å‰éªŒè¯ï¼Œé€‰æ‹©å‡ºæœ€å¥½çš„æ¨¡å‹</li><li>æµ‹è¯•é›†ï¼ˆTest Setï¼‰ï¼šç”¨äºè¯„ä¼°æ¨¡å‹çš„èƒ½åŠ›</li><li>å°æ•°æ®é‡ï¼ˆå°äº10ä¸‡ï¼‰æ¯”ä¾‹ï¼šæ— éªŒè¯é›†7:3ï¼Œæœ‰éªŒè¯é›†6:2:2</li><li>å¤§æ•°æ®é‡æ¯”ä¾‹ï¼š98:1:1ã€99.5:0.25:0.25</li></ul><h3 id="2-3-2-åå·®å’Œæ–¹å·®"><a href="#2-3-2-åå·®å’Œæ–¹å·®" class="headerlink" title="2.3.2 åå·®å’Œæ–¹å·®"></a>2.3.2 åå·®å’Œæ–¹å·®</h3><p>â€œåå·®-æ–¹å·®åˆ†è§£â€ï¼ˆbias-variance decompositionï¼‰æ˜¯è§£é‡Šå­¦ä¹ ç®—æ³•æ³›åŒ–æ€§èƒ½çš„ä¸€ç§é‡è¦å·¥å…·ã€‚</p><p>æ³›åŒ–è¯¯å·®å¯åˆ†è§£ä¸ºåå·®ã€æ–¹å·®ä¸å™ªå£°ï¼Œæ³›åŒ–æ€§èƒ½æ˜¯ç”±å­¦ä¹ ç®—æ³•çš„èƒ½åŠ›ã€æ•°æ®çš„å……åˆ†æ€§ä»¥åŠå­¦ä¹ ä»»åŠ¡æœ¬èº«çš„éš¾åº¦æ‰€å…±åŒå†³å®šçš„ã€‚</p><ul><li>åå·®ï¼šåº¦é‡å­¦ä¹ ç®—æ³•çš„æœŸæœ›é¢„æµ‹ä¸çœŸå®ç»“æœçš„åç¦»ç¨‹åº¦ï¼Œåæ˜ äº†<strong>æ¨¡å‹æœ¬èº«çš„æ‹Ÿåˆèƒ½åŠ›</strong></li><li>æ–¹å·®ï¼šåº¦é‡åŒæ ·å¤§å°çš„è®­ç»ƒé›†çš„å˜åŠ¨æ‰€å¯¼è‡´çš„å­¦ä¹ æ€§èƒ½çš„å˜åŒ–ï¼Œåæ˜ äº†<strong>æ¨¡å‹çš„ç¨³å®šæ€§</strong></li><li>å™ªå£°ï¼šå½“å‰ä»»åŠ¡ä¸‹ä»»ä½•å­¦ä¹ ç®—æ³•æ‰€èƒ½è¾¾åˆ°çš„æœŸæœ›æ³›åŒ–è¯¯å·®çš„ä¸‹ç•Œï¼Œåæ˜ äº†<strong>é—®é¢˜æœ¬èº«çš„éš¾åº¦</strong></li></ul><p>åå·®ã€æ–¹å·®ä¸æ•°æ®é›†åˆ’åˆ†çš„å…³ç³»åŠè§£å†³æ–¹æ³•ï¼š</p><ol><li>è®­ç»ƒé›†é”™è¯¯ç‡å°ã€æµ‹è¯•é›†é”™è¯¯ç‡å¤§ï¼šé«˜æ–¹å·®ï¼Œå¯èƒ½å‡ºç°äº†è¿‡æ‹Ÿåˆ<ul><li>å¢å¤§æ•°æ®é›†ï¼Œä½¿è®­ç»ƒå°½å¯èƒ½åŒ…å«æ‰€æœ‰æƒ…å†µ</li><li>å¯»æ‰¾æ›´åˆé€‚çš„ç½‘ç»œç»“æ„</li><li>æ­£åˆ™åŒ–</li></ul></li><li>è®­ç»ƒé›†é”™è¯¯ç‡å¤§ã€æµ‹è¯•é›†é”™è¯¯ç‡å¤§ï¼šé«˜åå·®ï¼Œå¯èƒ½å‡ºç°äº†æ¬ æ‹Ÿåˆ<ul><li>æ‰©å¤§ç½‘ç»œè§„æ¨¡ï¼Œä¾‹å¦‚å¢åŠ éšè—å±‚æˆ–ç¥ç»å…ƒæ•°é‡</li><li>å¯»æ‰¾æ›´åˆé€‚çš„ç½‘ç»œç»“æ„ï¼Œä½¿ç”¨æ›´å¤§çš„ç½‘ç»œï¼ˆå¦‚AlexNetï¼‰</li><li>å¢åŠ è®­ç»ƒæ—¶é—´ã€è¿­ä»£æ¬¡æ•°</li></ul></li><li>è®­ç»ƒé›†é”™è¯¯ç‡å°ã€æµ‹è¯•é›†é”™è¯¯ç‡å°ï¼šæ–¹å·®å’Œåå·®éƒ½å°ï¼Œæ¨¡å‹æ•ˆæœè¾ƒå¥½</li></ol><h3 id="2-3-3-é€»è¾‘å›å½’çš„L1å’ŒL2æ­£åˆ™åŒ–"><a href="#2-3-3-é€»è¾‘å›å½’çš„L1å’ŒL2æ­£åˆ™åŒ–" class="headerlink" title="2.3.3 é€»è¾‘å›å½’çš„L1å’ŒL2æ­£åˆ™åŒ–"></a>2.3.3 é€»è¾‘å›å½’çš„L1å’ŒL2æ­£åˆ™åŒ–</h3><p>é€»è¾‘å›å½’ä¸­ï¼Œå‚æ•°$W$çš„æ•°é‡ç”±ç‰¹å¾æ•°å†³å®šï¼Œæ­£åˆ™åŒ–å¦‚ä¸‹ï¼š</p><ul><li>L1æ­£åˆ™åŒ–ï¼š$J(W,b) = \dfrac{1}{m}\sum\limits_{i=1}^{m}L(\hat{y}^{(i)},y^{(i)})+\dfrac{\lambda}{2m}||W||_1$</li><li>L2æ­£åˆ™åŒ–ï¼š$J(W,b) = \dfrac{1}{m}\sum\limits_{i=1}^{m}L(\hat{y}^{(i)},y^{(i)})+\dfrac{\lambda}{2m}||W||_2^2$<ul><li>L2èŒƒæ•°ï¼š$\dfrac{\lambda}{2m}||W||<em>2^2 = \dfrac{\lambda}{2m}\sum\limits</em>{i=1}^{n}W_i^2=\dfrac{\lambda}{2m}W^TW$</li><li>è§£é‡Šï¼šæ‰€æœ‰Wå‚æ•°çš„å¹³æ–¹å’Œ</li></ul></li></ul><p>æ­£åˆ™åŒ–å› å­$\lambda$ï¼šè¶…å‚æ•°ï¼Œæ§åˆ¶æ­£åˆ™åŒ–é¡¹çš„æƒé‡ï¼Œ$\lambda$è¶Šå¤§ï¼Œæ­£åˆ™åŒ–é¡¹çš„å½±å“è¶Šå¤§ï¼Œæ¨¡å‹è¶Šç®€å•ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</p><p>L1æ­£åˆ™åŒ–åï¼Œ$W$çš„æŸäº›å‚æ•°ä¼šå˜ä¸º0ï¼Œä½¿æ¨¡å‹å˜ç¨€ç–ï¼Œå› æ­¤L2æ­£åˆ™åŒ–æ›´å¸¸ç”¨ã€‚</p><p>æ¢¯åº¦ä¸‹é™çš„ç›®çš„æ˜¯å‡å°æŸå¤±å‡½æ•°$J(W,b)$å€¼çš„å¤§å°ã€‚<br>åœ¨æŸå¤±å‡½æ•°ä¸­å¢åŠ äº†ä¸€é¡¹ï¼Œå¯¼è‡´$dW$å¢å¤§ï¼Œ$W$å‡å°çš„æ›´å¤šï¼ˆå¤šå‡å»ä¸€é¡¹ï¼‰ï¼Œå› æ­¤L2èŒƒæ•°ä¹Ÿç§°ä¸ºæƒé‡è¡°å‡ï¼ˆWeight Decayï¼‰ã€‚</p><h3 id="2-3-4-ç¥ç»ç½‘ç»œä¸­çš„L2æ­£åˆ™åŒ–"><a href="#2-3-4-ç¥ç»ç½‘ç»œä¸­çš„L2æ­£åˆ™åŒ–" class="headerlink" title="2.3.4 ç¥ç»ç½‘ç»œä¸­çš„L2æ­£åˆ™åŒ–"></a>2.3.4 ç¥ç»ç½‘ç»œä¸­çš„L2æ­£åˆ™åŒ–</h3><p>å¯¹æ¯ä¸€å±‚çš„æƒé‡çŸ©é˜µ$W^{[l]}$è¿›è¡Œæ­£åˆ™åŒ–ï¼Œæ¯ä¸€å±‚éƒ½æœ‰è‹¥å¹²ä¸ªæƒé‡ï¼Œå¯ä»¥ç†è§£ä¸ºçŸ©é˜µ</p><script type="math/tex; mode=display">J(W^{[1]},b^{[1]},...,W^{[L]},b^{[L]}) = \dfrac{1}{m}\sum\limits_{i=1}^{m}L(\hat{y}^{(i)},y^{(i)})+\dfrac{\lambda}{2m}\sum\limits_{l=1}^{L}||W^{[l]}||_F^2</script><p>å…¶ä¸­ï¼Œ$||W^{[l]}||_F^2$ä¸ºFrobeniusèŒƒæ•°ï¼Œè¡¨ç¤ºçŸ©é˜µçš„æ‰€æœ‰å…ƒç´ çš„å¹³æ–¹å’Œã€‚</p><p>æ­£åˆ™åŒ–å‡å°è¿‡æ‹Ÿåˆçš„åŸç†ï¼šæ­£åˆ™åŒ–å› å­è®¾ç½®çš„è¶³å¤Ÿå¤§çš„æƒ…å†µä¸‹ï¼Œä¸ºäº†ä½¿æŸå¤±å‡½æ•°æœ€å°åŒ–ï¼Œæƒé‡çŸ©é˜µä¼šè¶‹å‘äº0ï¼Œæ¶ˆé™¤äº†ä¸€äº›ç¥ç»å…ƒçš„å½±å“ï¼Œä½¿è¾ƒå¤§çš„ç½‘ç»œå˜å¾—ç®€å•ï¼Œå‡å°äº†è¿‡æ‹Ÿåˆçš„é£é™©ã€‚</p><h3 id="2-3-5-Dropoutæ­£åˆ™åŒ–"><a href="#2-3-5-Dropoutæ­£åˆ™åŒ–" class="headerlink" title="2.3.5 Dropoutæ­£åˆ™åŒ–"></a>2.3.5 Dropoutæ­£åˆ™åŒ–</h3><p>Dropoutæ­£åˆ™åŒ–ï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œéšæœºå…³é—­ä¸€äº›ç¥ç»å…ƒï¼Œå‡å°‘ç¥ç»å…ƒä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</p><p>Inverted Dropoutï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå¯¹æ¯ä¸€å±‚çš„ç¥ç»å…ƒï¼Œä»¥æ¦‚ç‡$keep_prob$ä¿ç•™ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">keep_prob = <span class="number">0.8</span>  <span class="comment"># ä¿ç•™æ¦‚ç‡</span></span><br><span class="line">dl = np.random.rand(A.shape[<span class="number">0</span>], A.shape[<span class="number">1</span>]) &lt; keep_prob  </span><br><span class="line">A = np.multiply(A, dl)  <span class="comment"># ä¿ç•™ç¥ç»å…ƒ</span></span><br><span class="line"></span><br><span class="line"> éƒ¨åˆ†ç¥ç»å…ƒè¢«å…³é—­ï¼ŒæœŸæœ›å€¼é¢„è®¡ä¸‹é™ä¸ºåŸæ¥çš„$keep_prob$ï¼Œéœ€è¦ç¼©æ”¾æ¿€æ´»å€¼ä¿æŒæœŸæœ›å€¼ä¸å˜</span><br><span class="line">A = A / keep_prob </span><br></pre></td></tr></table></figure><p>åŠ å…¥äº†Droupoutåï¼Œè¾“å…¥çš„ç‰¹å¾éƒ½å­˜åœ¨è¢«éšæœºæ¸…é™¤çš„å¯èƒ½ï¼Œæ‰€ä»¥è¯¥ç¥ç»å…ƒä¸ä¼šå†ç‰¹åˆ«ä¾èµ–äºä»»ä½•ä¸€ä¸ªè¾“å…¥ç‰¹å¾ã€‚<br>é€šè¿‡ä¼ æ’­è¿‡ç¨‹ï¼ŒDropoutå°†äº§ç”Ÿå’ŒL2æ­£åˆ™åŒ–ç›¸åŒçš„æ”¶ç¼©æƒé‡çš„æ•ˆæœã€‚</p><p>å¯¹äºç¥ç»å…ƒè¾ƒå¤šçš„å±‚ï¼Œè®¾ç½®è¾ƒå°çš„keep_probï¼Œå¯¹äºç¥ç»å…ƒè¾ƒå°‘çš„å±‚ï¼Œè®¾ç½®keep_prob=1ã€‚</p><p>åœ¨CVé¢†åŸŸï¼Œå›¾åƒå…·æœ‰æ›´å¤šçš„ç‰¹å¾ï¼ŒDropoutæ˜¯ä¸€ç§éå¸¸æœ‰æ•ˆçš„æ­£åˆ™åŒ–æ–¹æ³•ã€‚</p><p>ç¼ºç‚¹ï¼š</p><ol><li>å› ä¸ºæ¯æ¬¡ä¼šéšæœºæ¶ˆé™¤ä¸€éƒ¨åˆ†ç¥ç»å…ƒï¼Œæˆæœ¬å‡½æ•°æ— æ³•è¢«æ˜ç¡®å®šä¹‰</li><li>å‚æ•°æ— æ³•ç¡®å®šå…·ä½“æ˜¯å“ªäº›ï¼Œåœ¨åå‘ä¼ æ’­çš„æ—¶å€™å¸¦æ¥è®¡ç®—ä¸Šçš„éº»çƒ¦ï¼Œæ— æ³•ä¿è¯å½“å‰ç½‘ç»œæ˜¯å¦æŸå¤±å‡½æ•°ä¸‹é™çš„</li></ol><h3 id="2-3-6-æ—©åœæ­¢æ³•ï¼ˆEarly-Stoppingï¼‰"><a href="#2-3-6-æ—©åœæ­¢æ³•ï¼ˆEarly-Stoppingï¼‰" class="headerlink" title="2.3.6 æ—©åœæ­¢æ³•ï¼ˆEarly Stoppingï¼‰"></a>2.3.6 æ—©åœæ­¢æ³•ï¼ˆEarly Stoppingï¼‰</h3><p>å¦‚æœè®­ç»ƒè¿­ä»£çš„æ¬¡æ•°è¿‡é«˜ï¼Œä¼šå‘ç”Ÿè¿‡æ‹Ÿåˆï¼ŒæŸå¤±å‡½æ•°å›¾åƒå¦‚ä¸‹ï¼š</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/æ—©åœæ­¢æ³•.png" alt="æ—©åœæ­¢æ³•"></p><p>æ—©åœæ­¢æ³•ï¼šåœ¨æµ‹è¯•é›†ä¸Šçš„æŸå¤±å‡å°‘åˆ°ä¸€å®šç¨‹åº¦åï¼Œåœæ­¢è®­ç»ƒï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</p><p>è¿™ç§æ–¹æ³•æ²»æ ‡ä¸æ²»æœ¬ï¼Œè¿˜æ˜¯éœ€è¦ä»æ ¹æœ¬ä¸Šè§£å†³æ•°æ®æˆ–æ¨¡å‹çš„é—®é¢˜ã€‚</p><h3 id="2-3-7-æ•°æ®å¢å¼ºï¼ˆData-Augmentationï¼‰"><a href="#2-3-7-æ•°æ®å¢å¼ºï¼ˆData-Augmentationï¼‰" class="headerlink" title="2.3.7 æ•°æ®å¢å¼ºï¼ˆData Augmentationï¼‰"></a>2.3.7 æ•°æ®å¢å¼ºï¼ˆData Augmentationï¼‰</h3><p>ç®—æ³•åœ¨å­¦ä¹ åŒºåˆ†ä¸¤ç§ç±»åˆ«æ—¶ï¼Œå¯èƒ½ä¼šå¯»æ‰¾åˆ°ä¸€ä¸ªæœ€æ˜æ˜¾çš„ç‰¹å¾ã€‚</p><p>ä¾‹å¦‚åœ¨åŒºåˆ†ä¸¤ç§ä¸åŒå‹å·çš„è½¦æ—¶ï¼Œå¦‚æœè®­ç»ƒé›†ä¸­ï¼Œå‹å·1çš„è½¦éƒ½æœå·¦ï¼Œå‹å·2çš„è½¦éƒ½æœå³ï¼Œé‚£ä¹ˆæ¨¡å‹å¯èƒ½ä¼šè®¤ä¸ºè½¦çš„æœå‘æ˜¯åŒºåˆ†ä¸¤ç§è½¦çš„æœ€é‡è¦ç‰¹å¾ã€‚<br>åœ¨æµ‹è¯•é›†ä¸­ï¼Œå¦‚æœå‡ºç°äº†æœå³çš„å‹å·1è½¦ï¼Œæ¨¡å‹å¯èƒ½è®¤ä¸ºæ˜¯å‹å·2è½¦ã€‚<br>å› æ­¤ï¼Œéœ€è¦å‡å°‘æ•°æ®é›†ä¸­ä¸ç›¸å…³çš„ç‰¹å¾çš„æ•°é‡ã€‚</p><p>æ•°æ®å¢å¼ºï¼šé€šè¿‡å¯¹è®­ç»ƒé›†è¿›è¡Œä¸€ç³»åˆ—çš„éšæœºå˜æ¢ï¼ˆå¦‚å‰ªåˆ‡ã€æ—‹è½¬ã€ç¿»è½¬ã€ç¼©æ”¾ç­‰ï¼‰ï¼Œå¢åŠ è®­ç»ƒé›†çš„æ ·æœ¬æ•°é‡ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚</p><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¯ä»¥é€šè¿‡æ°´å¹³ç¿»è½¬å›¾åƒï¼Œä»¥é˜²æ­¢æ¨¡å‹å­¦ä¹ åˆ°ä¸ç›¸å…³çš„æ¨¡å¼ã€‚</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/æ•°æ®å¢å¼º.png" alt="æ•°æ®å¢å¼º"></p><ul><li>ç¦»çº¿å¢å¼ºï¼šé¢„å…ˆè¿›è¡Œæ‰€æœ‰çš„å¿…è¦è½¬æ¢ï¼Œä»æ ¹æœ¬ä¸Šå¢å¤§æ•°æ®é›†è§„æ¨¡ï¼ˆå¦‚æ°´å¹³ç¿»è½¬åï¼Œä¿å­˜ä¸ºæ–°çš„å›¾åƒï¼Œæ•°æ®é›†å¢å¤§ä¸ºåŸæ¥çš„ä¸¤å€ï¼‰</li><li>åœ¨çº¿å¢å¼ºï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå¯¹å³å°†è¾“å…¥æ¨¡å‹çš„å°æ‰¹é‡æ•°æ®è¿›è¡Œç›¸åº”å˜æ¢ï¼ŒåŒä¸€å¼ å›¾æ¯æ¬¡è®­ç»ƒè¢«éšæœºæ‰§è¡Œä¸€äº›å˜åŒ–æ“ä½œï¼Œç›¸å½“äºä¸åŒæ•°æ®é›†</li></ul><p>æ•°æ®å¢å¼ºçš„æ•ˆæœå¦‚ä¸‹</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/æ•°æ®å¢å¼ºçš„æ•ˆæœ.png" alt="æ•°æ®å¢å¼ºçš„æ•ˆæœ"></p><h2 id="2-4-ç¥ç»ç½‘ç»œè°ƒä¼˜å’Œæ‰¹æ ‡å‡†åŒ–"><a href="#2-4-ç¥ç»ç½‘ç»œè°ƒä¼˜å’Œæ‰¹æ ‡å‡†åŒ–" class="headerlink" title="2.4 ç¥ç»ç½‘ç»œè°ƒä¼˜å’Œæ‰¹æ ‡å‡†åŒ–"></a>2.4 ç¥ç»ç½‘ç»œè°ƒä¼˜å’Œæ‰¹æ ‡å‡†åŒ–</h2><h3 id="2-4-1-ç¥ç»ç½‘ç»œè°ƒä¼˜"><a href="#2-4-1-ç¥ç»ç½‘ç»œè°ƒä¼˜" class="headerlink" title="2.4.1 ç¥ç»ç½‘ç»œè°ƒä¼˜"></a>2.4.1 ç¥ç»ç½‘ç»œè°ƒä¼˜</h3><p>ç®—æ³•å±‚é¢ï¼š</p><ul><li>å­¦ä¹ ç‡$\alpha$</li><li>$\beta_1,\beta_2,\epsilon$ï¼šAdamç®—æ³•çš„è¶…å‚æ•°ï¼Œå¸¸ç”¨å€¼$\beta_1=0.9,\beta_2=0.999,\epsilon=10^{-8}$</li><li>æ­£åˆ™åŒ–å‚æ•°$\lambda$</li></ul><p>æ¨¡å‹å±‚é¢ï¼š</p><ul><li>hidden unitsï¼šéšè—å±‚ç¥ç»å…ƒæ•°</li><li>layersï¼šéšè—å±‚å±‚æ•°</li></ul><p>è°ƒå‚æŠ€å·§</p><ul><li>ç½‘æ ¼æœç´¢ï¼šéå†æ‰€æœ‰å¯èƒ½çš„å‚æ•°ç»„åˆï¼Œæµ‹è¯•æ¯ä¸€ç»„çš„æ•ˆæœï¼Œé€‰æ‹©æ•ˆæœæœ€å¥½çš„å‚æ•°ç»„åˆã€‚</li><li>å°½é‡è®©æ¯ä¸€ç»„å·®åˆ«æ˜æ˜¾ï¼Œé¿å…é‡å¤æµ‹è¯•</li><li>åˆç†çš„å‚æ•°è®¾ç½®<ul><li>å­¦ä¹ ç‡$\alpha$ï¼šé€šå¸¸è®¾ç½®ä¸º0.0001ã€0.001ã€0.01ã€0.1ç­‰</li><li>æŒ‡æ•°ç§»åŠ¨å‚æ•°$\beta$: é€šå¸¸è®¾ç½®ä¸º0.999ã€0.9995ã€0.9999ç­‰ï¼Œå°½å¯èƒ½æ¥è¿‘1ï¼ˆæŒ‡æ•°å¢åŠ æ•ˆåº”ï¼‰</li></ul></li></ul><p>é—®é¢˜ï¼šè°ƒå‚è¿‡ç¨‹éº»çƒ¦ã€è®­ç»ƒæ—¶é—´é•¿</p><h3 id="2-4-2-æ‰¹æ ‡å‡†åŒ–ï¼ˆæ‰¹æ ‡å‡†åŒ–ï¼‰"><a href="#2-4-2-æ‰¹æ ‡å‡†åŒ–ï¼ˆæ‰¹æ ‡å‡†åŒ–ï¼‰" class="headerlink" title="2.4.2 æ‰¹æ ‡å‡†åŒ–ï¼ˆæ‰¹æ ‡å‡†åŒ–ï¼‰"></a>2.4.2 æ‰¹æ ‡å‡†åŒ–ï¼ˆæ‰¹æ ‡å‡†åŒ–ï¼‰</h3><p>è®ºæ–‡åœ°å€ï¼š<a href="https://arxiv.org/abs/1502.03167">æ‰¹æ ‡å‡†åŒ–: Accelerating Deep Network Training by Reducing Internal Covariate Shift</a></p><blockquote><p>è®­ç»ƒæ·±åº¦ç¥ç»ç½‘ç»œå¾ˆå¤æ‚ï¼Œå› ä¸ºåœ¨è®­ç»ƒæœŸé—´æ¯å±‚è¾“å…¥çš„åˆ†å¸ƒå‘ç”Ÿå˜åŒ–ï¼Œå› ä¸ºå‰ä¸€å±‚çš„å‚æ•°å‘ç”Ÿäº†å˜åŒ–ã€‚<br>è¿™é€šè¿‡è¦æ±‚è¾ƒä½çš„å­¦ä¹ ç‡å’Œä»”ç»†çš„å‚æ•°åˆå§‹åŒ–æ¥å‡æ…¢è®­ç»ƒé€Ÿåº¦ï¼Œå¹¶ä¸”ä½¿å¾—è®­ç»ƒå…·æœ‰é¥±å’Œéçº¿æ€§çš„æ¨¡å‹å˜å¾—éå¸¸å›°éš¾ã€‚<br>æˆ‘ä»¬å°†è¿™ç§ç°è±¡ç§°ä¸º<strong>å†…éƒ¨åå˜é‡åç§»</strong>ï¼Œå¹¶é€šè¿‡<strong>æ ‡å‡†åŒ–å±‚</strong>è¾“å…¥æ¥è§£å†³é—®é¢˜ã€‚<br>æˆ‘ä»¬çš„æ–¹æ³•çš„ä¼˜åŠ¿åœ¨äºä½¿æ ‡å‡†åŒ–æˆä¸ºæ¨¡å‹ä½“ç³»ç»“æ„çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸ºæ¯ä¸ªåŸ¹è®­å°æ‰¹é‡æ‰§è¡Œæ ‡å‡†åŒ–ã€‚<br>æ‰¹æ ‡å‡†åŒ–å…è®¸æˆ‘ä»¬ä½¿ç”¨æ›´é«˜çš„å­¦ä¹ ç‡å¹¶ä¸”ä¸å¤ªå…³å¿ƒåˆå§‹åŒ–ã€‚<br>å®ƒè¿˜å¯ä»¥å……å½“è°ƒèŠ‚å™¨ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥æ¶ˆé™¤å¯¹Dropoutçš„éœ€æ±‚ã€‚<br>åº”ç”¨äºæœ€å…ˆè¿›çš„å›¾åƒåˆ†ç±»æ¨¡å‹ï¼Œæ‰¹é‡æ ‡å‡†åŒ–å®ç°äº†ç›¸åŒçš„ç²¾åº¦ï¼ŒåŸ¹è®­æ­¥éª¤å‡å°‘äº†14å€ï¼Œå¹¶ä¸”æ˜¾ç€åœ°è¶…è¿‡äº†åŸå§‹æ¨¡å‹ã€‚<br>ä½¿ç”¨æ‰¹é‡æ ‡å‡†åŒ–ç½‘ç»œçš„é›†åˆï¼Œæˆ‘ä»¬æ”¹è¿›äº†ImageNetåˆ†ç±»çš„æœ€ä½³å‘å¸ƒç»“æœï¼šè¾¾åˆ°4.9ï¼…çš„å‰5ä¸ªéªŒè¯é”™è¯¯ï¼ˆå’Œ4.8ï¼…çš„æµ‹è¯•é”™è¯¯ï¼‰ï¼Œè¶…å‡ºäº†äººç±»è¯„ä¼°è€…çš„å‡†ç¡®æ€§ã€‚</p></blockquote><p>æ‰¹æ ‡å‡†åŒ–ï¼šåœ¨ç¥ç»ç½‘ç»œçš„æ¯ä¸€å±‚çš„<strong>æ¿€æ´»å‡½æ•°ä¹‹å‰</strong>ï¼Œå¯¹æ¯ä¸€å±‚çš„<strong>è¾“å…¥</strong>è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ï¼Œä½¿å¾—æ¯ä¸€å±‚çš„è¾“å…¥æ•°æ®æœä»å‡å€¼ä¸º0ã€æ–¹å·®ä¸º1çš„æ­£æ€åˆ†å¸ƒã€‚</p><p>æ‰¹æ ‡å‡†åŒ–å…¬å¼ï¼š</p><script type="math/tex; mode=display">\begin{split}&\mu = \dfrac{1}{m}\sum\limits_{i=1}^{m}Z^{(i)} \\\\ &\sigma^2 = \dfrac{1}{m}\sum\limits_{i=1}^{m}(Z^{(i)}-\mu)^2 \\\\ &Z_{norm}^{(i)} = \dfrac{Z^{(i)}-\mu}{\sqrt{\sigma^2+\epsilon}}\end{split}</script><p>å…¶ä¸­ï¼Œ$\mu$ä¸ºå‡å€¼ï¼Œ$\sigma^2$ä¸ºæ–¹å·®ï¼Œ$\epsilon$ä¸ºä¸€ä¸ªå¾ˆå°çš„æ•°ï¼Œé¿å…åˆ†æ¯ä¸º0ã€‚</p><p>å¦‚æœå„éšè—å±‚çš„è¾“å…¥å‡å€¼åœ¨é è¿‘0çš„åŒºåŸŸï¼Œå³å¤„äºæ¿€æ´»å‡½æ•°çš„çº¿æ€§åŒºåŸŸï¼Œä¸åˆ©äºè®­ç»ƒéçº¿æ€§ç¥ç»ç½‘ç»œï¼Œä»è€Œå¾—åˆ°æ•ˆæœè¾ƒå·®çš„æ¨¡å‹ã€‚<br>å› æ­¤æ·»åŠ ä¸¤ä¸ªå¯å­¦ä¹ çš„å‚æ•°$\gamma$å’Œ$\beta$ï¼Œå¯¹æ ‡å‡†åŒ–åçš„æ•°æ®è¿›è¡Œç¼©æ”¾å’Œå¹³ç§»ã€‚</p><script type="math/tex; mode=display">\tilde{Z}^{(i)} = \gamma Z_{norm}^{(i)}+\beta</script><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/æ‰¹æ ‡å‡†åŒ–è¿‡ç¨‹.png" alt="æ‰¹æ ‡å‡†åŒ–è¿‡ç¨‹"></p><p>æ‰¹æ ‡å‡†åŒ–ä¼˜åŒ–è®­ç»ƒè¿‡ç¨‹çš„åŸç†ï¼š</p><p>æ•°æ®çš„åˆ†å¸ƒä¼šéšç€ä¸åŒæ•°æ®é›†æ”¹å˜ã€‚<br>ç½‘ç»œçš„å‚æ•°ä¼šå› è®­ç»ƒé›†æ•°æ®åˆ†å¸ƒçš„å˜åŒ–è€Œå˜åŒ–ï¼›æµ‹è¯•çš„æ•°æ®åˆ†å¸ƒä¸è®­ç»ƒé›†çš„æ•°æ®åˆ†å¸ƒä¸åŒï¼Œä¹Ÿä¼šå¯¼è‡´å‡†ç¡®æ€§ä¸‹é™ã€‚</p><p>æ‰¹æ ‡å‡†åŒ–çš„ä½œç”¨å°±æ˜¯å‡å°äº†æ•°æ®åˆ†å¸ƒçš„å˜åŒ–å¸¦æ¥çš„å½±å“ï¼Œè®©æ¨¡å‹æ›´å¥å£®ï¼Œé²æ£’æ€§æ›´å¼ºã€‚<br>å³ä½¿è¾“å…¥çš„å€¼æ”¹å˜ï¼Œç”±äºæ‰¹æ ‡å‡†åŒ–çš„ä½œç”¨ï¼Œå‡å€¼å’Œæ–¹å·®çš„å˜åŒ–ä¼šè¢«æ¶ˆé™¤ï¼Œåç»­çš„å­¦ä¹ æ›´åŠ å®¹æ˜“ã€‚<br>æ‰¹æ ‡å‡†åŒ–å‡å°‘äº†å„å±‚Wå’Œbä¹‹é—´çš„è€¦åˆæ€§ï¼Œè®©å„å±‚æ›´åŠ ç‹¬ç«‹ï¼Œå®ç°è‡ªæˆ‘è®­ç»ƒå­¦ä¹ çš„æ•ˆæœ</p><p>æ‰¹æ ‡å‡†åŒ–ä¹Ÿèµ·åˆ°å¾®å¼±çš„æ­£åˆ™åŒ–æ•ˆæœï¼Œä½†æ˜¯ä¸èƒ½å°†æ‰¹æ ‡å‡†åŒ–ä½œä¸ºæ­£åˆ™åŒ–çš„æ‰‹æ®µï¼Œè€Œæ˜¯å½“ä½œåŠ é€Ÿå­¦ä¹ çš„æ–¹å¼ã€‚<br>æ‰¹æ ‡å‡†åŒ– ä¸»è¦è§£å†³çš„è¿˜æ˜¯åå‘ä¼ æ’­è¿‡ç¨‹ä¸­çš„æ¢¯åº¦é—®é¢˜ï¼ˆæ¢¯åº¦æ¶ˆå¤±å’Œçˆ†ç‚¸ï¼‰ã€‚</p>]]></content>
    
    
    <summary type="html">å¤šåˆ†ç±»ã€ä¼˜åŒ–å™¨ã€æ­£åˆ™åŒ–ã€å‚æ•°è°ƒä¼˜</summary>
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>æ·±åº¦å­¦ä¹ ç¬”è®°1-æ·±åº¦å­¦ä¹ åŸºç¡€</title>
    <link href="https://www.cclmsy.cc/posts/Deep_Learning01.html"/>
    <id>https://www.cclmsy.cc/posts/Deep_Learning01.html</id>
    <published>2025-02-20T04:00:00.000Z</published>
    <updated>2025-02-19T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-1-æ·±åº¦å­¦ä¹ ä»‹ç»"><a href="#1-1-æ·±åº¦å­¦ä¹ ä»‹ç»" class="headerlink" title="1.1 æ·±åº¦å­¦ä¹ ä»‹ç»"></a>1.1 æ·±åº¦å­¦ä¹ ä»‹ç»</h2><h3 id="1-1-1-æ·±åº¦å­¦ä¹ å’Œæœºå™¨å­¦ä¹ çš„åŒºåˆ«"><a href="#1-1-1-æ·±åº¦å­¦ä¹ å’Œæœºå™¨å­¦ä¹ çš„åŒºåˆ«" class="headerlink" title="1.1.1 æ·±åº¦å­¦ä¹ å’Œæœºå™¨å­¦ä¹ çš„åŒºåˆ«"></a>1.1.1 æ·±åº¦å­¦ä¹ å’Œæœºå™¨å­¦ä¹ çš„åŒºåˆ«</h3><p>æ·±åº¦å­¦ä¹ çš„ä¼˜ç‚¹ï¼š</p><ul><li>ä¸éœ€è¦äººå·¥å¤„ç†è®¾è®¡ç‰¹å¾ï¼Œåªéœ€é€šè¿‡ç¥ç»ç½‘ç»œè¾“å‡ºç»“æœ</li><li>æ›´é€‚ç”¨äºéš¾æå–ç‰¹å¾çš„ä»»åŠ¡ï¼šå›¾åƒã€è¯­éŸ³ã€è‡ªç„¶è¯­è¨€å¤„ç†</li><li>èƒ½å¤Ÿåº”å¯¹å¤„ç†æ›´å¤§è§„æ¨¡æ•°æ®</li></ul><h3 id="1-1-2-äººå·¥ç¥ç»ç½‘ç»œï¼ˆArtificial-Neural-Network-ANNï¼‰"><a href="#1-1-2-äººå·¥ç¥ç»ç½‘ç»œï¼ˆArtificial-Neural-Network-ANNï¼‰" class="headerlink" title="1.1.2 äººå·¥ç¥ç»ç½‘ç»œï¼ˆArtificial Neural Network, ANNï¼‰"></a>1.1.2 äººå·¥ç¥ç»ç½‘ç»œï¼ˆArtificial Neural Network, ANNï¼‰</h3><p>åŒ…å«ï¼šè¾“å…¥å±‚ã€éšè—å±‚ã€è¾“å‡ºå±‚ï¼Œæ¯å±‚åŒ…å«å¤šä¸ªç¥ç»å…ƒï¼Œæ¯ä¸ªç¥ç»å…ƒåŒ…å«æ¿€æ´»å‡½æ•°</p><h3 id="1-1-3-æ¿€æ´»å‡½æ•°ï¼ˆActivation-Functionï¼‰"><a href="#1-1-3-æ¿€æ´»å‡½æ•°ï¼ˆActivation-Functionï¼‰" class="headerlink" title="1.1.3 æ¿€æ´»å‡½æ•°ï¼ˆActivation Functionï¼‰"></a>1.1.3 æ¿€æ´»å‡½æ•°ï¼ˆActivation Functionï¼‰</h3><p>æ¶‰åŠåˆ°ç½‘ç»œçš„ä¼˜åŒ–æ—¶å€™ï¼Œä¼šæœ‰ä¸åŒçš„æ¿€æ´»å‡½æ•°é€‰æ‹©ã€‚<br>æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ç¥ç»ç½‘ç»œçš„éšè—å±‚å’Œè¾“å‡ºå•å…ƒç”¨ä»€ä¹ˆæ¿€æ´»å‡½æ•°ã€‚<br>åœ¨é€»è¾‘å›å½’ä¸­é€‰ç”¨äº†Sigmoidå‡½æ•°ï¼Œä½†æœ‰æ—¶å…¶ä»–å‡½æ•°çš„æ•ˆæœä¼šå¥½å¾—å¤šã€‚<br>å¤§å¤šæ•°ç»“è®ºé€šè¿‡å®è·µå¾—æ¥ï¼Œæ²¡æœ‰å¾ˆå¥½çš„è§£é‡Šæ€§ã€‚</p><p>ä½¿ç”¨éçº¿æ€§çš„æ¿€æ´»å‡½æ•°ï¼šä½¿ç”¨çº¿æ€§å‡½æ•°ï¼Œåœ¨è¿™ä¸€å±‚ä¸Šçš„ç¥ç»å…ƒçš„è¾“å‡ºä»…ä»…æ˜¯è¾“å…¥çš„çº¿æ€§ç»„åˆï¼Œå¤±å»äº†æ•ˆæœã€‚</p><script type="math/tex; mode=display">a^{[1]} = W^{[1]}x+b^{[1]}</script><script type="math/tex; mode=display">\begin{align}    b^{[1]} &= W^{[2]}a^{[1]}+b^{[2]} \\\\    &= W^{[2]}(W^{[1]}x+b^{[1]})+b^{[2]} \\\\    &= (W^{[2]}W^{[1]})x+(W^{[2]}b^{[1]}+b^{[2]}) \\\\    &= Wx+b\end{align}</script><p>æœ¬èŠ‚æåŠçš„å‡ ç§å¸¸ç”¨æ¿€æ´»å‡½æ•°ï¼šSigmoidå‡½æ•°ã€tanHå‡½æ•°ã€ReLUå‡½æ•°</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/æ¿€æ´»å‡½æ•°.png" alt="æ¿€æ´»å‡½æ•°"></p><p>Sigmoidå‡½æ•°</p><script type="math/tex; mode=display">\begin{split} &\sigma(t)=\dfrac{1}{1+e^{-t}} \\\\&\sigma'(t)=\sigma(t)(1-\sigma(t)) \\\\&t\in(-\infty,+\infty), \sigma(t)\in(0,1)\end{split}</script><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/Sigmoidå‡½æ•°.png" alt="Sigmoidå‡½æ•°"></p><p>åŒæ›²æ­£åˆ‡å‡½æ•°ï¼ˆHyperbolic Tangent, tanHï¼‰</p><p>æ•ˆæœæ¯”Sigmoidå‡½æ•°å¥½ï¼Œå› ä¸ºå‡½æ•°è¾“å‡ºåœ¨(-1,1)ä¹‹é—´ï¼Œæ”¶æ•›é€Ÿåº¦æ›´å¿«</p><p>å­˜åœ¨å’ŒSigmoidå‡½æ•°ä¸€æ ·çš„ç¼ºç‚¹ï¼šå½“tè¶‹ç´§æ— ç©·ï¼Œå¯¼æ•°çš„æ¢¯åº¦ï¼ˆå³å‡½æ•°çš„æ–œç‡ï¼‰å°±è¶‹ç´§äº 0ï¼Œè¿™ä½¿å¾—æ¢¯åº¦ç®—æ³•çš„é€Ÿåº¦ä¼šå‡æ…¢ã€‚</p><script type="math/tex; mode=display">\begin{split} &tanh(t)=\dfrac{e^{t}-e^{-t}}{e^{t}+e^{-t}} \\\\&tanh'(t)=1-tanh^2(t)\end{split}</script><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/tanHå‡½æ•°.png" alt="tanHå‡½æ•°"></p><p>ReLUå‡½æ•°ï¼šä¿®æ­£çº¿æ€§å•å…ƒï¼ˆRectified Linear Unit, ReLUï¼‰</p><p>å½“ $t&gt;0$ æ—¶ï¼Œæ¢¯åº¦å§‹ç»ˆä¸º1ï¼Œä»è€Œæé«˜ç¥ç»ç½‘ç»œåŸºäºæ¢¯åº¦ç®—æ³•çš„è¿ç®—é€Ÿåº¦ï¼Œæ”¶æ•›é€Ÿåº¦è¿œå¤§äºSigmoidå’ŒtanHå‡½æ•°</p><script type="math/tex; mode=display">\begin{split}&f(t)=max(0,t) \\\\&f'(t)=\begin{cases}0 & \text{if } t<0 \\\\1 & \text{if } t \geq 0\end{cases}\end{split}</script><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/ReLUå‡½æ•°.png" alt="ReLUå‡½æ•°"></p><h3 id="1-1-4-æŸå¤±å‡½æ•°ï¼ˆLoss-Functionï¼‰"><a href="#1-1-4-æŸå¤±å‡½æ•°ï¼ˆLoss-Functionï¼‰" class="headerlink" title="1.1.4 æŸå¤±å‡½æ•°ï¼ˆLoss Functionï¼‰"></a>1.1.4 æŸå¤±å‡½æ•°ï¼ˆLoss Functionï¼‰</h3><p>æŸå¤±å‡½æ•°ç”¨äºè¡¡é‡é¢„æµ‹ç»“æœä¸çœŸå®å€¼ä¹‹é—´çš„è¯¯å·®ã€‚</p><p>å¹³æ–¹å·®æŸå¤±å‡½æ•°ï¼š$L(\hat{y},y)=\frac{1}{2}(\hat{y}-y)^2$</p><ul><li>æœ€ç®€å•çš„æŸå¤±å‡½æ•°</li><li>å…·æœ‰å¤šä¸ªå±€éƒ¨æœ€å°å€¼ï¼Œä¸é€‚åˆé€»è¾‘å›å½’</li></ul><p>å¯¹æ•°æŸå¤±å‡½æ•°ï¼š$L(\hat{y},y)=-(y\log(\hat{y})+(1-y)\log(1-\hat{y}))$</p><ul><li>é€»è¾‘å›å½’é€šå¸¸é‡‡ç”¨çš„æŸå¤±å‡½æ•°</li><li>y=1æ—¶ï¼ŒæŸå¤±å‡½æ•°ä¸º$-log(\hat{y})$ï¼Œ$\hat{y}$è¶Šå¤§ï¼ŒæŸå¤±è¶Šå°</li><li>y=0æ—¶ï¼ŒæŸå¤±å‡½æ•°ä¸º$log(1-\hat{y})$ï¼Œ$\hat{y}$è¶Šå°ï¼ŒæŸå¤±è¶Šå°</li></ul><p>æŸå¤±å‡½æ•°ï¼šè¡¡é‡äº†åœ¨å•ä¸ªè®­ç»ƒæ ·æœ¬ä¸Šçš„è¡¨ç°</p><p>ä»£ä»·å‡½æ•°ï¼ˆCost Functionï¼‰ï¼š$J(w,b)=\dfrac{1}{m}\sum\limits_{i=1}^{m}L(\hat{y}^{(i)},y^{(i)})$</p><ul><li>æ‰€æœ‰è®­ç»ƒæ ·æœ¬çš„æŸå¤±å¹³å‡å€¼</li><li>è¡¡é‡åœ¨å…¨ä½“è®­ç»ƒæ ·æœ¬ä¸Šçš„è¡¨ç°ã€å‚æ•°wå’Œbçš„æ•ˆæœ</li></ul><h2 id="1-2-é€»è¾‘å›å½’"><a href="#1-2-é€»è¾‘å›å½’" class="headerlink" title="1.2 é€»è¾‘å›å½’"></a>1.2 é€»è¾‘å›å½’</h2><h3 id="1-2-1-é€»è¾‘å›å½’ï¼ˆLogistic-Regression-LRï¼‰"><a href="#1-2-1-é€»è¾‘å›å½’ï¼ˆLogistic-Regression-LRï¼‰" class="headerlink" title="1.2.1 é€»è¾‘å›å½’ï¼ˆLogistic Regression, LRï¼‰"></a>1.2.1 é€»è¾‘å›å½’ï¼ˆLogistic Regression, LRï¼‰</h3><p>é€»è¾‘å›å½’æ˜¯ä¸€ç§ç”¨äºè§£å†³äºŒåˆ†ç±»é—®é¢˜çš„åˆ†ç±»ç®—æ³•ï¼Œç»™å®šä¸€ä¸ªè¾“å…¥xï¼Œè¾“å‡ºy=1çš„é¢„æµ‹æ¦‚ç‡ $\hat{y}=P(y=1|x)$</p><p>è®°è¾“å…¥å±‚ç‰¹å¾æ•°$n$ï¼Œå‚æ•°ï¼š</p><ul><li>è¾“å…¥$x \in R^{n}$ï¼Œxæ˜¯ä¸€ä¸ªnç»´çš„ç‰¹å¾å‘é‡</li><li>æƒé‡$w \in R^{n}$ï¼Œwæ˜¯ä¸€ä¸ªnç»´çš„æƒé‡å‘é‡</li><li>æ ‡ç­¾$y \in {0,1}$ï¼Œyæ˜¯ä¸€ä¸ªäºŒåˆ†ç±»æ ‡ç­¾</li><li>åç½®$b \in R$ï¼Œbæ˜¯ä¸€ä¸ªæ ‡é‡</li><li>è¾“å‡º$\hat{y} = \sigma(w^{T}x+b)=\sigma(w_1x_1+w_2x_2+â€¦+w_nx_n+b)$<ul><li>æ¿€æ´»å‡½æ•°ï¼šSigmoidå‡½æ•°ï¼š$\sigma(t)=\dfrac{1}{1+e^{-t}}$</li><li>téå¸¸å¤§æ—¶ï¼Œsæ¥è¿‘1ï¼›téå¸¸å°æ—¶ï¼Œsæ¥è¿‘0</li></ul></li></ul><h3 id="1-2-2-æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼ˆGradient-Descentï¼‰"><a href="#1-2-2-æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼ˆGradient-Descentï¼‰" class="headerlink" title="1.2.2 æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼ˆGradient Descentï¼‰"></a>1.2.2 æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼ˆGradient Descentï¼‰</h3><p>é€šè¿‡è¿­ä»£æ›´æ–°å‚æ•°wå’Œbï¼Œä½¿ä»£ä»·å‡½æ•°J(w,b)æ‰¾åˆ°æœ€å°å€¼</p><p>æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼šå‡½æ•°çš„æ¢¯åº¦ï¼ˆgradientï¼‰æŒ‡å‡ºäº†å‡½æ•°çš„æœ€é™¡å¢é•¿æ–¹å‘ã€‚æ¢¯åº¦çš„æ–¹å‘èµ°ï¼Œå‡½æ•°å¢é•¿å¾—å°±è¶Šå¿«ã€‚é‚£ä¹ˆæŒ‰æ¢¯åº¦çš„è´Ÿæ–¹å‘èµ°ï¼Œå‡½æ•°å€¼è‡ªç„¶å°±é™ä½å¾—æœ€å¿«äº†</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/æŸå¤±å‡½æ•°å›¾.png" alt="æŸå¤±å‡½æ•°å›¾"></p><p>å‚æ•°æ›´æ–°ï¼š</p><ul><li>$w:=w-\alpha \dfrac{\partial J(w,b)}{\partial w}$</li><li>$b:=b-\alpha \dfrac{\partial J(w,b)}{\partial b}$</li><li>$\alpha$ï¼šå­¦ä¹ ç‡ï¼ˆLearning Rateï¼‰ï¼Œæ§åˆ¶å‚æ•°æ›´æ–°çš„æ­¥é•¿ï¼Œå¤ªå¤§ä¼šå¯¼è‡´éœ‡è¡ï¼Œå¤ªå°ä¼šå¯¼è‡´æ”¶æ•›é€Ÿåº¦æ…¢</li></ul><h3 id="1-2-3-é€»è¾‘å›å½’çš„æ¢¯åº¦ä¸‹é™"><a href="#1-2-3-é€»è¾‘å›å½’çš„æ¢¯åº¦ä¸‹é™" class="headerlink" title="1.2.3 é€»è¾‘å›å½’çš„æ¢¯åº¦ä¸‹é™"></a>1.2.3 é€»è¾‘å›å½’çš„æ¢¯åº¦ä¸‹é™</h3><p>ä»¥2ç»´æ ·æœ¬ $x_1,x_2$ ä¸ºä¾‹ï¼Œå‚æ•°$w_1,w_2,b$ï¼Œè®¡ç®—æ¢¯åº¦ä¸‹é™</p><p>å·²çŸ¥ï¼š</p><script type="math/tex; mode=display">\begin{split}&z = w_1x_1+w_2x_2+b \\\\&è®° a = \hat{y} = \sigma(z) \\\\&J(a,y) = -y\log(a)-(1-y)\log(1-a) \\\\\end{split}</script><p>è®¡ç®—Jå¯¹zçš„å¯¼æ•°ï¼š</p><script type="math/tex; mode=display">\begin{split}&\frac{\partial J}{\partial a} = \frac{-y}{a}+\frac{1-y}{1-a} \\\\&\frac{\partial a}{\partial z} = a(1-a) \\\\&dz = \frac{\partial J}{\partial a} \cdot \frac{\partial a}{\partial z} = a-y\end{split}</script><p>è¿™æ ·å¯ä»¥æ±‚å‡ºæ€»æŸå¤±ç›¸å¯¹äº$w_1,w_2,b$çš„å¯¼æ•°</p><ul><li>$dw_1 = \frac{\partial J}{\partial z} \cdot \frac{\partial z}{\partial w_1} = x_1(a-y)$</li><li>$dw_2 = \frac{\partial J}{\partial z} \cdot \frac{\partial z}{\partial w_2} = x_2(a-y)$</li><li>$db = \frac{\partial J}{\partial z} \cdot \frac{\partial z}{\partial b} = a-y = dz$</li></ul><p>ç„¶åæ›´æ–°å‚æ•°ï¼š</p><ul><li>$w_1:=w_1-\alpha dw_1$</li><li>$w_2:=w_2-\alpha dw_1$</li><li>$b:=b-\alpha dw_1$</li></ul><h3 id="1-2-4-å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­"><a href="#1-2-4-å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­" class="headerlink" title="1.2.4 å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­"></a>1.2.4 å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­</h3><ul><li>å‰å‘ä¼ æ’­ï¼šä»å‰å¾€åè®¡ç®—æ¢¯åº¦å’ŒæŸå¤±çš„è¿‡ç¨‹</li><li>åå‘ä¼ æ’­ï¼šä»åå¾€å‰è®¡ç®—å‚æ•°çš„æ›´æ–°æ¢¯åº¦å€¼</li></ul><h3 id="1-2-5-é€»è¾‘å›å½’å®ç°"><a href="#1-2-5-é€»è¾‘å›å½’å®ç°" class="headerlink" title="1.2.5 é€»è¾‘å›å½’å®ç°"></a>1.2.5 é€»è¾‘å›å½’å®ç°</h3><p>å‘é‡åŒ–ç¼–ç¨‹çš„ä¼˜ç‚¹ï¼šå¤šæ ·æœ¬ä¸‹ï¼Œå‘é‡è®¡ç®—æ¯”å¾ªç¯è®¡ç®—å¿«çš„å¤šï¼Œä»£ç æ›´ç®€æ´</p><ol><li>è¾“å…¥å±‚$X$ï¼šå½¢çŠ¶$n \times m$ï¼Œ$n$ä¸ºç‰¹å¾æ•°ï¼Œ$m$ä¸ºæ ·æœ¬æ•°</li><li>æƒé‡å‚æ•°$W$ï¼šå½¢çŠ¶$n \times 1$</li><li>åç½®å‚æ•°$b$ï¼šæ ‡é‡</li><li>è¾“å‡ºå±‚$Z$ï¼š$Z=W^{T}X+b$ï¼Œå½¢çŠ¶$(1,n) \times (n,m) + b = (1,m)$  </li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">n = <span class="number">20</span>  <span class="comment"># ç‰¹å¾æ•°</span></span><br><span class="line">m = <span class="number">100</span>  <span class="comment"># æ ·æœ¬æ•°</span></span><br><span class="line">alpha = <span class="number">0.001</span>  <span class="comment"># å­¦ä¹ ç‡</span></span><br><span class="line">iterations = <span class="number">1000</span>  <span class="comment"># è¿­ä»£æ¬¡æ•°</span></span><br><span class="line"></span><br><span class="line">X = np.random.randn(n, m)  <span class="comment"># ç”Ÿæˆç‰¹å¾çŸ©é˜µ</span></span><br><span class="line">Y = np.random.randint(<span class="number">0</span>, <span class="number">2</span>, [<span class="number">1</span>, m])  <span class="comment"># ç”Ÿæˆæ ‡ç­¾</span></span><br><span class="line"></span><br><span class="line">J = <span class="number">0</span>  <span class="comment"># æŸå¤±å‡½æ•°å€¼</span></span><br><span class="line"></span><br><span class="line"> åˆå§‹åŒ–æƒé‡å’Œåç½®</span><br><span class="line">W = np.random.randn(n, <span class="number">1</span>) * <span class="number">0.01</span></span><br><span class="line">b = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sigmoid</span>(<span class="params">t</span>): <span class="comment"># Sigmoidå‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + np.exp(-t))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">log_loss</span>(<span class="params">A, Y</span>):  <span class="comment"># å¯¹æ•°æŸå¤±å‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span> / m * np.<span class="built_in">sum</span>(Y * np.log(A) + (<span class="number">1</span> - Y) * np.log(<span class="number">1</span> - A))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc_accuracy</span>(<span class="params">A, Y</span>):  <span class="comment"># è®¡ç®—å‡†ç¡®ç‡</span></span><br><span class="line">    A = np.where(A &gt; <span class="number">0.5</span>, <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> np.mean(A == Y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(iterations):</span><br><span class="line">    <span class="comment"># å‰å‘ä¼ æ’­</span></span><br><span class="line">    Z = np.dot(W.T, X) + b</span><br><span class="line">    A = sigmoid(Z)  <span class="comment"># æ¿€æ´»å€¼ï¼ˆé¢„æµ‹ï¼‰</span></span><br><span class="line">    J = log_loss(A, Y)  <span class="comment"># è®¡ç®—æŸå¤±å‡½æ•°å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># åå‘ä¼ æ’­</span></span><br><span class="line">    <span class="comment"># è®¡ç®—æ¢¯åº¦</span></span><br><span class="line">    dZ = A - Y</span><br><span class="line">    dW = <span class="number">1</span> / m * np.dot(X, dZ.T) <span class="comment"># 1/m * X * dZ</span></span><br><span class="line">    db = <span class="number">1</span> / m * np.<span class="built_in">sum</span>(dZ) <span class="comment"># 1/m * dZ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ›´æ–°æƒé‡å’Œåç½®</span></span><br><span class="line">    W = W - alpha * dW</span><br><span class="line">    b = b - alpha * db</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Loss:&quot;</span>, J)  <span class="comment"># æ‰“å°æŸå¤±å‡½æ•°å€¼</span></span><br><span class="line"></span><br><span class="line"> è®­ç»ƒé›†ä¸Šçš„å‡†ç¡®ç‡</span><br><span class="line">Z = np.dot(W.T, X) + b</span><br><span class="line">A = <span class="number">1</span> / (<span class="number">1</span> + np.exp(-Z))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Accuracy:&quot;</span>, calc_accuracy(A, Y))</span><br></pre></td></tr></table></figure><h2 id="1-3-æµ…å±‚ç¥ç»ç½‘ç»œ"><a href="#1-3-æµ…å±‚ç¥ç»ç½‘ç»œ" class="headerlink" title="1.3 æµ…å±‚ç¥ç»ç½‘ç»œ"></a>1.3 æµ…å±‚ç¥ç»ç½‘ç»œ</h2><h3 id="1-3-1-æµ…å±‚ç¥ç»ç½‘ç»œ"><a href="#1-3-1-æµ…å±‚ç¥ç»ç½‘ç»œ" class="headerlink" title="1.3.1 æµ…å±‚ç¥ç»ç½‘ç»œ"></a>1.3.1 æµ…å±‚ç¥ç»ç½‘ç»œ</h3><p>ç¥ç»ç½‘ç»œï¼ˆNeural Network, NNï¼‰æ˜¯ä¸€ç§æ¨¡æ‹Ÿäººè„‘ç¥ç»å…ƒå·¥ä½œæ–¹å¼çš„è®¡ç®—æ¨¡å‹ï¼ŒåŒ…å«è¾“å…¥å±‚ã€éšè—å±‚ã€è¾“å‡ºå±‚ï¼Œæ¯å±‚åŒ…å«å¤šä¸ªç¥ç»å…ƒ</p><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/æµ…å±‚ç¥ç»ç½‘ç»œ.png" alt="æµ…å±‚ç¥ç»ç½‘ç»œ"></p><p>ä»¥ä¸Šå›¾ï¼ˆå•éšè—å±‚ç¥ç»ç½‘ç»œï¼‰ä¸ºä¾‹ï¼Œè¾“å…¥å±‚æœ‰$n=3$ä¸ªç‰¹å¾ï¼Œéšè—å±‚ä¸€å±‚ï¼Œæœ‰$4$ä¸ªç¥ç»å…ƒã€‚è®°éšè—å±‚ $[1]$ ï¼Œè¾“å‡ºå±‚ $[2]$ ï¼Œåˆ™ï¼š</p><ul><li>è¾“å…¥å±‚ï¼š$x \in R^{3}$ï¼Œ$x$æ˜¯ä¸€ä¸ª$3$ç»´çš„ç‰¹å¾å‘é‡<ul><li>å½¢çŠ¶ï¼š(3, m)ï¼Œ$m$ä¸ºæ ·æœ¬æ•°</li></ul></li><li>éšè—å±‚å…·æœ‰4è¡Œ3åˆ—çš„æƒé‡çŸ©é˜µ$W^{[1]} \in R^{4 \times 3}$ï¼Œåç½®å‘é‡$b^{[1]} \in R^{4}$<ul><li>éšè—å±‚çš„æ¯ä¸ªç¥ç»å…ƒ$i$å…·æœ‰æƒé‡$W^{[1]}<em>{i} \in R^{3}$ï¼Œåç½®$b^{[1]}</em>{i} \in R$</li><li>å½¢çŠ¶ï¼šè¾“å…¥(3, m) * æƒé‡(4, 3) + åç½®(4, 1) = è¾“å‡º(4, m)</li></ul></li><li>è¾“å‡ºå±‚å…·æœ‰1è¡Œ4åˆ—çš„æƒé‡çŸ©é˜µ$W^{[2]} \in R^{1 \times 4}$ï¼Œåç½®$b^{[2]} \in R$<ul><li>å½¢çŠ¶ï¼šè¾“å…¥(4, m) * æƒé‡(1, 4) + åç½®(1, 1) = è¾“å‡º(1, m)</li></ul></li></ul><h3 id="1-3-2-å‰å‘ä¼ æ’­"><a href="#1-3-2-å‰å‘ä¼ æ’­" class="headerlink" title="1.3.2 å‰å‘ä¼ æ’­"></a>1.3.2 å‰å‘ä¼ æ’­</h3><script type="math/tex; mode=display">\begin{split}&Z^{[1]} = W^{[1]}X+b^{[1]} \\\\&A^{[1]} = tanh(Z^{[1]}) \\\\&Z^{[2]} = W^{[2]}A^{[1]}+b^{[2]} \\\\&A^{[2]} = \sigma(Z^{[2]})\end{split}</script><h3 id="1-3-3-åå‘ä¼ æ’­"><a href="#1-3-3-åå‘ä¼ æ’­" class="headerlink" title="1.3.3 åå‘ä¼ æ’­"></a>1.3.3 åå‘ä¼ æ’­</h3><p>è¾“å‡ºå±‚ä»¥Sigmoidå‡½æ•°ä½œä¸ºæ¿€æ´»å‡½æ•°ï¼Œæ ¹æ®<a href="#14-é€»è¾‘å›å½’çš„æ¢¯åº¦ä¸‹é™">é€»è¾‘å›å½’çš„æ¢¯åº¦ä¸‹é™</a>çš„æ¨å¯¼ï¼Œå¯ä»¥å¾—åˆ°ï¼š</p><script type="math/tex; mode=display">\begin{split}&dZ^{[2]} = A^{[2]}-Y \\\\&dW^{[2]} = \dfrac{1}{m}dZ^{[2]}A^{[1]T} \\\\&db^{[2]} = \dfrac{1}{m}np.sum(dZ^{[2]}, axis=1)\end{split}</script><p>éšè—å±‚ä»¥tanhå‡½æ•°ä½œä¸ºæ¿€æ´»å‡½æ•°ï¼Œå·²çŸ¥ï¼š</p><script type="math/tex; mode=display">\begin{split}&tanh'(t) = 1-tanh^2(t) \\\\&Z^{[1]} = W^{[1]}X+b^{[1]} \\\\&A^{[1]} = tanh(Z^{[1]}) \\\\&J(A^{[2]},Y) = -Y\log(A^{[2]})-(1-Y)\log(1-A^{[2]})\end{split}</script><p>æ ¹æ®é“¾å¼æ±‚å¯¼æ³•åˆ™ï¼ˆæ­¥éª¤ç•¥ï¼‰ï¼Œå¯ä»¥å¾—åˆ°ï¼š</p><script type="math/tex; mode=display">\begin{split}&dZ^{[1]} = \frac{\partial J}{\partial A^{[2]}} \cdot \frac{\partial A^{[2]}}{\partial Z^{[2]}} \cdot \frac{\partial Z^{[2]}}{\partial A^{[1]}} \cdot \frac{\partial A^{[1]}}{\partial Z^{[1]}} = W^{[2]T}dZ^{[2]} \cdot (1-A^{[1]2}) \\\\&dW^{[1]} = \dfrac{1}{m}dZ^{[1]}X^T \\\\&db^{[1]} = \dfrac{1}{m}np.sum(dZ^{[1]}, axis=1)\end{split}</script><h3 id="å®è·µï¼šæµ…å±‚ç¥ç»ç½‘ç»œå®ç°"><a href="#å®è·µï¼šæµ…å±‚ç¥ç»ç½‘ç»œå®ç°" class="headerlink" title="å®è·µï¼šæµ…å±‚ç¥ç»ç½‘ç»œå®ç°"></a>å®è·µï¼šæµ…å±‚ç¥ç»ç½‘ç»œå®ç°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">n = <span class="number">20</span>  <span class="comment"># ç‰¹å¾æ•°</span></span><br><span class="line">m = <span class="number">100</span>  <span class="comment"># æ ·æœ¬æ•°</span></span><br><span class="line">k = <span class="number">4</span>  <span class="comment"># éšè—å±‚ç¥ç»å…ƒæ•°</span></span><br><span class="line">alpha = <span class="number">0.001</span>  <span class="comment"># å­¦ä¹ ç‡</span></span><br><span class="line">iterations = <span class="number">1000</span>  <span class="comment"># è¿­ä»£æ¬¡æ•°</span></span><br><span class="line"></span><br><span class="line">X = np.random.randn(n, m)  <span class="comment"># ç”Ÿæˆç‰¹å¾çŸ©é˜µ</span></span><br><span class="line">Y = np.random.randint(<span class="number">0</span>, <span class="number">2</span>, [<span class="number">1</span>, m])  <span class="comment"># ç”Ÿæˆæ ‡ç­¾</span></span><br><span class="line"></span><br><span class="line">J = <span class="number">0</span>  <span class="comment"># æŸå¤±å‡½æ•°å€¼</span></span><br><span class="line"></span><br><span class="line"> éšè—å±‚æƒé‡å’Œåç½®</span><br><span class="line">W1 = np.random.randn(k, n) * <span class="number">0.01</span></span><br><span class="line">b1 = np.zeros([k, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"> è¾“å‡ºå±‚æƒé‡å’Œåç½®</span><br><span class="line">W2 = np.random.randn(<span class="number">1</span>, k) * <span class="number">0.01</span></span><br><span class="line">b2 = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sigmoid</span>(<span class="params">t</span>): <span class="comment"># Sigmoidå‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + np.exp(-t))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tanh</span>(<span class="params">t</span>): <span class="comment"># tanHå‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> (np.exp(t) - np.exp(-t)) / (np.exp(t) + np.exp(-t))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">log_loss</span>(<span class="params">A, Y</span>):  <span class="comment"># å¯¹æ•°æŸå¤±å‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span> / m * np.<span class="built_in">sum</span>(Y * np.log(A) + (<span class="number">1</span> - Y) * np.log(<span class="number">1</span> - A))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc_accuracy</span>(<span class="params">A, Y</span>):  <span class="comment"># è®¡ç®—å‡†ç¡®ç‡</span></span><br><span class="line">    A = np.where(A &gt; <span class="number">0.5</span>, <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> np.mean(A == Y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(iterations):</span><br><span class="line">    <span class="comment"># å‰å‘ä¼ æ’­</span></span><br><span class="line">    Z1 = np.dot(W1, X) + b1 <span class="comment"># [k, m]</span></span><br><span class="line">    A1 = tanh(Z1)  <span class="comment"># éšè—å±‚æ¿€æ´»å€¼ [k, m]</span></span><br><span class="line">    Z2 = np.dot(W2, A1) + b2 <span class="comment"># [1, m]</span></span><br><span class="line">    A2 = sigmoid(Z2)  <span class="comment"># è¾“å‡ºå±‚æ¿€æ´»å€¼ï¼ˆé¢„æµ‹ï¼‰ [1, m]</span></span><br><span class="line">    J = log_loss(A2, Y)  <span class="comment"># è®¡ç®—æŸå¤±å‡½æ•°å€¼ </span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># åå‘ä¼ æ’­</span></span><br><span class="line">    <span class="comment"># è¾“å‡ºå±‚</span></span><br><span class="line">    dZ2 = A2 - Y <span class="comment"># [1, m]</span></span><br><span class="line">    dW2 = <span class="number">1</span> / m * np.dot(dZ2, A1.T) <span class="comment"># [1, k]</span></span><br><span class="line">    db2 = <span class="number">1</span> / m * np.<span class="built_in">sum</span>(dZ2) <span class="comment"># [1, 1]</span></span><br><span class="line">    <span class="comment"># éšè—å±‚</span></span><br><span class="line">    dZ1 = np.dot(W2.T, dZ2) * (<span class="number">1</span> - A1 ** <span class="number">2</span>)</span><br><span class="line">    dW1 = <span class="number">1</span> / m * np.dot(dZ1, X.T)</span><br><span class="line">    db1 = <span class="number">1</span> / m * np.<span class="built_in">sum</span>(dZ1)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ›´æ–°æƒé‡å’Œåç½®</span></span><br><span class="line">    W1 = W1 - alpha * dW1</span><br><span class="line">    b1 = b1 - alpha * db1</span><br><span class="line">    W2 = W2 - alpha * dW2</span><br><span class="line">    b2 = b2 - alpha * db2</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Loss:&quot;</span>, J)  <span class="comment"># æ‰“å°æŸå¤±å‡½æ•°å€¼</span></span><br><span class="line"></span><br><span class="line"> è®­ç»ƒé›†ä¸Šçš„å‡†ç¡®ç‡</span><br><span class="line">Z1 = np.dot(W1, X) + b1</span><br><span class="line">A1 = tanh(Z1)</span><br><span class="line">Z2 = np.dot(W2, A1) + b2</span><br><span class="line">A2 = <span class="number">1</span> / (<span class="number">1</span> + np.exp(-Z2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Accuracy:&quot;</span>, calc_accuracy(A2, Y))</span><br></pre></td></tr></table></figure><h2 id="1-4-æ·±å±‚ç¥ç»ç½‘ç»œ"><a href="#1-4-æ·±å±‚ç¥ç»ç½‘ç»œ" class="headerlink" title="1.4 æ·±å±‚ç¥ç»ç½‘ç»œ"></a>1.4 æ·±å±‚ç¥ç»ç½‘ç»œ</h2><h3 id="1-4-1-æ·±å±‚ç¥ç»ç½‘ç»œ"><a href="#1-4-1-æ·±å±‚ç¥ç»ç½‘ç»œ" class="headerlink" title="1.4.1 æ·±å±‚ç¥ç»ç½‘ç»œ"></a>1.4.1 æ·±å±‚ç¥ç»ç½‘ç»œ</h3><p>ä¸ºä»€ä¹ˆéœ€è¦æ·±å±‚ç¥ç»ç½‘ç»œï¼š</p><ul><li>ç¥ç»ç½‘ç»œä»ç¬¬ä¸€å±‚å¼€å§‹ï¼Œä»åŸå§‹æ•°æ®ä¸­æå–ç‰¹å¾</li><li>ä¸‹ä¸€å±‚å°†ä¸Šä¸€å±‚ä¹ å¾—çš„ä¿¡æ¯ç»„åˆèµ·æ¥ï¼Œå½¢æˆæ›´é«˜çº§çš„ç‰¹å¾</li><li>éšç€å±‚æ•°å¢å¤šï¼Œç‰¹å¾ä»ç®€å•åˆ°å¤æ‚ï¼Œå­¦ä¹ çš„èƒ½åŠ›æ›´å¼º</li></ul><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/æ·±å±‚ç¥ç»ç½‘ç»œ.png" alt="æ·±å±‚ç¥ç»ç½‘ç»œ"> </p><h3 id="1-4-2-å‰å‘ä¼ æ’­"><a href="#1-4-2-å‰å‘ä¼ æ’­" class="headerlink" title="1.4.2 å‰å‘ä¼ æ’­"></a>1.4.2 å‰å‘ä¼ æ’­</h3><script type="math/tex; mode=display">\begin{split}&x=a^{[0]} \\\\&z^{[L]}=W^{[L]}a^{[L-1]}+b^{[L]} \\\\&a^{[L]}=g^{[L]}(z^{[L]})\end{split}</script><p>è¾“å…¥$a^{[L-1]}$ï¼Œè¾“å‡º$a^{[L]}$</p><h3 id="1-4-3-åå‘ä¼ æ’­"><a href="#1-4-3-åå‘ä¼ æ’­" class="headerlink" title="1.4.3 åå‘ä¼ æ’­"></a>1.4.3 åå‘ä¼ æ’­</h3><p><img src="https://source.cclmsy.cc/Images/Posts/Deep_Learning/æ·±å±‚ç¥ç»ç½‘ç»œåå‘ä¼ æ’­.png" alt="æ·±å±‚ç¥ç»ç½‘ç»œåå‘ä¼ æ’­"></p><script type="math/tex; mode=display">\begin{split}&dZ^{[L]} = \frac{\partial J}{\partial A^{[L]}} \cdot \frac{\partial A^{[L]}}{\partial Z^{[L]}} = dA^{[L]} \cdot g^{[L]'}(Z^{[L]}) \\\\&dW^{[L]} = \frac{\partial J}{\partial Z^{[L]}} \cdot \frac{\partial Z^{[L]}}{\partial W^{[L]}} = \frac{1}{m}dZ^{[L]}A^{[L-1]T} \\\\&db^{[L]} = \frac{1}{m}np.sum(dZ^{[L]}, axis=1) \\\\&dA^{[L]} = W^{[L+1]T}dZ^{[L+1]}\end{split}</script><h3 id="1-4-4-å‚æ•°å’Œè¶…å‚æ•°"><a href="#1-4-4-å‚æ•°å’Œè¶…å‚æ•°" class="headerlink" title="1.4.4 å‚æ•°å’Œè¶…å‚æ•°"></a>1.4.4 å‚æ•°å’Œè¶…å‚æ•°</h3><p>å‚æ•°ï¼ˆParametersï¼‰ï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¸Œæœ›æ¨¡å‹å­¦ä¹ åˆ°çš„ä¿¡æ¯ï¼Œæ¨¡å‹è‡ªå·±è°ƒæ•´çš„å‚æ•°</p><ul><li>æƒé‡Wé€šå¸¸ä½¿ç”¨éšæœºåˆå§‹åŒ–ï¼Œé¿å…å¯¹ç§°æ€§ï¼Œ$randn*0.01$<ul><li>å¯¹ç§°æ€§ï¼šå¦‚æœæ‰€æœ‰çš„ç¥ç»å…ƒéƒ½å…·æœ‰ç›¸åŒçš„æƒé‡ï¼Œé‚£ä¹ˆåœ¨åå‘ä¼ æ’­è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰çš„ç¥ç»å…ƒéƒ½ä¼šå­¦ä¹ åˆ°ç›¸åŒçš„ç‰¹å¾</li><li>ä¹˜ç³»æ•°0.01ï¼šä½¿ç”¨Sigmoidå‡½æ•°æˆ–è€…tanHå‡½æ•°ä½œä¸ºæ¿€æ´»å‡½æ•°æ—¶ï¼ŒWæ¯”è¾ƒå°ï¼Œåˆ™Z=WX+bæ‰€å¾—çš„å€¼è¶‹è¿‘äº0ï¼Œæ¢¯åº¦è¾ƒå¤§ï¼Œèƒ½å¤Ÿæé«˜ç®—æ³•çš„æ›´æ–°é€Ÿåº¦ï¼›ReLUå‡½æ•°åˆ™æ²¡æœ‰è¿™ä¸ªé—®é¢˜</li></ul></li><li>åç½®bæ²¡æœ‰å¯¹ç§°æ€§é—®é¢˜ï¼Œé€šå¸¸åˆå§‹åŒ–ä¸º0</li></ul><p>è¶…å‚æ•°ï¼ˆHyper parametersï¼‰ï¼šé€šè¿‡äººçš„ç»éªŒåˆ¤æ–­ã€æ‰‹åŠ¨è°ƒæ•´çš„ç½‘ç»œä¿¡æ¯ï¼Œä¼šå½±å“æœ€ç»ˆçš„å‚æ•°</p><ul><li>å…¸å‹çš„è¶…å‚æ•°ï¼šå­¦ä¹ é€Ÿç‡$\alpha$ã€è¿­ä»£æ¬¡æ•°$N$ã€éšè—å±‚æ•°$L$ã€æ¯å±‚ç¥ç»å…ƒæ•°$n_i$ã€æ¿€æ´»å‡½æ•°$g^{[i]}()$çš„é€‰æ‹©</li><li>å¼€å‘æ–°åº”ç”¨æ—¶ï¼Œå¾ˆéš¾é¢„å…ˆå‡†ç¡®çŸ¥é“æœ€ä½³çš„è¶…å‚æ•°ï¼Œéœ€è¦é€šè¿‡ä¸åŒçš„å°è¯•å’Œè°ƒæ•´æ¥æ‰¾åˆ°æœ€ä½³çš„è¶…å‚æ•°</li></ul>]]></content>
    
    
    <summary type="html">ä»é€»è¾‘å›å½’åˆ°æ·±å±‚ç¥ç»ç½‘ç»œ</summary>
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://www.cclmsy.cc/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šè®¡ç®—æœºç½‘ç»œä¸é€šä¿¡ã€‹è¯¾ç¨‹ç¬”è®°</title>
    <link href="https://www.cclmsy.cc/posts/Computer_Networks_and_Communications.html"/>
    <id>https://www.cclmsy.cc/posts/Computer_Networks_and_Communications.html</id>
    <published>2025-01-05T15:00:00.000Z</published>
    <updated>2025-01-04T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h2><p>å› ç‰¹ç½‘æœåŠ¡æä¾›è€… ISP(Internet Service Provider)</p><p>ARPANETï¼šæœ€æ—©çš„å› ç‰¹ç½‘ï¼Œ1969å¹´ï¼Œä½¿ç”¨åˆ†ç»„äº¤æ¢æŠ€æœ¯ï¼Œåæ¥TCP/IPåè®®æˆä¸ºæ ‡å‡†åè®®</p><p>äº’è”ç½‘çš„ç»„æˆï¼šè¾¹ç¼˜ï¼ˆç”¨æˆ·ï¼‰+æ ¸å¿ƒï¼ˆè·¯ç”±å™¨ã€é“¾è·¯ï¼‰</p><p>ä¸¤ç§é€šä¿¡æ–¹å¼ï¼šå®¢æˆ·-æœåŠ¡å™¨æ–¹å¼ C/S(Client/Server)ã€å¯¹ç­‰æ–¹å¼ P2P(Peer-to-Peer)</p><p>ä¸‰ç§äº¤æ¢æ–¹å¼ï¼šç”µè·¯äº¤æ¢ã€åˆ†ç»„äº¤æ¢ã€æŠ¥æ–‡äº¤æ¢</p><ul><li>ç”µè·¯äº¤æ¢ï¼šé¢å‘è¿æ¥<ul><li>ä¸‰é˜¶æ®µï¼šå»ºç«‹è¿æ¥ã€é€šä¿¡ã€é‡Šæ”¾è¿æ¥</li></ul></li><li>åˆ†ç»„äº¤æ¢<ul><li>å¯ä»¥æ— è¿æ¥ä¹Ÿå¯ä»¥é¢å‘è¿æ¥</li><li>åˆ’åˆ†æˆè¾ƒçŸ­çš„ã€å›ºå®šé•¿åº¦çš„æ•°æ®æ®µ</li><li>å­˜å‚¨è½¬å‘</li></ul></li><li>æŠ¥æ–‡äº¤æ¢<ul><li>å­˜å‚¨è½¬å‘ä¼ è¾“æ•´ä¸ªæŠ¥æ–‡</li></ul></li></ul><p>æ—¶å»¶=ä¼ è¾“æ—¶å»¶+å¤„ç†æ—¶å»¶+æ’é˜Ÿæ—¶å»¶+ä¼ æ’­æ—¶å»¶</p><ul><li>å‘é€æ—¶å»¶ï¼šæ•°æ®å—é•¿åº¦/å‘é€é€Ÿç‡</li><li>å¤„ç†æ—¶å»¶ï¼šäº¤æ¢ç»“ç‚¹ä¸ºå­˜å‚¨è½¬å‘è€Œè¿›è¡Œä¸€äº›å¿…è¦çš„å¤„ç†æ‰€èŠ±è´¹çš„æ—¶é—´</li><li>æ’é˜Ÿæ—¶å»¶ï¼šç»“ç‚¹ç¼“å­˜é˜Ÿåˆ—ä¸­åˆ†ç»„æ’é˜Ÿæ‰€ç»å†çš„æ—¶å»¶</li><li>ä¼ æ’­æ—¶å»¶ï¼šä¿¡å·åœ¨ä¼ è¾“åª’ä½“ä¸Šä¼ æ’­æ‰€éœ€çš„æ—¶é—´ï¼ˆå–å†³äºä¿¡é“è·ç¦»ï¼‰<ul><li>ä¼ è¾“é€Ÿç‡å¯ä»¥æé«˜ï¼Œä½†ä¼ æ’­é€Ÿç‡æ˜¯ç‰©ç†ç‰¹æ€§å†³å®šçš„</li></ul></li></ul><p>æ—¶å»¶å¸¦å®½ç§¯ï¼šä¼ æ’­æ—¶å»¶ä¸å¸¦å®½çš„ä¹˜ç§¯ï¼Œé“¾è·¯ä¸Šæœ€å¤§çš„æ¯”ç‰¹æ•°é‡</p><p>ä¿¡é“åˆ©ç”¨ç‡ï¼šä¿¡é“è¢«åˆ©ç”¨çš„æ—¶é—´å æ¯”ï¼Œéè¶Šé«˜è¶Šå¥½</p><p>ç½‘ç»œåˆ©ç”¨ç‡Uï¼šä¿¡é“åˆ©ç”¨ç‡åŠ æƒå¹³å‡å€¼</p><p>$å½“å‰æ—¶å»¶D=\dfrac{ç©ºé—²æ—¶å»¶D_0}{1-U}$</p><p>ç½‘ç»œåè®®ä¸‰è¦ç´ ï¼šè¯­æ³•ã€è¯­ä¹‰ã€æ—¶åº</p><p>å®ä½“(Entity)ï¼šä»»ä½•å¯å‘é€æˆ–æ¥æ”¶ä¿¡æ¯çš„ç¡¬ä»¶æˆ–è½¯ä»¶è¿›ç¨‹</p><p>åè®®(Protocol)ï¼šæ§åˆ¶å¯¹ç­‰å®ä½“ä¹‹é—´çš„é€šä¿¡çš„è§„åˆ™é›†</p><p>ç¬¬nå±‚åè®®å‘ç¬¬n+1å±‚æä¾›æœåŠ¡ï¼Œæ˜¯ç¬¬n-1å±‚çš„ç”¨æˆ·</p><h3 id="OSI-TCP-IP"><a href="#OSI-TCP-IP" class="headerlink" title="OSI/TCP-IP"></a>OSI/TCP-IP</h3><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/1_1.png" alt="OSIå’ŒTCP/IP"></p><h2 id="äºŒã€ç‰©ç†å±‚"><a href="#äºŒã€ç‰©ç†å±‚" class="headerlink" title="äºŒã€ç‰©ç†å±‚"></a>äºŒã€ç‰©ç†å±‚</h2><p>ä¸»è¦ä»»åŠ¡ï¼šç¡®å®šä¸ä¼ è¾“åª’ä½“çš„æ¥å£çš„ä¸€äº›ç‰¹æ€§ï¼ŒåŒ…æ‹¬ï¼šæœºæ¢°ç‰¹æ€§ã€ç”µæ°”ç‰¹æ€§ã€åŠŸèƒ½ç‰¹æ€§ã€è¿‡ç¨‹ç‰¹æ€§</p><p>æ•°æ®é€šä¿¡ç³»ç»Ÿå¯åˆ’åˆ†ä¸ºä¸‰å¤§éƒ¨åˆ†ï¼šæºç³»ç»Ÿ(å‘é€ç«¯)ã€ä¼ è¾“ç³»ç»Ÿ(ä¼ è¾“ç½‘ç»œ)ã€ç›®çš„ç³»ç»Ÿ(æ¥æ”¶ç«¯)ã€‚</p><p>ä¿¡é“(channel)åˆ†ç±»ï¼šå•å·¥é€šä¿¡ï¼ˆåªèƒ½å•å‘ä¼ è¾“ï¼‰ã€åŠåŒå·¥é€šä¿¡ï¼ˆåŒå‘ä¼ è¾“ä½†ä¸èƒ½åŒæ—¶ï¼‰ã€å…¨åŒå·¥é€šä¿¡ï¼ˆåŒå‘ä¼ è¾“ä¸”å¯ä»¥åŒæ—¶ï¼‰</p><p>å¯¼å¼•å‹ä¼ è¾“åª’ä½“ï¼šåŒç»çº¿ã€åŒè½´ç”µç¼†ã€å…‰çº¤</p><p>éå¯¼å¼•å‹ä¼ è¾“åª’ä½“ï¼šæ— çº¿ç”µæ³¢ã€å¾®æ³¢ã€çº¢å¤–çº¿</p><p>å®½å¸¦æ¥å…¥æŠ€æœ¯ï¼šéå¯¹ç§°æ•°å­—ç”¨æˆ·çº¿ADSL(Asymmetric Digital Subscriber Line)ã€å…‰çº¤åŒè½´æ··åˆç½‘HFC(Hybrid Fiber Coax)ã€å…‰çº¤åˆ°â€¦FTTx(Fiber To The x)</p><h3 id="2-1-è°ƒåˆ¶"><a href="#2-1-è°ƒåˆ¶" class="headerlink" title="2.1 è°ƒåˆ¶"></a>2.1 è°ƒåˆ¶</h3><p>åŸºæœ¬å¸¦é€šè°ƒåˆ¶æ–¹å¼ï¼šè°ƒå¹…AMã€è°ƒé¢‘FMã€è°ƒç›¸PM</p><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/2_2.png" alt="åŸºæœ¬å¸¦é€šè°ƒåˆ¶æ–¹å¼"></p><p>ä¸€ç§å¤šå…ƒåˆ¶çš„æŒ¯å¹…ç›¸ä½æ··åˆè°ƒåˆ¶æ–¹æ³•ï¼šæ­£äº¤æŒ¯å¹…è°ƒåˆ¶(Quadrature Amplitude Modulationï¼ŒQAM)</p><ul><li>å¯ä¾›é€‰æ‹©çš„ç›¸ä½æœ‰12ç§ï¼Œè€Œå¯¹äºæ¯ä¸€ç§ç›¸ä½æœ‰1æˆ–2ç§æŒ¯å¹…å¯ä¾›é€‰æ‹©ã€‚</li><li>å…±æœ‰16ç§ä¸åŒçš„ç»„åˆï¼Œæ¯ç§ç»„åˆå¯ä»¥ç”¨4bitäºŒè¿›åˆ¶æ•°è¡¨ç¤ºï¼Œå› æ­¤è¿™16ä¸ªç‚¹ä¸­çš„æ¯ä¸ªç‚¹å¯å¯¹åº”äºä¸€ç§4bitçš„ç¼–ç ã€‚</li></ul><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/2_3.png" alt="æ­£äº¤æŒ¯å¹…è°ƒåˆ¶">ã€</p><h3 id="2-2-ä¿¡é“æé™å®¹é‡"><a href="#2-2-ä¿¡é“æé™å®¹é‡" class="headerlink" title="2.2 ä¿¡é“æé™å®¹é‡"></a>2.2 ä¿¡é“æé™å®¹é‡</h3><p>å¥ˆæ°å‡†åˆ™-å¥ˆå¥æ–¯ç‰¹ï¼šåœ¨å¸¦å®½ä¸ºW(Hz)çš„ä½é€šä¿¡é“ä¸­ï¼Œè‹¥ä¸è€ƒè™‘å™ªå£°å½±å“ï¼Œåˆ™ç å…ƒä¼ è¾“çš„æœ€é«˜é€Ÿç‡æ˜¯2W(ç å…ƒ/ç§’ æ³¢ç‰¹Baud)</p><p>ä¿¡å™ªæ¯”(Signal-to-Noise Ratio, SNR)ï¼šä¿¡å·åŠŸç‡ä¸å™ªå£°åŠŸç‡ä¹‹æ¯”</p><p>$SNR=10\log_{10}(\dfrac{S}{N})$(å•ä½ï¼šdB)</p><p>é¦™å†œå®šç†ï¼š$C=W\log_2(1+\dfrac{S}{N})$(å•ä½ï¼šbps)</p><p>Wä¸ºä¿¡é“çš„å¸¦å®½(Hz)ï¼ŒSä¸ºä¿¡é“å†…æ‰€ä¼ ä¿¡å·çš„å¹³å‡åŠŸç‡(æ•°æ®ä¼ è¾“é€Ÿç‡=ç å…ƒä¼ è¾“é€Ÿç‡*ç å…ƒæºå¸¦çš„æ¯”ç‰¹æ•°)ï¼ŒNä¸ºä¿¡é“å†…éƒ¨çš„é«˜æ–¯å™ªå£°åŠŸç‡</p><h4 id="ä¿¡é“æé™å®¹é‡ä¾‹é¢˜"><a href="#ä¿¡é“æé™å®¹é‡ä¾‹é¢˜" class="headerlink" title="ä¿¡é“æé™å®¹é‡ä¾‹é¢˜"></a>ä¿¡é“æé™å®¹é‡ä¾‹é¢˜</h4><ol><li>ä¿¡é“å¸¦å®½ä¸º3000Hzï¼Œä¿¡å™ªæ¯”ä¸º30dBï¼Œåˆ™æœ€å¤§æ•°æ®é€Ÿç‡ä¸ºå¤šå°‘ï¼Ÿ<ul><li>æ ¹æ®ä¿¡å™ªæ¯”å…¬å¼ï¼Œ$SNR=10log_{10}(\frac{S}{N})=30dB \Rightarrow \frac{S}{N}=10^3$</li><li>æ ¹æ®é¦™å†œå…¬å¼ï¼Œ$C=W\log_2(1+\frac{S}{N})=3000\log_2(1+10^3) \approx 3000\times9.97 \approx 30000bps$</li></ul></li><li>ä¸‹åˆ—å› ç´ ä¸­,ä¸ä¼šå½±å“ä¿¡é“æ•°æ®ä¼ è¾“ç‡çš„æ˜¯( )<ul><li>A. ä¿¡å™ªæ¯” B. é¢‘ç‡å®½å¸¦ C. è°ƒåˆ¶é€Ÿç‡ D. ä¿¡å·ä¼ æ’­é€Ÿåº¦</li><li>Aï¼š$\frac{S}{N}$, Bï¼šW, Cï¼šSçš„å› å­, Dï¼šä¸å½±å“</li></ul></li><li>è‹¥ä¿¡é“åœ¨æ— å™ªå£°æƒ…å†µä¸‹çš„æé™æ•°æ®ä¼ è¾“é€Ÿç‡ä¸å°äºä¿¡å™ªæ¯”ä¸º30dBæ¡ä»¶ä¸‹çš„æé™æ•°æ®ä¼ è¾“é€Ÿç‡ï¼Œåˆ™ä¿¡å·çŠ¶æ€æ•°è‡³å°‘æ˜¯ï¼Ÿ<ul><li>è®°ä¿¡é“å¸¦å®½ä¸ºWï¼Œä¸€ä¸ªç å…ƒæ‰€å ä½æ•°kã€‚</li><li>æ ¹æ®ä¿¡å™ªæ¯”å…¬å¼ï¼Œ$SNR=10log_{10}(\frac{S}{N})=30dB \Rightarrow \frac{S}{N}=10^3$</li><li>æ ¹æ®å¥ˆæ°å‡†åˆ™å’Œé¦™å†œå…¬å¼ï¼š$2W\times k \ge W\log_2(1+10^3) \Rightarrow 2k \ge \log_2(1+10^3)\approx 10 \Rightarrow k \ge 5$</li><li>çŠ¶æ€æ•°è‡³å°‘æ˜¯$2^5=32$</li></ul></li></ol><h3 id="2-3-ä¿¡é“å¤ç”¨æŠ€æœ¯"><a href="#2-3-ä¿¡é“å¤ç”¨æŠ€æœ¯" class="headerlink" title="2.3 ä¿¡é“å¤ç”¨æŠ€æœ¯"></a>2.3 ä¿¡é“å¤ç”¨æŠ€æœ¯</h3><ul><li>å¤ç”¨å™¨(multiplexer)ï¼šå¤ç”¨å¼€å§‹å‰ï¼Œå¤šä¸ªä½é€Ÿä¿¡é“åˆæˆä¸€ä¸ªé«˜é€Ÿä¿¡é“çš„è®¾å¤‡</li><li>åˆ†ç”¨å™¨(de-multiplexer)ï¼šå¤ç”¨ç»“æŸåï¼Œå°†é«˜é€Ÿä¿¡é“åˆ†è§£ä¸ºå¤šä¸ªä½é€Ÿä¿¡é“çš„è®¾å¤‡</li></ul><p><strong>é¢‘åˆ†å¤ç”¨FDM</strong>(Frequency Division Multiplexing)ï¼šå°†é¢‘å¸¦åˆ†æˆè‹¥å¹²çª„å¸¦ï¼Œå„è·¯ä¿¡å·åˆ†åˆ«æ¬ç§»åˆ°é€‚å½“çš„é¢‘ç‡ä½ç½®ï¼Œå½¼æ­¤äº’ä¸å¹²æ‰°ã€‚<br>é¢‘åˆ†å¤ç”¨çš„æ‰€æœ‰ç”¨æˆ·åœ¨åŒæ ·çš„æ—¶é—´å ç”¨ä¸åŒçš„å¸¦å®½èµ„æºï¼Œè¿™é‡Œçš„â€œå¸¦å®½â€æ˜¯é¢‘ç‡å¸¦å®½è€Œä¸æ˜¯æ•°æ®çš„å‘é€é€Ÿç‡ã€‚</p><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/2_4.png" alt="é¢‘åˆ†å¤ç”¨"></p><p><strong>æ—¶åˆ†å¤ç”¨TDM</strong>(Time Division Multiplexing)ï¼šå°†æ—¶é—´åˆ†æˆè‹¥å¹²æ—¶éš™ï¼Œæ¯ä¸ªæ—¶éš™ç”¨æ¥ä¼ è¾“ä¸€ä¸ªä¿¡å·ï¼Œç„¶åæŠŠè¿™äº›æ—¶éš™ä¿¡å·å åŠ åœ¨ä¸€èµ·ä¼ è¾“ã€‚<br>æ—¶åˆ†å¤ç”¨å¯èƒ½ä¼šé€ æˆçº¿è·¯èµ„æºçš„æµªè´¹ï¼Œè§£å†³æ–¹æ³•ï¼šç»Ÿè®¡æ—¶åˆ†å¤ç”¨STDMï¼ˆStatistical TDMï¼‰</p><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/2_5.png" alt="æ—¶åˆ†å¤ç”¨"></p><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/2_6.png" alt="æ—¶åˆ†å¤ç”¨å¯èƒ½ä¼šé€ æˆçº¿è·¯èµ„æºçš„æµªè´¹"></p><p><strong>æ³¢åˆ†å¤ç”¨WDM</strong>(Wavelength Division Multiplexing)ï¼šå…‰çš„é¢‘åˆ†å¤ç”¨ï¼Œä½¿ç”¨ä¸€æ ¹å…‰çº¤æ¥åŒæ—¶ä¼ è¾“å¤šä¸ªå…‰è½½æ³¢ä¿¡å·ã€‚</p><p><strong>ç åˆ†å¤šå€CDMA</strong>(Code Division Multiple Access)ï¼šå¤šä¸ªä¸åŒåœ°å€çš„ç”¨æˆ·å…±äº«ç åˆ†å¤ç”¨(CDM, Code Division Multiplexing)ä¿¡é“ã€‚</p><p>ç ç‰‡(chip)ï¼šæ¯ä¸€ä¸ªæ¯”ç‰¹æ—¶é—´åˆ’åˆ†ä¸ºmä¸ªçŸ­çš„é—´éš”ï¼Œç§°ä¸º</p><p>ç ç‰‡åºåˆ—ï¼šæ¯ä¸ªç«™è¢«æŒ‡æ´¾ä¸€ä¸ªå”¯ä¸€çš„m bitç ç‰‡åºåˆ—</p><p>ä»¥$S=00011011, T=00101110$ä¸ºä¾‹</p><ul><li>Så‘é€1ï¼šå‘é€ç ç‰‡åºåˆ—$S=00011011$</li><li>Så‘é€0ï¼šå‘é€ç ç‰‡åºåˆ—çš„åç $S_x=11100100$</li><li>æŒ‰ç…§æƒ¯ä¾‹ï¼Œ1è®°ä¸º+1ï¼Œ0è®°ä¸º-1ï¼Œç ç‰‡åºåˆ—Sä¸º-1 -1 -1 +1 +1 -1 +1 +1</li><li>ç ç‰‡ç‰¹ç‚¹ï¼š<ul><li>è§„æ ¼åŒ–å†…ç§¯$S\cdot S=\frac{1}{m}\sum_{i=1}^{m}S_iS_i=1$</li><li>è§„æ ¼åŒ–å†…ç§¯$S\cdot S<em>x=\frac{1}{m}\sum</em>{i=1}^{m}S<em>iS</em>{xi}=-1$</li></ul></li></ul><p>CDMAçš„é‡è¦ç‰¹ç‚¹</p><ul><li>æ¯ä¸ªç«™åˆ†é…çš„ç ç‰‡åºåˆ—ä¸ä»…å¿…é¡»å„ä¸ç›¸åŒï¼Œå¹¶ä¸”è¿˜å¿…é¡»äº’ç›¸æ­£äº¤(è§„æ ¼åŒ–å†…ç§¯ä¸º0)<ul><li>Så’ŒTæ­£äº¤ï¼š$S\cdot T=\frac{1}{m}\sum_{i=1}^{m}S_iT_i=0$</li></ul></li><li>åœ¨å®ç”¨çš„ç³»ç»Ÿä¸­æ˜¯ä½¿ç”¨ä¼ªéšæœºç åºåˆ—</li></ul><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/2_7.png" alt="ç åˆ†å¤ç”¨"></p><h2 id="ä¸‰ã€æ•°æ®é“¾è·¯å±‚"><a href="#ä¸‰ã€æ•°æ®é“¾è·¯å±‚" class="headerlink" title="ä¸‰ã€æ•°æ®é“¾è·¯å±‚"></a>ä¸‰ã€æ•°æ®é“¾è·¯å±‚</h2><p>æ•°æ®é“¾è·¯(data link)ï¼šé™¤äº†ç‰©ç†çº¿è·¯å¤–ï¼Œè¿˜å¿…é¡»æœ‰é€šä¿¡åè®®æ¥æ§åˆ¶è¿™äº›æ•°æ®çš„ä¼ è¾“ã€‚<br>æ•°æ®é“¾è·¯ç”±ç‰©ç†é“¾è·¯å’Œå®ç°è¿™äº›åè®®çš„ç¡¬ä»¶å’Œè½¯ä»¶æ„æˆã€‚</p><p>æ•°æ®é“¾è·¯å±‚ä½¿ç”¨çš„ä¿¡é“ï¼šç‚¹å¯¹ç‚¹ä¿¡é“ã€å¹¿æ’­ä¿¡é“</p><p>æ•°æ®é“¾è·¯å±‚çš„ä¸‰ä¸ªåŸºæœ¬é—®é¢˜ï¼šå°è£…æˆå¸§ã€é€æ˜ä¼ è¾“ã€å·®é”™æ£€æµ‹</p><ol><li>å°è£…æˆå¸§ï¼šåœ¨ä¸€æ®µæ•°æ®çš„å‰ååˆ†åˆ«æ·»åŠ é¦–éƒ¨å’Œå°¾éƒ¨ï¼Œç„¶åå°±æ„æˆäº†ä¸€ä¸ªå¸§ï¼Œç¡®å®šå¸§çš„ç•Œé™ã€‚</li><li>é€æ˜ä¼ è¾“ï¼šä½¿æ•°æ®é“¾è·¯å±‚çš„åè®®å¯¹ä¸Šå±‚æ˜¯é€æ˜çš„ï¼Œç½‘ç»œå±‚ä¸å¿…å…³å¿ƒæ•°æ®é“¾è·¯å±‚çš„å…·ä½“å®ç°ã€‚</li><li>å·®é”™æ£€æµ‹ï¼šåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å¯èƒ½ä¼šäº§ç”Ÿæ¯”ç‰¹å·®é”™ï¼Œä¸ºäº†ä¿è¯æ•°æ®ä¼ è¾“çš„å¯é æ€§ï¼Œåœ¨è®¡ç®—æœºç½‘ç»œä¼ è¾“æ•°æ®æ—¶ï¼Œå¿…é¡»é‡‡ç”¨å„ç§å·®é”™æ£€æµ‹æªæ–½</li></ol><p>ä½¿ç”¨è½½æ³¢ç›‘å¬å¤šç‚¹æ¥å…¥/ç¢°æ’æ£€æµ‹åè®®CSMA/CDçš„ä»¥å¤ªç½‘ä¸èƒ½è¿›è¡Œå…¨åŒå·¥é€šä¿¡è€Œåªèƒ½è¿›è¡ŒåŒå‘äº¤æ›¿é€šä¿¡(åŠåŒå·¥é€šä¿¡)</p><ul><li>å¤šç‚¹æ¥å…¥CSMAï¼šè®¸å¤šè®¡ç®—æœºä»¥å¤šç‚¹æ¥å…¥çš„æ–¹å¼è¿æ¥åœ¨ä¸€æ ¹æ€»çº¿ä¸Š</li><li>ç¢°æ’æ£€æµ‹CDï¼šæ¯ä¸€ä¸ªç«™åœ¨å‘é€æ•°æ®ä¹‹å‰å…ˆè¦æ£€æµ‹ä¸€ä¸‹æ€»çº¿ä¸Šæ˜¯å¦æœ‰å…¶ä»–è®¡ç®—æœºåœ¨å‘é€æ•°æ®ï¼Œå¦‚æœæœ‰ï¼Œåˆ™æš‚æ—¶ä¸è¦å‘é€æ•°æ®ï¼Œä»¥å…å‘ç”Ÿç¢°æ’</li></ul><h3 id="3-1-å¾ªç¯å†—ä½™æ ¡éªŒCRC"><a href="#3-1-å¾ªç¯å†—ä½™æ ¡éªŒCRC" class="headerlink" title="3.1 å¾ªç¯å†—ä½™æ ¡éªŒCRC"></a>3.1 å¾ªç¯å†—ä½™æ ¡éªŒCRC</h3><p>å¾ªç¯å†—ä½™æ ¡éªŒCRC(Cyclic Redundancy Check)æ˜¯ä¸€ç§å·®é”™æ£€æµ‹æ–¹æ³•ï¼Œé€šè¿‡åœ¨æ•°æ®æœ«ç«¯æ·»åŠ å†—ä½™ä½ï¼Œç¡®å®šæ•°æ®æ˜¯å¦åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å‘ç”Ÿå˜åŒ–ã€‚</p><p>æ¨¡äºŒè¿ç®—ï¼šä¸€ç§ä¸è€ƒè™‘è¿›ä½çš„äºŒè¿›åˆ¶æŒ‰ä½è¿ç®—ã€‚</p><ul><li>åŠ æ³•/å‡æ³•ï¼šç›¸åŠ å‡è€Œä¸è€ƒè™‘è¿›ä½/å€Ÿä½ï¼Œå³äºŒè¿›åˆ¶æŒ‰ä½å¼‚æˆ–è¿ç®—</li><li>ä¹˜æ³•ï¼šåˆ—ç«–å¼ï¼Œé€ä½ç›¸ä¹˜ï¼ŒæŒ‰ä½å¼‚æˆ–</li><li>é™¤æ³•ï¼šåˆ—ç«–å¼ï¼Œå•†ä¸Šä½™æ•°çš„é¦–ä½ï¼ŒæŒ‰ä½ç›¸å‡</li></ul><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/3_2.png" alt="æ¨¡äºŒä¹˜æ³•"><br><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/3_3.png" alt="æ¨¡äºŒé™¤æ³•"></p><p>CRCå†—ä½™ç çš„è®¡ç®—å’Œæ ¡éªŒï¼š</p><ol><li>åŸå§‹äºŒè¿›åˆ¶æ•°æ®$M=1100$</li><li>å°†åŸå§‹æ•°æ®å·¦ç§»$r=3$ä½ï¼ˆå†—ä½™ä½ä½æ•°ï¼‰å¾—åˆ°$M\times 2^r=1100|000$</li><li>çº¦å®šä¸€ä¸ª$r+1=4$ä½ç”Ÿæˆå¤šé¡¹å¼$G=1011$ä½œä¸ºé™¤æ•°<ul><li>ç”Ÿæˆå¤šé¡¹å¼çš„æœ€é«˜ä½å’Œæœ€ä½ä½éƒ½å¿…é¡»æ˜¯1</li><li>å½“ä¼ è¾“çš„æ•°æ®Xçš„ä»»ä½•ä¸€ä½å‘ç”Ÿé”™è¯¯æ—¶ï¼Œè¢«Gé™¤çš„ä½™æ•°ä¸ä¸º0</li><li>æ•°æ®Xçš„ä¸åŒä½å‘ç”Ÿé”™è¯¯æ—¶ï¼Œè¢«Gé™¤çš„ä½™æ•°ä¸åŒ</li></ul></li><li>æ¨¡äºŒé™¤æ³•ï¼š$(M \times 2^r) \div G = Q \cdots R$<ul><li>$1100000 \div 1011 = 1110 \cdots 010$</li><li>å•†$Q=1100$ï¼Œä½™æ•°$R=010$</li><li>æ­¤æ—¶æœ‰$M \times 2^r = Q \times G + R$ æˆç«‹</li></ul></li><li>å°†ä½™æ•°Ræ·»åŠ åˆ°åŸå§‹æ•°æ®Måé¢ï¼Œå¾—åˆ°ä¼ è¾“çš„æ•°æ®$X=1100|010$<ul><li>$M \times 2^r + R = Q \times G + R + R = Q \times G$</li></ul></li><li>æ¥æ”¶ç«¯å°†æ¥æ”¶åˆ°çš„æ•°æ®Xå¯¹Gè¿›è¡Œæ¨¡äºŒé™¤æ³•ï¼Œè‹¥ä½™æ•°ä¸º0åˆ™æ— å·®é”™ï¼Œå¦åˆ™æœ‰å·®é”™</li></ol><p>å·®é”™å®šä½/çº æ­£ï¼š</p><div class="table-container"><table><thead><tr><th style="text-align:center">X=A1~A7</th><th style="text-align:center">ä½™æ•°</th><th style="text-align:center">å‡ºé”™ä½</th></tr></thead><tbody><tr><td style="text-align:center">1100010</td><td style="text-align:center">010</td><td style="text-align:center">æ— å·®é”™</td></tr><tr><td style="text-align:center">110001<strong>1</strong></td><td style="text-align:center">001</td><td style="text-align:center">7</td></tr><tr><td style="text-align:center">11000<strong>0</strong>0</td><td style="text-align:center">000</td><td style="text-align:center">6</td></tr><tr><td style="text-align:center">1100<strong>1</strong>10</td><td style="text-align:center">110</td><td style="text-align:center">5</td></tr><tr><td style="text-align:center">110<strong>1</strong>010</td><td style="text-align:center">011</td><td style="text-align:center">4</td></tr><tr><td style="text-align:center">11<strong>1</strong>0010</td><td style="text-align:center">110</td><td style="text-align:center">3</td></tr><tr><td style="text-align:center">1<strong>0</strong>0010</td><td style="text-align:center">111</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center"><strong>0</strong>10010</td><td style="text-align:center">101</td><td style="text-align:center">1</td></tr></tbody></table></div><h3 id="3-2-å¸§æ£€éªŒåºåˆ—FCS"><a href="#3-2-å¸§æ£€éªŒåºåˆ—FCS" class="headerlink" title="3.2 å¸§æ£€éªŒåºåˆ—FCS"></a>3.2 å¸§æ£€éªŒåºåˆ—FCS</h3><p>å¸§æ£€éªŒåºåˆ—FCS(Frame Check Sequence)æ˜¯æ•°æ®é“¾è·¯å±‚çš„å·®é”™æ£€æµ‹æŠ€æœ¯ï¼Œç”¨äºæ£€æµ‹æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ã€‚</p><p>CRCå’ŒFCSçš„å…³ç³»ï¼šCRCæ˜¯ä¸€ç§å¸¸ç”¨çš„å·®é”™æ£€æµ‹æ–¹æ³•ï¼Œè€ŒFCSæ˜¯æ·»åŠ åœ¨æ•°æ®åé¢çš„å†—ä½™ç ã€‚FCSå¯ä»¥ç”¨CRCè¿™ç§æ–¹æ³•å¾—å‡ºï¼Œä½†CRCå¹¶éç”¨æ¥è·å¾—FCSçš„å”¯ä¸€æ–¹æ³•ã€‚</p><p>æ— å·®é”™æ¥å—ï¼šæ¥æ”¶ç«¯å¯¹æ”¶åˆ°çš„æ¯ä¸€å¸§è¿›è¡ŒCRCæ£€éªŒï¼Œè‹¥ä½™æ•°ä¸º0åˆ™æ— å·®é”™ï¼Œæ¥å—ï¼Œå¦åˆ™ä¸¢å¼ƒ</p><p>ç è·ï¼šåŒä¸€ç¼–ç ä¸­ï¼Œä»»æ„ä¸¤ä¸ªåˆæ³•ç¼–ç ä¹‹é—´ä¸åŒäºŒè¿›æ•°ä½æ•°çš„æœ€å°å€¼ã€‚</p><ul><li>ç è·è¶Šå¤§ï¼ŒæŠ—å¹²æ‰°èƒ½åŠ›ã€çº é”™èƒ½åŠ›è¶Šå¼ºï¼Œæ•°æ®å†—ä½™è¶Šå¤§ï¼Œç¼–ç æ•ˆç‡è¶Šä½</li><li>æ£€é”™ä½æ•°=ç è·//2ï¼Œçº é”™ä½æ•°=(ç è·-1)//2</li><li>ç‰¹æ®Šæƒ…å†µï¼šç è·=3ï¼Œæ£€é”™1çº é”™1ï¼Œæˆ–æ£€é”™2çº é”™0</li></ul><p>æ ¡éªŒç ä¸­å¢åŠ å†—ä½™é¡¹çš„ç›®çš„å°±æ˜¯ä¸ºäº†å¢å¤§ç è·</p><p>ä»…ç”¨å¾ªç¯å†—ä½™æ£€éªŒCRCå·®é”™æ£€æµ‹æŠ€æœ¯åªèƒ½åšåˆ°æ— å·®é”™æ¥å—ï¼Œè¦åšåˆ°â€œå¯é ä¼ è¾“â€ï¼ˆå³å‘é€ä»€ä¹ˆå°±æ”¶åˆ°ä»€ä¹ˆï¼‰å°±å¿…é¡»å†åŠ ä¸Šç¡®è®¤å’Œé‡ä¼ æœºåˆ¶ã€‚</p><ul><li>éœ€è¦è€ƒè™‘çš„é—®é¢˜ï¼šå¸§é‡å¤ã€å¸§ä¸¢å¤±ã€å¸§ä¹±åº</li><li>è§£å†³æ–¹æ³•ï¼šå¸§ç¼–å·ã€ç¡®è®¤å’Œé‡ä¼ </li></ul><p>OSI/RMæ¨¡å‹çš„è§‚ç‚¹ï¼šæ•°æ®é“¾è·¯å±‚è¦åšæˆæ— ä¼ è¾“å·®é”™çš„ã€‚ä½†è¿™ç§ç†å¿µç›®å‰ä¸è¢«æ¥å—</p><h3 id="3-2-ç‚¹å¯¹ç‚¹åè®®PPP"><a href="#3-2-ç‚¹å¯¹ç‚¹åè®®PPP" class="headerlink" title="3.2 ç‚¹å¯¹ç‚¹åè®®PPP"></a>3.2 ç‚¹å¯¹ç‚¹åè®®PPP</h3><p>PPPæ˜¯ç°åœ¨å…¨ä¸–ç•Œä½¿ç”¨çš„æœ€å¤šçš„æ•°æ®é“¾è·¯å±‚åè®®ï¼Œç”¨æˆ·ä½¿ç”¨æ‹¨å·ç”µè¯çº¿æ¥å…¥äº’è”ç½‘æ—¶ï¼Œä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨PPPåè®®ã€‚</p><p>PPPåè®®çš„ç»„æˆéƒ¨åˆ†ï¼ˆè‡ªä¸‹è€Œä¸Šï¼‰ï¼š</p><ol><li>ä¸€ä¸ªå°†IPæ•°æ®æŠ¥å°è£…åˆ°ä¸²è¡Œé“¾è·¯çš„æ–¹æ³•ã€‚æ—¢æ”¯æŒå¼‚æ­¥é“¾è·¯ï¼Œä¹Ÿæ”¯æŒåŒæ­¥é“¾è·¯</li><li>ä¸€ä¸ªç”¨æ¥å»ºç«‹ã€é…ç½®å’Œæµ‹è¯•æ•°æ®é“¾è·¯è¿æ¥çš„é“¾è·¯æ§åˆ¶åè®®LCP(Link Control Protocol)</li><li>ä¸€å¥—ç½‘ç»œæ§åˆ¶åè®®NCP(Network Control Protocol)ã€‚å…è®¸åœ¨ç‚¹åˆ°ç‚¹è¿æ¥ä¸Šä½¿ç”¨å¤šç§ç½‘ç»œå±‚åè®®</li></ol><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/3_5.png" alt="PPPåè®®çš„å·¥ä½œçŠ¶æ€"></p><h4 id="PPPçš„å¸§æ ¼å¼"><a href="#PPPçš„å¸§æ ¼å¼" class="headerlink" title="PPPçš„å¸§æ ¼å¼"></a>PPPçš„å¸§æ ¼å¼</h4><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/3_4.png" alt="PPPçš„å¸§æ ¼å¼"></p><div class="table-container"><table><thead><tr><th style="text-align:center">å­—æ®µ</th><th style="text-align:center">é•¿åº¦</th><th style="text-align:center">å€¼</th><th style="text-align:center">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center">å¸§å¼€å§‹æ ‡å¿—F</td><td style="text-align:center">1B</td><td style="text-align:center">01111110(0x7E)</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">åœ°å€A</td><td style="text-align:center">1B</td><td style="text-align:center">11111111(0xFF)</td><td style="text-align:center">è§„å®šå€¼ï¼Œæ— ä½œç”¨</td></tr><tr><td style="text-align:center">æ§åˆ¶C</td><td style="text-align:center">1B</td><td style="text-align:center">00000011(0x03)</td><td style="text-align:center">è§„å®šå€¼ï¼Œæ— ä½œç”¨</td></tr><tr><td style="text-align:center">åè®®P</td><td style="text-align:center">2B</td><td style="text-align:center">IPæ•°æ®æŠ¥ï¼š0x0021<br>PPPé“¾è·¯æ§åˆ¶æ•°æ®ï¼š0xC021<br>ç½‘ç»œæ§åˆ¶æ•°æ®ï¼š0x8021</td><td style="text-align:center">è¡¨ç¤ºä¸Šå±‚åè®®ç±»å‹</td></tr><tr><td style="text-align:center">ä¿¡æ¯å­—æ®µ</td><td style="text-align:center">0~1500B</td><td style="text-align:center">IPæ•°æ®æŠ¥ç­‰æ•°æ®</td><td style="text-align:center">å¯å˜é•¿åº¦ï¼Œä¸åŒ…æ‹¬FCS</td></tr><tr><td style="text-align:center">å¸§æ ¡éªŒåºåˆ—FCS</td><td style="text-align:center">2B</td><td style="text-align:center">CRCæ ¡éªŒç </td><td style="text-align:center"></td></tr><tr><td style="text-align:center">å¸§ç»“æŸæ ‡å¿—F</td><td style="text-align:center">1B</td><td style="text-align:center">01111110(0x7E)</td></tr></tbody></table></div><h3 id="3-3-é€æ˜ä¼ è¾“å®ç°ï¼šå­—èŠ‚å¡«å……å’Œæ¯”ç‰¹å¡«å……"><a href="#3-3-é€æ˜ä¼ è¾“å®ç°ï¼šå­—èŠ‚å¡«å……å’Œæ¯”ç‰¹å¡«å……" class="headerlink" title="3.3 é€æ˜ä¼ è¾“å®ç°ï¼šå­—èŠ‚å¡«å……å’Œæ¯”ç‰¹å¡«å……"></a>3.3 é€æ˜ä¼ è¾“å®ç°ï¼šå­—èŠ‚å¡«å……å’Œæ¯”ç‰¹å¡«å……</h3><p>PPPå¼‚æ­¥ä¼ è¾“ï¼ˆé€å­—ç¬¦ï¼‰ï¼šå­—èŠ‚å¡«å……</p><ul><li>å­—èŠ‚å¡«å……è½¬ä¹‰ç¬¦ï¼š0x7D</li><li>0x7Eè½¬ä¹‰ä¸º0x7D 0x5E</li><li>0x7Dè½¬ä¹‰ä¸º0x7D 0x5D</li><li>ASCIIç å°äº0x20,+0x20è½¬ä¹‰ã€‚å¦‚0x03è½¬ä¹‰ä¸º0x7D 0x23</li></ul><p>å­—èŠ‚å¡«å……ä¾‹é¢˜ï¼šä¸€ä¸ªPPPå¸§çš„ä¿¡æ¯å­—æ®µä¸º 7E 7D 5E FE 27 7D 5D 7D 27 7Eï¼Œæ±‚çœŸæ­£çš„ä¿¡æ¯å­—æ®µ</p><ul><li>æ ‡å‡ºè½¬ä¹‰å­—ç¬¦ï¼š76 (7D 5E) FE 27 (7D 5D) (7D 27) 7E</li><li>å­—ç¬¦è½¬ä¹‰ï¼š76 (7E) FE 27 (7D) (07) 7E</li></ul><p>PPPåŒæ­¥ä¼ è¾“ï¼ˆé€æ¯”ç‰¹ä½è¿ç»­å‘é€ï¼‰ï¼šæ¯”ç‰¹å¡«å……</p><ul><li>åœ¨å‘é€ç«¯ï¼Œåªè¦å‘ç°æœ‰5ä¸ªè¿ç»­çš„1ï¼Œåˆ™ç«‹å³å¡«å…¥ä¸€ä¸ª0</li><li>åœ¨æ¥æ”¶ç«¯ï¼Œåªè¦å‘ç°æœ‰5ä¸ªè¿ç»­çš„1ï¼Œä¸”åé¢ç´§è·Ÿä¸€ä¸ª0ï¼Œåˆ™åˆ é™¤è¿™ä¸ª0</li></ul><p>æ¯”ç‰¹å¡«å……ä¾‹é¢˜ï¼šè‹¥æ¥æ”¶ç«¯æ”¶åˆ°çš„ PPP çš„æ•°æ®éƒ¨åˆ†æ˜¯0001110111110111110110 ï¼Œé—®åˆ é™¤å‘é€ç«¯åŠ å…¥çš„é›¶æ¯”ç‰¹åå˜æˆæ€æ ·çš„æ¯”ç‰¹ä¸²</p><ul><li>æ ‡å‡º111110ï¼š0001110(111110)(111110)110</li><li>åˆ é™¤é›¶æ¯”ç‰¹ï¼š0001110(11111)(11111)110</li></ul><h3 id="3-4-ä½¿ç”¨å¹¿æ’­ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚"><a href="#3-4-ä½¿ç”¨å¹¿æ’­ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚" class="headerlink" title="3.4 ä½¿ç”¨å¹¿æ’­ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚"></a>3.4 ä½¿ç”¨å¹¿æ’­ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚</h3><p>å±€åŸŸç½‘æ‹“æ‰‘ç»“æ„</p><ul><li>æ€»çº¿ç½‘ï¼šæ‰€æœ‰ç«™ç‚¹å…±äº«ä¸€æ¡æ€»çº¿ã€‚<ul><li>åŒ¹é…ç”µé˜»ï¼šé¿å…æ€»çº¿æœ‰å®³ç”µç£æ³¢åå°„</li></ul></li><li>æ˜Ÿå½¢ç½‘ï¼šæ‰€æœ‰ç«™ç‚¹éƒ½è¿æ¥åˆ°ä¸€ä¸ªä¸­å¿ƒç«™ç‚¹ã€‚<ul><li>é›†çº¿å™¨ï¼šä¸­å¿ƒç«™ç‚¹çš„åŠŸèƒ½æ˜¯è½¬å‘æ•°æ®</li></ul></li><li>ç¯å½¢ç½‘ï¼šæ‰€æœ‰ç«™ç‚¹è¿æ¥æˆä¸€ä¸ªç¯å½¢ã€‚<ul><li>å¹²çº¿è€¦åˆå™¨ï¼šç¯å½¢ç½‘çš„æ•°æ®ä¼ è¾“æ–¹å‘æ˜¯å›ºå®šçš„ï¼ˆé¡ºæ—¶é’ˆ/é€†æ—¶é’ˆï¼‰</li></ul></li></ul><p>åª’ä½“å…±äº«æŠ€æœ¯</p><ul><li>é™æ€åˆ’åˆ†ä¿¡é“ï¼šTDMã€FDMã€WDMã€CDM<ul><li>ä»£ä»·é«˜ï¼Œä¸é€‚åˆå±€åŸŸç½‘</li></ul></li><li>åŠ¨æ€åª’ä½“æ¥å…¥æ§åˆ¶ï¼ˆå¤šç‚¹æ¥å…¥ï¼‰<ul><li>éšæœºæ¥å…¥ï¼šéšæœºå‘é€ä¿¡æ¯ï¼Œè¦æœ‰å†²çªæ£€æµ‹å’Œå†²çªè§£å†³æœºåˆ¶</li><li>å—æ§æ¥å…¥ï¼šå¤šç‚¹çº¿è·¯æ¢è¯¢(polling)æˆ–è½®è¯¢</li></ul></li></ul><p>å±€åŸŸç½‘çš„æ•°æ®é“¾è·¯å±‚çš„ä¸¤ä¸ªå­å±‚ï¼šè¾‘é“¾è·¯æ§åˆ¶LLC(Logical Link Control)å­å±‚ã€åª’ä½“æ¥å…¥æ§åˆ¶MAC(Media Access Control)å­å±‚</p><p>ç½‘å¡çš„ä½œç”¨ï¼šè¿›è¡Œä¸²è¡Œ/å¹¶è¡Œè½¬æ¢ã€<strong>å®ç°ä»¥å¤ªç½‘åè®®</strong>ã€å­˜å‚¨MACåœ°å€</p><h4 id="3-4-ä»¥å¤ªå±€åŸŸç½‘ï¼ˆä»¥å¤ªç½‘ï¼‰"><a href="#3-4-ä»¥å¤ªå±€åŸŸç½‘ï¼ˆä»¥å¤ªç½‘ï¼‰" class="headerlink" title="3.4 ä»¥å¤ªå±€åŸŸç½‘ï¼ˆä»¥å¤ªç½‘ï¼‰"></a>3.4 ä»¥å¤ªå±€åŸŸç½‘ï¼ˆä»¥å¤ªç½‘ï¼‰</h4><p>ä»¥å¤ªç½‘å•ç¨‹ç«¯åˆ°ç«¯æ—¶å»¶ $\tau$ ï¼Œäº‰ç”¨æœŸé•¿åº¦ $2\tau$ ï¼Œå¸§é•¿ $L(bit)$ ï¼Œæ•°æ®å‘é€é€Ÿç‡ $C(bps)$ ï¼Œå¸§å‘é€æ—¶é—´ $T_0=\frac{L}{C}$</p><p>å‘é€ä¸€å¸§çš„å¹³å‡æ—¶é—´ï¼š$k\cdot 2\tau + T_0 + \tau$ï¼ˆå‘é€å®Œæˆåç­‰å¾…ä¸€ä¸ª$\tau$çš„ä¼ æ’­æ—¶é—´ï¼‰</p><p>ä¿¡é“åˆ©ç”¨ç‡ï¼š$S=\dfrac{T_0}{k\cdot 2\tau + T_0+\tau}$</p><p>è¦æé«˜ä»¥å¤ªç½‘çš„ä¿¡é“åˆ©ç”¨ç‡ï¼Œå°±å¿…é¡»å‡å°$\tau$ä¸$T_0$ä¹‹æ¯”ï¼š$a=\frac{\tau}{T_0}$ã€‚<br>aè¶Šå¤§ï¼Œè¡¨æ˜äº‰ç”¨æœŸæ‰€å çš„æ¯”ä¾‹å¢å¤§ï¼Œæ¯å‘ç”Ÿä¸€æ¬¡ç¢°æ’å°±æµªè´¹è®¸å¤šä¿¡é“èµ„æºï¼Œä½¿å¾—ä¿¡é“åˆ©ç”¨ç‡æ˜æ˜¾é™ä½</p><p>ç†æƒ³æƒ…å†µä¸‹çš„æé™ä¿¡é“åˆ©ç”¨ç‡$S_{max}=\dfrac{T_0}{T_0+\tau}=\dfrac{1}{1+a}$</p><p>ä»¥å¤ªç½‘MACå¸§æ ¼å¼ï¼ˆDIX Ethernet V2 æ ‡å‡†ï¼‰ï¼š</p><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/3_6.png" alt="ä»¥å¤ªç½‘MACå¸§æ ¼å¼"></p><div class="table-container"><table><thead><tr><th style="text-align:center">å­—æ®µ</th><th style="text-align:center">é•¿åº¦</th><th style="text-align:center">å€¼</th><th style="text-align:center">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center">å‰åŒæ­¥ç </td><td style="text-align:center">7B</td><td style="text-align:center">å›ºå®šä¸º10101010äº¤æ›¿</td><td style="text-align:center">è°ƒæ•´æ—¶é’Ÿé¢‘ç‡</td></tr><tr><td style="text-align:center">å¸§å¼€å§‹å®šç•Œç¬¦</td><td style="text-align:center">1B</td><td style="text-align:center">10101011</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">ç›®çš„åœ°å€</td><td style="text-align:center">6B</td><td style="text-align:center">ç›®çš„MACåœ°å€</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">æºåœ°å€</td><td style="text-align:center">6B</td><td style="text-align:center">æºMACåœ°å€</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">ç±»å‹</td><td style="text-align:center">2B</td><td style="text-align:center">ä¸Šå±‚åè®®ç±»å‹</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">æ•°æ®</td><td style="text-align:center">46~1500B</td><td style="text-align:center">IPæ•°æ®æŠ¥</td><td style="text-align:center">å¯å˜é•¿åº¦ï¼Œä¸åŒ…æ‹¬FCS</td></tr><tr><td style="text-align:center">FCS</td><td style="text-align:center">4B</td><td style="text-align:center">CRCæ ¡éªŒç </td></tr></tbody></table></div><h3 id="3-5-HDLCåè®®"><a href="#3-5-HDLCåè®®" class="headerlink" title="3.5 HDLCåè®®"></a>3.5 HDLCåè®®</h3><p>HDLC(High-level Data Link Control)æ˜¯ä¸€ç§æ•°æ®é“¾è·¯å±‚åè®®ï¼Œæ˜¯ISOç»„ç»‡åˆ¶å®šçš„ä¸€ç§æ•°æ®é“¾è·¯å±‚åè®®ï¼Œæ˜¯ä¸€ç§é¢å‘æ¯”ç‰¹çš„åè®®ã€‚</p><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">HDLCåè®®</th><th style="text-align:center">PPPåè®®</th></tr></thead><tbody><tr><td style="text-align:center">ä¿¡é“</td><td style="text-align:center">ç‚¹å¯¹ç‚¹</td><td style="text-align:center">ç‚¹å¯¹ç‚¹</td></tr><tr><td style="text-align:center">é¢å‘</td><td style="text-align:center">æ¯”ç‰¹</td><td style="text-align:center">å­—èŠ‚</td></tr><tr><td style="text-align:center">é€æ˜æ€§</td><td style="text-align:center">0æ¯”ç‰¹å¡«å……</td><td style="text-align:center">å­—èŠ‚å¡«å……</td></tr><tr><td style="text-align:center">é€šä¿¡</td><td style="text-align:center">å…¨åŒå·¥ã€åŠåŒå·¥</td><td style="text-align:center">å…¨åŒå·¥</td></tr><tr><td style="text-align:center">å¯é æ€§</td><td style="text-align:center">ä½¿ç”¨ç¼–å·å’Œç¡®è®¤æœºåˆ¶ï¼Œæä¾›å¯é ä¼ è¾“</td><td style="text-align:center">åªä¿è¯æ— å·®é”™æ¥æ”¶CRCæ£€éªŒ</td></tr><tr><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center">å¤šä¸€ä¸ª2å­—èŠ‚çš„åè®®å­—æ®µã€‚å½“åè®®å­—æ®µå€¼ä¸º0x0021æ—¶ï¼Œè¡¨ç¤ºä¿¡æ¯å­—æ®µæ˜¯IPæ•°æ®æŠ¥</td></tr></tbody></table></div><h2 id="å››ã€ç½‘ç»œå±‚"><a href="#å››ã€ç½‘ç»œå±‚" class="headerlink" title="å››ã€ç½‘ç»œå±‚"></a>å››ã€ç½‘ç»œå±‚</h2><h3 id="4-1-ç½‘ç»œå±‚çš„åŸºæœ¬æ¦‚å¿µ"><a href="#4-1-ç½‘ç»œå±‚çš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="4.1 ç½‘ç»œå±‚çš„åŸºæœ¬æ¦‚å¿µ"></a>4.1 ç½‘ç»œå±‚çš„åŸºæœ¬æ¦‚å¿µ</h3><h4 id="4-1-1-ç½‘ç»œå±‚æä¾›çš„ä¸¤ç§æœåŠ¡"><a href="#4-1-1-ç½‘ç»œå±‚æä¾›çš„ä¸¤ç§æœåŠ¡" class="headerlink" title="4.1.1 ç½‘ç»œå±‚æä¾›çš„ä¸¤ç§æœåŠ¡"></a>4.1.1 ç½‘ç»œå±‚æä¾›çš„ä¸¤ç§æœåŠ¡</h4><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">è™šç”µè·¯æœåŠ¡</th><th style="text-align:center">æ•°æ®æŠ¥æœåŠ¡</th></tr></thead><tbody><tr><td style="text-align:center">æ€è·¯</td><td style="text-align:center">å¯é é€šä¿¡åº”å½“ç”±ç½‘ç»œæ¥ä¿è¯</td><td style="text-align:center">é€šä¿¡çš„å¯é æ€§åº”å½“ç”±ç”¨æˆ·ä¸»æœºæ¥ä¿è¯</td></tr><tr><td style="text-align:center">å»ºç«‹çš„è¿æ¥</td><td style="text-align:center">å¿…é¡»æœ‰</td><td style="text-align:center">ä¸éœ€è¦</td></tr><tr><td style="text-align:center">ç»ˆç‚¹åœ°å€</td><td style="text-align:center">ä»…åœ¨è¿æ¥å»ºç«‹é˜¶æ®µä½¿ç”¨ï¼Œæ¯ä¸ªåˆ†ç»„ä½¿ç”¨çŸ­çš„è™šç”µè·¯å·</td><td style="text-align:center">æ¯ä¸ªåˆ†ç»„éƒ½æœ‰ç»ˆç‚¹çš„å®Œæ•´åœ°å€</td></tr><tr><td style="text-align:center">åˆ†ç»„çš„è½¬å‘</td><td style="text-align:center">å±äºåŒä¸€æ¡è™šç”µè·¯çš„åˆ†ç»„å‡æŒ‰ç…§åŒä¸€è·¯ç”±è¿›è¡Œè½¬å‘</td><td style="text-align:center">æ¯ä¸ªåˆ†ç»„ç‹¬ç«‹é€‰æ‹©è·¯ç”±è¿›è¡Œè½¬å‘</td></tr><tr><td style="text-align:center">ç»“ç‚¹å‡ºæ•…éšœæ—¶</td><td style="text-align:center">æ‰€æœ‰é€šè¿‡å‡ºæ•…éšœçš„ç»“ç‚¹çš„è™šç”µè·¯å‡ä¸èƒ½å·¥ä½œ</td><td style="text-align:center">å‡ºæ•…éšœçš„ç»“ç‚¹å¯èƒ½ä¼šä¸¢å¤±åˆ†ç»„ï¼Œä¸€äº›è·¯ç”±å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–</td></tr><tr><td style="text-align:center">åˆ†ç»„çš„é¡ºåº</td><td style="text-align:center">æ€»æ˜¯æŒ‰å‘é€é¡ºåºåˆ°è¾¾ç»ˆç‚¹</td><td style="text-align:center">åˆ°è¾¾ç»ˆç‚¹æ—¶ä¸ä¸€å®šæŒ‰å‘é€é¡ºåº</td></tr><tr><td style="text-align:center">ç«¯åˆ°ç«¯çš„å·®é”™å¤„ç†å’Œæµé‡æ§åˆ¶</td><td style="text-align:center">å¯ä»¥ç”±ç½‘ç»œè´Ÿè´£ï¼Œä¹Ÿå¯ä»¥ç”±ç”¨æˆ·ä¸»æœºè´Ÿè´£</td><td style="text-align:center">ç”±ç”¨æˆ·ä¸»æœºè´Ÿè´£</td></tr></tbody></table></div><h4 id="4-1-2-ä¸­é—´è®¾å¤‡-ä¸­ç»§ç³»ç»Ÿ"><a href="#4-1-2-ä¸­é—´è®¾å¤‡-ä¸­ç»§ç³»ç»Ÿ" class="headerlink" title="4.1.2 ä¸­é—´è®¾å¤‡/ä¸­ç»§ç³»ç»Ÿ"></a>4.1.2 ä¸­é—´è®¾å¤‡/ä¸­ç»§ç³»ç»Ÿ</h4><ul><li>ç‰©ç†å±‚ï¼šè½¬å‘å™¨(repeater)</li><li>æ•°æ®é“¾è·¯å±‚ï¼šç½‘æ¡¥(bridge)</li><li>ç½‘ç»œå±‚ï¼šè·¯ç”±å™¨(router)</li><li>ç½‘ç»œå±‚ä»¥ä¸Šï¼šç½‘å…³(gateway)</li></ul><h3 id="4-2-IPåè®®"><a href="#4-2-IPåè®®" class="headerlink" title="4.2 IPåè®®"></a>4.2 IPåè®®</h3><p>ç½‘é™…åè®®IPæ˜¯TCP/IPä½“ç³»ä¸­ä¸¤ä¸ªæœ€ä¸»è¦çš„åè®®ä¹‹ä¸€ã€‚ä¸IPåè®®é…å¥—ä½¿ç”¨çš„è¿˜æœ‰ä¸‰ä¸ªåè®®ï¼š</p><ul><li>åœ°å€è§£æåè®®ARP(Address Resolution Protocol)</li><li>ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMP(Internet Control Message Protocol)</li><li>ç½‘é™…ç»„ç®¡ç†åè®®IGMP(Internet Group Management Protocol)</li></ul><h4 id="4-2-1-IPåœ°å€åˆ†ç±»"><a href="#4-2-1-IPåœ°å€åˆ†ç±»" class="headerlink" title="4.2.1 IPåœ°å€åˆ†ç±»"></a>4.2.1 IPåœ°å€åˆ†ç±»</h4><p>IPåœ°å€åˆ†ä¸ºAã€Bã€Cã€Dã€Eäº”ç±»ï¼Œæ¯ç±»åœ°å€çš„ç½‘ç»œå·å’Œä¸»æœºå·çš„åˆ’åˆ†ä¸åŒã€‚</p><div class="table-container"><table><thead><tr><th style="text-align:center">ç±»åˆ«</th><th style="text-align:center">å‰ç¼€</th><th style="text-align:center">ç½‘ç»œå·</th><th style="text-align:center">ä¸»æœºå·</th><th style="text-align:center">ç¬¬ä¸€å­—èŠ‚èŒƒå›´</th><th style="text-align:center">å­ç½‘æ©ç </th><th style="text-align:center">ä¸»æœºæ•°</th><th style="text-align:center">é¢„ç•™ç§æœ‰åœ°å€ç½‘æ®µï¼ˆRFC 1918ï¼‰</th></tr></thead><tbody><tr><td style="text-align:center">Aç±»</td><td style="text-align:center">0</td><td style="text-align:center">7ä½</td><td style="text-align:center">24ä½</td><td style="text-align:center">0~127</td><td style="text-align:center">/8</td><td style="text-align:center">2^24-2=16777214</td><td style="text-align:center">10.0.0.0~10.255.255.255</td></tr><tr><td style="text-align:center">Bç±»</td><td style="text-align:center">10</td><td style="text-align:center">14ä½</td><td style="text-align:center">16ä½</td><td style="text-align:center">128~191</td><td style="text-align:center">/16</td><td style="text-align:center">2^16-2=65534</td><td style="text-align:center">172.16.0.0~172.31.255.255</td></tr><tr><td style="text-align:center">Cç±»</td><td style="text-align:center">110</td><td style="text-align:center">21ä½</td><td style="text-align:center">8ä½</td><td style="text-align:center">192~223</td><td style="text-align:center">/24</td><td style="text-align:center">2^8-2=254</td><td style="text-align:center">192.168.0.0~192.168.255.255</td></tr><tr><td style="text-align:center">Dç±»</td><td style="text-align:center">1110</td><td style="text-align:center">å¤šæ’­åœ°å€28ä½</td><td style="text-align:center">-</td><td style="text-align:center">224~239</td><td style="text-align:center">-</td><td style="text-align:center">-</td><td style="text-align:center">-</td></tr><tr><td style="text-align:center">Eç±»</td><td style="text-align:center">1111</td><td style="text-align:center">ä¿ç•™åœ°å€</td><td style="text-align:center">-</td><td style="text-align:center">240~255</td><td style="text-align:center">-</td><td style="text-align:center">-</td><td style="text-align:center">-</td></tr></tbody></table></div><h3 id="4-2-2-åœ°å€è§£æåè®®ARP"><a href="#4-2-2-åœ°å€è§£æåè®®ARP" class="headerlink" title="4.2.2 åœ°å€è§£æåè®®ARP"></a>4.2.2 åœ°å€è§£æåè®®ARP</h3><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/4_1.png" alt="ARPå·¥ä½œåŸç†"></p><p>å½“ä¸»æœºAæ¬²å‘æœ¬å±€åŸŸç½‘ä¸Šçš„æŸä¸ªä¸»æœºBå‘é€IPæ•°æ®æŠ¥æ—¶ï¼Œå°±å…ˆåœ¨å…¶ARPé«˜é€Ÿç¼“å­˜ä¸­æŸ¥çœ‹æœ‰æ— ä¸»æœºBçš„IPåœ°å€ã€‚<br>å¦‚æœ‰ï¼Œå°±å¯æŸ¥å‡ºå…¶å¯¹åº”çš„ç¡¬ä»¶åœ°å€ï¼Œå†å°†æ­¤ç¡¬ä»¶åœ°å€å†™å…¥MACï¼Œç„¶åé€šè¿‡å±€åŸŸç½‘å°†è¯¥MACå‘å¾€æ­¤ç¡¬ä»¶åœ°å€ã€‚<br>å¦‚æ²¡æœ‰ï¼ŒARPè¿›ç¨‹åœ¨æœ¬å±€åŸŸç½‘ä¸Šå¹¿æ’­å‘é€ä¸€ä¸ªARPè¯·æ±‚åˆ†ç»„æ”¶åˆ°ARPå“åº”åˆ†ç»„åï¼Œå°†å¾—åˆ°çš„Påœ°å€åˆ°ç¡¬ä»¶åœ°å€çš„æ˜ å°„å†™å…¥ARPé«˜é€Ÿç¼“å­˜ã€‚</p><h3 id="4-2-3-IPæ•°æ®æŠ¥çš„å°è£…æ ¼å¼"><a href="#4-2-3-IPæ•°æ®æŠ¥çš„å°è£…æ ¼å¼" class="headerlink" title="4.2.3 IPæ•°æ®æŠ¥çš„å°è£…æ ¼å¼"></a>4.2.3 IPæ•°æ®æŠ¥çš„å°è£…æ ¼å¼</h3><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/4_2.png" alt="IPæ•°æ®æŠ¥çš„å°è£…æ ¼å¼"></p><p>IPæ•°æ®æŠ¥çš„å°è£…æ ¼å¼ï¼š</p><div class="table-container"><table><thead><tr><th style="text-align:center">å­—æ®µ</th><th style="text-align:center">é•¿åº¦</th><th style="text-align:left">å€¼</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center">ç‰ˆæœ¬</td><td style="text-align:center">4b</td><td style="text-align:left">IPv4ä¸º4</td><td style="text-align:left">IPåè®®çš„ç‰ˆæœ¬å·</td></tr><tr><td style="text-align:center">é¦–éƒ¨é•¿åº¦</td><td style="text-align:center">4b</td><td style="text-align:left">é¦–éƒ¨é•¿åº¦</td><td style="text-align:left">æœ€å¤§ä¸º1111(15)ï¼Œå•ä½ä¸º4å­—èŠ‚ï¼Œå³é¦–éƒ¨æœ€å¤§ä¸º60å­—èŠ‚</td></tr><tr><td style="text-align:center">åŒºåˆ†æœåŠ¡</td><td style="text-align:center">8b</td><td style="text-align:left"></td><td style="text-align:left">æœåŠ¡ç±»å‹ï¼Œä¸€èˆ¬ä¸ä½¿ç”¨</td></tr><tr><td style="text-align:center">æ€»é•¿åº¦</td><td style="text-align:center">16b</td><td style="text-align:left">IPæ•°æ®æŠ¥çš„æ€»é•¿åº¦</td><td style="text-align:left">å•ä½ä¸ºå­—èŠ‚ï¼ŒåŒ…æ‹¬é¦–éƒ¨å’Œæ•°æ®éƒ¨åˆ†</td></tr><tr><td style="text-align:center">æ ‡è¯†</td><td style="text-align:center">16b</td><td style="text-align:left">æ ‡è¯†ç¬¦</td><td style="text-align:left">ç”¨äºæ ‡è¯†å‘é€çš„æ•°æ®æŠ¥</td></tr><tr><td style="text-align:center">æ ‡å¿—</td><td style="text-align:center">3b</td><td style="text-align:left">æ ‡å¿—ä½</td><td style="text-align:left">MFï¼š1ä½ï¼Œ1è¡¨ç¤ºè¿˜æœ‰åˆ†ç‰‡<br>DFï¼š1ä½ï¼Œ1è¡¨ç¤ºä¸å…è®¸åˆ†ç‰‡<br>ä¿ç•™ä½ï¼š1ä½</td></tr><tr><td style="text-align:center">ç‰‡åç§»</td><td style="text-align:center">13b</td><td style="text-align:left">ç‰‡åç§»</td><td style="text-align:left">å•ä½ä¸º8å­—èŠ‚ï¼Œè¡¨ç¤ºè¯¥ç‰‡ç›¸å¯¹äºåŸå§‹æ•°æ®æŠ¥çš„åç§»é‡</td></tr><tr><td style="text-align:center">ç”Ÿå­˜æ—¶é—´</td><td style="text-align:center">8b</td><td style="text-align:left">TTL</td><td style="text-align:left">æ•°æ®æŠ¥åœ¨ç½‘ç»œä¸­å¯é€šè¿‡çš„è·¯ç”±å™¨æ•°çš„æœ€å¤§å€¼ï¼Œæ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨å‡1ï¼Œä¸º0æ—¶ä¸¢å¼ƒ</td></tr><tr><td style="text-align:center">åè®®</td><td style="text-align:center">8b</td><td style="text-align:left">åè®®å·</td><td style="text-align:left">æŒ‡å‡ºæ­¤æ•°æ®æŠ¥æºå¸¦çš„æ•°æ®ä½¿ç”¨ä½•ç§åè®®ï¼Œå¦‚TCPä¸º6ï¼ŒUDPä¸º17</td></tr><tr><td style="text-align:center">é¦–éƒ¨æ ¡éªŒå’Œ</td><td style="text-align:center">16b</td><td style="text-align:left">é¦–éƒ¨æ ¡éªŒå’Œ</td><td style="text-align:left">åªæ£€éªŒæ•°æ®æŠ¥çš„é¦–éƒ¨ä¸æ£€éªŒæ•°æ®éƒ¨åˆ†<br>è¿™é‡Œä¸é‡‡ç”¨CRCæ£€éªŒç è€Œé‡‡ç”¨ç®€å•çš„è®¡ç®—æ–¹æ³•</td></tr><tr><td style="text-align:center">æºåœ°å€</td><td style="text-align:center">32b</td><td style="text-align:left">æºIPåœ°å€</td><td style="text-align:left">å‘é€æ•°æ®æŠ¥çš„ä¸»æœºçš„IPåœ°å€</td></tr><tr><td style="text-align:center">ç›®çš„åœ°å€</td><td style="text-align:center">32b</td><td style="text-align:left">ç›®çš„IPåœ°å€</td><td style="text-align:left">æ¥æ”¶æ•°æ®æŠ¥çš„ä¸»æœºçš„IPåœ°å€</td></tr><tr><td style="text-align:center">é€‰é¡¹</td><td style="text-align:center">å¯å˜</td><td style="text-align:left"></td><td style="text-align:left">é€‰é¡¹å­—æ®µçš„é•¿åº¦æ˜¯å¯å˜çš„ï¼Œæœ€é•¿ä¸º40å­—èŠ‚</td></tr></tbody></table></div><p>IPæ•°æ®æŠ¥åˆ†ç‰‡ä¾‹ï¼šä¸€æ•°æ®æŠ¥çš„æ€»é•¿åº¦ä¸º3820å­—èŠ‚ï¼Œå…¶æ•°æ®éƒ¨åˆ†çš„é•¿åº¦ä¸º3800å­—èŠ‚(ä½¿ç”¨å›ºå®šé¦–éƒ¨)ï¼ŒMTU=1420å­—èŠ‚</p><ul><li>é¦–éƒ¨é•¿åº¦ï¼š20å­—èŠ‚</li><li>åˆ†ç‰‡æœ€é•¿æ•°æ®é•¿åº¦ï¼š1420-20=1400å­—èŠ‚</li><li>åˆ†ç‰‡æ•°æ®é•¿åº¦ï¼š3800=1400+1400+1000</li><li>åˆ†ç‰‡1ï¼šåç§»0ï¼ŒMF=1</li><li>åˆ†ç‰‡2ï¼šåç§»1400/8=175ï¼ŒMF=1</li><li>åˆ†ç‰‡3ï¼šåç§»2800/8=350ï¼ŒMF=0</li></ul><h3 id="4-3-IPå±‚åˆ†ç»„è½¬å‘è¿‡ç¨‹"><a href="#4-3-IPå±‚åˆ†ç»„è½¬å‘è¿‡ç¨‹" class="headerlink" title="4.3 IPå±‚åˆ†ç»„è½¬å‘è¿‡ç¨‹"></a>4.3 IPå±‚åˆ†ç»„è½¬å‘è¿‡ç¨‹</h3><h4 id="4-3-1-åˆ†ç»„è½¬å‘ç®—æ³•"><a href="#4-3-1-åˆ†ç»„è½¬å‘ç®—æ³•" class="headerlink" title="4.3.1 åˆ†ç»„è½¬å‘ç®—æ³•"></a>4.3.1 åˆ†ç»„è½¬å‘ç®—æ³•</h4><ol><li>ä»æ•°æ®æŠ¥çš„é¦–éƒ¨æå–ç›®çš„ä¸»æœºDçš„IPåœ°å€,å¾—å‡ºç›®çš„ç½‘ç»œåœ°å€ä¸ºN</li><li>è‹¥ç½‘ç»œNä¸æ­¤è·¯ç”±å™¨ç›´æ¥ç›¸è¿ï¼Œåˆ™æŠŠæ•°æ®æŠ¥ç›´æ¥äº¤ä»˜ç›®çš„ä¸»æœºDï¼›å¦åˆ™æ˜¯é—´æ¥äº¤ä»˜ï¼Œæ‰§è¡Œä¸‹ä¸€æ­¥</li><li>è‹¥è·¯ç”±è¡¨ä¸­æœ‰ç›®çš„åœ°å€ä¸ºDçš„ç‰¹å®šä¸»æœºè·¯ç”±ï¼Œåˆ™æŠŠæ•°æ®æŠ¥ä¼ é€ç»™è·¯ç”±è¡¨ä¸­æ‰€æŒ‡æ˜çš„ä¸‹ä¸€è·³è·¯ç”±å™¨ï¼›å¦åˆ™ï¼Œæ‰§è¡Œä¸‹ä¸€æ­¥</li><li>è‹¥è·¯ç”±è¡¨ä¸­æœ‰åˆ°è¾¾ç½‘ç»œ N çš„è·¯ç”±ï¼Œåˆ™æŠŠæ•°æ®æŠ¥ä¼ é€ç»™è·¯ç”±è¡¨æŒ‡æ˜çš„ä¸‹ä¸€è·³è·¯ç”±å™¨ï¼›å¦åˆ™ï¼Œæ‰§è¡Œä¸‹ä¸€æ­¥</li><li>è‹¥è·¯ç”±è¡¨ä¸­æœ‰ä¸€ä¸ªé»˜è®¤è·¯ç”±ï¼Œåˆ™æŠŠæ•°æ®æŠ¥ä¼ é€ç»™è·¯ç”±è¡¨ä¸­æ‰€æŒ‡æ˜çš„é»˜è®¤è·¯ç”±å™¨ï¼Œå¦åˆ™ï¼ŒæŠ¥å‘Šè½¬å‘åˆ†ç»„å‡ºé”™</li></ol><h4 id="4-3-2-å­ç½‘åˆ’åˆ†"><a href="#4-3-2-å­ç½‘åˆ’åˆ†" class="headerlink" title="4.3.2 å­ç½‘åˆ’åˆ†"></a>4.3.2 å­ç½‘åˆ’åˆ†</h4><p>å€Ÿä½ï¼šä»ä¸»æœºæœ€é«˜ä½å¼€å§‹å€Ÿä½å˜ä¸ºæ–°çš„å­ç½‘ä½ï¼Œå‰©ä½™éƒ¨åˆ†ä»ä¸ºä¸»æœºä½</p><p>ä¾‹å¦‚192.168.1.0/24å¯åˆ’åˆ†ä¸ºï¼š</p><ul><li>2ä¸ªå­ç½‘ï¼š192.168.1.0/25ã€192.168.1.128/25</li><li>4ä¸ªå­ç½‘ï¼š192.168.1.0/26ã€192.168.1.64/26ã€192.168.1.128/26ã€192.168.1.192/26</li></ul><p>192.168.1.55/26 çš„ç½‘ç»œå·ï¼šå°†IPåœ°å€è½¬æ¢ä¸ºäºŒè¿›åˆ¶ï¼Œå–å‰26ä½å³å¯ã€‚<br>192.168.1.55(00|110111)=&gt;192.168.1.0</p><h4 id="4-3-3-åˆ’åˆ†å­ç½‘çš„åˆ†ç»„è½¬å‘ç®—æ³•"><a href="#4-3-3-åˆ’åˆ†å­ç½‘çš„åˆ†ç»„è½¬å‘ç®—æ³•" class="headerlink" title="4.3.3 åˆ’åˆ†å­ç½‘çš„åˆ†ç»„è½¬å‘ç®—æ³•"></a>4.3.3 åˆ’åˆ†å­ç½‘çš„åˆ†ç»„è½¬å‘ç®—æ³•</h4><ol><li>ä»æ•°æ®æŠ¥çš„é¦–éƒ¨æå–ç›®çš„ä¸»æœºDçš„IPåœ°å€</li><li>å…ˆç”¨ç›´æ¥ç›¸è¿çš„å„ç½‘ç»œçš„å­ç½‘æ©ç å’ŒDé€ä½ç›¸â€œä¸â€ï¼Œçœ‹æ˜¯å¦å’Œç›¸åº”çš„ç½‘ç»œåœ°å€åŒ¹é…ã€‚è‹¥åŒ¹é…ï¼Œåˆ™å°†åˆ†ç»„ç›´æ¥äº¤ä»˜ï¼›å¦åˆ™å°±æ˜¯é—´æ¥äº¤ä»˜ï¼Œæ‰§è¡Œä¸‹ä¸€æ­¥</li><li>è‹¥è·¯ç”±è¡¨ä¸­æœ‰ç›®çš„åœ°å€ä¸ºDçš„ç‰¹å®šä¸»æœºè·¯ç”±ï¼Œåˆ™å°†åˆ†ç»„ä¼ é€ç»™æŒ‡æ˜çš„ä¸‹ä¸€è·³è·¯ç”±å™¨ï¼›å¦åˆ™ï¼Œæ‰§è¡Œä¸‹ä¸€æ­¥</li><li>å¯¹è·¯ç”±è¡¨ä¸­çš„æ¯ä¸€è¡Œçš„å­ç½‘æ©ç å’Œ D é€ä½ç›¸â€œä¸â€ï¼Œè‹¥å…¶ç»“æœä¸è¯¥è¡Œçš„ç›®çš„ç½‘ç»œåœ°å€åŒ¹é…ï¼Œåˆ™å°†åˆ†ç»„ä¼ é€ç»™è¯¥è¡ŒæŒ‡æ˜çš„ä¸‹ä¸€è·³è·¯ç”±å™¨ï¼›å¦åˆ™ï¼Œæ‰§è¡Œä¸‹ä¸€æ­¥</li><li>è‹¥è·¯ç”±è¡¨ä¸­æœ‰ä¸€ä¸ªé»˜è®¤è·¯ç”±ï¼Œåˆ™å°†åˆ†ç»„ä¼ é€ç»™æŒ‡æ˜çš„é»˜è®¤è·¯ç”±å™¨ï¼›å¦åˆ™ï¼ŒæŠ¥å‘Šè½¬å‘åˆ†ç»„å‡ºé”™</li></ol><h4 id="4-3-4-æ— åˆ†ç±»IPåœ°å€CIDR"><a href="#4-3-4-æ— åˆ†ç±»IPåœ°å€CIDR" class="headerlink" title="4.3.4 æ— åˆ†ç±»IPåœ°å€CIDR"></a>4.3.4 æ— åˆ†ç±»IPåœ°å€CIDR</h4><p>ä¸€ä¸ª CIDR åœ°å€å—å¯ä»¥è¡¨ç¤ºå¾ˆå¤šåœ°å€ï¼Œè¿™ç§åœ°å€çš„èšåˆå¸¸ç§°ä¸ºè·¯ç”±èšåˆï¼Œå®ƒä½¿å¾—è·¯ç”±è¡¨ä¸­çš„ä¸€ä¸ªé¡¹ç›®å¯ä»¥è¡¨ç¤ºå¾ˆå¤šä¸ªï¼ˆä¾‹å¦‚ä¸Šåƒä¸ªï¼‰åŸæ¥ä¼ ç»Ÿåˆ†ç±»åœ°å€çš„è·¯ç”±ã€‚</p><p>æœ€é•¿å‰ç¼€åŒ¹é…ï¼šåœ¨è·¯ç”±è¡¨ä¸­æŸ¥æ‰¾ä¸€ä¸ªä¸ç›®çš„åœ°å€æœ€åŒ¹é…çš„è·¯ç”±è¡¨é¡¹ï¼Œå³æŸ¥æ‰¾æœ€é•¿çš„å‰ç¼€åŒ¹é…ã€‚</p><h3 id="4-4-ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMP"><a href="#4-4-ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMP" class="headerlink" title="4.4 ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMP"></a>4.4 ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMP</h3><p>ICMP å…è®¸ä¸»æœºæˆ–è·¯ç”±å™¨æŠ¥å‘Šå·®é”™æƒ…å†µå’Œæä¾›æœ‰å…³å¼‚å¸¸æƒ…å†µçš„æŠ¥å‘Šã€‚<br>ICMP ä¸æ˜¯é«˜å±‚åè®®ï¼Œè€Œæ˜¯IPå±‚çš„åè®®ã€‚<br>ICMP æŠ¥æ–‡ä½œä¸ºIPå±‚æ•°æ®æŠ¥çš„æ•°æ®ï¼ŒåŠ ä¸Šæ•°æ®æŠ¥çš„é¦–éƒ¨ï¼Œç»„æˆIPæ•°æ®æŠ¥å‘é€å‡ºå»ã€‚</p><p>ICMPå·®é”™æŠ¥æ–‡ï¼šç»ˆç‚¹ä¸å¯è¾¾ã€æ—¶é—´è¶…é™ã€å‚æ•°é—®é¢˜ã€æ”¹å˜è·¯ç”±(é‡å®šå‘)ã€æºæŠ‘åˆ¶</p><p>ICMPè¯¢é—®æŠ¥æ–‡ï¼šå›é€è¯·æ±‚å’Œå›ç­”æŠ¥æ–‡ã€æ—¶é—´æˆ³è¯·æ±‚å’Œå›ç­”æŠ¥æ–‡</p><p>ICMPåº”ç”¨ï¼šPINGã€Traceroute</p><h3 id="4-5-è·¯ç”±é€‰æ‹©åè®®"><a href="#4-5-è·¯ç”±é€‰æ‹©åè®®" class="headerlink" title="4.5 è·¯ç”±é€‰æ‹©åè®®"></a>4.5 è·¯ç”±é€‰æ‹©åè®®</h3><p>å†…éƒ¨ç½‘å…³åè®® IGP:å…·ä½“çš„åè®®æœ‰å¤šç§ï¼Œå¦‚RIPå’ŒOSPFç­‰</p><p>å¤–éƒ¨ç½‘å…³åè®® EGP:ç›®å‰ä½¿ç”¨çš„åè®®å°±æ˜¯BGP</p><h4 id="4-5-1-RIPåè®®"><a href="#4-5-1-RIPåè®®" class="headerlink" title="4.5.1 RIPåè®®"></a>4.5.1 RIPåè®®</h4><p>RIPæ˜¯ä¸€ç§åŸºäºè·ç¦»çŸ¢é‡ï¼ˆDistance-Vectorï¼‰ç®—æ³•çš„åè®®ï¼Œå®ƒä½¿ç”¨è·³æ•°ï¼ˆHop Countï¼‰ä½œä¸ºåº¦é‡å€¼æ¥è¡¡é‡åˆ°è¾¾ç›®çš„åœ°å€çš„è·ç¦»ã€‚</p><p>åœ¨RIPç½‘ç»œä¸­ï¼Œç¼ºçœæƒ…å†µä¸‹ï¼Œè®¾å¤‡åˆ°ä¸å®ƒç›´æ¥ç›¸è¿ç½‘ç»œçš„è·³æ•°ä¸º0ï¼Œé€šè¿‡ä¸€ä¸ªè®¾å¤‡å¯è¾¾çš„ç½‘ç»œçš„è·³æ•°ä¸º1ï¼Œå…¶ä½™ä¾æ­¤ç±»æ¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåº¦é‡å€¼ç­‰äºä»æœ¬ç½‘ç»œåˆ°è¾¾ç›®çš„ç½‘ç»œé—´çš„è®¾å¤‡æ•°é‡ã€‚</p><p>ä¸ºé™åˆ¶æ”¶æ•›æ—¶é—´ï¼ŒRIPè§„å®šåº¦é‡å€¼å–0ï½15ä¹‹é—´çš„æ•´æ•°ï¼Œå¤§äºæˆ–ç­‰äº16çš„è·³æ•°è¢«å®šä¹‰ä¸ºæ— ç©·å¤§ï¼Œå³ç›®çš„ç½‘ç»œæˆ–ä¸»æœºä¸å¯è¾¾ã€‚ç”±äºè¿™ä¸ªé™åˆ¶ï¼Œä½¿å¾—RIPä¸å¯èƒ½åœ¨å¤§å‹ç½‘ç»œä¸­å¾—åˆ°åº”ç”¨ã€‚</p><p>RIPè·¯ç”±å™¨å·¥ä½œæµç¨‹ï¼š</p><ul><li>RIPè·¯ç”±å™¨A,Båˆå§‹çš„è·¯ç”±è¡¨ä¸­åªæœ‰è‡ªå·±çš„ç›´è¿è·¯ç”±ã€‚</li><li>æ¯30ç§’ï¼Œå‘ç›¸é‚»è·¯ç”±å™¨å‘é€è‡ªå·±çš„è·¯ç”±è¡¨ã€‚</li><li>æ”¶åˆ°ç›¸é‚»è·¯ç”±å™¨çš„è·¯ç”±è¡¨åï¼Œæ›´æ–°è‡ªå·±çš„è·¯ç”±è¡¨ï¼š<ul><li>æ–°å¢ï¼šå¦‚æœæ”¶åˆ°çš„è·¯ç”±è¡¨ä¸­æœ‰è‡ªå·±æ²¡æœ‰çš„è·¯ç”±ï¼Œåˆ™æ·»åŠ åˆ°è‡ªå·±çš„è·¯ç”±è¡¨ä¸­ã€‚</li><li>æ›´æ–°ï¼šå¦‚æœæ”¶åˆ°çš„è·¯ç”±è¡¨ä¸­æœ‰è‡ªå·±å·²æœ‰çš„è·¯ç”±ï¼Œä¸”æ–°çš„è·³æ•°æ›´å°ï¼Œåˆ™æ›´æ–°è‡ªå·±çš„è·¯ç”±è¡¨çš„è·³æ•°ã€‚</li></ul></li><li>RIPè®¡æ—¶å™¨ï¼š<ul><li>æ›´æ–°è®¡æ—¶å™¨ï¼šæ¯30ç§’å·¦å³å‘é€ä¸€æ¬¡è·¯ç”±è¡¨ã€‚</li><li>å¤±æ•ˆè®¡æ—¶å™¨ï¼š180ç§’ï¼ˆ6å€æ›´æ–°æ—¶é—´ï¼‰æœªæ›´æ–°ï¼Œæ ‡è®°ä¸ºä¸å¯è¾¾ã€‚</li><li>åˆ·æ–°è®¡æ—¶å™¨ï¼šæ— æ•ˆè·¯ç”±240ç§’æœªæ›´æ–°ï¼Œä»è·¯ç”±è¡¨ä¸­åˆ é™¤ã€‚</li></ul></li></ul><p>RIPåè®®çš„ç¼ºç‚¹ï¼šåæ¶ˆæ¯ä¼ æ’­æ…¢ã€æ”¶æ•›æ—¶é—´é•¿ã€ä¸é€‚åˆå¤§å‹ç½‘ç»œ</p><h4 id="4-5-2-OSPFåè®®"><a href="#4-5-2-OSPFåè®®" class="headerlink" title="4.5.2 OSPFåè®®"></a>4.5.2 OSPFåè®®</h4><p>ä½¿ç”¨äº† Dijkstra æå‡ºçš„æœ€çŸ­è·¯å¾„ç®—æ³•SPF(Shortest Path First)ï¼Œæ˜¯åˆ†å¸ƒå¼çš„é“¾è·¯çŠ¶æ€åè®®</p><p>æ”¯æŒå¯å˜é•¿åº¦çš„å­ç½‘åˆ’åˆ†å’Œæ— åˆ†ç±»ç¼–å€ CIDR</p><p>äº”ç§åˆ†ç»„ç±»å‹ï¼šé—®å€™åˆ†ç»„Helloã€æ•°æ®åº“æè¿°åˆ†ç»„Database Descriptionã€é“¾è·¯çŠ¶æ€è¯·æ±‚åˆ†ç»„Link State Requestã€é“¾è·¯çŠ¶æ€æ›´æ–°åˆ†ç»„Link State Updateã€é“¾è·¯çŠ¶æ€ç¡®è®¤åˆ†ç»„Link State Acknowledgement</p><p>å½“äº’è”ç½‘è§„æ¨¡å¾ˆå¤§æ—¶ï¼ŒOSPF åè®®è¦æ¯”è·ç¦»å‘é‡åè®® RIP å¥½å¾—å¤šï¼Œä¸”æ²¡æœ‰â€œåæ¶ˆæ¯ä¼ æ’­å¾—æ…¢â€çš„é—®é¢˜</p><h4 id="4-5-3-BGPåè®®"><a href="#4-5-3-BGPåè®®" class="headerlink" title="4.5.3 BGPåè®®"></a>4.5.3 BGPåè®®</h4><p>BGP åªèƒ½æ˜¯åŠ›æ±‚å¯»æ‰¾ä¸€æ¡èƒ½å¤Ÿåˆ°è¾¾ç›®çš„ç½‘ç»œä¸”æ¯”è¾ƒå¥½çš„è·¯ç”±ï¼ˆä¸èƒ½å…œåœˆå­ï¼‰ï¼Œè€Œå¹¶éè¦å¯»æ‰¾ä¸€æ¡æœ€ä½³è·¯ç”±</p><p>ä¸€ä¸ªBGP å‘è¨€äººä¸å…¶ä»–è‡ªæ²»ç³»ç»Ÿä¸­çš„BGPå‘è¨€äººè¦äº¤æ¢è·¯ç”±ä¿¡æ¯å°±è¦å…ˆå»ºç«‹TCPè¿æ¥ï¼Œç„¶ååœ¨æ­¤è¿æ¥ä¸Šäº¤æ¢BGPæŠ¥æ–‡ä»¥å»ºç«‹BGPä¼šè¯(session)ï¼Œåˆ©ç”¨ BGP ä¼šè¯äº¤æ¢è·¯ç”±ä¿¡æ¯ã€‚</p><p>BGPåè®®çš„ç‰¹ç‚¹ï¼šæ”¯æŒCIDRã€åªåœ¨å‘ç”Ÿå˜åŒ–æ—¶æ›´æ–°æœ‰å˜åŒ–çš„éƒ¨åˆ†</p><p>å››ç§BGPæŠ¥æ–‡ï¼šæ‰“å¼€æŠ¥æ–‡Openï¼ˆä¸ç›¸é‚»BGPå‘è¨€äººå»ºç«‹è”ç³»ï¼‰ã€æ›´æ–°æŠ¥æ–‡Updateï¼ˆå‘é€è·¯ç”±ä¿¡æ¯ï¼‰ã€é€šçŸ¥æŠ¥æ–‡Notificationï¼ˆå‘é€å·®é”™ï¼‰ã€ä¿æŒæŠ¥æ–‡Keepaliveï¼ˆç¡®è®¤Openå’Œä¿æŒè¿æ¥ï¼‰</p><h3 id="4-6-è·¯ç”±å™¨çš„æ„æˆ"><a href="#4-6-è·¯ç”±å™¨çš„æ„æˆ" class="headerlink" title="4.6 è·¯ç”±å™¨çš„æ„æˆ"></a>4.6 è·¯ç”±å™¨çš„æ„æˆ</h3><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/4_3.png" alt="è·¯ç”±å™¨çš„ç»“æ„"></p><p>å¸¸ç”¨äº¤æ¢æ–¹æ³•ï¼šé€šè¿‡å­˜å‚¨å™¨ã€é€šè¿‡æ€»çº¿ã€é€šè¿‡çºµæ¨ªäº¤æ¢ç»“æ„</p><h4 id="4-7-IPå¤šæ’­"><a href="#4-7-IPå¤šæ’­" class="headerlink" title="4.7 IPå¤šæ’­"></a>4.7 IPå¤šæ’­</h4><p>TCP/IP åè®®ä½¿ç”¨çš„ä»¥å¤ªç½‘å¤šæ’­åœ°å€å—çš„èŒƒå›´æ˜¯ï¼šä» 00-00-5E-00-00-00 åˆ° 00-00-5E-FF-FF-FF</p><p>ä¸ºäº†ä½¿è·¯ç”±å™¨çŸ¥é“å¤šæ’­ç»„æˆå‘˜çš„ä¿¡æ¯ï¼Œéœ€è¦åˆ©ç”¨ç½‘é™…ç»„ç®¡ç†åè®®IGMP (Internet Group Management Protocol)ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦è·¯ç”±å™¨å¤šæ’­é€‰æ‹©åè®®</p><p>IGMPé˜¶æ®µï¼šåŠ å…¥å¤šæ’­ç»„ã€æ¢å¯»æˆå‘˜å˜åŒ–</p><p>å¤šæ’­è·¯ç”±é€‰æ‹©åè®®è½¬å‘å¤šæ’­æ•°æ®æŠ¥æ—¶ä½¿ç”¨ä¸‰ç§æ–¹æ³•ï¼šæ´ªæ³›ä¸å‰ªé™¤ï¼ˆé€‚åˆäºè¾ƒå°çš„å¤šæ’­ç»„ï¼ŒRPBï¼‰ã€éš§é“æŠ€æœ¯ã€åŸºäºæ ¸å¿ƒçš„å‘ç°æŠ€æœ¯</p><p>åå‘è·¯å¾„å¹¿æ’­RPB(Reverse Path Broadcasting)ï¼šè·¯ç”±å™¨æ”¶åˆ°å¤šæ’­æ•°æ®æŠ¥æ—¶ï¼Œæ£€æŸ¥æ•°æ®æŠ¥çš„æºåœ°å€ï¼Œå¦‚æœæ•°æ®æŠ¥çš„æºåœ°å€æ˜¯æœ€çŸ­è·¯å¾„æ ‘ä¸Šçš„æˆå‘˜ï¼Œåˆ™è½¬å‘æ•°æ®æŠ¥ï¼Œå¦åˆ™ä¸¢å¼ƒ</p><h2 id="äº”ã€ä¼ è¾“å±‚-è¿è¾“å±‚"><a href="#äº”ã€ä¼ è¾“å±‚-è¿è¾“å±‚" class="headerlink" title="äº”ã€ä¼ è¾“å±‚/è¿è¾“å±‚"></a>äº”ã€ä¼ è¾“å±‚/è¿è¾“å±‚</h2><p>è¿è¾“å±‚å‘å®ƒä¸Šé¢çš„åº”ç”¨å±‚æä¾›é€šä¿¡æœåŠ¡</p><p>åªæœ‰ä½äºç½‘ç»œè¾¹ç¼˜éƒ¨åˆ†çš„ä¸»æœºçš„åè®®æ ˆæ‰æœ‰è¿è¾“å±‚ï¼Œè€Œç½‘ç»œæ ¸å¿ƒéƒ¨åˆ†ä¸­çš„è·¯ç”±å™¨åœ¨è½¬å‘åˆ†ç»„æ—¶éƒ½åªç”¨åˆ°ä¸‹ä¸‰å±‚çš„åŠŸèƒ½</p><p>åº”ç”¨è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡åˆç§°ä¸ºç«¯åˆ°ç«¯çš„é€šä¿¡ï¼Œè¿è¾“å±‚æä¾›åº”ç”¨è¿›ç¨‹é—´çš„é€»è¾‘é€šä¿¡</p><div class="table-container"><table><thead><tr><th style="text-align:center">è¿è¾“å±‚</th><th style="text-align:center">ç½‘ç»œå±‚</th></tr></thead><tbody><tr><td style="text-align:center">ä¸ºåº”ç”¨è¿›ç¨‹ä¹‹é—´æä¾›ç«¯åˆ°ç«¯çš„é€»è¾‘é€šä¿¡</td><td style="text-align:center">ä¸ºä¸»æœºä¹‹é—´æä¾›é€»è¾‘é€šä¿¡</td></tr><tr><td style="text-align:center">å¯¹æŠ¥æ–‡è¿›è¡Œå·®é”™æ£€æµ‹</td><td style="text-align:center">å¯¹é¦–éƒ¨è¿›è¡Œå·®é”™æ£€æµ‹</td></tr><tr><td style="text-align:center">éœ€è¦ä¸¤ç§ä¸åŒçš„è¿è¾“åè®®ï¼Œå³é¢å‘è¿æ¥çš„TCPå’Œæ— è¿æ¥çš„UDP</td><td style="text-align:center">æ— è¿æ¥çš„IPåè®®</td></tr></tbody></table></div><p>åè®®ç«¯å£å·ï¼šç”¨äºæ ‡è¯†ä¸»æœºä¸Šçš„åº”ç”¨è¿›ç¨‹ï¼Œç®€ç§°ç«¯å£ã€‚16ä½ï¼ŒèŒƒå›´0~65535</p><ul><li>æœåŠ¡ç«¯ï¼š0~1023ä¸ºç†ŸçŸ¥ç«¯å£å·ï¼Œ1024~49151ä¸ºç™»è®°ç«¯å£å·</li><li>å®¢æˆ·ç«¯ï¼š49152(65536/4*3)~65535ä¸ºçŸ­æš‚ç«¯å£å·</li></ul><div class="table-container"><table><thead><tr><th style="text-align:center">åè®®</th><th style="text-align:center">FTP</th><th style="text-align:center">Telnet</th><th style="text-align:center">SMTP</th><th style="text-align:center">DNS</th><th style="text-align:center">HTTP</th><th style="text-align:center">SMTP</th><th style="text-align:center">HTTPS</th></tr></thead><tbody><tr><td style="text-align:center">ç†ŸçŸ¥ç«¯å£å·</td><td style="text-align:center">21/20</td><td style="text-align:center">23</td><td style="text-align:center">25</td><td style="text-align:center">53</td><td style="text-align:center">80</td><td style="text-align:center">110</td><td style="text-align:center">443</td></tr></tbody></table></div><h3 id="5-1-ç”¨æˆ·æ•°æ®æŠ¥åè®®UDP-v-s-ä¼ è¾“æ§åˆ¶åè®®TCP"><a href="#5-1-ç”¨æˆ·æ•°æ®æŠ¥åè®®UDP-v-s-ä¼ è¾“æ§åˆ¶åè®®TCP" class="headerlink" title="5.1 ç”¨æˆ·æ•°æ®æŠ¥åè®®UDP v.s. ä¼ è¾“æ§åˆ¶åè®®TCP"></a>5.1 ç”¨æˆ·æ•°æ®æŠ¥åè®®UDP v.s. ä¼ è¾“æ§åˆ¶åè®®TCP</h3><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">ç”¨æˆ·æ•°æ®æŠ¥åè®®UDP(User Datagram Protocol)</th><th style="text-align:center">ä¼ è¾“æ§åˆ¶åè®®TCP(Transmission Control Protocol)</th></tr></thead><tbody><tr><td style="text-align:center">è¿æ¥æœåŠ¡</td><td style="text-align:center">æ— è¿æ¥çš„åè®®ï¼Œæä¾›æ— è¿æ¥æœåŠ¡</td><td style="text-align:center">é¢å‘è¿æ¥çš„åè®®ï¼Œæä¾›é¢å‘è¿æ¥æœåŠ¡</td></tr><tr><td style="text-align:center">å¯é æ€§</td><td style="text-align:center">ä¸å¯é </td><td style="text-align:center">å…¨åŒå·¥çš„å¯é ä¿¡é“</td></tr><tr><td style="text-align:center">è¿è¾“åè®®æ•°æ®å•å…ƒTPDU</td><td style="text-align:center">UDPæŠ¥æ–‡/ç”¨æˆ·æ•°æ®æŠ¥</td><td style="text-align:center">TCPæŠ¥æ–‡æ®µ</td></tr><tr><td style="text-align:center">ä¼ è¾“æ–¹å¼</td><td style="text-align:center">å•æ’­ã€å¤šæ’­ã€å¹¿æ’­</td><td style="text-align:center">ç‚¹å¯¹ç‚¹å•æ’­ï¼Œä¸æ”¯æŒå¤šæ’­å’Œå¹¿æ’­</td></tr><tr><td style="text-align:center">é¢å‘</td><td style="text-align:center">æŠ¥æ–‡</td><td style="text-align:center">å­—èŠ‚æµ</td></tr><tr><td style="text-align:center">å¤æ‚æ€§</td><td style="text-align:center">ç®€å•</td><td style="text-align:center">å¤æ‚</td></tr><tr><td style="text-align:center">åº”ç”¨</td><td style="text-align:center">å¤šåª’ä½“</td><td style="text-align:center">æ–‡ä»¶ä¼ è¾“ã€ç”µå­é‚®ä»¶ã€WWW</td></tr><tr><td style="text-align:center">åº”ç”¨å±‚åè®®</td><td style="text-align:center">DNSã€TFTPã€SNMPã€NFS</td><td style="text-align:center">HTTPã€FTPã€Telnetã€SMTP</td></tr><tr><td style="text-align:center">æ‹¥å¡æ§åˆ¶</td><td style="text-align:center">æ— </td><td style="text-align:center">æœ‰</td></tr><tr><td style="text-align:center">é¦–éƒ¨å¼€é”€</td><td style="text-align:center">8å­—èŠ‚</td><td style="text-align:center">20å­—èŠ‚</td></tr></tbody></table></div><h3 id="5-2-ç”¨æˆ·æ•°æ®æŠ¥åè®®UDP"><a href="#5-2-ç”¨æˆ·æ•°æ®æŠ¥åè®®UDP" class="headerlink" title="5.2 ç”¨æˆ·æ•°æ®æŠ¥åè®®UDP"></a>5.2 ç”¨æˆ·æ•°æ®æŠ¥åè®®UDP</h3><p>åªåœ¨IPæ•°æ®æŠ¥ä¹‹ä¸Šå¢åŠ äº†å¤ç”¨å’Œåˆ†ç”¨ï¼ˆç«¯å£ï¼‰ã€å·®é”™æ£€æµ‹åŠŸèƒ½</p><h4 id="5-2-1-UDPé¦–éƒ¨æ ¼å¼"><a href="#5-2-1-UDPé¦–éƒ¨æ ¼å¼" class="headerlink" title="5.2.1 UDPé¦–éƒ¨æ ¼å¼"></a>5.2.1 UDPé¦–éƒ¨æ ¼å¼</h4><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/5_1.png" alt="UDPé¦–éƒ¨æ ¼å¼"></p><div class="table-container"><table><thead><tr><th style="text-align:center">å­—æ®µ</th><th style="text-align:center">é•¿åº¦</th><th style="text-align:center">å€¼</th><th style="text-align:center">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center">ä¼ªé¦–éƒ¨</td><td style="text-align:center">12B</td><td style="text-align:center">æºIPåœ°å€ã€ç›®çš„IPåœ°å€ã€åè®®å·ã€UDPé•¿åº¦</td><td style="text-align:center">ç”¨äºè®¡ç®—æ ¡éªŒå’Œ</td></tr><tr><td style="text-align:center">æºç«¯å£</td><td style="text-align:center">2B</td><td style="text-align:center">0~65535</td><td style="text-align:center">æ ‡è¯†å‘é€æ–¹åº”ç”¨è¿›ç¨‹</td></tr><tr><td style="text-align:center">ç›®çš„ç«¯å£</td><td style="text-align:center">2B</td><td style="text-align:center">0~65535</td><td style="text-align:center">æ ‡è¯†æ¥æ”¶æ–¹åº”ç”¨è¿›ç¨‹</td></tr><tr><td style="text-align:center">é•¿åº¦</td><td style="text-align:center">2B</td><td style="text-align:center">8~65535</td><td style="text-align:center">UDPæŠ¥æ–‡é•¿åº¦</td></tr><tr><td style="text-align:center">æ ¡éªŒå’Œ</td><td style="text-align:center">2B</td><td style="text-align:center">0~65535</td><td style="text-align:center">æ ¡éªŒUDPé¦–éƒ¨å’Œæ•°æ®</td></tr></tbody></table></div><h4 id="5-2-2-UDPæ ¡éªŒå’Œ"><a href="#5-2-2-UDPæ ¡éªŒå’Œ" class="headerlink" title="5.2.2 UDPæ ¡éªŒå’Œ"></a>5.2.2 UDPæ ¡éªŒå’Œ</h4><p>è¦åŠ ä¸Š12å­—èŠ‚çš„ä¼ªé¦–éƒ¨ï¼ŒåŒ…å«ï¼šæºIPåœ°å€ã€ç›®çš„IPåœ°å€ã€åè®®å·ã€UDPé•¿åº¦</p><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/5_2.png" alt="æ ¡éªŒå’Œè®¡ç®—"></p><ol><li>äºŒè¿›åˆ¶åç æ±‚å’Œï¼š<ol><li>ç»Ÿè®¡å‡ºæ¯ä¸€ä½ä¸Š1çš„ä¸ªæ•°ï¼š24135445 04247779</li><li>ä»æœ«å°¾å¼€å§‹ï¼Œæ¨¡äºŒè¿›ä½ï¼›é¦–ä½è¿›ä½åŠ åˆ°æœ«ä½<ul><li>24135445 042477(7+9/2=11)1</li><li>24135445 04247(7+11/2=12)11</li><li>24135445 0424(7+12/2=13)011</li><li>â€¦</li><li>(2+6/2=5)0010110 11001011</li><li>10010110 1100101(1+5/2=3)</li><li>10010110 110010(1+3/2=2)1</li><li>10010110 11001(0+2/2=1)01</li><li>10010110 11001101</li></ul></li></ol></li><li>å–åç ï¼š01101001 00110010ï¼Œå³ä¸ºæ ¡éªŒå’Œ</li></ol><h3 id="5-3-ä¼ è¾“æ§åˆ¶åè®®TCP"><a href="#5-3-ä¼ è¾“æ§åˆ¶åè®®TCP" class="headerlink" title="5.3 ä¼ è¾“æ§åˆ¶åè®®TCP"></a>5.3 ä¼ è¾“æ§åˆ¶åè®®TCP</h3><p>å¥—æ¥å­—(socket)ï¼šIPåœ°å€:ç«¯å£å·</p><p>æ¯ä¸€æ¡ TCP è¿æ¥å”¯ä¸€åœ°è¢«é€šä¿¡ä¸¤ç«¯çš„ä¸¤ä¸ªç«¯ç‚¹ï¼ˆå³ä¸¤ä¸ªå¥—æ¥å­—ï¼‰ç¡®å®šã€‚</p><h4 id="5-3-1-TCPé¦–éƒ¨æ ¼å¼"><a href="#5-3-1-TCPé¦–éƒ¨æ ¼å¼" class="headerlink" title="5.3.1 TCPé¦–éƒ¨æ ¼å¼"></a>5.3.1 TCPé¦–éƒ¨æ ¼å¼</h4><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/5_4.png" alt="TCPé¦–éƒ¨æ ¼å¼"></p><div class="table-container"><table><thead><tr><th style="text-align:center">å­—æ®µ</th><th style="text-align:center">é•¿åº¦</th><th style="text-align:center">å€¼</th><th style="text-align:center">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center">æºç«¯å£</td><td style="text-align:center">2B</td><td style="text-align:center">0~65535</td><td style="text-align:center">æ ‡è¯†å‘é€æ–¹åº”ç”¨è¿›ç¨‹</td></tr><tr><td style="text-align:center">ç›®çš„ç«¯å£</td><td style="text-align:center">2B</td><td style="text-align:center">0~65535</td><td style="text-align:center">æ ‡è¯†æ¥æ”¶æ–¹åº”ç”¨è¿›ç¨‹</td></tr><tr><td style="text-align:center">åºå·</td><td style="text-align:center">4B</td><td style="text-align:center">0~4294967295</td><td style="text-align:center">æ¯ä¸ªå­—èŠ‚éƒ½è¢«ç¼–å·ï¼Œè¿™æ˜¯æœ¬æŠ¥æ–‡æ®µçš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·</td></tr><tr><td style="text-align:center">ç¡®è®¤å·ack</td><td style="text-align:center">4B</td><td style="text-align:center">0~4294967295</td><td style="text-align:center">æœŸæœ›æ”¶åˆ°å¯¹æ–¹çš„ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„æ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·ï¼Œ=åºå·+æ•°æ®é•¿åº¦</td></tr><tr><td style="text-align:center">æ•°æ®åç§»</td><td style="text-align:center">4b</td><td style="text-align:center">0~15</td><td style="text-align:center">TCPé¦–éƒ¨é•¿åº¦ï¼Œå•ä½ä¸º4å­—èŠ‚ï¼Œæœ€å¤§ä¸º60å­—èŠ‚</td></tr><tr><td style="text-align:center">ä¿ç•™</td><td style="text-align:center">6b</td><td style="text-align:center">0</td><td style="text-align:center">ä¿ç•™ä½</td></tr><tr><td style="text-align:center">æ§åˆ¶ä½</td><td style="text-align:center">6b</td><td style="text-align:center">URGã€ACKã€PSHã€RSTã€SYNã€FIN</td><td style="text-align:center">URGï¼šç´§æ€¥æ•°æ®ä¼˜å…ˆä¼ é€<br>ACKï¼šç¡®è®¤å·å­—æ®µæœ‰æ•ˆ<br>PSHï¼šæ¥æ”¶æ–¹å°½å¿«å°†ç´¯ç§¯æ•°æ®äº¤ç»™åº”ç”¨å±‚<br>RSTï¼šè¿æ¥å·®é”™ï¼Œé‡ç½®è¿æ¥<br>SYNï¼šè¿æ¥è¯·æ±‚/æ¥å—<br>FINï¼šå‘é€å®Œæ¯•ï¼Œé‡Šæ”¾è¿æ¥</td></tr><tr><td style="text-align:center">çª—å£rwnd</td><td style="text-align:center">16b</td><td style="text-align:center">0~65535</td><td style="text-align:center">æ¥æ”¶çª—å£å¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚</td></tr><tr><td style="text-align:center">æ ¡éªŒå’Œ</td><td style="text-align:center">16b</td><td style="text-align:center">0~65535</td><td style="text-align:center">é¦–éƒ¨å’Œæ•°æ®çš„æ ¡éªŒå’Œ</td></tr><tr><td style="text-align:center">ç´§æ€¥æŒ‡é’ˆ</td><td style="text-align:center">16b</td><td style="text-align:center">0~65535</td><td style="text-align:center">ç´§æ€¥æ•°æ®çš„é•¿åº¦ï¼ˆå­—èŠ‚ï¼‰ï¼Œç´§æ€¥æ•°æ®æœ€åä¸€ä½=åºå·+ç´§æ€¥æŒ‡é’ˆ-1</td></tr><tr><td style="text-align:center">é€‰é¡¹</td><td style="text-align:center">å¯å˜</td><td style="text-align:center"></td><td style="text-align:center">æœ€å¤§æŠ¥æ–‡æ®µé•¿åº¦MSSã€çª—å£æ‰©å¤§é€‰é¡¹ï¼ˆ3å­—èŠ‚ï¼‰ã€æ—¶é—´æˆ³é€‰é¡¹ï¼ˆ10å­—èŠ‚ï¼‰ã€é€‰æ‹©ç¡®è®¤é€‰é¡¹</td></tr><tr><td style="text-align:center">å¡«å……</td><td style="text-align:center">å¯å˜</td><td style="text-align:center"></td><td style="text-align:center">ä½¿é¦–éƒ¨é•¿åº¦ä¸º4çš„å€æ•°</td></tr></tbody></table></div><h4 id="5-3-2-TCPå¯é ä¼ è¾“å·¥ä½œåŸç†"><a href="#5-3-2-TCPå¯é ä¼ è¾“å·¥ä½œåŸç†" class="headerlink" title="5.3.2 TCPå¯é ä¼ è¾“å·¥ä½œåŸç†"></a>5.3.2 TCPå¯é ä¼ è¾“å·¥ä½œåŸç†</h4><p>è‡ªåŠ¨é‡ä¼ è¯·æ±‚ARQ(Automatic Repeat reQuest)ï¼šä½¿ç”¨ç¡®è®¤å’Œé‡ä¼ æœºåˆ¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸å¯é çš„ä¼ è¾“ç½‘ç»œä¸Šå®ç°å¯é çš„é€šä¿¡ã€‚<br>é‡ä¼ æ˜¯è‡ªåŠ¨è¿›è¡Œçš„ï¼Œä¸éœ€è¦æ¥æ”¶æ–¹å‘é€é‡ä¼ è¯·æ±‚ã€‚</p><p>TCPè¿æ¥çš„æ¯ä¸€ç«¯éƒ½å¿…é¡»è®¾æœ‰ä¸¤ä¸ªçª—å£ï¼šä¸€ä¸ªå‘é€çª—å£å’Œä¸€ä¸ªæ¥æ”¶çª—å£ã€‚TCP ä¸¤ç«¯çš„å››ä¸ªçª—å£ç»å¸¸å¤„äºåŠ¨æ€å˜åŒ–ä¹‹ä¸­ã€‚<br>TCP çš„å¯é ä¼ è¾“æœºåˆ¶ç”¨å­—èŠ‚çš„åºå·è¿›è¡Œæ§åˆ¶ï¼ŒTCPæ‰€æœ‰çš„ç¡®è®¤éƒ½æ˜¯åŸºäºåºå·è€Œä¸æ˜¯åŸºäºæŠ¥æ–‡æ®µã€‚<br>TCPè¿æ¥çš„å¾€è¿”æ—¶é—´RTTä¹Ÿä¸æ˜¯å›ºå®šä¸å˜çš„ï¼Œéœ€è¦ä½¿ç”¨ç‰¹å®šçš„ç®—æ³•ä¼°ç®—è¾ƒä¸ºåˆç†çš„é‡ä¼ æ—¶é—´ã€‚</p><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">åœæ­¢ç­‰å¾…åè®®</th><th style="text-align:center">è¿ç»­ARQåè®®</th></tr></thead><tbody><tr><td style="text-align:center">å‘é€åˆ†ç»„æ•°é‡</td><td style="text-align:center">1</td><td style="text-align:center">å¤šä¸ª</td></tr><tr><td style="text-align:center">æ§åˆ¶ä¼ è¾“</td><td style="text-align:center">åœæ­¢-ç­‰å¾…</td><td style="text-align:center">æ»‘åŠ¨çª—å£åè®®</td></tr><tr><td style="text-align:center">ç¡®è®¤æ–¹å¼</td><td style="text-align:center">å•ç‹¬ç¡®è®¤</td><td style="text-align:center">å•ç‹¬ç¡®è®¤+ç´¯ç§¯ç¡®è®¤</td></tr><tr><td style="text-align:center">è¶…æ—¶å®šæ—¶</td><td style="text-align:center">æ¯ä¸ªå‘é€çš„åˆ†ç»„</td><td style="text-align:center">æ¯ä¸ªå‘é€çš„åˆ†ç»„</td></tr><tr><td style="text-align:center">åˆ†ç»„ç¼–å·</td><td style="text-align:center">æ¯ä¸ªåˆ†ç»„</td><td style="text-align:center">æ¯ä¸ªåˆ†ç»„</td></tr><tr><td style="text-align:center">é‡ä¼ æœºåˆ¶</td><td style="text-align:center">ä¸€ä¸ªåˆ†ç»„</td><td style="text-align:center">å›é€€N</td></tr></tbody></table></div><h4 id="5-3-3-åœæ­¢ç­‰å¾…åè®®"><a href="#5-3-3-åœæ­¢ç­‰å¾…åè®®" class="headerlink" title="5.3.3 åœæ­¢ç­‰å¾…åè®®"></a>5.3.3 åœæ­¢ç­‰å¾…åè®®</h4><p>åœæ­¢ç­‰å¾…åè®®æ˜¯ä¸€ç§ç®€å•çš„ARQåè®®ã€‚<br>åœ¨å‘é€å®Œä¸€ä¸ªåˆ†ç»„åï¼Œå¿…é¡»æš‚æ—¶ä¿ç•™å·±å‘é€çš„åˆ†ç»„çš„å‰¯æœ¬ã€‚<br>åˆ†ç»„å’Œç¡®è®¤åˆ†ç»„éƒ½å¿…é¡»è¿›è¡Œç¼–å·ã€‚</p><p>ä¼˜ç‚¹ï¼šç®€å•ã€æ˜“äºå®ç°</p><p>ç¼ºç‚¹ï¼šä¿¡é“åˆ©ç”¨ç‡ä½ $U=\dfrac{æ•°æ®å‘é€æ—¶é—´T_D}{T_D+å¾€è¿”æ—¶é—´RTT+ACKè¯»å–æ—¶é—´T_A}$</p><ol><li>æ— å·®é”™<ul><li>Aå‘é€åˆ†ç»„1ï¼Œå¯åŠ¨å®šæ—¶å™¨ï¼Œç­‰å¾…Bç¡®è®¤ï¼ˆACKï¼‰</li><li>Bæ”¶åˆ°åˆ†ç»„1ï¼Œå‘é€ACK</li><li>Aæ”¶åˆ°ACKï¼Œå‘é€åˆ†ç»„2</li></ul></li><li>åˆ†ç»„å·®é”™<ul><li>Aå‘é€åˆ†ç»„1ï¼Œå¯åŠ¨å®šæ—¶å™¨ï¼Œç­‰å¾…Bç¡®è®¤</li><li>åˆ†ç»„1æŸåä¸¢å¼ƒ/ä¸­é€”ä¸¢å¤±</li><li>Aè¶…æ—¶æœªæ”¶åˆ°ACKï¼Œé‡å‘åˆ†ç»„1</li><li>Bæ”¶åˆ°åˆ†ç»„1ï¼Œå‘é€ACK</li></ul></li><li>ç¡®è®¤å·®é”™/è¿Ÿåˆ°<ul><li>Aå‘é€åˆ†ç»„1ï¼Œå¯åŠ¨å®šæ—¶å™¨ï¼Œç­‰å¾…Bç¡®è®¤</li><li>Bæ”¶åˆ°åˆ†ç»„1ï¼Œå‘é€ACK</li><li>ACKä¸­é€”ä¸¢å¤±</li><li>Aè¶…æ—¶æœªæ”¶åˆ°ACKï¼Œé‡å‘åˆ†ç»„1</li><li>Bæ”¶åˆ°åˆ†ç»„1ï¼Œé‡å¤ï¼Œä¸¢å¼ƒï¼Œé‡å‘ACK</li><li>Aæ”¶åˆ°é‡å‘çš„ACKï¼Œå‘é€åˆ†ç»„2</li></ul></li></ol><h4 id="5-3-4-è¿ç»­ARQåè®®"><a href="#5-3-4-è¿ç»­ARQåè®®" class="headerlink" title="5.3.4 è¿ç»­ARQåè®®"></a>5.3.4 è¿ç»­ARQåè®®</h4><p>è¿ç»­ARQåè®®æ˜¯ä¸€ç§æµæ°´çº¿åè®®ï¼Œå…è®¸å‘é€æ–¹å‘é€å¤šä¸ªåˆ†ç»„è€Œä¸å¿…ç­‰å¾…æ¥æ”¶æ–¹çš„ç¡®è®¤ã€‚</p><p>ç¡®è®¤æ–¹å¼ï¼šæ¥æ”¶æ–¹ç´¯ç§¯ç¡®è®¤ï¼šä¸å¿…å¯¹æ”¶åˆ°çš„åˆ†ç»„é€ä¸ªå‘é€ç¡®è®¤ï¼Œè€Œæ˜¯å¯¹æŒ‰åºåˆ°è¾¾çš„æœ€åä¸€ä¸ªåˆ†ç»„å‘é€ç¡®è®¤ï¼Œè¡¨ç¤ºï¼šåˆ°è¿™ä¸ªåˆ†ç»„ä¸ºæ­¢çš„æ‰€æœ‰åˆ†ç»„éƒ½å·²æ­£ç¡®æ”¶åˆ°äº†ã€‚</p><p>ç´¯ç§¯ç¡®è®¤çš„ä¼˜ç‚¹æ˜¯ï¼šå®¹æ˜“å®ç°ï¼Œå³ä½¿ç¡®è®¤ä¸¢å¤±ä¹Ÿä¸å¿…é‡ä¼ ã€‚</p><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/5_3.png" alt="ç´¯ç§¯ç¡®è®¤"></p><p>é‡ä¼ æ–¹å¼ï¼šå›é€€Nï¼š5ä¸ªåˆ†ç»„ï¼Œç¬¬3ä¸ªå‡ºé”™ï¼Œæ¥æ”¶æ–¹åªå¯¹å‰2ä¸ªåˆ†ç»„å‘é€ç¡®è®¤ï¼Œå‘é€æ–¹æ”¶åˆ°ç¡®è®¤åï¼Œé‡ä¼ ç¬¬3ä¸ªåˆ†ç»„åŠåé¢çš„åˆ†ç»„ã€‚</p><h3 id="5-3-5-TCPå¯é é€šä¿¡å…·ä½“å®ç°"><a href="#5-3-5-TCPå¯é é€šä¿¡å…·ä½“å®ç°" class="headerlink" title="5.3.5 TCPå¯é é€šä¿¡å…·ä½“å®ç°"></a>5.3.5 TCPå¯é é€šä¿¡å…·ä½“å®ç°</h3><ul><li>å‡å®šAå‘Bå‘é€æ•°æ®ï¼Œå½“å‰Aæ”¶åˆ°äº†Bå‘æ¥çš„ç¡®è®¤æŠ¥æ–‡ï¼Œå…¶ä¸­çª—å£=20ï¼Œç¡®è®¤å·=31ï¼ˆè¡¨ç¤ºæœŸæœ›æ”¶åˆ°Açš„ä¸‹ä¸€ä¸ªæŠ¥æ–‡çš„åºå·ä¸º31ï¼Œä¸”30ä»¥å‰çš„æŠ¥æ–‡éƒ½å·²æ”¶åˆ°ï¼‰ã€‚</li><li>æ­¤æ—¶Açš„å‘é€çª—å£[31,50]ï¼ŒBçš„æ¥æ”¶çª—å£[31,50]ã€‚Aå‘é€31~41</li><li>å‡è®¾Bæ”¶åˆ°31~33ï¼Œå‘é€ç¡®è®¤å·34ï¼Œçª—å£=20çš„ACKï¼ŒåŒæ—¶Bçš„æ¥æ”¶çª—å£æ»‘åŠ¨è‡³[34,53]ã€‚</li><li>Aæ”¶åˆ°ACKï¼Œçª—å£æ»‘åŠ¨è‡³[34,53]ã€‚</li><li>æœªæ”¶åˆ°çš„æ•°æ®åœ¨è¶…æ—¶åé‡ä¼ ã€‚</li></ul><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/5_5.png" alt="TCPå¯é é€šä¿¡å…·ä½“å®ç°"></p><ul><li>å‘é€ç¼“å­˜ç”¨äºå­˜å‚¨ï¼šå·²å‘é€ä½†æœªæ”¶åˆ°ç¡®è®¤çš„æ•°æ®ã€å‡†å¤‡å‘é€çš„æ•°æ®</li><li>æ¥æ”¶ç¼“å­˜ç”¨äºå­˜å‚¨ï¼šå·²æ¥æ”¶ä½†æœªè¢«ä½¿ç”¨çš„æ•°æ®ã€æœªæŒ‰åºåˆ°è¾¾çš„æ•°æ®</li></ul><h4 id="5-3-6-è¶…æ—¶é‡ä¼ æ—¶é—´RTOçš„é€‰æ‹©"><a href="#5-3-6-è¶…æ—¶é‡ä¼ æ—¶é—´RTOçš„é€‰æ‹©" class="headerlink" title="5.3.6 è¶…æ—¶é‡ä¼ æ—¶é—´RTOçš„é€‰æ‹©"></a>5.3.6 è¶…æ—¶é‡ä¼ æ—¶é—´RTOçš„é€‰æ‹©</h4><ul><li>æŠ¥æ–‡å¾€è¿”æ—¶é—´RTTï¼šä»å‘é€æ–¹å‘é€æ•°æ®æŠ¥åˆ°æ¥æ”¶æ–¹æ”¶åˆ°ç¡®è®¤æŠ¥æ–‡çš„æ—¶é—´</li><li>åŠ æƒç§»åŠ¨å¹³å‡å¾€è¿”æ—¶é—´RTTsï¼šå½“ç›‘æµ‹åˆ°ä¸€ä¸ªæ–°çš„RTTæ—¶ï¼Œè®¡ç®—æ–°çš„RTTs<ul><li>$RTT_S=(1-\alpha)RTT_S+\alpha RTT$ï¼Œå…¶ä¸­$\alpha$ä¸€èˆ¬å–$\dfrac{1}{8}$</li></ul></li><li>å¹³å‡åå·®RTTdï¼šåˆå€¼ä¸ºç¬¬ä¸€æ¬¡RTTçš„ä¸€åŠï¼Œä¹‹åæ¯æ¬¡RTTçš„åå·®ä¸º<ul><li>$RTT_D=(1-\beta)RTT_D+\beta|RTT_S-RTT|$ï¼Œå…¶ä¸­$\beta$ä¸€èˆ¬å–$\dfrac{1}{4}$</li></ul></li><li>è¶…æ—¶é‡ä¼ æ—¶é—´RTOï¼šç•¥å¤§äºRTTsï¼Œ$RTO=RTT_S+4*RTT_D$</li></ul><p>é’ˆå¯¹è¶…æ—¶é‡ä¼ æ— æ³•å‡†ç¡®è®¡ç®—RTTçš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨Karnç®—æ³•ï¼š</p><ol><li>åªè¦æŠ¥æ–‡æ®µé‡ä¼ äº†ï¼Œå°±ä¸é‡‡ç”¨å…¶å¾€è¿”æ—¶é—´RTTæ ·æœ¬</li><li>æŠ¥æ–‡æ®µæ¯é‡ä¼ ä¸€æ¬¡ï¼Œå°±æŠŠè¶…æ—¶é‡ä¼ æ—¶é—´RTOå¢å¤§ä¸€äº›ï¼Œä¸€èˆ¬åŠ å€</li></ol><h3 id="5-4-TCPæµé‡æ§åˆ¶"><a href="#5-4-TCPæµé‡æ§åˆ¶" class="headerlink" title="5.4 TCPæµé‡æ§åˆ¶"></a>5.4 TCPæµé‡æ§åˆ¶</h3><p>ç«¯åˆ°ç«¯çš„é—®é¢˜</p><h4 id="5-4-1-æ»‘åŠ¨çª—å£å®ç°æµé‡æ§åˆ¶"><a href="#5-4-1-æ»‘åŠ¨çª—å£å®ç°æµé‡æ§åˆ¶" class="headerlink" title="5.4.1 æ»‘åŠ¨çª—å£å®ç°æµé‡æ§åˆ¶"></a>5.4.1 æ»‘åŠ¨çª—å£å®ç°æµé‡æ§åˆ¶</h4><p>æµé‡æ§åˆ¶ï¼šè®©å‘é€æ–¹å‘é€é€Ÿç‡ä¸è¦å¤ªå¿«ï¼Œè¦è®©æ¥æ”¶æ–¹æ¥å¾—åŠæ¥æ”¶ã€‚</p><p>ä¸‹å›¾çš„ä¼ è¾“æµç¨‹é€šè¿‡3æ¬¡æ›´æ”¹æ¥æ”¶çª—å£å¤§å°æ¥å®ç°æµé‡æ§åˆ¶ã€‚</p><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/5_6.png" alt="TCPæµé‡æ§åˆ¶"></p><p>æ­»é”ï¼š<br>Bå‘Aå‘é€rwnd=0çš„ACKåï¼ŒAä¸å†å‘é€æ•°æ®ã€‚<br>Båˆæœ‰äº†ä¸€äº›ç¼“å­˜ï¼Œå‘Aå‘é€rwnd&gt;0çš„ACKï¼Œä½†æ˜¯ä¸¢å¤±äº†ã€‚<br>Aç­‰å¾…Bçš„ACKï¼ŒBç­‰å¾…Açš„æ•°æ®ï¼Œå½¢æˆæ­»é”ã€‚</p><p>è§£å†³ï¼šæ”¶åˆ°rwnd=0åå¯åŠ¨æŒç»­è®¡æ—¶å™¨ï¼Œæ¯æ¬¡åˆ°æœŸå‘é€ä¸€ä¸ªâ€œé›¶çª—å£æ¢æµ‹æŠ¥æ–‡æ®µâ€</p><h4 id="5-4-2-æ§åˆ¶å‘é€æ—¶æœº"><a href="#5-4-2-æ§åˆ¶å‘é€æ—¶æœº" class="headerlink" title="5.4.2 æ§åˆ¶å‘é€æ—¶æœº"></a>5.4.2 æ§åˆ¶å‘é€æ—¶æœº</h4><ol><li>ç¼“å­˜å­˜æ”¾çš„æ•°æ®è¾¾åˆ°æœ€å¤§æŠ¥æ–‡æ®µé•¿åº¦MSSå­—èŠ‚æ—¶ï¼Œå‘é€ä¸€ä¸ªTCPæŠ¥æ–‡æ®µ</li><li>ç”±å‘é€æ–¹è¿›ç¨‹é€šè¿‡PSHã€URGæ ‡å¿—ä½æ§åˆ¶å‘é€æ—¶æœº</li><li>å‘é€æ–¹è®¡æ—¶å™¨åˆ°æœŸï¼Œå‘é€ä¸€ä¸ªæŠ¥æ–‡æ®µ</li></ol><p>Nagleç®—æ³•ï¼šåº”ç”¨é€å­—èŠ‚å‘é€æ•°æ®æ—¶ï¼Œé€šè¿‡å»¶è¿Ÿå‘é€å°æŠ¥æ–‡æ®µæ¥æé«˜ç½‘ç»œåˆ©ç”¨ç‡ã€‚</p><ul><li>å‘é€æ–¹å‘é€ç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚ï¼Œç¼“å­˜åç»­å­—èŠ‚</li><li>æ”¶åˆ°æ¥æ”¶æ–¹çš„ACKåï¼Œå‘é€ç¼“å­˜ä¸­çš„æ•°æ®</li><li>å½“åˆ°è¾¾çš„æ•°æ®è¾¾åˆ°å‘é€çª—å£å¤§å°ä¸€åŠæˆ–MSSæ—¶ï¼Œå‘é€ç¼“å­˜ä¸­çš„æ•°æ®</li></ul><p>ç³Šæ¶‚çª—å£ç»¼åˆç—‡ï¼šäº¤æ¢çš„æ•°æ®æ®µå¤§å°ä¸æ˜¯å…¨é•¿è€Œæ˜¯ä¸€äº›è¾ƒå°çš„æ•°æ®ã€‚ç”±äºæ¯ä¸ªæ•°æ®æ®µçš„æœ‰ç”¨æ•°æ®ï¼ˆæ•°æ®éƒ¨åˆ†ï¼‰è¾ƒå°‘ï¼Œå› è€Œæ¶ˆè€—çš„èµ„æºä¹Ÿæ›´å¤šï¼Œç›¸åº”çš„ä¼ è¾“æ•ˆç‡ä¹Ÿæ›´ä½ã€‚</p><p>è§£å†³ï¼šæ¥æ”¶æ–¹ç­‰å¾…ç¼“å­˜æœ‰è¶³å¤Ÿç©ºé—´åï¼Œå†å‘é€rwnd&gt;0çš„ACK</p><h3 id="5-5-TCPæ‹¥å¡æ§åˆ¶"><a href="#5-5-TCPæ‹¥å¡æ§åˆ¶" class="headerlink" title="5.5 TCPæ‹¥å¡æ§åˆ¶"></a>5.5 TCPæ‹¥å¡æ§åˆ¶</h3><p>æµé‡æ§åˆ¶:æ˜¯ç«¯åˆ°ç«¯çš„é—®é¢˜(æ¥æ”¶ç«¯æ§åˆ¶å‘é€ç«¯)ï¼Œç‚¹å¯¹ç‚¹é€šä¿¡é‡çš„æ§åˆ¶ã€‚æŠ‘åˆ¶å‘é€ç«¯å‘é€é€Ÿç‡ï¼Œä»¥ä¾¿ä½¿æ¥æ”¶ç«¯æ¥å¾—åŠæ¥æ”¶ã€‚</p><p>æ‹¥å¡æ§åˆ¶:æ˜¯ä¸€ä¸ªå…¨å±€æ€§çš„è¿‡ç¨‹ï¼Œæ¶‰åŠåˆ°ä¸é™ä½ç½‘ç»œä¼ è¾“æ€§èƒ½æœ‰å…³çš„æ‰€æœ‰å› ç´ ã€‚é˜²æ­¢è¿‡å¤šæ•°æ®æ³¨å…¥åˆ°ç½‘ç»œï¼Œä½¿ç½‘ç»œä¸­çš„è·¯ç”±å™¨æˆ–é“¾è·¯ä¸è‡´è¿‡è½½ã€‚</p><h4 id="5-5-1-æ‹¥å¡æ§åˆ¶çš„åŸºæœ¬åŸç†"><a href="#5-5-1-æ‹¥å¡æ§åˆ¶çš„åŸºæœ¬åŸç†" class="headerlink" title="5.5.1 æ‹¥å¡æ§åˆ¶çš„åŸºæœ¬åŸç†"></a>5.5.1 æ‹¥å¡æ§åˆ¶çš„åŸºæœ¬åŸç†</h4><p>å‡ºç°èµ„æºæ‹¥å¡çš„æ¡ä»¶ï¼šå¯¹èµ„æºéœ€æ±‚çš„æ€»å’Œ&gt;å¯ç”¨èµ„æº</p><p>åŸå› ï¼šé“¾è·¯å®¹é‡ä¸è¶³ã€èµ„æºåˆ†é…ä¸å‡ã€è·¯ç”±å™¨ç¼“å­˜ç©ºé—´å’Œæµé‡åˆ†å¸ƒä¸å‡ã€å¤„ç†æœºæ€§èƒ½ä¸è¶³ç­‰</p><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/5_7.png" alt="æ‹¥å¡æ§åˆ¶çš„ä½œç”¨"></p><p>å¼€ç¯æ§åˆ¶ï¼šè®¾è®¡ç½‘ç»œæ—¶å°±è€ƒè™‘åˆ°æ‹¥å¡æ§åˆ¶ï¼ŒåŠ›æ±‚é¿å…æ‹¥å¡çš„å‘ç”Ÿ</p><p>é—­ç¯æ§åˆ¶ï¼šåŸºäºåé¦ˆç¯è·¯</p><ul><li>ç›‘æµ‹ç½‘ç»œç³»ç»Ÿä»¥ä¾¿æ£€æµ‹åˆ°æ‹¥å¡åœ¨ä½•æ—¶ã€ä½•å¤„å‘ç”Ÿ</li><li>å°†æ‹¥å¡å‘ç”Ÿçš„ä¿¡æ¯ä¼ é€åˆ°å¯é‡‡å–è¡ŒåŠ¨çš„åœ°æ–¹</li><li>è°ƒæ•´ç½‘ç»œç³»ç»Ÿçš„è¿è¡Œä»¥è§£å†³å‡ºç°çš„é—®é¢˜</li></ul><p>æ‹¥å¡é€šçŸ¥çš„ä¼ é€’ç­–ç•¥ï¼šæ˜¾ç¤ºæ‹¥å¡é€šå‘ŠECN</p><h4 id="5-5-2-TCPæ‹¥å¡æ§åˆ¶ç®—æ³•"><a href="#5-5-2-TCPæ‹¥å¡æ§åˆ¶ç®—æ³•" class="headerlink" title="5.5.2 TCPæ‹¥å¡æ§åˆ¶ç®—æ³•"></a>5.5.2 TCPæ‹¥å¡æ§åˆ¶ç®—æ³•</h4><p>TCPé‡‡ç”¨åŸºäºçª—å£çš„æ–¹æ³•è¿›è¡Œæ‹¥å¡æ§åˆ¶ï¼Œå±äºé—­ç¯æ§åˆ¶ã€‚</p><p>TCPå‘é€æ–¹ç»´æŒä¸€ä¸ªæ‹¥å¡çª—å£ CWND(Congestion Window):</p><ul><li>æ‹¥å¡çª—å£çš„å¤§å°å–å†³äºç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ï¼Œå¹¶ä¸”åŠ¨æ€åœ°åœ¨å˜åŒ–</li><li>å‘é€ç«¯åˆ©ç”¨æ‹¥å¡çª—å£æ ¹æ®ç½‘ç»œçš„æ‹¥å¡æƒ…å†µè°ƒæ•´å‘é€çš„æ•°æ®é‡</li><li>ç½‘ç»œæ²¡æœ‰å‡ºç°æ‹¥å¡ï¼Œæ‹¥å¡çª—å£å¢å¤§ä¸€äº›ï¼Œä»¥ä¾¿å‘é€æ›´å¤šçš„åˆ†ç»„ï¼Œæé«˜ç½‘ç»œçš„åˆ©ç”¨ç‡</li><li>ç½‘ç»œå‡ºç°æ‹¥å¡æˆ–æœ‰å¯èƒ½å‡ºç°æ‹¥å¡ï¼Œæ‹¥å¡çª—å£å‡å°ä¸€äº›ï¼Œå‡å°‘æ³¨å…¥åˆ°ç½‘ç»œä¸­çš„åˆ†ç»„æ•°</li></ul><p>TCPæ‹¥å¡åˆ¤æ–­ä¾æ®ï¼šé‡ä¼ å®šæ—¶å™¨è¶…æ—¶</p><p>TCPè¿›è¡Œæ‹¥å¡æ§åˆ¶çš„ç®—æ³•æœ‰4ç§ï¼šæ…¢å¼€å§‹ã€æ‹¥å¡é¿å…ã€å¿«é‡ä¼ ã€å¿«æ¢å¤</p><h4 id="5-5-3-æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…"><a href="#5-5-3-æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…" class="headerlink" title="5.5.3 æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…"></a>5.5.3 æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…</h4><p>å‘é€æ–¹æœ€å¤§æŠ¥æ–‡æ®µSMSS(Sender Maximum Segment Size)ï¼šMTU/MSS</p><p>åˆå§‹æ‹¥å¡çª—å£cwndå¤§å°ï¼š</p><ul><li>æ—§è§„å®šï¼š1~2ä¸ªSMSS</li><li>æ–°è§„å®šRFC5681ï¼š<ul><li>$SMSS&gt;2190B$ï¼š$cwnd=2SMSS$ï¼Œ&lt;=2ä¸ªæŠ¥æ–‡æ®µ</li><li>$2190B\ge SMSS&gt;1095B$ï¼š$cwnd=3SMSS$ï¼Œ&lt;=3ä¸ªæŠ¥æ–‡æ®µ</li><li>$1095B\ge SMSS$ï¼š$cwnd=4SMSS$ï¼Œ&lt;=4ä¸ªæŠ¥æ–‡æ®µ</li></ul></li><li>æ…¢å¼€å§‹é—¨é™ssthreshï¼ˆçŠ¶æ€å˜é‡ï¼‰ï¼šé˜²æ­¢cwndå¢é•¿è¿‡å¿«å¼•èµ·ç½‘ç»œæ‹¥å¡<ul><li>$cwnd&lt;ssthresh$ï¼šæ…¢å¼€å§‹ç®—æ³•</li><li>$cwnd\ge ssthresh$ï¼šæ‹¥å¡é¿å…ç®—æ³•</li></ul></li></ul><p>æ…¢å¼€å§‹ç®—æ³•ï¼šcwndä»1å¼€å§‹ï¼Œ2ï¼Œ4ï¼Œ8ï¼Œ16æŒ‡æ•°å¢é•¿ï¼Œè‹¥è¶…å‡ºssthreshåˆ™å–ssthresh</p><p>é¿å…æ‹¥å¡ï¼šcwnd&gt;=ssthreshåï¼Œçº¿æ€§å¢é•¿ï¼Œæ¯ä¸ªRTTå¢åŠ 1</p><p>é‡åˆ°è¶…æ—¶ï¼šssthresh=cwnd/2ï¼Œcwnd=1ï¼Œæ…¢å¼€å§‹</p><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/5_8.png" alt="æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…"></p><h4 id="5-5-3-å¿«é‡ä¼ å’Œå¿«æ¢å¤"><a href="#5-5-3-å¿«é‡ä¼ å’Œå¿«æ¢å¤" class="headerlink" title="5.5.3 å¿«é‡ä¼ å’Œå¿«æ¢å¤"></a>5.5.3 å¿«é‡ä¼ å’Œå¿«æ¢å¤</h4><p>å¿«é‡ä¼ FR(Fast Retransmission)ç®—æ³•å¯ä»¥è®©å‘é€æ–¹å°½æ—©çŸ¥é“å‘ç”Ÿäº†ä¸ªåˆ«æŠ¥æ–‡æ®µçš„ä¸¢å¤±ã€‚</p><p>å‘é€æ–¹åªè¦ä¸€è¿æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤ï¼Œåº”å½“ç«‹å³è¿›è¡Œé‡ä¼ (å³â€œå¿«é‡ä¼ â€)ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºç°è¶…æ—¶ï¼Œå‘é€æ–¹ä¸ä¼šè¯¯è®¤ä¸ºå‡ºç°äº†ç½‘ç»œæ‹¥å¡ã€‚</p><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/5_9.png" alt="å¿«é‡ä¼ "></p><p>å¿«æ¢å¤ç®—æ³•ï¼šåœ¨å¿«é‡ä¼ çš„åŸºç¡€ä¸Šï¼Œå°†ssthreshå‡åŠï¼Œcwnd=ssthreshï¼Œç„¶åè¿›å…¥æ‹¥å¡é¿å…çŠ¶æ€</p><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/5_10.png" alt="TCPæ‹¥å¡æ§åˆ¶ç®—æ³•"></p><h3 id="5-6-TCPä¼ è¾“è¿æ¥ç®¡ç†"><a href="#5-6-TCPä¼ è¾“è¿æ¥ç®¡ç†" class="headerlink" title="5.6 TCPä¼ è¾“è¿æ¥ç®¡ç†"></a>5.6 TCPä¼ è¾“è¿æ¥ç®¡ç†</h3><p>TCPåè®®å·¥ä½œæµç¨‹ï¼š</p><ol><li>å»ºç«‹è¿æ¥ï¼šä¸‰æ¬¡æ¡æ‰‹<ol><li>å‘èµ·æ–¹å‘æ¥æ”¶æ–¹å‘é€SYNæŠ¥æ–‡ï¼Œè¯·æ±‚å»ºç«‹è¿æ¥<ul><li>SYN=1ï¼Œseq=xï¼Œè¡¨ç¤ºå‘é€æ–¹æœ¬æ¬¡æŠ¥æ–‡çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·æ˜¯x</li></ul></li><li>æ¥æ”¶æ–¹æ”¶åˆ°SYNæŠ¥æ–‡åï¼Œå›å¤SYN+ACKæŠ¥æ–‡ï¼Œè¡¨ç¤ºåŒæ„å»ºç«‹è¿æ¥<ul><li>SYN=1ï¼ŒACK=1</li><li>seq=yï¼Œè¡¨ç¤ºæ¥æ”¶æ–¹æœ¬æŠ¥æ–‡çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·æ˜¯y</li><li>ack=x+1ï¼Œè¡¨ç¤ºæ¥æ”¶æ–¹æœŸæœ›æ”¶åˆ°çš„ä¸‹ä¸€ä¸ªæŠ¥æ–‡çš„åºå·æ˜¯x+1ï¼Œå› ä¸ºSYNæŠ¥æ–‡å äº†ä¸€ä¸ªåºå·</li></ul></li><li>å‘èµ·æ–¹æ”¶åˆ°SYN+ACKæŠ¥æ–‡åï¼Œå›å¤ACKæŠ¥æ–‡ï¼Œè¡¨ç¤ºè¿æ¥å»ºç«‹æˆåŠŸ<ul><li>ACK=1</li><li>seq=x+1ï¼Œè¡¨ç¤ºå‘é€æ–¹æœ¬æŠ¥æ–‡çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·æ˜¯x+1</li><li>ack=y+1ï¼Œè¡¨ç¤ºå‘é€æ–¹æœŸæœ›æ”¶åˆ°çš„ä¸‹ä¸€ä¸ªæŠ¥æ–‡çš„åºå·æ˜¯y+1ï¼Œå› ä¸ºSYN+ACKæŠ¥æ–‡å äº†ä¸€ä¸ªåºå·</li></ul></li><li>ä¸‰æ¬¡æ¡æ‰‹å®Œæˆï¼Œè¿æ¥å»ºç«‹æˆåŠŸ</li></ol></li><li>æ•°æ®ä¼ è¾“ï¼šæ•°æ®ä¼ è¾“é˜¶æ®µ</li><li>æ–­å¼€è¿æ¥ï¼šå››æ¬¡æŒ¥æ‰‹<ol><li>å‘èµ·æ–¹å‘æ¥æ”¶æ–¹å‘é€FINæŠ¥æ–‡ï¼Œè¯·æ±‚æ–­å¼€è¿æ¥<ul><li>FIN=1ï¼Œseq=u</li></ul></li><li>æ¥æ”¶æ–¹æ”¶åˆ°FINæŠ¥æ–‡åï¼Œå›å¤ACKæŠ¥æ–‡ï¼Œè¡¨ç¤ºæ”¶åˆ°æ–­å¼€è¯·æ±‚<ul><li>ACK=1ï¼Œseq=vï¼Œack=u+1</li></ul></li><li>æ¥æ”¶æ–¹å‘å‘èµ·æ–¹å‘é€FIN+ACKæŠ¥æ–‡ï¼Œè¯·æ±‚æ–­å¼€è¿æ¥<ul><li>FIN=1ï¼ŒACK=1ï¼Œseq=wï¼Œack=u+1</li></ul></li><li>å‘èµ·æ–¹æ”¶åˆ°FIN+ACKæŠ¥æ–‡åï¼Œå›å¤ACKæŠ¥æ–‡ï¼Œè¡¨ç¤ºæ”¶åˆ°æ–­å¼€è¯·æ±‚ï¼Œç­‰å¾…2MSLåæ–­å¼€è¿æ¥<ul><li>ACK=1ï¼Œseq=u+1ï¼Œack=w+1</li></ul></li><li>å››æ¬¡æŒ¥æ‰‹å®Œæˆï¼Œè¿æ¥æ–­å¼€æˆåŠŸ</li></ol></li></ol><ul><li>è°æƒ³å»ºç«‹æˆ–æ–­å¼€è¿æ¥ï¼Œè°å°±æ˜¯å‘èµ·æ–¹ã€‚å‘èµ·æ–¹å°±æ˜¯å®¢æˆ·ç«¯ï¼Œæ¥æ”¶æ–¹å°±æ˜¯æœåŠ¡å™¨ç«¯ã€‚</li><li>MSL(Maximum Segment Lifetime)ï¼šæŠ¥æ–‡æœ€å¤§ç”Ÿå­˜æ—¶é—´ï¼Œ2MSLæ˜¯ä¸ºäº†ä¿è¯ç½‘ç»œä¸­çš„æ‰€æœ‰æŠ¥æ–‡éƒ½å·²ç»æ¶ˆå¤±ï¼Œä¸ä¼šå†æ¬¡å‡ºç°åœ¨ç½‘ç»œä¸­ï¼Œä¿è¯TCPåè®®çš„å…¨åŒå·¥è¿æ¥èƒ½å¤Ÿå¯é å…³é—­</li></ul><p>TCPå››ä¸ªè®¡æ—¶å™¨ï¼šè¶…æ—¶é‡ä¼ è®¡æ—¶å™¨ã€æŒç»­è®¡æ—¶å™¨(0çª—å£æŠ¥æ–‡æ¢æµ‹è®¡æ—¶å™¨)ã€æ—¶é—´ç­‰å¾…è®¡æ—¶å™¨(2MSLå…³é—­è¿æ¥)ã€ä¿æ´»è®¡æ—¶å™¨ã€TCPå‘é€æŠ¥æ–‡è®¡æ—¶å™¨ã€‚</p><h2 id="å…­ã€åº”ç”¨å±‚"><a href="#å…­ã€åº”ç”¨å±‚" class="headerlink" title="å…­ã€åº”ç”¨å±‚"></a>å…­ã€åº”ç”¨å±‚</h2><h3 id="6-1-åŸŸåç³»ç»ŸDNS"><a href="#6-1-åŸŸåç³»ç»ŸDNS" class="headerlink" title="6.1 åŸŸåç³»ç»ŸDNS"></a>6.1 åŸŸåç³»ç»ŸDNS</h3><p>åŸŸåæœåŠ¡å™¨ç±»å‹ï¼š</p><ol><li>æ ¹åŸŸåæœåŠ¡å™¨ï¼šç®¡ç†é¡¶çº§åŸŸåçš„æœåŠ¡å™¨</li><li>é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼šç®¡ç†åœ¨è¯¥é¡¶çº§åŸŸåæœåŠ¡å™¨æ³¨å†Œçš„äºŒçº§åŸŸåæœåŠ¡å™¨</li><li>æƒå¨åŸŸåæœåŠ¡å™¨ï¼šç®¡ç†è‡ªå·±çš„åŸŸå</li><li>æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼šæä¾›åŸŸåè§£ææœåŠ¡ï¼Œä¹Ÿç§°é»˜è®¤åŸŸåæœåŠ¡å™¨</li></ol><p>åŸŸåæŸ¥è¯¢æ–¹å¼ï¼š</p><ol><li>é€’å½’æŸ¥è¯¢ï¼šä¸»æœºå‘æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘å‡ºæŸ¥è¯¢è¯·æ±‚ï¼Œæœ¬åœ°åŸŸåæœåŠ¡å™¨ä¸çŸ¥é“ç­”æ¡ˆï¼Œåˆ™ä»¥DNSå®¢æˆ·èº«ä»½å‘æ ¹åŸŸåæœåŠ¡å™¨å‘å‡ºæŸ¥è¯¢è¯·æ±‚</li><li>è¿­ä»£æŸ¥è¯¢ï¼šæœ¬åœ°åŸŸåæœåŠ¡å™¨å‘æ ¹åŸŸåæœåŠ¡å™¨å‘å‡ºæŸ¥è¯¢è¯·æ±‚ï¼Œæ ¹åŸŸåæœåŠ¡å™¨å‘ŠçŸ¥æœ¬åœ°åŸŸåæœåŠ¡å™¨ä¸‹ä¸€æ­¥åº”è¯¥å‘å“ªä¸ªåŸŸåæœåŠ¡å™¨æŸ¥è¯¢ï¼Œæœ¬åœ°åŸŸåæœåŠ¡å™¨å†å‘ä¸‹ä¸€çº§åŸŸåæœåŠ¡å™¨å‘å‡ºæŸ¥è¯¢è¯·æ±‚</li></ol><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications/6_1.png" alt="DNSæŸ¥è¯¢è¿‡ç¨‹"></p><h3 id="6-2-æ–‡ä»¶ä¼ è¾“åè®®FTP"><a href="#6-2-æ–‡ä»¶ä¼ è¾“åè®®FTP" class="headerlink" title="6.2 æ–‡ä»¶ä¼ è¾“åè®®FTP"></a>6.2 æ–‡ä»¶ä¼ è¾“åè®®FTP</h3><p>æ–‡ä»¶ä¼ é€åè®® FTP (File Transfer Protocol) æ˜¯å› ç‰¹ç½‘ä¸Šä½¿ç”¨å¾—æœ€å¹¿æ³›çš„æ–‡ä»¶ä¼ é€åè®®</p><p>å®ç°äº†é€šè¿‡ç½‘ç»œå®ç°å¼‚æ„è®¡ç®—æœºé—´çš„æ–‡ä»¶â€œæ‹·è´â€ã€æä¾›äº¤äº’å¼çš„è®¿é—®ã€å±è”½äº†å„è®¡ç®—æœºç³»ç»Ÿçš„ç»†èŠ‚</p><p>FTPä½¿ç”¨2ä¸ªTCPè¿æ¥ï¼šæ§åˆ¶è¿æ¥å’Œæ•°æ®è¿æ¥</p><ul><li>æ§åˆ¶è¿æ¥ï¼ˆTCP21ï¼‰ï¼šç”¨äºä¼ é€è¯·æ±‚ï¼Œåœ¨æ•´ä¸ªä¼šè¯æœŸé—´ä¿æŒæ‰“å¼€çŠ¶æ€</li><li>æ•°æ®è¿æ¥ï¼ˆTCP20ï¼‰ï¼šç”¨äºä¼ é€æ–‡ä»¶å†…å®¹ï¼Œæ¯æ¬¡ä¼ é€æ–‡ä»¶æ—¶æ‰“å¼€ï¼Œä¼ é€å®Œæ¯•åå…³é—­</li><li>ç«¯å£å·ï¼šæœåŠ¡å™¨ä½¿ç”¨ç†ŸçŸ¥ç«¯å£TCP21/20ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨å…¶ä»–ç«¯å£å·&gt;1023</li></ul><p>FTPä¼ è¾“æ¨¡å¼ï¼šæ–‡æœ¬æ¨¡å¼/ASCIIæ¨¡å¼ã€äºŒè¿›åˆ¶æ¨¡å¼/Binaryæ¨¡å¼</p><h3 id="6-3-ç®€å•æ–‡ä»¶ä¼ è¾“åè®®TFTP"><a href="#6-3-ç®€å•æ–‡ä»¶ä¼ è¾“åè®®TFTP" class="headerlink" title="6.3 ç®€å•æ–‡ä»¶ä¼ è¾“åè®®TFTP"></a>6.3 ç®€å•æ–‡ä»¶ä¼ è¾“åè®®TFTP</h3><p>TFTP(Trivial File Transfer Protocol)æ˜¯ä¸€ä¸ªå¾ˆå°æ˜“äºå®ç°çš„æ–‡ä»¶ä¼ è¾“åè®®</p><p>åªæ”¯æŒä¼ è¾“æ–‡ä»¶ï¼Œä¸æ”¯æŒäº¤äº’ï¼Œä½¿ç”¨UDPæ•°æ®æŠ¥ä¼ è¾“ï¼Œç«¯å£å·UDP69</p><p>æ–‡ä»¶é•¿åº¦æ°å¥½ä¸º 512 å­—èŠ‚çš„æ•´æ•°å€ï¼Œåˆ™åœ¨æ–‡ä»¶ä¼ é€å®Œæ¯•åï¼Œè¿˜å¿…é¡»åœ¨æœ€åå‘é€ä¸€ä¸ªåªå«é¦–éƒ¨è€Œæ— æ•°æ®çš„æ•°æ®PDU</p><h3 id="6-4-è¿œç¨‹ç»ˆç«¯åè®®Telnet"><a href="#6-4-è¿œç¨‹ç»ˆç«¯åè®®Telnet" class="headerlink" title="6.4 è¿œç¨‹ç»ˆç«¯åè®®Telnet"></a>6.4 è¿œç¨‹ç»ˆç«¯åè®®Telnet</h3><p>C/Sæ¨¡å¼ï¼ŒTCPè¿æ¥ï¼ŒNVTæ ¼å¼ï¼Œç«¯å£å·é»˜è®¤TCP23</p><p>Telnetåè®®çš„ç¼ºç‚¹ï¼šæ˜æ–‡ä¼ é€</p><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">Telnet</th><th style="text-align:center">SSH</th></tr></thead><tbody><tr><td style="text-align:center">åŠŸèƒ½</td><td style="text-align:center">è¿œç¨‹ç™»å½•</td><td style="text-align:center">è¿œç¨‹ç™»å½•</td></tr><tr><td style="text-align:center">è¿è¾“å±‚åè®®</td><td style="text-align:center">TCP</td><td style="text-align:center">TCP</td></tr><tr><td style="text-align:center">åŠ å¯†</td><td style="text-align:center">æ˜æ–‡</td><td style="text-align:center">RSAåŠ å¯†ã€æ”¯æŒå‹ç¼©</td></tr><tr><td style="text-align:center">ç«¯å£å·</td><td style="text-align:center">23</td><td style="text-align:center">22</td></tr></tbody></table></div><h3 id="6-5-ä¸‡ç»´ç½‘WWW"><a href="#6-5-ä¸‡ç»´ç½‘WWW" class="headerlink" title="6.5 ä¸‡ç»´ç½‘WWW"></a>6.5 ä¸‡ç»´ç½‘WWW</h3><p>è¶…æ–‡æœ¬ä¼ è¾“åè®®HTTP(HyperText Transfer Protocol)æ˜¯ä¸‡ç»´ç½‘çš„åº”ç”¨å±‚åè®®ï¼Œé¢å‘äº‹åŠ¡ï¼Œæœ¬èº«æ— è¿æ¥ï¼Œæ˜¯å¯é äº¤æ¢æ–‡ä»¶çš„åŸºç¡€</p><p>HTTPåè®®æ°¸è¿œéƒ½æ˜¯å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯å“åº”è¯·æ±‚ï¼Œæ˜¯æ— çŠ¶æ€çš„åè®®ï¼Œé»˜è®¤ç«¯å£ï¼šTCP80</p><p>URLï¼š&lt;åè®®&gt;://&lt;ä¸»æœº&gt;:&lt;ç«¯å£&gt;/&lt;è·¯å¾„&gt;</p><p>HTTPæŠ¥æ–‡ï¼š</p><ul><li>è¯·æ±‚æŠ¥æ–‡ï¼šè¯·æ±‚è¡Œã€è¯·æ±‚å¤´ã€ç©ºè¡Œã€è¯·æ±‚ä½“</li><li>å“åº”æŠ¥æ–‡ï¼šçŠ¶æ€è¡Œã€å“åº”å¤´ã€ç©ºè¡Œã€å“åº”ä½“</li></ul><p>çŠ¶æ€ç ï¼šä¸‰ä½æ•°å­—</p><ul><li>1xxï¼šä¿¡æ¯æ€§çŠ¶æ€ç ï¼Œæ¥æ”¶åˆ°è¯·æ±‚ï¼Œç»§ç»­å¤„ç†</li><li>2xxï¼šæˆåŠŸçŠ¶æ€ç ï¼Œè¯·æ±‚æˆåŠŸæ¥æ”¶ã€ç†è§£ã€æ¥å—</li><li>3xxï¼šé‡å®šå‘çŠ¶æ€ç ï¼Œéœ€è¦è¿›ä¸€æ­¥æ“ä½œ</li><li>4xxï¼šå®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€ç ï¼Œè¯·æ±‚åŒ…å«è¯­æ³•é”™è¯¯æˆ–æ— æ³•å®Œæˆ</li><li>5xxï¼šæœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç ï¼ŒæœåŠ¡å™¨æ— æ³•å®Œæˆæ˜æ˜¾æœ‰æ•ˆçš„è¯·æ±‚</li></ul><h3 id="6-6-ç”µå­é‚®ä»¶"><a href="#6-6-ç”µå­é‚®ä»¶" class="headerlink" title="6.6 ç”µå­é‚®ä»¶"></a>6.6 ç”µå­é‚®ä»¶</h3><p>ä¸¤ä¸ªé‡è¦æ ‡å‡†ï¼šç®€å•é‚®ä»¶ä¼ é€åè®®ã€äº’è”ç½‘æŠ¥æ–‡äº¤æ¢æ ¼å¼(Internet Message Format)</p><p>ä¸‰ä¸ªä¸»è¦æ„ä»¶ï¼šç”¨æˆ·ä»£ç†ã€é‚®ä»¶æœåŠ¡å™¨ã€SMTPå’ŒPOP3åè®®</p><p>å‘é€é‚®ä»¶æµç¨‹ï¼š</p><ol><li>å‘ä»¶äººUAå‘å‘ä»¶äººé‚®ä»¶æœåŠ¡å™¨å‘é€é‚®ä»¶<ul><li>SMTPï¼ŒTCP25</li></ul></li><li>å‘ä»¶äººé‚®ä»¶æœåŠ¡å™¨ä»¥å®¢æˆ·çš„èº«ä»½å‘æ”¶ä»¶äººé‚®ä»¶æœåŠ¡å™¨å‘é€é‚®ä»¶<ul><li>SMTPï¼ŒTCP25</li></ul></li><li>æ”¶ä»¶äººä»æ”¶ä»¶äººé‚®ä»¶æœåŠ¡å™¨æ¥æ”¶é‚®ä»¶<ul><li>POP3ï¼ŒTCP110</li></ul></li></ol><p>SMTPä¸‰é˜¶æ®µï¼šæ¡æ‰‹ã€ä¼ è¾“ã€ç»“æŸ</p><p>POP3ï¼šä»…å®¢æˆ·ç«¯å†…è¯»å–</p><p>IMAPï¼šå®¢æˆ·ç«¯ä¸é‚®ä»¶æ›´æ–°åŒæ­¥</p><h3 id="6-7-DHCPåè®®"><a href="#6-7-DHCPåè®®" class="headerlink" title="6.7 DHCPåè®®"></a>6.7 DHCPåè®®</h3><ol><li>DHCP DiscoveræŠ¥æ–‡<ul><li>å®¢æˆ·ç«¯å¯åŠ¨æ—¶ï¼Œå®¢æˆ·ä¸»æœº-&gt;DHCPæœåŠ¡å™¨ï¼šè°èƒ½ç»™æˆ‘ä¸€ä¸ªIPåœ°å€ï¼Ÿ</li><li>æºåœ°å€ï¼š0.0.0.0</li><li>æºç«¯å£ï¼šUDP 68</li><li>ç›®çš„åœ°å€ï¼š255.255.255.255(å¹¿æ’­)</li><li>ç›®çš„ç«¯å£ï¼šUDP 67</li></ul></li><li>DHCP OfferæŠ¥æ–‡<ul><li>æœåŠ¡å™¨æ¥æ”¶åˆ°å¹¿æ’­æ•°æ®åŒ…åï¼ŒDHCPæœåŠ¡å™¨-&gt;å®¢æˆ·ä¸»æœºï¼šæˆ‘èƒ½ç»™ä½ åˆ†é…IPåœ°å€192.168.1.2</li><li>æºåœ°å€ï¼šæœåŠ¡å™¨IPåœ°å€</li><li>æºç«¯å£ï¼šUDP 67</li><li>ç›®çš„åœ°å€ï¼š255.255.255.255(å¹¿æ’­)</li><li>ç›®çš„ç«¯å£ï¼šUDP 68</li></ul></li><li>DHCP RequestæŠ¥æ–‡<ul><li>å®¢æˆ·ç«¯æ¥æ”¶åˆ°DHCPæœåŠ¡å™¨åˆ†é…çš„IPåœ°å€åï¼Œå®¢æˆ·ä¸»æœº-&gt;DHCPæœåŠ¡å™¨ï¼šå¥½çš„ï¼Œæˆ‘æ¥å—ä½ åˆ†é…çš„IPåœ°å€192.168.1.2ï¼Œè¯·æ±‚ç¡®è®¤</li><li>æºåœ°å€ï¼š0.0.0.0</li><li>æºç«¯å£ï¼šUDP 68</li><li>ç›®çš„åœ°å€ï¼š255.255.255.255(å¹¿æ’­)</li><li>ç›®çš„ç«¯å£ï¼šUDP 67</li></ul></li><li>DHCP ACKæŠ¥æ–‡<ul><li>æœåŠ¡å™¨æ¥æ”¶åˆ°å¹¿æ’­æ•°æ®åŒ…åï¼ŒDHCPæœåŠ¡å™¨-&gt;å®¢æˆ·ä¸»æœºï¼šå¥½çš„ï¼Œæˆ‘å·²ç»ç¡®è®¤åˆ†é…ç»™ä½ IPåœ°å€</li><li>æºåœ°å€ï¼šæœåŠ¡å™¨IPåœ°å€</li><li>æºç«¯å£ï¼šUDP 67</li><li>ç›®çš„åœ°å€ï¼š255.255.255.255(å¹¿æ’­)</li><li>ç›®çš„ç«¯å£ï¼šUDP 68</li></ul></li></ol><p>DHCPç«¯å£å·ï¼šUDP 67(æœåŠ¡å™¨)å’ŒUDP 68(å®¢æˆ·ç«¯)</p>]]></content>
    
    
    <summary type="html">åœ°çƒæ‘äº’è”çš„åŸºæœ¬åŸç†</summary>
    
    
    
    <category term="è¯¾ç¨‹ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="è¯¾ç¨‹ç¬”è®°" scheme="https://www.cclmsy.cc/tags/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šè®¡ç®—æœºç½‘ç»œä¸é€šä¿¡ å®éªŒã€‹è¯¾ç¨‹ç¬”è®°</title>
    <link href="https://www.cclmsy.cc/posts/Computer_Networks_and_Communications(Lab).html"/>
    <id>https://www.cclmsy.cc/posts/Computer_Networks_and_Communications(Lab).html</id>
    <published>2024-12-18T15:00:00.000Z</published>
    <updated>2024-12-17T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é›¶-æ¦‚è¿°"><a href="#é›¶-æ¦‚è¿°" class="headerlink" title="é›¶. æ¦‚è¿°"></a>é›¶. æ¦‚è¿°</h2><h3 id="0-1-ç½‘ç»œåˆ†å±‚OSIå‚è€ƒæ¨¡å‹"><a href="#0-1-ç½‘ç»œåˆ†å±‚OSIå‚è€ƒæ¨¡å‹" class="headerlink" title="0.1 ç½‘ç»œåˆ†å±‚OSIå‚è€ƒæ¨¡å‹"></a>0.1 ç½‘ç»œåˆ†å±‚OSIå‚è€ƒæ¨¡å‹</h3><p>OSIå‚è€ƒæ¨¡å‹æ˜¯å›½é™…æ ‡å‡†åŒ–ç»„ç»‡(ISO)åˆ¶å®šçš„ä¸€ä¸ªç”¨äºè®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„çš„æ ‡å‡†æ¡†æ¶ã€‚</p><p>OSIåˆ†ä¸º7å±‚ï¼Œè‡ªä¸Šè€Œä¸‹åˆ†åˆ«æ˜¯ï¼š</p><ul><li>7.åº”ç”¨å±‚ï¼šåº”ç”¨è½¯ä»¶</li><li>6.è¡¨ç¤ºå±‚ï¼šæ•°æ®æ ¼å¼è½¬æ¢</li><li>5.ä¼šè¯å±‚ï¼šå†³å®šé‡‡ç”¨å“ªç§ä¼ è¾“æ–¹å¼</li><li>4.ä¼ è¾“å±‚ï¼šæä¾›ç«¯åˆ°ç«¯çš„é€šä¿¡ï¼Œä¸»æœºè¿æ¥å»ºç«‹å’Œæ–­å¼€ï¼Œä¿è¯æ•°æ®ä¼ è¾“çš„å¯é æ€§</li><li>3.ç½‘ç»œå±‚ï¼šæ ¹æ®ç›®æ ‡åœ°å€å®ç°é€šä¿¡</li><li>2.æ•°æ®é“¾è·¯å±‚ï¼šæ ¹æ®ç‰©ç†åœ°å€å®ç°æ•°æ®çš„ä¼ è¾“</li><li>1.ç‰©ç†å±‚ï¼šä¼ è¾“ä»‹è´¨</li></ul><h3 id="0-2-TCP-IPå‚è€ƒæ¨¡å‹"><a href="#0-2-TCP-IPå‚è€ƒæ¨¡å‹" class="headerlink" title="0.2 TCP/IPå‚è€ƒæ¨¡å‹"></a>0.2 TCP/IPå‚è€ƒæ¨¡å‹</h3><p>TCP/IPå‚è€ƒæ¨¡å‹æ˜¯å®é™…åº”ç”¨æœ€å¹¿æ³›çš„ç½‘ç»œåè®®ä½“ç³»ç»“æ„ï¼Œå®ƒåªæœ‰4å±‚ï¼Œè‡ªä¸Šè€Œä¸‹åˆ†åˆ«æ˜¯ï¼š</p><ul><li>4.åº”ç”¨å±‚(åŒ…å«äº†OSIçš„åº”ç”¨å±‚ã€è¡¨ç¤ºå±‚ã€ä¼šè¯å±‚)<ul><li>æ•°æ®</li><li>åè®®ï¼šHTTPã€HTTPSã€SSHã€DNSã€FTPã€POP3ã€SMTPâ€¦</li></ul></li><li>3.ä¼ è¾“å±‚<ul><li>TCPé¦–éƒ¨+æ•°æ®</li><li>TCPï¼šé¢å‘è¿æ¥çš„å¯é ä¼ è¾“åè®®ï¼Œæ”¯æŒåº”ç”¨å±‚æ‰€æœ‰åè®®</li><li>UDPï¼šæ— è¿æ¥çš„ä¸å¯é ä¼ è¾“åè®®ï¼Œæ”¯æŒDNSã€DHCPã€SMBç­‰</li></ul></li><li>2.ç½‘ç»œå±‚<ul><li>IPé¦–éƒ¨+TCPé¦–éƒ¨+æ•°æ®</li><li>IPï¼šè´Ÿè´£æ•°æ®åŒ…çš„ä¼ è¾“</li><li>ICMPï¼šè´Ÿè´£ç½‘ç»œæ•…éšœè¯Šæ–­</li><li>ARPï¼šè´Ÿè´£åœ°å€è§£æ</li></ul></li><li>1.ç½‘ç»œæ¥å£å±‚(åŒ…å«äº†OSIçš„æ•°æ®é“¾è·¯å±‚ã€ç‰©ç†å±‚)<ul><li>æ•°æ®é“¾è·¯å±‚<ul><li>MACé¦–éƒ¨+LLCé¦–éƒ¨+IPé¦–éƒ¨+TCPé¦–éƒ¨+æ•°æ®+FCS(å¸§æ ¡éªŒåºåˆ—)</li><li>MACå­å±‚åè®®ï¼šå°†æ•°æ®åŒ…å°è£…æˆå¸§ï¼Œé€šè¿‡ç‰©ç†å±‚ä¼ è¾“</li></ul></li><li>ç‰©ç†å±‚<ul><li>ä¼ è¾“ä»‹è´¨</li></ul></li></ul></li></ul><h3 id="0-3-ç½‘ç»œå±‚"><a href="#0-3-ç½‘ç»œå±‚" class="headerlink" title="0.3 ç½‘ç»œå±‚"></a>0.3 ç½‘ç»œå±‚</h3><p>ç½‘ç»œå±‚å…³æ³¨çš„é—®é¢˜ï¼šå¦‚ä½•æ‰¾åˆ°åˆé€‚çš„ç½‘ç»œè·¯å¾„ï¼Œå°†æ•°æ®åŒ…ä»æºä¸»æœºä¼ è¾“åˆ°ç›®çš„ä¸»æœºã€‚</p><h4 id="0-3-1-æ•°æ®åŒ…åˆ†ç»„ä¸å°è£…"><a href="#0-3-1-æ•°æ®åŒ…åˆ†ç»„ä¸å°è£…" class="headerlink" title="0.3.1 æ•°æ®åŒ…åˆ†ç»„ä¸å°è£…"></a>0.3.1 æ•°æ®åŒ…åˆ†ç»„ä¸å°è£…</h4><p>ç½‘ç»œå±‚ä¸»è¦åè®®ï¼šIPã€ICMPã€ARP</p><ul><li>åˆ†ç»„äº¤æ¢ï¼šä»¥åˆ†ç»„ä¸ºå•ä½çš„<strong>å­˜å‚¨è½¬å‘</strong>çš„ä¼ è¾“æ–¹å¼ï¼Œå°†é•¿çš„æŠ¥æ–‡åˆ†å‰²æˆè‹¥å¹²çŸ­åˆ†ç»„è¿›è¡Œå¤šæ¬¡ä¼ è¾“ã€‚</li><li>è·¯ç”±è½¬å‘ï¼šæºä¸ç›®çš„ä¸»æœºä¹‹é—´å¯èƒ½å­˜åœ¨å¤šæ¡ç›¸é€šçš„è·¯å¾„ï¼Œç½‘ç»œå±‚é€‰æ‹©ä¸€æ¡â€œæœ€ä½³â€è·¯å¾„å®Œæˆæ•°æ®è½¬å‘ã€‚</li><li>æ‹¥å¡æ§åˆ¶ï¼šåˆç†åˆ†é…æ•°æ®åŒ…çš„è½¬å‘è·¯å¾„ï¼Œæé«˜è½¬å‘æ•ˆç‡ã€‚å½“äº§ç”Ÿç½‘ç»œæ‹¥å¡æ—¶ï¼ŒåŠæ—¶æ›´æ¢ä¼ è¾“è·¯å¾„ã€‚</li><li>å¼‚ç§ç½‘ç»œçš„äº’è¿ï¼šå½“æºä¸»æœºå’Œç›®æ ‡ä¸»æœºçš„ç½‘ç»œä¸å±äºåŒä¸€ç§ç½‘ç»œç±»å‹æ—¶ï¼Œä¸ºäº†è§£å†³ä¸åŒç½‘ç»œåœ¨å¯»å€ã€åˆ†ç»„å¤§å°ã€åè®®ç­‰æ–¹é¢çš„å·®å¼‚ï¼Œè¦æ±‚åœ¨ä¸åŒç§ç±»ç½‘ç»œäº¤ç•Œå¤„çš„è·¯ç”±å™¨èƒ½å¤Ÿå¯¹åˆ†ç»„è¿›è¡Œå¤„ç†ï¼Œä½¿å¾—åˆ†ç»„èƒ½å¤Ÿåœ¨ä¸åŒç½‘ç»œä¸Šä¼ è¾“ã€‚ä¸åŒçš„ç½‘ç»œç±»å‹å¯¹åˆ†ç»„å¤§å°è¦æ±‚ä¸ä¸€æ ·ï¼Œéœ€è¦é‡æ–°åˆ†ç»„ã€‚</li></ul><h4 id="0-3-2-ç½‘ç»œå±‚ä¸æ•°æ®é“¾è·¯å±‚çš„å…³ç³»"><a href="#0-3-2-ç½‘ç»œå±‚ä¸æ•°æ®é“¾è·¯å±‚çš„å…³ç³»" class="headerlink" title="0.3.2 ç½‘ç»œå±‚ä¸æ•°æ®é“¾è·¯å±‚çš„å…³ç³»"></a>0.3.2 ç½‘ç»œå±‚ä¸æ•°æ®é“¾è·¯å±‚çš„å…³ç³»</h4><ul><li>é€šä¿¡åŒæ–¹ï¼š<ul><li>æ•°æ®é“¾è·¯å±‚å®ç°åœ¨åŒä¸€å±€åŸŸç½‘å†…åˆ©ç”¨MACåœ°å€è¿›è¡Œé€šä¿¡</li><li>ç½‘ç»œå±‚å®ç°åœ¨ä¸åŒå±€åŸŸç½‘å†…åˆ©ç”¨IPåœ°å€è¿›è¡Œé€šä¿¡</li></ul></li><li>è§£å†³çš„é—®é¢˜ï¼š<ul><li>æ•°æ®é“¾è·¯å±‚å®ç°çš„æ˜¯ä¿è¯ä¸¤ç«¯é“¾è·¯çš„è¿é€šæ€§ï¼Œå¯ä»¥è¯´æ•°æ®é“¾è·¯å±‚ä¸èƒ½åˆ†è¾¨å¼‚æ„çš„ç½‘ç»œ</li><li>ç½‘ç»œå±‚è¦è§£å†³å¼‚æ„ç½‘ç»œäº’è”çš„é—®é¢˜ï¼ŒæŒ‰ç…§ä¸åŒç½‘ç»œåè®®çš„æ ¼å¼å®Œæˆæ•°æ®çš„é‡æ–°å°è£…</li></ul></li></ul><h4 id="0-3-3-IPåœ°å€ã€å­ç½‘æ©ç ï¼ˆSubnet-Maskï¼‰ã€ç½‘å…³ï¼ˆGatewayï¼‰"><a href="#0-3-3-IPåœ°å€ã€å­ç½‘æ©ç ï¼ˆSubnet-Maskï¼‰ã€ç½‘å…³ï¼ˆGatewayï¼‰" class="headerlink" title="0.3.3 IPåœ°å€ã€å­ç½‘æ©ç ï¼ˆSubnet Maskï¼‰ã€ç½‘å…³ï¼ˆGatewayï¼‰"></a>0.3.3 IPåœ°å€ã€å­ç½‘æ©ç ï¼ˆSubnet Maskï¼‰ã€ç½‘å…³ï¼ˆGatewayï¼‰</h4><p>IPåœ°å€ï¼šä¸»æœºåœ¨Internetä¸Šçš„ä¸€ä¸ªå…¨ä¸–ç•ŒèŒƒå›´å†…å”¯ä¸€32ä½æ ‡è¯†ç¬¦ï¼Œç”¨ç‚¹åˆ†åè¿›åˆ¶è¡¨ç¤ºï¼Œå¦‚192.168.0.1ã€‚</p><p>å­ç½‘æ©ç ï¼šç”¨æ¥åˆ’åˆ†ç½‘ç»œå’Œä¸»æœºçš„32ä½äºŒè¿›åˆ¶æ•°ï¼Œç”¨æ¥æŒ‡æ˜ä¸€ä¸ªIPåœ°å€çš„å“ªäº›ä½æ ‡è¯†ç½‘ç»œåœ°å€ï¼Œå“ªäº›ä½æ ‡è¯†ä¸»æœºåœ°å€ã€‚</p><p>è¡¨ç¤ºæ–¹æ³•ï¼š</p><ul><li>CIDRè¡¨ç¤ºæ³•ï¼š/å­ç½‘æ©ç ä½æ•°ï¼Œå¦‚/24è¡¨ç¤ºå‰24ä½æ˜¯1ï¼Œå…¶ä½™8ä½æ˜¯0</li><li>ç‚¹åˆ†åè¿›åˆ¶ï¼šxxx.xxx.xxx.xxxï¼Œå¦‚255.255.255.0</li><li>è½¬æ¢ä¾‹ï¼š255.255.254.0 -&gt; 11111111.11111111.11111110.00000000 -&gt; /23</li></ul><p>ç½‘å…³ï¼šä¸€ä¸ªç½‘ç»œçš„å‡ºå£ã€‚å½“ä¸€ä¸ªä¸»æœºè¦å°†æ•°æ®å‘é€ç»™å…¶ä»–ç½‘ç»œçš„ä¸»æœºæ—¶ï¼Œé€šå¸¸é¦–å…ˆå°†æ•°æ®å‘å¾€ç½‘å…³ã€‚</p><h4 id="0-3-4-IPåœ°å€åˆ†ç±»"><a href="#0-3-4-IPåœ°å€åˆ†ç±»" class="headerlink" title="0.3.4 IPåœ°å€åˆ†ç±»"></a>0.3.4 IPåœ°å€åˆ†ç±»</h4><p>IPåœ°å€åˆ†ä¸ºAã€Bã€Cã€Dã€Eäº”ç±»ï¼Œæ¯ç±»åœ°å€çš„ç½‘ç»œå·å’Œä¸»æœºå·çš„åˆ’åˆ†ä¸åŒã€‚</p><div class="table-container"><table><thead><tr><th>ç±»åˆ«</th><th>å‰ç¼€</th><th>ç½‘ç»œå·</th><th>ä¸»æœºå·</th><th>ç¬¬ä¸€å­—èŠ‚èŒƒå›´</th><th>å­ç½‘æ©ç </th><th>ä¸»æœºæ•°</th><th>é¢„ç•™ç§æœ‰åœ°å€ç½‘æ®µï¼ˆRFC 1918ï¼‰</th></tr></thead><tbody><tr><td>Aç±»</td><td>0</td><td>7ä½</td><td>24ä½</td><td>0~127</td><td>/8</td><td>2^24-2=16777214</td><td>10.0.0.0~10.255.255.255</td></tr><tr><td>Bç±»</td><td>10</td><td>14ä½</td><td>16ä½</td><td>128~191</td><td>/16</td><td>2^16-2=65534</td><td>172.16.0.0~172.31.255.255</td></tr><tr><td>Cç±»</td><td>110</td><td>21ä½</td><td>8ä½</td><td>192~223</td><td>/24</td><td>2^8-2=254</td><td>192.168.0.0~192.168.255.255</td></tr><tr><td>Dç±»</td><td>1110</td><td>å¤šæ’­åœ°å€28ä½</td><td>-</td><td>224~239</td><td>-</td><td>-</td><td>-</td></tr><tr><td>Eç±»</td><td>1111</td><td>ä¿ç•™åœ°å€</td><td>-</td><td>240~255</td><td>-</td><td>-</td><td>-</td></tr></tbody></table></div><h4 id="0-3-5-å­ç½‘åˆ’åˆ†"><a href="#0-3-5-å­ç½‘åˆ’åˆ†" class="headerlink" title="0.3.5 å­ç½‘åˆ’åˆ†"></a>0.3.5 å­ç½‘åˆ’åˆ†</h4><p>å€Ÿä½ï¼šä»ä¸»æœºæœ€é«˜ä½å¼€å§‹å€Ÿä½å˜ä¸ºæ–°çš„å­ç½‘ä½ï¼Œå‰©ä½™éƒ¨åˆ†ä»ä¸ºä¸»æœºä½</p><p>ä¾‹å¦‚192.168.1.0/24å¯åˆ’åˆ†ä¸ºï¼š</p><ul><li>2ä¸ªå­ç½‘ï¼š192.168.1.0/25ã€192.168.1.128/25</li><li>4ä¸ªå­ç½‘ï¼š192.168.1.0/26ã€192.168.1.64/26ã€192.168.1.128/26ã€192.168.1.192/26</li></ul><div STYLE="page-break-after: always;"></div><h2 id="ä¸€-ä¼ è¾“ä»‹è´¨"><a href="#ä¸€-ä¼ è¾“ä»‹è´¨" class="headerlink" title="ä¸€. ä¼ è¾“ä»‹è´¨"></a>ä¸€. ä¼ è¾“ä»‹è´¨</h2><h3 id="1-1-ä¼ è¾“ä»‹è´¨åˆ†ç±»"><a href="#1-1-ä¼ è¾“ä»‹è´¨åˆ†ç±»" class="headerlink" title="1.1 ä¼ è¾“ä»‹è´¨åˆ†ç±»"></a>1.1 ä¼ è¾“ä»‹è´¨åˆ†ç±»</h3><h4 id="1-1-1-æœ‰çº¿ä¼ è¾“ä»‹è´¨"><a href="#1-1-1-æœ‰çº¿ä¼ è¾“ä»‹è´¨" class="headerlink" title="1.1.1 æœ‰çº¿ä¼ è¾“ä»‹è´¨"></a>1.1.1 æœ‰çº¿ä¼ è¾“ä»‹è´¨</h4><p>æœ‰çº¿ä¼ è¾“ä»‹è´¨æ˜¯æŒ‡åœ¨ä¸¤ä¸ªé€šä¿¡è®¾å¤‡ä¹‹é—´å®ç°çš„ç‰©ç†è¿æ¥éƒ¨åˆ†ï¼Œå®ƒèƒ½å°†ä¿¡å·ä»ä¸€æ–¹ä¼ è¾“åˆ°å¦ä¸€æ–¹ã€‚</p><p>æœ‰çº¿ä¼ è¾“ä»‹è´¨ä¸»è¦æœ‰<strong>åŒç»çº¿</strong>ã€åŒè½´ç”µç¼†å’Œå…‰çº¤ã€‚åŒç»çº¿å’ŒåŒè½´ç”µç¼†ä¼ è¾“ç”µä¿¡å·ï¼Œå…‰çº¤ä¼ è¾“å…‰ä¿¡å·ã€‚</p><h4 id="1-1-2-æ— çº¿ä¼ è¾“ä»‹è´¨"><a href="#1-1-2-æ— çº¿ä¼ è¾“ä»‹è´¨" class="headerlink" title="1.1.2 æ— çº¿ä¼ è¾“ä»‹è´¨"></a>1.1.2 æ— çº¿ä¼ è¾“ä»‹è´¨</h4><p>åœ¨è‡ªç”±ç©ºé—´ä¼ è¾“çš„ç”µç£æ³¢æ ¹æ®é¢‘è°±å¯å°†å…¶åˆ†ä¸ºæ— çº¿ç”µæ³¢ã€å¾®æ³¢ã€çº¢å¤–çº¿ã€æ¿€å…‰ç­‰ï¼Œä¿¡æ¯è¢«åŠ è½½åœ¨ç”µç£æ³¢ä¸Šè¿›è¡Œä¼ è¾“ã€‚åœ¨å±€åŸŸç½‘ä¸­ï¼Œé€šå¸¸åªä½¿ç”¨æ— çº¿ç”µæ³¢å’Œçº¢å¤–çº¿ä½œä¸ºä¼ è¾“ä»‹è´¨ã€‚</p><h4 id="1-1-3-ç›´è¿çº¿å’Œäº¤å‰çº¿çš„åŒºåˆ«"><a href="#1-1-3-ç›´è¿çº¿å’Œäº¤å‰çº¿çš„åŒºåˆ«" class="headerlink" title="1.1.3 ç›´è¿çº¿å’Œäº¤å‰çº¿çš„åŒºåˆ«"></a>1.1.3 ç›´è¿çº¿å’Œäº¤å‰çº¿çš„åŒºåˆ«</h4><p>ç›´è¿çº¿ï¼šä¸¤ç«¯çš„çº¿åºç›¸åŒï¼Œç”¨äºè¿æ¥ä¸åŒè®¾å¤‡ã€‚</p><ul><li>PC&lt;-&gt;Hub/Switch</li></ul><p>äº¤å‰çº¿ï¼šä¸¤ç«¯çš„çº¿åºä¸åŒï¼Œç”¨äºè¿æ¥ç›¸åŒè®¾å¤‡ã€‚</p><h3 id="1-2-åŒç»çº¿åˆ¶ä½œ"><a href="#1-2-åŒç»çº¿åˆ¶ä½œ" class="headerlink" title="1.2 åŒç»çº¿åˆ¶ä½œ"></a>1.2 åŒç»çº¿åˆ¶ä½œ</h3><h4 id="1-2-1-åŒç»çº¿åˆ¶ä½œæ ‡å‡†ï¼šEIA-TIA-568"><a href="#1-2-1-åŒç»çº¿åˆ¶ä½œæ ‡å‡†ï¼šEIA-TIA-568" class="headerlink" title="1.2.1 åŒç»çº¿åˆ¶ä½œæ ‡å‡†ï¼šEIA/TIA 568"></a>1.2.1 åŒç»çº¿åˆ¶ä½œæ ‡å‡†ï¼šEIA/TIA 568</h4><ul><li>Aï¼šç™½ç»¿/ç»¿/ç™½æ©™/è“/ç™½è“/æ©™/ç™½æ£•/æ£•</li><li>Bï¼šç™½æ©™/æ©™/ç™½ç»¿/è“/ç™½è“/ç»¿/ç™½æ£•/æ£•</li></ul><h4 id="1-2-2-åŒç»çº¿åˆ¶ä½œæ­¥éª¤"><a href="#1-2-2-åŒç»çº¿åˆ¶ä½œæ­¥éª¤" class="headerlink" title="1.2.2 åŒç»çº¿åˆ¶ä½œæ­¥éª¤"></a>1.2.2 åŒç»çº¿åˆ¶ä½œæ­¥éª¤</h4><ol><li>å‰¥çº¿ï¼šç”¨å‹çº¿é’³å°†åŒç»çº¿ä¸€ç«¯çš„å¤–çš®å‰¥å»3cmï¼Œéœ²å‡º8æ ¹çº¿ã€‚</li><li>ç†çº¿ï¼šå°†4å¯¹å¯¼çº¿åˆ†åˆ«ç»•å¼€ï¼Œ8æ ¹å¯¼çº¿æŒ‰EIA/TIA 568Bæ ‡å‡†é¡ºåºæ’åˆ—ï¼Œå°†çº¿èŠ¯æ’¸ç›´å¹¶æ‹¢ã€‚</li><li>å‰ªçº¿ï¼šå°†èŠ¯çº¿æ”¾åˆ°å‹çº¿é’³åˆ‡åˆ€å¤„ï¼Œ8æ ¹çº¿èŠ¯è¦åœ¨åŒä¸€å¹³é¢ä¸Šå¹¶æ‹¢ï¼Œè€Œä¸”å°½é‡ç›´ï¼Œç•™ä¸‹ä¸€å®šçš„çº¿èŠ¯é•¿åº¦çº¦1.5CMå¤„å‰ªé½ã€‚</li><li>æ’çº¿ï¼šå°†åŒç»çº¿æ’å…¥RJ45æ°´æ™¶å¤´ä¸­ï¼Œæ’å…¥è¿‡ç¨‹å‡è¡¡åŠ›åº¦ç›´åˆ°æ’åˆ°å°½å¤´ã€‚æ£€æŸ¥8æ ¹çº¿èŠ¯æ˜¯å¦å·²ç»å…¨éƒ¨å……åˆ†ã€æ•´é½åœ°æ’åˆ—åœ¨æ°´æ™¶å¤´é‡Œé¢ã€‚</li><li>å‹çº¿ï¼šç”¨å‹çº¿é’³ç”¨åŠ›å‹ç´§æ°´æ™¶å¤´ï¼ŒæŠ½å‡ºå³å¯ã€‚</li></ol><h4 id="1-2-3-åŒç»çº¿æµ‹è¯•"><a href="#1-2-3-åŒç»çº¿æµ‹è¯•" class="headerlink" title="1.2.3 åŒç»çº¿æµ‹è¯•"></a>1.2.3 åŒç»çº¿æµ‹è¯•</h4><p>ç›´è¿çº¿(ä¸¤ç«¯éƒ½æ˜¯568Bæ ‡å‡†)ï¼š12345678</p><p>äº¤å‰çº¿(ä¸€ç«¯æ˜¯568Aæ ‡å‡†ï¼Œä¸€ç«¯æ˜¯568Bæ ‡å‡†)ï¼š36145278</p><p>100Mbpsä»¥å¤ªç½‘çº¿å®é™…ä½¿ç”¨çš„çº¿ï¼šç™½ç»¿/ç»¿/ç™½æ©™/æ©™</p><div STYLE="page-break-after: always;"></div><h2 id="äºŒ-DHCP"><a href="#äºŒ-DHCP" class="headerlink" title="äºŒ. DHCP"></a>äºŒ. DHCP</h2><h3 id="2-1-DHCPå·¥ä½œåŸç†"><a href="#2-1-DHCPå·¥ä½œåŸç†" class="headerlink" title="2.1 DHCPå·¥ä½œåŸç†"></a>2.1 DHCPå·¥ä½œåŸç†</h3><p>DHCP(Dynamic Host Configuration Protocol)æ˜¯ä¸€ç§åŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼Œå®ƒæ˜¯ä¸€ç§è‡ªåŠ¨åˆ†é…IPåœ°å€çš„åè®®ã€‚</p><h4 id="DHCPå·¥ä½œåŸç†"><a href="#DHCPå·¥ä½œåŸç†" class="headerlink" title="DHCPå·¥ä½œåŸç†"></a>DHCPå·¥ä½œåŸç†</h4><ol><li>DHCP DiscoveræŠ¥æ–‡<ul><li>å®¢æˆ·ç«¯å¯åŠ¨æ—¶ï¼Œå®¢æˆ·ä¸»æœº-&gt;DHCPæœåŠ¡å™¨ï¼šè°èƒ½ç»™æˆ‘ä¸€ä¸ªIPåœ°å€ï¼Ÿ</li><li>æºåœ°å€ï¼š0.0.0.0</li><li>æºç«¯å£ï¼šUDP 68</li><li>ç›®çš„åœ°å€ï¼š255.255.255.255(å¹¿æ’­)</li><li>ç›®çš„ç«¯å£ï¼šUDP 67</li></ul></li><li>DHCP OfferæŠ¥æ–‡<ul><li>æœåŠ¡å™¨æ¥æ”¶åˆ°å¹¿æ’­æ•°æ®åŒ…åï¼ŒDHCPæœåŠ¡å™¨-&gt;å®¢æˆ·ä¸»æœºï¼šæˆ‘èƒ½ç»™ä½ åˆ†é…IPåœ°å€192.168.1.2</li><li>æºåœ°å€ï¼šæœåŠ¡å™¨IPåœ°å€</li><li>æºç«¯å£ï¼šUDP 67</li><li>ç›®çš„åœ°å€ï¼š255.255.255.255(å¹¿æ’­)</li><li>ç›®çš„ç«¯å£ï¼šUDP 68</li></ul></li><li>DHCP RequestæŠ¥æ–‡<ul><li>å®¢æˆ·ç«¯æ¥æ”¶åˆ°DHCPæœåŠ¡å™¨åˆ†é…çš„IPåœ°å€åï¼Œå®¢æˆ·ä¸»æœº-&gt;DHCPæœåŠ¡å™¨ï¼šå¥½çš„ï¼Œæˆ‘æ¥å—ä½ åˆ†é…çš„IPåœ°å€192.168.1.2ï¼Œè¯·æ±‚ç¡®è®¤</li><li>æºåœ°å€ï¼š0.0.0.0</li><li>æºç«¯å£ï¼šUDP 68</li><li>ç›®çš„åœ°å€ï¼š255.255.255.255(å¹¿æ’­)</li><li>ç›®çš„ç«¯å£ï¼šUDP 67</li></ul></li><li>DHCP ACKæŠ¥æ–‡<ul><li>æœåŠ¡å™¨æ¥æ”¶åˆ°å¹¿æ’­æ•°æ®åŒ…åï¼ŒDHCPæœåŠ¡å™¨-&gt;å®¢æˆ·ä¸»æœºï¼šå¥½çš„ï¼Œæˆ‘å·²ç»ç¡®è®¤åˆ†é…ç»™ä½ IPåœ°å€</li><li>æºåœ°å€ï¼šæœåŠ¡å™¨IPåœ°å€</li><li>æºç«¯å£ï¼šUDP 67</li><li>ç›®çš„åœ°å€ï¼š255.255.255.255(å¹¿æ’­)</li><li>ç›®çš„ç«¯å£ï¼šUDP 68</li></ul></li></ol><p>DHCPç«¯å£å·ï¼šUDP 67(æœåŠ¡å™¨)å’ŒUDP 68(å®¢æˆ·ç«¯)</p><h3 id="2-2-DHCPé…ç½®"><a href="#2-2-DHCPé…ç½®" class="headerlink" title="2.2 DHCPé…ç½®"></a>2.2 DHCPé…ç½®</h3><ol><li>ç½‘ç»œæ‹“æ‰‘å›¾<ul><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="ç½‘ç»œæ‹“æ‰‘å›¾2">/2_1.png)</li></ul></li><li>è®¾ç½®DHCPæœåŠ¡å™¨å’ŒPCæœºçš„TCP/IPå±æ€§<ul><li>DHCPæœåŠ¡å™¨ï¼š192.168.1.1/24</li><li>PC1/PC2ï¼šè‡ªåŠ¨è·å–IPåœ°å€</li></ul></li><li>é…ç½®DHCPæœåŠ¡å™¨<ul><li>è®¾ç½®IPæ± ä¸º192.168.1.10-20</li></ul></li></ol><h3 id="2-3-éªŒè¯DHCPé…ç½®"><a href="#2-3-éªŒè¯DHCPé…ç½®" class="headerlink" title="2.3 éªŒè¯DHCPé…ç½®"></a>2.3 éªŒè¯DHCPé…ç½®</h3><ol><li>ä½¿ç”¨ipconfig /allå‘½ä»¤æŸ¥çœ‹å„æœºå™¨çš„TCP/IPé…ç½®<ul><li>PC1: 192.168.0.10</li><li>PC2: 192.168.0.11</li></ul></li><li>ä½¿ç”¨pingå‘½ä»¤æµ‹è¯•è¿é€šæ€§<ul><li>PC1&lt;-&gt;PC2ï¼šè¿é€š</li></ul></li></ol><div STYLE="page-break-after: always;"></div><h2 id="ä¸‰-DNSåŠWebæœåŠ¡"><a href="#ä¸‰-DNSåŠWebæœåŠ¡" class="headerlink" title="ä¸‰. DNSåŠWebæœåŠ¡"></a>ä¸‰. DNSåŠWebæœåŠ¡</h2><h3 id="3-1-DNSå·¥ä½œåŸç†"><a href="#3-1-DNSå·¥ä½œåŸç†" class="headerlink" title="3.1 DNSå·¥ä½œåŸç†"></a>3.1 DNSå·¥ä½œåŸç†</h3><p>DNS(Domain Name Systemï¼ŒåŸŸåç³»ç»Ÿ)æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œç”¨äºåŸŸåå’ŒIPåœ°å€ä¹‹é—´çš„æ˜ å°„ã€‚</p><ul><li>IPv4ï¼š32ä½äºŒè¿›åˆ¶æ•°ï¼Œå¯å†™ä½œç‚¹åˆ†åè¿›åˆ¶</li><li>IPv6ï¼š128ä½äºŒè¿›åˆ¶æ•°ï¼Œå¯å†™ä½œå†’å·åˆ†éš”çš„8ç»„16è¿›åˆ¶æ•°</li></ul><p>DNSå·¥ä½œæµç¨‹ï¼š</p><ol><li>PCæœº-&gt;é¦–é€‰DNSæœåŠ¡å™¨ï¼šæˆ‘è¦è®¿é—®www.baidu.com</li><li>é¦–é€‰DNSæœåŠ¡å™¨-&gt;æ ¹åŸŸåâ€™.â€™DNSæœåŠ¡å™¨ï¼šwww.baidu.comå¯¹åº”çš„IPåœ°å€æ˜¯å¤šå°‘ï¼Ÿ</li><li>æ ¹åŸŸåâ€™.â€™DNSæœåŠ¡å™¨-&gt;é¦–é€‰DNSæœåŠ¡å™¨ï¼šwww.baidu.comå½’â€™comâ€™DNSæœåŠ¡å™¨ç®¡</li><li>é¦–é€‰DNSæœåŠ¡å™¨-&gt;â€™comâ€™DNSæœåŠ¡å™¨ï¼šwww.baidu.comå¯¹åº”çš„IPåœ°å€æ˜¯å¤šå°‘ï¼Ÿ</li><li>â€˜comâ€™DNSæœåŠ¡å™¨-&gt;é¦–é€‰DNSæœåŠ¡å™¨ï¼šwww.baidu.comå½’â€™baidu.comâ€™DNSæœåŠ¡å™¨ç®¡</li><li>é¦–é€‰DNSæœåŠ¡å™¨-&gt;â€™baidu.comâ€™DNSæœåŠ¡å™¨ï¼šwww.baidu.comå¯¹åº”çš„IPåœ°å€æ˜¯å¤šå°‘ï¼Ÿ</li><li>â€˜baidu.comâ€™DNSæœåŠ¡å™¨-&gt;é¦–é€‰DNSæœåŠ¡å™¨ï¼šwww.baidu.comå¯¹åº”çš„IPåœ°å€æ˜¯XXX.XXX.XXX.XXX</li><li>é¦–é€‰DNSæœåŠ¡å™¨-&gt;PCæœºï¼šwww.baidu.comå¯¹åº”çš„IPåœ°å€æ˜¯XXX.XXX.XXX.XXX</li><li>PCæœº-&gt;WebæœåŠ¡å™¨ï¼šæˆ‘è¦è®¿é—®XXX.XXX.XXX.XXX</li><li>WebæœåŠ¡å™¨-&gt;PCæœºï¼šè¿”å›ç›¸å…³çš„æ•°æ®</li></ol><ul><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="DNSå·¥ä½œåŸç†">/3_1.png)</li></ul><p>é€’å½’æŸ¥è¯¢ï¼šé€’å½’æŸ¥è¯¢æ˜¯ä¸€ç§DNSæœåŠ¡å™¨çš„æŸ¥è¯¢æ¨¡å¼ã€‚åœ¨è¯¥æ¨¡å¼ä¸‹ï¼ŒDNSæœåŠ¡å™¨æ¥æ”¶åˆ°å®¢æˆ·æœºè¯·æ±‚ï¼Œå¿…é¡»ä½¿ç”¨ä¸€ä¸ªå‡†ç¡®çš„æŸ¥è¯¢ç»“æœå›å¤å®¢æˆ·æœºã€‚å¦‚æœDNSæœåŠ¡å™¨æœ¬åœ°æ²¡æœ‰å­˜å‚¨æŸ¥è¯¢DNSä¿¡æ¯ï¼Œé‚£ä¹ˆè¯¥æœåŠ¡å™¨ä¼šè¯¢é—®å…¶ä»–æœåŠ¡å™¨ï¼Œå¹¶å°†è¿”å›çš„æŸ¥è¯¢ç»“æœæäº¤ç»™å®¢æˆ·æœºã€‚</p><p>è¿­ä»£æŸ¥è¯¢ï¼šDNSæœåŠ¡å™¨ä¼šå‘å®¢æˆ·æœºæä¾›å…¶ä»–èƒ½å¤Ÿè§£ææŸ¥è¯¢è¯·æ±‚çš„DNSæœåŠ¡å™¨åœ°å€ã€‚å½“å®¢æˆ·æœºå‘é€æŸ¥è¯¢è¯·æ±‚æ—¶ï¼ŒDNSæœåŠ¡å™¨å¹¶ä¸ç›´æ¥å›å¤æŸ¥è¯¢ç»“æœï¼Œè€Œæ˜¯å‘Šè¯‰å®¢æˆ·æœºå¦ä¸€å°DNSæœåŠ¡å™¨åœ°å€ï¼Œå®¢æˆ·æœºå†å‘è¿™å°DNSæœåŠ¡å™¨æäº¤è¯·æ±‚ï¼Œä¾æ¬¡å¾ªç¯ç›´åˆ°è¿”å›æŸ¥è¯¢çš„ç»“æœä¸ºæ­¢ã€‚</p><p>DNSç«¯å£å·ï¼šUDP 53</p><h3 id="3-2-HTTPå·¥ä½œåŸç†"><a href="#3-2-HTTPå·¥ä½œåŸç†" class="headerlink" title="3.2 HTTPå·¥ä½œåŸç†"></a>3.2 HTTPå·¥ä½œåŸç†</h3><p>HTTP(HyperText Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®)æ˜¯ä¸€ç§ç”¨äºä¼ è¾“è¶…æ–‡æœ¬çš„åè®®ã€‚</p><p>HTTPå·¥ä½œæµç¨‹ï¼š</p><pre><code>1. å®¢æˆ·ç«¯æµè§ˆå™¨è§£æURL2. å®¢æˆ·ç«¯æµè§ˆå™¨ç”Ÿäº§HTTPè¯·æ±‚ä¿¡æ¯3. æœåŠ¡å™¨å‘é€å“åº”HTTPé¡µé¢4. å®¢æˆ·ç«¯æµè§ˆå™¨è§£æå“åº”é¡µé¢</code></pre><h3 id="3-3-DNSé…ç½®"><a href="#3-3-DNSé…ç½®" class="headerlink" title="3.3 DNSé…ç½®"></a>3.3 DNSé…ç½®</h3><ol><li>ç½‘ç»œæ‹“æ‰‘å›¾ï¼ˆå®ŒæˆTCP/IPé…ç½®ï¼‰<ul><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="ç½‘ç»œæ‹“æ‰‘å›¾3">/3_2.png)</li></ul></li><li>é…ç½®DNSæœåŠ¡å™¨<ul><li>jike.comé…ç½®Host IPï¼š192.168.0.20(å¯¹åº”WebæœåŠ¡å™¨)</li><li>ruanjian.comé…ç½®Host IPï¼š192.168.0.70(æ²¡æœ‰å¯¹åº”çš„WebæœåŠ¡å™¨)</li></ul></li></ol><h3 id="3-4-éªŒè¯DNSé…ç½®"><a href="#3-4-éªŒè¯DNSé…ç½®" class="headerlink" title="3.4 éªŒè¯DNSé…ç½®"></a>3.4 éªŒè¯DNSé…ç½®</h3><ol><li>ä½¿ç”¨ipconfig /allå‘½ä»¤æŸ¥çœ‹å„æœºå™¨çš„TCP/IPé…ç½®</li><li>åœ¨å®¢æˆ·ç«¯PCä¸Šä½¿ç”¨pingå‘½ä»¤æµ‹è¯•è¿é€šæ€§<ul><li>jike.comï¼šReply from 192.168.0.20: bytes=32 time&lt;1ms TTL=128(æ¥è‡ª192.168.0.20çš„å›å¤ï¼šå­—èŠ‚=32 æ—¶é—´&lt;1ms TTL=128)</li><li>ruanjian.comï¼šRequest timed out(æ¥è‡ª192.168.0.10çš„å›å¤ï¼šæ— æ³•è®¿é—®ç›®æ ‡ä¸»æœº)</li><li>anquan.comï¼šUnknown host <www.anquan.com(Pingè¯·æ±‚æ‰¾ä¸åˆ°ä¸»æœºanquan.comã€‚è¯·æ£€æŸ¥è¯¥åç§°ï¼Œç„¶åé‡è¯•)></li></ul></li></ol><h3 id="3-5-FTPæœåŠ¡é…ç½®"><a href="#3-5-FTPæœåŠ¡é…ç½®" class="headerlink" title="3.5 FTPæœåŠ¡é…ç½®"></a>3.5 FTPæœåŠ¡é…ç½®</h3><ol><li>åœ¨æ§åˆ¶é¢æ¿ä¸­å¯ç”¨IIS(Internet Information Servicesï¼ŒInternetä¿¡æ¯æœåŠ¡)</li><li>æ‰“å¼€IISï¼Œç½‘ç«™åç§°æ”¹ä¸ºjikeï¼Œé€‰æ‹©ç‰©ç†è·¯å¾„ã€‚åœ¨è·¯å¾„ä¸‹æ–°å»ºindex.htmlæ–‡ä»¶ï¼Œç”¨ANSIç¼–ç ä¿å­˜ï¼Œå¹¶åœ¨é»˜è®¤æ–‡æ¡£ä¸­æ·»åŠ è¯¥æ–‡æ¡£ã€‚æ­¤æ—¶è®¿é—®jingke.com/index.htmlåº”è¯¥èƒ½çœ‹åˆ°index.htmlçš„å†…å®¹ã€‚</li><li>æ–°å»ºä¸€ä¸ªFTPç«™ç‚¹ï¼Œåç§°ä¸ºjikeFTPï¼Œé€‰æ‹©ç‰©ç†è·¯å¾„(åœ¨è¯¥ä½ç½®æ–°å»ºå‡ ä¸ªæ–‡ä»¶å¤¹æµ‹è¯•)ï¼Œç»‘å®šIPåœ°å€ä¸º192.168.0.20ï¼Œé€‰æ‹©æ— SSLï¼Œå…è®¸æ‰€æœ‰ç”¨æˆ·è®¿é—®ã€‚æ­¤æ—¶ä½¿ç”¨FTPå®¢æˆ·ç«¯è¿æ¥ï¼Œåº”è¯¥èƒ½çœ‹åˆ°FTPç«™ç‚¹çš„å†…å®¹ã€‚</li></ol><div STYLE="page-break-after: always;"></div><h2 id="å››-äº¤æ¢æœºå·¥ä½œåŸç†åŠåŸºæœ¬é…ç½®"><a href="#å››-äº¤æ¢æœºå·¥ä½œåŸç†åŠåŸºæœ¬é…ç½®" class="headerlink" title="å››. äº¤æ¢æœºå·¥ä½œåŸç†åŠåŸºæœ¬é…ç½®"></a>å››. äº¤æ¢æœºå·¥ä½œåŸç†åŠåŸºæœ¬é…ç½®</h2><h3 id="4-1-äº¤æ¢æœº"><a href="#4-1-äº¤æ¢æœº" class="headerlink" title="4.1 äº¤æ¢æœº"></a>4.1 äº¤æ¢æœº</h3><p>äº¤æ¢æœº(Switch)æ˜¯ä¸€ç§ç½‘ç»œè®¾å¤‡ï¼Œç”¨äºåœ¨è®¡ç®—æœºç½‘ç»œä¸­è¿æ¥å¤šä¸ªè®¾å¤‡ï¼Œå®ç°è®¾å¤‡ä¹‹é—´çš„é€šä¿¡ã€‚</p><p>æœ€å¸¸è§çš„ä»¥å¤ªç½‘äº¤æ¢æœºå·¥ä½œäºOSIç½‘ç»œå‚è€ƒæ¨¡å‹çš„ç¬¬äºŒå±‚(å³æ•°æ®é“¾è·¯å±‚)ï¼Œæ˜¯ä¸€ç§åŸºäºMACåœ°å€è¯†åˆ«ã€å®Œæˆä»¥å¤ªç½‘æ•°æ®å¸§è½¬å‘çš„ç½‘ç»œè®¾å¤‡ã€‚</p><h4 id="4-1-1-MACåœ°å€"><a href="#4-1-1-MACåœ°å€" class="headerlink" title="4.1.1 MACåœ°å€"></a>4.1.1 MACåœ°å€</h4><p>MACåœ°å€(Media Access Control Addressï¼Œä»‹è´¨è®¿é—®æ§åˆ¶åœ°å€)æ˜¯ä¸€ä¸ªç”¨æ¥è¯†åˆ«ç½‘ç»œè®¾å¤‡çš„åœ°å€ï¼Œåˆç§°ç‰©ç†åœ°å€ã€‚</p><p>ç”±48ä½äºŒè¿›åˆ¶æ•°ç»„æˆï¼Œé€šå¸¸ä»¥12ä½åå…­è¿›åˆ¶æ•°è¡¨ç¤ºï¼Œå¦‚00-0C-29-3D-2E-7Cï¼Œä¹Ÿå†™ä½œ000C.293D.2E7Cã€00:0C:29:3D:2E:7Cã€‚</p><p>å‰24ä½æ˜¯å‚å•†è¯†åˆ«ç ï¼Œå24ä½æ˜¯è®¾å¤‡è¯†åˆ«ç (ä¾›åº”å•†å¯¹ç½‘å¡çš„å”¯ä¸€ç¼–å·)ã€‚</p><ul><li>å•æ’­åœ°å€ï¼šMACåœ°å€çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„æœ€ä½ä½ä¸º0ï¼Œå¯ä½œä¸ºç›®çš„åœ°å€å’Œæºåœ°å€ã€‚</li><li>ç»„æ’­åœ°å€ï¼šMACåœ°å€çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„æœ€ä½ä½ä¸º1ï¼Œä»…èƒ½ä½œä¸ºç›®çš„åœ°å€ã€‚</li><li>å¹¿æ’­åœ°å€ï¼šMACåœ°å€å…¨ä¸º1ï¼Œå³FF-FF-FF-FF-FF-FFï¼Œç”¨äºå‘åŒä¸€ç½‘ç»œä¸­çš„æ‰€æœ‰è®¾å¤‡å‘é€æ•°æ®ã€‚</li></ul><h4 id="4-1-2-MACåœ°å€è¡¨"><a href="#4-1-2-MACåœ°å€è¡¨" class="headerlink" title="4.1.2 MACåœ°å€è¡¨"></a>4.1.2 MACåœ°å€è¡¨</h4><p>äº¤æ¢æœºå†…éƒ¨ç”¨äºå­˜æ”¾ç‰©ç†åœ°å€ä¸äº¤æ¢æœºç«¯å£æ˜ å°„å…³ç³»çš„æ•°æ®åº“ï¼Œäº¤æ¢æœºä¾é MACåœ°å€è¡¨å®ç°æ•°æ®å¸§çš„è½¬å‘ã€‚</p><pre><code>- Static MAC Addressï¼šé™æ€MACåœ°å€ï¼Œç”±ç®¡ç†å‘˜æ‰‹åŠ¨é…ç½®ã€‚- Dynamic MAC Addressï¼šåŠ¨æ€MACåœ°å€ï¼Œç”±äº¤æ¢æœºè‡ªåŠ¨å­¦ä¹ ã€‚</code></pre><p>åŠ¨æ€MACåœ°å€å­¦ä¹ è¿‡ç¨‹</p><ol><li>ä¸»æœºA-&gt;äº¤æ¢æœºï¼šæˆ‘è¦å‘é€æ•°æ®å¸§ç»™ä¸»æœºBã€‚ äº¤æ¢æœºï¼šè®°å½•ä¸»æœºAçš„MACåœ°å€å’Œç«¯å£æ˜ å°„ã€‚</li><li>äº¤æ¢æœº-&gt;å¹¿æ’­ï¼šä¸»æœºAçš„æ•°æ®å¸§å‘é€ç»™æ‰€æœ‰ç«¯å£ã€‚</li><li>ä¸»æœºB-&gt;äº¤æ¢æœºï¼šæˆ‘æ”¶åˆ°æ•°æ®å¸§äº†ï¼Œå›å¤ã€‚ äº¤æ¢æœºï¼šè®°å½•ä¸»æœºBçš„MACåœ°å€å’Œç«¯å£æ˜ å°„ã€‚</li></ol><h4 id="4-1-3-æ•°æ®å¸§"><a href="#4-1-3-æ•°æ®å¸§" class="headerlink" title="4.1.3 æ•°æ®å¸§"></a>4.1.3 æ•°æ®å¸§</h4><ul><li>æ•°æ®å¸§(Data Frame)æ˜¯æ•°æ®é“¾è·¯å±‚çš„åè®®æ•°æ®å•å…ƒï¼ŒåŒ…æ‹¬ï¼šå¸§å¤´ã€æ•°æ®ã€å¸§å°¾ã€‚</li><li>åœ¨ä»¥å¤ªç½‘é“¾è·¯ä¸Šçš„æ•°æ®å•å…ƒç§°ä¸ºä»¥å¤ªç½‘å¸§ï¼Œç°åœ¨æœ€å¸¸è§çš„ä»¥å¤ªç½‘å¸§æ˜¯Ethernet IIï¼ŒåŒ…æ‹¬ï¼šç›®çš„MACåœ°å€(6B)ã€æºMACåœ°å€(6B)ã€ç±»å‹/é•¿åº¦(2B)ã€æ•°æ®(46-1500B)ã€FCSå¸§æ ¡éªŒåºåˆ—(4B)ã€‚</li></ul><p>å¸§è½¬å‘/è¿‡æ»¤ï¼šå•æ’­å¸§ä¾é MACåœ°å€è¡¨è¿›è¡Œè½¬å‘/è¿‡æ»¤ï¼Œç»„æ’­å¸§å‘æŒ‡å®šç«¯å£è½¬å‘ï¼Œå¹¿æ’­å¸§å‘æ‰€æœ‰ç«¯å£è½¬å‘</p><p>å¸§è½¬å‘æ–¹å¼ï¼š</p><ul><li>ç›´é€šè½¬å‘ï¼šäº¤æ¢æœºæ”¶åˆ°å¸§å¤´(é€šå¸¸åªæ£€æŸ¥14ä¸ªå­—èŠ‚)åç«‹åˆ»å¯Ÿçœ‹ç›®çš„MACåœ°å€å¹¶è¿›è¡Œè½¬å‘ã€‚</li><li>å­˜å‚¨è½¬å‘ï¼šæ¥æ”¶å®Œæ•´çš„å¸§ï¼Œæ‰§è¡Œå®Œæ ¡éªŒåï¼Œè½¬å‘æ­£ç¡®çš„å¸§è€Œä¸¢å¼ƒé”™è¯¯çš„å¸§ã€‚</li><li>æ— ç¢ç‰‡ç›´é€šè½¬å‘ï¼šäº¤æ¢æœºè¯»å–å‰64ä¸ªå­—èŠ‚åå¼€å§‹è½¬å‘ã€‚</li></ul><h3 id="4-2-äº¤æ¢æœºæœ¬åœ°é…ç½®-MACåœ°å€ç»‘å®š"><a href="#4-2-äº¤æ¢æœºæœ¬åœ°é…ç½®-MACåœ°å€ç»‘å®š" class="headerlink" title="4.2 äº¤æ¢æœºæœ¬åœ°é…ç½®-MACåœ°å€ç»‘å®š"></a>4.2 äº¤æ¢æœºæœ¬åœ°é…ç½®-MACåœ°å€ç»‘å®š</h3><ol><li>ç½‘ç»œæ‹“æ‰‘å›¾ï¼ˆå®ŒæˆTCP/IPé…ç½®ï¼‰<ul><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="ç½‘ç»œæ‹“æ‰‘å›¾4">/4_1.png)</li></ul></li><li>è®¡ç®—æœºä¸²å£æˆ–USBå£ä¸äº¤æ¢æœºçš„Consoleç«¯å£è¿æ¥ï¼›æ‰“å¼€è®¡ç®—æœºWinç³»ç»Ÿçš„â€œè¶…çº§ç»ˆç«¯â€æˆ–å…¶ä»–ä¸²å£é€šä¿¡å®¢æˆ·ç«¯è½¯ä»¶ï¼›Serial PortæŒ‰äº¤æ¢æœºè¦æ±‚è®¾ç½®ï¼Œä¸€èˆ¬é»˜è®¤<ul><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="ç»ˆç«¯é…ç½®">/4_2.png)</li></ul></li><li>å¸¸ç”¨å‘½ä»¤/æ¨¡å¼åˆ‡æ¢å‘½ä»¤<ul><li>Switch&gt;   //(åˆå§‹)ç”¨æˆ·æ¨¡å¼</li><li>Switch&gt;enable  //è¿›å…¥ç‰¹æƒæ¨¡å¼</li><li>Switch#configure terminal  //è¿›å…¥å…¨å±€é…ç½®æ¨¡å¼</li><li>Switch(config)#interface fa0/1  //è¿›å…¥æ¥å£fa0/1é…ç½®æ¨¡å¼</li><li>Switch(config-if)#end //é€€å‡ºé…ç½®æ¨¡å¼ï¼Œè¿”å›ç‰¹æƒæ¨¡å¼</li><li>Switch#show clock  //æŸ¥çœ‹äº¤æ¢æœºæ—¶é—´</li><li>Switch#show version  //æŸ¥çœ‹äº¤æ¢æœºç‰ˆæœ¬ä¿¡æ¯</li><li>ä¿®æ”¹äº¤æ¢æœºä¸»æœºå<ul><li>Switch#configure terminal</li><li>Switch(config)#hostname jike</li><li>jike(config)#</li></ul></li></ul></li><li>MACåœ°å€è¡¨ç®¡ç†å‘½ä»¤<ul><li>Switch#show mac-address-table  //æŸ¥çœ‹MACåœ°å€è¡¨</li><li>Switch#show mac-address-table aging-time  //æŸ¥çœ‹MACåœ°å€è¡¨è€åŒ–æ—¶é—´</li><li>äº¤æ¢æœºä¸Šæ·»åŠ MACåœ°å€ç»‘å®š<ul><li>Switch(config)#mac-address-table static aaaa.aaaa.aaaa vlan 1 interface fa0/1</li><li>Switch(config)#mac-address-table static aaaa.aaaa.aaab vlan 1 interface fa0/2</li><li>Switch(config)#mac-address-table static aaaa.aaaa.aaac vlan 1 interface fa0/3</li></ul></li><li>äº¤æ¢æœºä¸Šåˆ é™¤MACåœ°å€ç»‘å®š<ul><li>Switch(config)#no mac-address-table static aaaa.aaaa.aaac vlan 1 interface fa0/3</li></ul></li></ul></li></ol><h3 id="4-3-éªŒè¯äº¤æ¢æœºé…ç½®"><a href="#4-3-éªŒè¯äº¤æ¢æœºé…ç½®" class="headerlink" title="4.3 éªŒè¯äº¤æ¢æœºé…ç½®"></a>4.3 éªŒè¯äº¤æ¢æœºé…ç½®</h3><p>ä»¥ç»‘å®šäº†fa0/1ã€fa0/2çš„äº¤æ¢æœºä¸ºä¾‹ï¼Œåœ¨ä»¥ä¸‹ç«¯å£è¿æ¥æƒ…å†µä¸‹ï¼Œä½¿ç”¨pingå‘½ä»¤æµ‹è¯•è¿é€šæ€§ï¼š</p><ol><li>PC1è‡³1å·ç«¯å£ï¼ŒPC2è‡³2å·ç«¯å£ï¼ŒPC3è‡³3å·ç«¯å£<ul><li>PC1&lt;-&gt;PC2ï¼šè¿é€š</li><li>PC1&lt;-&gt;PC3ï¼šè¿é€š</li><li>PC2&lt;-&gt;PC3ï¼šè¿é€š</li><li>MACåœ°å€è¡¨ï¼šfa0/1-PC1ã€fa0/2-PC2ã€fa0/3-PC3</li></ul></li><li>PC1è‡³2å·ç«¯å£ï¼ŒPC2è‡³1å·ç«¯å£ï¼ŒPC3è‡³10å·ç«¯å£<ul><li>PC1&lt;-&gt;PC2ï¼šä¸è¿é€š</li><li>PC1&lt;-&gt;PC3ï¼šä¸è¿é€š</li><li>PC2&lt;-&gt;PC3ï¼šä¸è¿é€š</li><li>MACåœ°å€è¡¨ï¼šfa0/1-PC2ã€fa0/2-PC1ã€fa0/10-PC3</li></ul></li><li>PC1è‡³5å·ç«¯å£ï¼ŒPC2è‡³2å·ç«¯å£ï¼ŒPC3è‡³3å·ç«¯å£<ul><li>PC1&lt;-&gt;PC2ï¼šä¸è¿é€š</li><li>PC1&lt;-&gt;PC3ï¼šä¸è¿é€š</li><li>PC2&lt;-&gt;PC3ï¼šè¿é€š</li><li>MACåœ°å€è¡¨ï¼šfa0/1-PC2ã€fa0/2-PC1ã€fa0/3-PC3</li></ul></li></ol><ul><li>æ€»ç»“ï¼šé™æ€MACåœ°å€ç»‘å®šåï¼Œä¸»æœºä¸ç«¯å£è¿çº¿å¿…é¡»ä¸€ä¸€å¯¹åº”æ‰èƒ½ä¼ è¾“æ•°æ®ï¼›å¦‚æœæ˜¯åŠ¨æ€MACåœ°å€ï¼Œä¸»æœºè¿ä»»æ„ä¸€ä¸ªç«¯å£å‡å¯æ­£å¸¸æ”¶å‘æ•°æ®ã€‚</li></ul><div STYLE="page-break-after: always;"></div><h2 id="äº”-äº¤æ¢æœºVLAN"><a href="#äº”-äº¤æ¢æœºVLAN" class="headerlink" title="äº”. äº¤æ¢æœºVLAN"></a>äº”. äº¤æ¢æœºVLAN</h2><h3 id="5-1-VLAN"><a href="#5-1-VLAN" class="headerlink" title="5.1 VLAN"></a>5.1 VLAN</h3><p>äº¤æ¢ç½‘ç»œæ˜¯å¹³é¢ç½‘ç»œç»“æ„ï¼Œå¿…é¡»ä¾èµ–å¹¿æ’­ï¼Œå¹¿æ’­åŸŸè¿‡å¤§ä¼šå¯¼è‡´ç½‘ç»œæ‹¥å¡ã€‚</p><p>VLAN(Virtual Local Area Networkï¼Œè™šæ‹Ÿå±€åŸŸç½‘)æ˜¯ä¸€ç»„é€»è¾‘ä¸Šçš„è®¾å¤‡å’Œç”¨æˆ·ï¼Œè¿™äº›è®¾å¤‡å’Œç”¨æˆ·å¹¶ä¸å—ç‰©ç†ä½ç½®çš„é™åˆ¶ï¼Œå¯ä»¥æ ¹æ®åŠŸèƒ½ã€éƒ¨é—¨åŠåº”ç”¨ç­‰å› ç´ å°†å®ƒä»¬ç»„ç»‡èµ·æ¥ï¼Œç›¸äº’ä¹‹é—´çš„é€šä¿¡å°±å¥½åƒå®ƒä»¬åœ¨åŒä¸€ä¸ªç½‘æ®µä¸­ä¸€æ ·ã€‚</p><p>VLANçš„ç‰¹ç‚¹ï¼š</p><ul><li>åŸºäºé€»è¾‘çš„åˆ†ç»„ï¼Œä¸å—ç‰©ç†ä½ç½®é™åˆ¶ã€‚</li><li>åœ¨åŒä¸€VLANå†…å’ŒçœŸå®å±€åŸŸç½‘ç›¸åŒã€‚</li><li>ä¸åŒVLANå†…ç”¨æˆ·è¦é€šä¿¡éœ€è¦å€ŸåŠ©ä¸‰å±‚è®¾å¤‡ã€‚</li></ul><p>åŸºäºç«¯å£çš„VLANï¼šäº¤æ¢æœºç«¯å£å¯ä»¥åˆ’åˆ†åˆ°ä¸åŒçš„VLANä¸­ï¼Œä¸åŒVLANä¹‹é—´çš„é€šä¿¡éœ€è¦é€šè¿‡è·¯ç”±å™¨ã€‚</p><h4 id="5-1-1-IEEE-802-1Qæ ‡å‡†"><a href="#5-1-1-IEEE-802-1Qæ ‡å‡†" class="headerlink" title="5.1.1 IEEE 802.1Qæ ‡å‡†"></a>5.1.1 IEEE 802.1Qæ ‡å‡†</h4><p>å®šä¹‰äº†åŸºäºç«¯å£çš„VLANæ¨¡å‹ï¼Œè§„å®šå¦‚ä½•æ ‡è¯†å¸¦æœ‰ VLAN æˆå‘˜ä¿¡æ¯çš„ä»¥å¤ªå¸§ï¼Œå®šä¹‰VLANæ ‡ç­¾æ ¼å¼ã€‚</p><p>åœ¨ä»¥å¤ªç½‘å¸§ä¸­å¢åŠ äº†ä¸€ä¸ª4å­—èŠ‚çš„802.1Qå¸§å¤´ï¼Œç”¨äºæ ‡è¯†VLANä¿¡æ¯ï¼šç›®çš„MACåœ°å€(6B)ã€æºMACåœ°å€(6B)ã€802.1Qå¸§å¤´(4B)ã€ç±»å‹/é•¿åº¦(2B)ã€æ•°æ®(46-1500B)ã€FCSå¸§æ ¡éªŒåºåˆ—(4B)ã€‚</p><p>802.1Qå¸§å¤´æ ¼å¼ï¼šTPID(2B)+PCP(3b)+DEI(1b)+VID(12b)</p><ul><li>TPIDï¼šæ ‡è¯†802.1Qå¸§å¤´ï¼Œå–å€¼0x8100</li><li>PCPï¼šä¼˜å…ˆçº§ï¼Œå–å€¼0-7ï¼Œ0æœ€ä½ï¼Œ7æœ€é«˜</li><li>DEIï¼šä¸¢å¼ƒæ ‡å¿—ï¼Œç”¨äºQoS</li><li>VIDï¼šVLAN IDï¼Œå–å€¼1-4094</li></ul><h4 id="5-1-2-äº¤æ¢æœºç«¯å£ç±»å‹"><a href="#5-1-2-äº¤æ¢æœºç«¯å£ç±»å‹" class="headerlink" title="5.1.2 äº¤æ¢æœºç«¯å£ç±»å‹"></a>5.1.2 äº¤æ¢æœºç«¯å£ç±»å‹</h4><div class="table-container"><table><thead><tr><th></th><th>Accessç«¯å£</th><th>Trunkç«¯å£</th></tr></thead><tbody><tr><td>Tag</td><td>UnTaggedç«¯å£ï¼ˆæ¥å…¥ç«¯å£ï¼‰</td><td>Tag Awareç«¯å£ï¼ˆå¹²é“ç«¯å£ï¼‰</td></tr><tr><td>VLAN</td><td>åªèƒ½å±äºä¸€ä¸ªVLAN</td><td>å¯ä»¥å…è®¸å¤šä¸ªVLANé€šè¿‡</td></tr><tr><td>æ•°æ®å¸§</td><td>å‘é€çš„æ•°æ®å¸§ä¸å¸¦VLANæ ‡ç­¾</td><td>å‘é€çš„æ•°æ®å¸§å¸¦æœ‰VLANæ ‡ç­¾</td></tr><tr><td>ç”¨é€”</td><td>ä¸€èˆ¬ç”¨äºè¿æ¥ç»ˆç«¯è®¾å¤‡ï¼ˆPCæœºï¼‰</td><td>ä¸€èˆ¬ç”¨äºäº¤æ¢æœºä¹‹é—´çš„è¿æ¥</td></tr><tr><td>é»˜è®¤</td><td>äº¤æ¢æœºä¸Šçš„é»˜è®¤ç«¯å£</td><td>-</td></tr></tbody></table></div><h3 id="5-2-äº¤æ¢æœºVLANé…ç½®"><a href="#5-2-äº¤æ¢æœºVLANé…ç½®" class="headerlink" title="5.2 äº¤æ¢æœºVLANé…ç½®"></a>5.2 äº¤æ¢æœºVLANé…ç½®</h3><ol><li>ç½‘ç»œæ‹“æ‰‘å›¾ï¼ˆå®ŒæˆTCP/IPé…ç½®ï¼‰<ul><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="ç½‘ç»œæ‹“æ‰‘å›¾5">/5_1.png)</li></ul></li><li>åˆ›å»ºVLAN<ul><li>Switch(config)#vlan 10</li><li>Switch(config-vlan)#exit</li><li>Switch(config)#vlan 20</li><li>Switch(config-vlan)#exit</li></ul></li><li>é…ç½®Accessç«¯å£/åˆ’åˆ†VLAN<ul><li>Switch(config)#interface fa0/1-5</li><li>Switch(config-if-range)#switchport mode access</li><li>Switch(config-if-range)#switchport access vlan 10</li><li>Switch(config-if-range)#exit</li><li>Switch(config)#interface fa0/6-10</li><li>Switch(config-if-range)#switchport mode access</li><li>Switch(config-if-range)#switchport access vlan 20</li><li>Switch(config-if-range)#exit</li></ul></li><li>é…ç½®Trunkç«¯å£<ul><li>Switch(config)#interface fa0/24</li><li>Switch(config-if)#switchport mode trunk</li></ul></li></ol><h3 id="5-3-éªŒè¯äº¤æ¢æœºVLANé…ç½®"><a href="#5-3-éªŒè¯äº¤æ¢æœºVLANé…ç½®" class="headerlink" title="5.3 éªŒè¯äº¤æ¢æœºVLANé…ç½®"></a>5.3 éªŒè¯äº¤æ¢æœºVLANé…ç½®</h3><ol><li>æ˜¾ç¤ºäº¤æ¢æœºVLANé…ç½®<ul><li>Switch#show vlan brief</li><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="äº¤æ¢æœºVLANé…ç½®">/5_2.png)</li></ul></li><li>è¿é€šæ€§æµ‹è¯•<ul><li>PC1&lt;-&gt;PC4ï¼šè¿é€š</li><li>PC2&lt;-&gt;PC3ï¼šè¿é€š</li><li>å…¶ä½™PCä¹‹é—´ä¸è¿é€š</li></ul></li><li>æ€»ç»“ï¼šåŒä¸€VLANå†…å¯ä»¥ç›´æ¥ç›¸äº’é€šä¿¡ï¼Œä¸åŒVLANå†…ä¸èƒ½ç›´æ¥ç›¸äº’é€šä¿¡ã€‚</li></ol><div STYLE="page-break-after: always;"></div><h2 id="å…­-VLANé—´é€šä¿¡"><a href="#å…­-VLANé—´é€šä¿¡" class="headerlink" title="å…­. VLANé—´é€šä¿¡"></a>å…­. VLANé—´é€šä¿¡</h2><h3 id="6-1-è·¯ç”±"><a href="#6-1-è·¯ç”±" class="headerlink" title="6.1 è·¯ç”±"></a>6.1 è·¯ç”±</h3><p>VLANæ˜¯å¹¿æ’­åŸŸï¼ˆäºŒå±‚æ¦‚å¿µï¼‰ï¼Œè€Œä¸¤ä¸ªå¹¿æ’­åŸŸä¹‹é—´é€šå¸¸ç”±è·¯ç”±å™¨è¿æ¥ï¼Œå¹¿æ’­åŸŸä¹‹é—´æ¥å¾€çš„æ•°æ®åŒ…éƒ½æ˜¯ç”±è·¯ç”±ï¼ˆä¸‰å±‚æ¦‚å¿µï¼‰è½¬å‘çš„ã€‚è·¯ç”±çš„ä¸»è¦åŠŸèƒ½ç”±è·¯ç”±å™¨å’Œä¸‰å±‚äº¤æ¢æœºæä¾›ã€‚</p><p>VLANé—´é€šä¿¡ä¸€èˆ¬æœ‰ä»¥ä¸‹3ç§å®æ–½æ–¹æ¡ˆï¼š</p><ol><li>è·¯ç”±å™¨å¤šç«¯å£æ–¹å¼</li><li>å•è‡‚è·¯ç”±æ–¹å¼</li><li>ä¸‰å±‚äº¤æ¢æœºæ–¹å¼</li></ol><h3 id="6-2-è·¯ç”±å™¨å¤šç«¯å£æ–¹å¼"><a href="#6-2-è·¯ç”±å™¨å¤šç«¯å£æ–¹å¼" class="headerlink" title="6.2 è·¯ç”±å™¨å¤šç«¯å£æ–¹å¼"></a>6.2 è·¯ç”±å™¨å¤šç«¯å£æ–¹å¼</h3><p>ä¸è·¯ç”±å™¨è¿æ¥ä¸åŒå­ç½‘é€šä¿¡çš„æ–¹æ³•ä¸€æ ·ï¼Œä¸ºè·¯ç”±å™¨ç«¯å£è®¾ç½®ä¸€ä¸ªIPåœ°å€ä½œä¸ºå¯¹åº”VLANçš„ç½‘å…³ï¼Œæœ‰å‡ ä¸ªVLANå°±éœ€è¦åœ¨å‡ ä¸ªç«¯å£è®¾ç½®IPåœ°å€ã€‚</p><p>ç¼ºç‚¹ï¼š<br>ä¸€èˆ¬ä¸­å¤§å‹å±€åŸŸç½‘ï¼ŒVLANæ•°é‡å¯ä»¥å¾ˆå¤šï¼Œè€Œè·¯ç”±å™¨ç«¯å£æ•°é‡è¾ƒå°‘ï¼Œè·¯ç”±å™¨ä¼šæˆä¸ºå±€åŸŸç½‘æ€§èƒ½ç“¶é¢ˆã€‚<br>è·¯ç”±å™¨é‡‡ç”¨è½¯ä»¶å¯¹IPæŠ¥æ–‡è¿›è¡Œè½¬å‘ï¼Œå ç”¨CPUå’Œå†…å­˜èµ„æºï¼Œæ•ˆç‡æ¯”è¾ƒä½ï¼Œæ— æ³•èƒœä»»é€šä¿¡æ•°æ®é‡è¾ƒå¤§çš„å±€åŸŸç½‘ã€‚</p><h4 id="6-2-1-é…ç½®"><a href="#6-2-1-é…ç½®" class="headerlink" title="6.2.1 é…ç½®"></a>6.2.1 é…ç½®</h4><ol><li>ç½‘ç»œæ‹“æ‰‘å›¾ï¼ˆå®ŒæˆTCP/IPé…ç½®ï¼‰<ul><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="ç½‘ç»œæ‹“æ‰‘å›¾6_1">/6_1_1.png)</li></ul></li><li>äºŒå±‚äº¤æ¢æœºé…ç½®<ul><li>åˆ›å»ºVLAN10å’ŒVLAN20</li><li>é…ç½®Accessç«¯å£/åˆ’åˆ†VLAN<ul><li>VLAN10: fa0/1,fa0/10</li><li>VLAN20: fa0/2,fa0/20</li></ul></li><li>æŸ¥çœ‹VLANé…ç½®: Switch#show vlan brief</li></ul></li><li>è·¯ç”±å™¨é…ç½®<ul><li>Router(config)#interface fa0/0</li><li>Router(config-if)#no shutdown //æ¿€æ´»æ¥å£</li><li>Router(config-if)#ip address 192.168.1.1 255.255.255.0 //è®¾ç½®æ¥å£IPåœ°å€</li><li>Router(config-if)#exit</li><li>Router(config)#interface fa0/1</li><li>Router(config-if)#no shutdown</li><li>Router(config-if)#ip address 192.168.2.1 255.255.255.0</li><li>Router(config-if)#exit</li></ul></li></ol><h4 id="6-2-2-éªŒè¯è·¯ç”±å™¨é…ç½®"><a href="#6-2-2-éªŒè¯è·¯ç”±å™¨é…ç½®" class="headerlink" title="6.2.2 éªŒè¯è·¯ç”±å™¨é…ç½®"></a>6.2.2 éªŒè¯è·¯ç”±å™¨é…ç½®</h4><ol><li>æ˜¾ç¤ºè·¯ç”±è¡¨<ul><li>Router#show ip route</li><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="è·¯ç”±è¡¨">/6_1_2.png)</li></ul></li><li>æ˜¾ç¤ºIPæ¥å£ä¿¡æ¯<ul><li>Router#show ip interface brief</li><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="IPæ¥å£">/6_1_3.png)</li></ul></li><li>è¿é€šæ€§æµ‹è¯•<ul><li>PC1&lt;-&gt;PC2ï¼šè¿é€š</li></ul></li></ol><h3 id="6-3-å•è‡‚è·¯ç”±æ–¹å¼"><a href="#6-3-å•è‡‚è·¯ç”±æ–¹å¼" class="headerlink" title="6.3 å•è‡‚è·¯ç”±æ–¹å¼"></a>6.3 å•è‡‚è·¯ç”±æ–¹å¼</h3><p>åœ¨è·¯ç”±å™¨çš„ä¸€ä¸ªç‰©ç†æ¥å£ä¸Šé…ç½®å¤šä¸ªå­æ¥å£ï¼Œä½œä¸ºä¸åŒVLANçš„é»˜è®¤ç½‘å…³ï¼Œå®ç°åŸæ¥ç›¸äº’éš”ç¦»çš„ä¸åŒVLANä¹‹é—´çš„é€šä¿¡ã€‚</p><p>ç¼ºç‚¹ï¼š<br>è·¯ç”±å™¨è½¬å‘é€Ÿåº¦æœ‰é™ï¼Œæ— æ³•æ»¡è¶³VLANé—´é€šä¿¡æ•°æ®é‡å¤§çš„éœ€æ±‚ï¼Œå¹¶ä¸”å®¹æ˜“é€ æˆå•ç‚¹æ•…éšœã€‚<br>æ•°æ®åœ¨ç‰©ç†é“¾è·¯ä¸Šå¾€è¿”ä¼ è¾“ï¼Œä¼šæœ‰è½¬å‘å»¶è¿Ÿï¼Œå¾ˆå¯èƒ½æˆä¸ºå±€åŸŸç½‘æ€§èƒ½ç“¶é¢ˆã€‚</p><h4 id="6-3-1-é…ç½®"><a href="#6-3-1-é…ç½®" class="headerlink" title="6.3.1 é…ç½®"></a>6.3.1 é…ç½®</h4><ol><li>ç½‘ç»œæ‹“æ‰‘å›¾ï¼ˆå®ŒæˆTCP/IPé…ç½®ï¼‰<ul><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="ç½‘ç»œæ‹“æ‰‘å›¾6_2">/6_2_1.png)</li></ul></li><li>äºŒå±‚äº¤æ¢æœºé…ç½®<ul><li>åˆ›å»ºVLAN10å’ŒVLAN20</li><li>é…ç½®Accessç«¯å£/åˆ’åˆ†VLAN<ul><li>VLAN10: fa0/1</li><li>VLAN20: fa0/2</li></ul></li><li>é…ç½®Trunkç«¯å£<ul><li>Switch(config)#interface fa0/24</li><li>Switch(config-if)#switchport mode trunk</li><li>Switch(config-if)#exit</li></ul></li><li>æŸ¥çœ‹VLANé…ç½®: Switch#show vlan brief</li></ul></li><li>è·¯ç”±å™¨é…ç½®<ul><li>Router(config)#interface fa0/0</li><li>Router(config-if)#no shutdown //æ¿€æ´»æ¥å£</li><li>Router(config-if)#exit</li><li>Router(config)#interface fa0/0.10 //åˆ›å»ºè™šæ‹Ÿå­æ¥å£10</li><li>Router(config-subif)#encapsulation dot1Q 10 //å°è£…VLANåè®®ï¼ˆ802.1Qï¼‰</li><li>Router(config-subif)#ip address 192.168.1.1 255.255.255.0 //è®¾ç½®å­æ¥å£IPåœ°å€</li><li>Router(config-subif)#exit</li><li>Router(config)#interface fa0/0.20 //åˆ›å»ºè™šæ‹Ÿå­æ¥å£20</li><li>Router(config-subif)#encapsulation dot1Q 20</li><li>Router(config-subif)#ip address 192.168.2.1 255.255.255.0</li><li>Router(config-subif)#exit</li></ul></li></ol><h4 id="6-3-2-éªŒè¯è·¯ç”±å™¨é…ç½®"><a href="#6-3-2-éªŒè¯è·¯ç”±å™¨é…ç½®" class="headerlink" title="6.3.2 éªŒè¯è·¯ç”±å™¨é…ç½®"></a>6.3.2 éªŒè¯è·¯ç”±å™¨é…ç½®</h4><ol><li>æ˜¾ç¤ºè·¯ç”±è¡¨<ul><li>Router#show ip route</li><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="è·¯ç”±è¡¨">/6_2_2.png)</li></ul></li><li>æ˜¾ç¤ºIPæ¥å£ä¿¡æ¯<ul><li>Router#show ip interface brief</li><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="IPæ¥å£">/6_2_3.png)</li></ul></li><li>æ˜¾ç¤ºTrunkç«¯å£<ul><li>Switch#show interfaces trunk</li><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="Trunkç«¯å£">/6_2_4.png)</li></ul></li><li>è¿é€šæ€§æµ‹è¯•<ul><li>PC1&lt;-&gt;PC2ï¼šè¿é€š</li></ul></li></ol><h3 id="6-4-ä¸‰å±‚äº¤æ¢æœºè™šæ‹Ÿæ¥å£SVI"><a href="#6-4-ä¸‰å±‚äº¤æ¢æœºè™šæ‹Ÿæ¥å£SVI" class="headerlink" title="6.4 ä¸‰å±‚äº¤æ¢æœºè™šæ‹Ÿæ¥å£SVI"></a>6.4 ä¸‰å±‚äº¤æ¢æœºè™šæ‹Ÿæ¥å£SVI</h3><p>ä¸‰å±‚äº¤æ¢æœºå®ç°VLANé—´é€šä¿¡çš„æ–¹æ³•æ˜¯åœ¨å·²æœ‰çš„VLANä¸Šåˆ›å»ºè™šæ¥å£ï¼Œå®ƒåŒæ ·å¯ä»¥é…ç½®IPåœ°å€ï¼Œå€ŸåŠ©è™šæ¥å£ä¸‰å±‚äº¤æ¢æœºèƒ½å¤Ÿå®ç°è·¯ç”±è½¬å‘åŠŸèƒ½ã€‚</p><p>ä¼˜ç‚¹ï¼š<br>VLANé—´æµé‡ä¸å¿…ç»è¿‡è·¯ç”±å™¨ï¼Œç½‘ç»œå»¶æ—¶å’ŒæŠ–åŠ¨éƒ½å¾ˆå°ï¼ŒåŒæ—¶ä¹Ÿæå¤§ç¨‹åº¦çš„å‡è½»ä¸Šå±‚æ¥å…¥è·¯ç”±å™¨çš„è´Ÿè½½ã€‚<br>ä¸‰å±‚äº¤æ¢æœºçš„VLANé—´è·¯ç”±ç”±äº¤æ¢æœºçš„ä¸‰å±‚è½¬å‘å¼•æ“å®Œæˆï¼Œå…¶æ€§èƒ½å–å†³äºäº¤æ¢æœºçš„èƒŒæ¿è½¬å‘é€Ÿç‡ï¼Œå¯ä»¥åœ¨å¤šä¸ªç«¯å£ä¸Šè½»æ¾å®ç°çº¿é€Ÿè½¬å‘ï¼Œå¯ä»¥è·å¾—å¾ˆå¥½çš„æ€§èƒ½ã€‚</p><h4 id="6-4-1-é…ç½®"><a href="#6-4-1-é…ç½®" class="headerlink" title="6.4.1 é…ç½®"></a>6.4.1 é…ç½®</h4><ol><li>ç½‘ç»œæ‹“æ‰‘å›¾ï¼ˆå®ŒæˆTCP/IPé…ç½®ï¼‰<ul><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="ç½‘ç»œæ‹“æ‰‘å›¾6_3">/6_3_1.png)</li></ul></li><li>äºŒå±‚äº¤æ¢æœºé…ç½®<ul><li>åˆ›å»ºVLAN10å’ŒVLAN20</li><li>é…ç½®Accessç«¯å£/åˆ’åˆ†VLAN<ul><li>VLAN10: fa0/1</li><li>VLAN20: fa0/2</li></ul></li><li>é…ç½®Trunkç«¯å£ï¼šfa0/24</li><li>æŸ¥çœ‹VLANé…ç½®: Switch#show vlan brief</li><li>æŸ¥çœ‹Trunkç«¯å£: Switch#show interfaces trunk</li></ul></li><li>ä¸‰å±‚äº¤æ¢æœºé…ç½®<ul><li>åˆ›å»ºVLAN10å’ŒVLAN20</li><li>é…ç½®SVIçš„ipåœ°å€<ul><li>Switch(config)#interface vlan 10</li><li>Switch(config-if)#ip address 192.168.1.1 255.255.255.0</li><li>Switch(config-if)#exit</li><li>Switch(config)#interface vlan 20</li><li>Switch(config-if)#ip address 192.168.2.1 255.255.255.0</li><li>Switch(config-if)#exit</li></ul></li><li>å¼€å¯è·¯ç”±åŠŸèƒ½<ul><li>Switch(config)#ip routing</li></ul></li></ul></li></ol><h4 id="6-4-2-éªŒè¯ä¸‰å±‚äº¤æ¢æœºé…ç½®"><a href="#6-4-2-éªŒè¯ä¸‰å±‚äº¤æ¢æœºé…ç½®" class="headerlink" title="6.4.2 éªŒè¯ä¸‰å±‚äº¤æ¢æœºé…ç½®"></a>6.4.2 éªŒè¯ä¸‰å±‚äº¤æ¢æœºé…ç½®</h4><ol><li>æ˜¾ç¤ºè·¯ç”±è¡¨<ul><li>Switch#show ip route</li><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="è·¯ç”±è¡¨">/6_3_2.png)</li></ul></li><li>è¿é€šæ€§æµ‹è¯•ï¼š4å°ä¸»æœºä¹‹é—´å‡å¯ç›¸äº’é€šä¿¡</li></ol><div STYLE="page-break-after: always;"></div><h2 id="ä¸ƒ-é™æ€è·¯ç”±"><a href="#ä¸ƒ-é™æ€è·¯ç”±" class="headerlink" title="ä¸ƒ. é™æ€è·¯ç”±"></a>ä¸ƒ. é™æ€è·¯ç”±</h2><h3 id="7-1-è·¯ç”±å™¨"><a href="#7-1-è·¯ç”±å™¨" class="headerlink" title="7.1 è·¯ç”±å™¨"></a>7.1 è·¯ç”±å™¨</h3><p>è·¯ç”±å™¨ï¼ˆRouterï¼‰ï¼šè¿æ¥ä¸¤ä¸ªæˆ–å¤šä¸ªç½‘ç»œçš„ç¡¬ä»¶è®¾å¤‡ï¼Œåœ¨ç½‘ç»œé—´èµ·ç½‘å…³çš„ä½œç”¨ï¼Œæ˜¯è¯»å–æ¯ä¸€ä¸ªIPæ•°æ®åŒ…ä¸­çš„åœ°å€ç„¶åå†³å®šå¦‚ä½•ä¼ é€çš„ä¸“ç”¨æ™ºèƒ½æ€§çš„ç½‘ç»œè®¾å¤‡ã€‚</p><ul><li>ç›´è¿ç½‘ç»œï¼ˆé‚»æ‘ï¼‰ï¼šç›´æ¥è¿æ¥åœ¨æŸä¸ªè·¯ç”±å™¨ä¸Šçš„ç½‘ç»œï¼Œç§°ä¸ºè¯¥è·¯ç”±å™¨çš„ç›´è¿ç½‘ç»œã€‚æ¯ä¸ªè·¯ç”±å™¨æ¥å£çš„IPä½œä¸ºæ‰€è¿ç›´è¿ç½‘ç»œçš„ç½‘å…³ï¼ˆæ‘å£ï¼‰ã€‚</li><li>éç›´è¿ç½‘ç»œï¼šä¸ç›´æ¥è¿æ¥åœ¨æŸä¸ªè·¯ç”±å™¨ä¸Šçš„ç½‘ç»œï¼ˆé€šå¸¸é—´éš”å¤šä¸ªè·¯ç”±å™¨ï¼‰ã€‚</li></ul><h4 id="7-1-1-è·¯ç”±è¡¨"><a href="#7-1-1-è·¯ç”±è¡¨" class="headerlink" title="7.1.1 è·¯ç”±è¡¨"></a>7.1.1 è·¯ç”±è¡¨</h4><p>è·¯ç”±å™¨ä¾é è·¯ç”±è¡¨æ¥é€‰æ‹©è½¬å‘è·¯å¾„ã€‚<br>è·¯ç”±è¡¨ä¸­åŒ…å«æœ‰è¯¥è·¯ç”±å™¨æŒæ¡çš„æ‰€æœ‰ç›®çš„ç½‘ç»œåœ°å€ï¼Œä»¥åŠé€šè¿‡æ­¤è·¯ç”±å™¨åˆ°è¾¾è¿™äº›ç½‘ç»œä¸­æœ€ä½³è·¯å¾„ï¼Œè¿™ä¸ªæœ€ä½³è·¯å¾„æŒ‡çš„æ˜¯è·¯ç”±å™¨çš„æŸä¸ªæ¥å£æˆ–ä¸‹ä¸€æ¡è·¯ç”±å™¨çš„åœ°å€ã€‚</p><h4 id="7-1-2-é™æ€è·¯ç”±"><a href="#7-1-2-é™æ€è·¯ç”±" class="headerlink" title="7.1.2 é™æ€è·¯ç”±"></a>7.1.2 é™æ€è·¯ç”±</h4><p>é™æ€è·¯ç”±ï¼šç”±ç³»ç»Ÿç®¡ç†å‘˜äº‹å…ˆè®¾ç½®å¥½å›ºå®šçš„è·¯ç”±ä¿¡æ¯ã€‚</p><ul><li>ä¼˜ç‚¹ï¼šç®€å•ã€é«˜æ•ˆã€å¯é ã€‚ä¼˜å…ˆçº§æœ€é«˜ã€‚</li><li>ç¼ºç‚¹ï¼šä¸èƒ½åŠ¨æ€åœ°é€‚ç”¨ç½‘ç»œçŠ¶å†µçš„å˜åŒ–ã€‚</li></ul><h3 id="7-2-é™æ€è·¯ç”±é…ç½®"><a href="#7-2-é™æ€è·¯ç”±é…ç½®" class="headerlink" title="7.2 é™æ€è·¯ç”±é…ç½®"></a>7.2 é™æ€è·¯ç”±é…ç½®</h3><ol><li>ç½‘ç»œæ‹“æ‰‘å›¾ï¼ˆå®ŒæˆTCP/IPé…ç½®ï¼‰<ul><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="ç½‘ç»œæ‹“æ‰‘å›¾7_1">/7_1.png)</li></ul></li><li>è·¯ç”±å™¨é…ç½®ï¼ˆRouter1ä¸ºä¾‹ï¼‰<ul><li>Router1(config)#interface fa0/0</li><li>Router1(config-if)#no shutdown  //æ¿€æ´»æ¥å£</li><li>Router1(config-if)#ip address 192.168.1.1 255.255.255.0 //è®¾ç½®æ¥å£IPåœ°å€ä¸ºæ‰€åœ¨ç½‘ç»œçš„ç½‘å…³</li><li>Router1(config-if)#exit</li><li>Router1(config)#interface fa0/1</li><li>Router1(config-if)#no shutdown</li><li>Router1(config-if)#ip address 192.168.2.1 255.255.255.0</li><li>Router1(config-if)#exit</li><li>Router1(config)#ip route 192.168.3.0 255.255.255.0 192.168.2.2 //è®¾ç½®é™æ€è·¯ç”±ï¼šip route &lt;ç›®çš„ç½‘ç»œ&gt; &lt;å­ç½‘æ©ç &gt; &lt;ä¸‹ä¸€è·³åœ°å€&gt;</li></ul></li></ol><h3 id="7-3-éªŒè¯é™æ€è·¯ç”±é…ç½®"><a href="#7-3-éªŒè¯é™æ€è·¯ç”±é…ç½®" class="headerlink" title="7.3 éªŒè¯é™æ€è·¯ç”±é…ç½®"></a>7.3 éªŒè¯é™æ€è·¯ç”±é…ç½®</h3><ol><li>æ˜¾ç¤ºè·¯ç”±è¡¨<ul><li>Router1#show ip route</li><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="è·¯ç”±è¡¨">/7_2.png)</li></ul></li><li>è¿é€šæ€§æµ‹è¯•ï¼š3å°ä¸»æœºä¹‹é—´å‡å¯ç›¸äº’é€šä¿¡</li></ol><h3 id="7-4-é™æ€è·¯ç”±é…ç½®è¡¥å……"><a href="#7-4-é™æ€è·¯ç”±é…ç½®è¡¥å……" class="headerlink" title="7.4 é™æ€è·¯ç”±é…ç½®è¡¥å……"></a>7.4 é™æ€è·¯ç”±é…ç½®è¡¥å……</h3><ul><li>é€šè¿‡192.168.0.1çš„ç«¯å£ï¼Œè®¿é—®æ‰€æœ‰24ä½å­ç½‘æ©ç çš„ç›®çš„ç½‘ç»œ<ul><li>Router1(config)#ip route 0.0.0.0 255.255.255.0 192.168.0.1</li></ul></li><li>é€šè¿‡192.168.0.1çš„ç«¯å£ï¼Œè®¿é—®æ‰€æœ‰ç½‘ç»œ<ul><li>Router1(config)#ip route 0.0.0.0 0.0.0.0 192.168.0.1</li></ul></li></ul><div STYLE="page-break-after: always;"></div><h2 id="å…«-åŠ¨æ€è·¯ç”±RIP"><a href="#å…«-åŠ¨æ€è·¯ç”±RIP" class="headerlink" title="å…«. åŠ¨æ€è·¯ç”±RIP"></a>å…«. åŠ¨æ€è·¯ç”±RIP</h2><h3 id="8-1-åŠ¨æ€è·¯ç”±"><a href="#8-1-åŠ¨æ€è·¯ç”±" class="headerlink" title="8.1 åŠ¨æ€è·¯ç”±"></a>8.1 åŠ¨æ€è·¯ç”±</h3><p>åŠ¨æ€è·¯ç”±ï¼šè·¯ç”±å™¨æ ¹æ®ç½‘ç»œç³»ç»Ÿçš„è¿è¡Œæƒ…å†µè€Œè‡ªåŠ¨è°ƒæ•´çš„è·¯ç”±ä¿¡æ¯ã€‚è·¯ç”±å™¨æ ¹æ®è·¯ç”±é€‰æ‹©åè®®ï¼ˆRouting Protocolï¼‰æä¾›çš„åŠŸèƒ½ï¼Œè‡ªåŠ¨å­¦ä¹ å’Œè®°å¿†ç½‘ç»œè¿è¡Œæƒ…å†µï¼Œåœ¨éœ€è¦æ—¶è‡ªåŠ¨è®¡ç®—æ•°æ®ä¼ è¾“çš„æœ€ä½³è·¯å¾„ã€‚</p><ul><li>ä¼˜ç‚¹ï¼šåŠ¨æ€è·¯ç”±å¯ä»¥è‡ªåŠ¨å­¦ä¹ ç½‘ç»œçš„æ‹“æœ´ç»“æ„ï¼Œå¹¶æ›´æ–°è·¯ç”±è¡¨ã€‚</li><li>ç¼ºç‚¹ï¼šè·¯ç”±å¹¿æ’­æ›´æ–°ä¿¡æ¯å°†å æ®å¤§é‡çš„ç½‘ç»œå¸¦å®½ã€‚</li></ul><h4 id="8-1-1-åŠ¨æ€è·¯ç”±åˆ†ç±»"><a href="#8-1-1-åŠ¨æ€è·¯ç”±åˆ†ç±»" class="headerlink" title="8.1.1 åŠ¨æ€è·¯ç”±åˆ†ç±»"></a>8.1.1 åŠ¨æ€è·¯ç”±åˆ†ç±»</h4><ul><li>æŒ‰ç…§ä½¿ç”¨çš„åŒºåŸŸä¸åŒ<ul><li>å†…éƒ¨ç½‘å…³åè®®IGPï¼ˆInterior Gateway Protocolï¼‰åŸŸå†…åè®®ã€‚å¦‚RIPã€EIGRPã€OSPFã€ISIS</li><li>å¤–éƒ¨ç½‘å…³åè®®EGPï¼ˆExterior Gateway Protocolï¼‰åŸŸé—´åè®®ã€‚å¦‚BGP</li></ul></li><li>æŒ‰ç…§ç®—æ³•ä¸åŒ<ul><li>è·ç¦»çŸ¢é‡åè®®ï¼ˆDistance Vectorï¼‰ã€‚å¦‚RIPV1ã€RIPV2ã€BGP</li><li>é“¾è·¯çŠ¶æ€è·¯ç”±åè®®ï¼ˆLink Stateï¼‰ã€‚å¦‚OSPFã€ISIS</li></ul></li><li>æŒ‰æ˜¯å¦æºå¸¦å­ç½‘æ©ç <ul><li>æœ‰ç±»è·¯ç”±åè®®ã€‚å¦‚RIPV1</li><li>æ— ç±»è·¯ç”±åè®®ã€‚å¦‚RIPV2ã€OSPFã€ISISã€BGP</li></ul></li></ul><h4 id="8-1-2-RIPåè®®"><a href="#8-1-2-RIPåè®®" class="headerlink" title="8.1.2 RIPåè®®"></a>8.1.2 RIPåè®®</h4><p>RIPæ˜¯ä¸€ç§åŸºäºè·ç¦»çŸ¢é‡ï¼ˆDistance-Vectorï¼‰ç®—æ³•çš„åè®®ï¼Œå®ƒä½¿ç”¨è·³æ•°ï¼ˆHop Countï¼‰ä½œä¸ºåº¦é‡å€¼æ¥è¡¡é‡åˆ°è¾¾ç›®çš„åœ°å€çš„è·ç¦»ã€‚</p><p>åœ¨RIPç½‘ç»œä¸­ï¼Œç¼ºçœæƒ…å†µä¸‹ï¼Œè®¾å¤‡åˆ°ä¸å®ƒç›´æ¥ç›¸è¿ç½‘ç»œçš„è·³æ•°ä¸º0ï¼Œé€šè¿‡ä¸€ä¸ªè®¾å¤‡å¯è¾¾çš„ç½‘ç»œçš„è·³æ•°ä¸º1ï¼Œå…¶ä½™ä¾æ­¤ç±»æ¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåº¦é‡å€¼ç­‰äºä»æœ¬ç½‘ç»œåˆ°è¾¾ç›®çš„ç½‘ç»œé—´çš„è®¾å¤‡æ•°é‡ã€‚</p><p>ä¸ºé™åˆ¶æ”¶æ•›æ—¶é—´ï¼ŒRIPè§„å®šåº¦é‡å€¼å–0ï½15ä¹‹é—´çš„æ•´æ•°ï¼Œå¤§äºæˆ–ç­‰äº16çš„è·³æ•°è¢«å®šä¹‰ä¸ºæ— ç©·å¤§ï¼Œå³ç›®çš„ç½‘ç»œæˆ–ä¸»æœºä¸å¯è¾¾ã€‚ç”±äºè¿™ä¸ªé™åˆ¶ï¼Œä½¿å¾—RIPä¸å¯èƒ½åœ¨å¤§å‹ç½‘ç»œä¸­å¾—åˆ°åº”ç”¨ã€‚</p><p>RIPè·¯ç”±å™¨å·¥ä½œæµç¨‹ï¼š</p><ul><li>RIPè·¯ç”±å™¨A,Båˆå§‹çš„è·¯ç”±è¡¨ä¸­åªæœ‰è‡ªå·±çš„ç›´è¿è·¯ç”±ã€‚</li><li>æ¯30ç§’ï¼Œå‘ç›¸é‚»è·¯ç”±å™¨å‘é€è‡ªå·±çš„è·¯ç”±è¡¨ã€‚</li><li>æ”¶åˆ°ç›¸é‚»è·¯ç”±å™¨çš„è·¯ç”±è¡¨åï¼Œæ›´æ–°è‡ªå·±çš„è·¯ç”±è¡¨ï¼š<ul><li>æ–°å¢ï¼šå¦‚æœæ”¶åˆ°çš„è·¯ç”±è¡¨ä¸­æœ‰è‡ªå·±æ²¡æœ‰çš„è·¯ç”±ï¼Œåˆ™æ·»åŠ åˆ°è‡ªå·±çš„è·¯ç”±è¡¨ä¸­ã€‚</li><li>æ›´æ–°ï¼šå¦‚æœæ”¶åˆ°çš„è·¯ç”±è¡¨ä¸­æœ‰è‡ªå·±å·²æœ‰çš„è·¯ç”±ï¼Œä¸”æ–°çš„è·³æ•°æ›´å°ï¼Œåˆ™æ›´æ–°è‡ªå·±çš„è·¯ç”±è¡¨çš„è·³æ•°ã€‚</li></ul></li><li>RIPè®¡æ—¶å™¨ï¼š<ul><li>æ›´æ–°è®¡æ—¶å™¨ï¼šæ¯30ç§’å·¦å³å‘é€ä¸€æ¬¡è·¯ç”±è¡¨ã€‚</li><li>å¤±æ•ˆè®¡æ—¶å™¨ï¼š180ç§’ï¼ˆ6å€æ›´æ–°æ—¶é—´ï¼‰æœªæ›´æ–°ï¼Œæ ‡è®°ä¸ºä¸å¯è¾¾ã€‚</li><li>åˆ·æ–°è®¡æ—¶å™¨ï¼šæ— æ•ˆè·¯ç”±240ç§’æœªæ›´æ–°ï¼Œä»è·¯ç”±è¡¨ä¸­åˆ é™¤ã€‚</li></ul></li></ul><p>è·¯ç”±æ¯’åŒ–ï¼šå½“ä¸€ä¸ªè·¯ç”±å™¨å‘ç°ä¸€ä¸ªç½‘ç»œä¸å¯è¾¾æ—¶ï¼Œä¼šå‘å…¶ä»–è·¯ç”±å™¨å‘é€ä¸€ä¸ªåº¦é‡å€¼ä¸º16çš„è·¯ç”±ï¼Œä»¥ä¼ æ’­è·¯ç”±å¤±æ•ˆçš„æ¶ˆæ¯ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºè·¯ç”±æ¯’åŒ–ã€‚</p><h4 id="8-1-3-RIPåè®®ç‰ˆæœ¬"><a href="#8-1-3-RIPåè®®ç‰ˆæœ¬" class="headerlink" title="8.1.3 RIPåè®®ç‰ˆæœ¬"></a>8.1.3 RIPåè®®ç‰ˆæœ¬</h4><p>RIPv1</p><ul><li>ä½¿ç”¨å¹¿æ’­çš„æ–¹å¼å‘é€è·¯ç”±æ›´æ–°</li><li>è·¯ç”±æ›´æ–°ä¿¡æ¯ä¸­ä¸æºå¸¦å­ç½‘æ©ç ï¼Œä¸ºæœ‰ç±»è·¯ç”±åè®®ï¼Œä¸æ”¯æŒ VLSM å’Œ CIDR</li><li>ä¸æ”¯æŒè®¤è¯</li></ul><p>RIPv2</p><ul><li>å‘é€æ›´æ–°æŠ¥æ–‡çš„æ–¹å¼ä¸ºç»„æ’­ï¼Œç»„æ’­åœ°å€ä¸º224.0.0.9</li><li>è·¯ç”±ä¿¡æ¯ä¸­åŠ å…¥äº†å­ç½‘æ©ç ï¼Œä¸ºæ— ç±»è·¯ç”±åè®®ï¼Œæ”¯æŒ VLSMï¼Œæ”¯æŒè·¯ç”±èšåˆä¸ CIDR</li><li>æ”¯æŒæ˜æ–‡è®¤è¯å’Œ MD5 å¯†æ–‡è®¤è¯</li></ul><p>VLSMï¼šå¯å˜é•¿å­ç½‘æ©ç Variable Length Subnet Mask</p><p>CIDRï¼šæ— ç±»åŸŸé—´è·¯ç”±èšåˆClassless Inter-Domain Routing</p><h3 id="8-2-RIPV1"><a href="#8-2-RIPV1" class="headerlink" title="8.2 RIPV1"></a>8.2 RIPV1</h3><h4 id="8-2-1-é…ç½®"><a href="#8-2-1-é…ç½®" class="headerlink" title="8.2.1 é…ç½®"></a>8.2.1 é…ç½®</h4><ol><li>ç½‘ç»œæ‹“æ‰‘å›¾ï¼ˆå®ŒæˆTCP/IPé…ç½®ï¼‰<ul><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="ç½‘ç»œæ‹“æ‰‘å›¾8_1">/8_1_1.png)</li></ul></li><li>è·¯ç”±å™¨é…ç½®ï¼ˆä»¥Router1ä¸ºä¾‹ï¼‰<ul><li>Router1(config)#interface lo0  //åˆ›å»ºLoopbackæ¥å£ï¼Œç”¨äºæ¨¡æ‹Ÿç½‘ç»œ</li><li>Router1(config-if)#ip address 1.1.1.1 255.255.255.0</li><li>Router1(config-if)#exit</li><li>Router1(config)#interface fa0/0</li><li>Router1(config-if)#no shutdown  //æ¿€æ´»æ¥å£</li><li>Router1(config-if)#ip address 12.1.1.1 255.55.255.0</li><li>Router1(config-if)#exit</li><li>Router1(config)#router rip  //è¿›å…¥RIPåè®®é…ç½®æ¨¡å¼</li><li>Router1(config-router)#version 1  //è®¾ç½®RIPç‰ˆæœ¬ä¸º1</li><li>Router1(config-router)#network 1.1.1.0 //è®¾ç½®RIPåè®®çš„ç½‘ç»œåœ°å€</li><li>Router1(config-router)#network 12.1.1.0</li></ul></li></ol><h4 id="8-2-2-éªŒè¯RIPV1é…ç½®"><a href="#8-2-2-éªŒè¯RIPV1é…ç½®" class="headerlink" title="8.2.2 éªŒè¯RIPV1é…ç½®"></a>8.2.2 éªŒè¯RIPV1é…ç½®</h4><ol><li>æ˜¾ç¤ºè·¯ç”±è¡¨<ul><li>Router1#show ip route</li><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="è·¯ç”±è¡¨">/8_1_2.png)</li></ul></li><li>è¿é€šæ€§æµ‹è¯•ï¼šRouter1å’ŒRouter3çš„lo0æ¥å£ä¹‹é—´å¯ä»¥ç›¸äº’é€šä¿¡</li></ol><h3 id="8-3-RIPV2"><a href="#8-3-RIPV2" class="headerlink" title="8.3 RIPV2"></a>8.3 RIPV2</h3><h4 id="8-3-1-é…ç½®"><a href="#8-3-1-é…ç½®" class="headerlink" title="8.3.1 é…ç½®"></a>8.3.1 é…ç½®</h4><ol><li>ç½‘ç»œæ‹“æ‰‘å›¾ï¼ˆå®ŒæˆTCP/IPé…ç½®ï¼‰<ul><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="ç½‘ç»œæ‹“æ‰‘å›¾8_2">/8_2_1.png)</li></ul></li><li>è·¯ç”±å™¨é…ç½®ï¼ˆä»¥Router1ä¸ºä¾‹ï¼‰<ul><li>Router1(config)#interface lo0</li><li>Router1(config-if)#ip address 10.1.1.1 255.255.255.0</li><li>Router1(config-if)#exit</li><li>Router1(config)#interface fa0/0</li><li>Router1(config-if)#no shutdown</li><li>Router1(config-if)#ip address 12.1.1.1 255.255.255.0</li><li>Router1(config-if)#exit</li><li>Router1(config)#router rip</li><li>Router1(config-router)#version 2 //è®¾ç½®RIPç‰ˆæœ¬ä¸º2</li><li>Router1(config-router)#network 10.1.1.0</li><li>Router1(config-router)#network 12.1.1.0</li><li>Router1(config-router)#no auto-summary //å…³é—­è‡ªåŠ¨æ±‡æ€»</li></ul></li></ol><h4 id="8-3-2-éªŒè¯RIPV2é…ç½®"><a href="#8-3-2-éªŒè¯RIPV2é…ç½®" class="headerlink" title="8.3.2 éªŒè¯RIPV2é…ç½®"></a>8.3.2 éªŒè¯RIPV2é…ç½®</h4><ol><li>æ˜¾ç¤ºè·¯ç”±è¡¨<ul><li>Router1#show ip route</li><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="è·¯ç”±è¡¨">/8_2_2.png)</li></ul></li><li>è¿é€šæ€§æµ‹è¯•ï¼šRouter1å’ŒRouter3çš„lo0æ¥å£ä¹‹é—´å¯ä»¥ç›¸äº’é€šä¿¡</li></ol><div STYLE="page-break-after: always;"></div><h2 id="ä¹-NAT"><a href="#ä¹-NAT" class="headerlink" title="ä¹. NAT"></a>ä¹. NAT</h2><h3 id="9-1-NAT"><a href="#9-1-NAT" class="headerlink" title="9.1 NAT"></a>9.1 NAT</h3><p>NAT(Network Address Translationï¼Œç½‘ç»œåœ°å€è½¬æ¢)æ˜¯ä¸€ç§å°†ç§æœ‰åœ°å€ï¼ˆRFC 1918ï¼‰è½¬æ¢ä¸ºå…¬æœ‰åœ°å€çš„æŠ€æœ¯ï¼Œç”¨äºè§£å†³IPåœ°å€ä¸è¶³çš„é—®é¢˜ã€‚</p><h4 id="9-1-1-NATæœ¯è¯­"><a href="#9-1-1-NATæœ¯è¯­" class="headerlink" title="9.1.1 NATæœ¯è¯­"></a>9.1.1 NATæœ¯è¯­</h4><ul><li>å†…éƒ¨æœ¬åœ°IPåœ°å€ï¼šåˆ†é…ç»™å†…éƒ¨ç½‘ç»œä¸­çš„ä¸»æœºçš„IPåœ°å€ï¼Œé€šå¸¸è¿™ç§åœ°å€æ¥è‡ªRFC1918æŒ‡å®šçš„ç§æœ‰åœ°å€ç©ºé—´ã€‚</li><li>å†…éƒ¨å…¨å±€IPåœ°å€ï¼šå†…éƒ¨å…¨å±€IPåœ°å€ï¼Œå¯¹å¤–ä»£è¡¨ä¸€ä¸ªæˆ–å¤šä¸ªå†…éƒ¨æœ¬åœ°IPåœ°å€ï¼Œé€šå¸¸è¿™ç§åœ°å€æ¥è‡ªå…¨å±€æƒŸä¸€çš„åœ°å€ç©ºé—´ï¼Œé€šå¸¸ç”±ISPæä¾›ã€‚</li><li>å¤–éƒ¨æœ¬åœ°IPåœ°å€ï¼šåœ¨å†…éƒ¨ç½‘ç»œä¸­çœ‹åˆ°çš„å¤–éƒ¨ä¸»æœºçš„IPåœ°å€ï¼Œé€šå¸¸æ¥è‡ªRFC 1918å®šä¹‰çš„ç§æœ‰åœ°å€ç©ºé—´ã€‚</li><li>å¤–éƒ¨å…¨å±€IPåœ°å€ï¼šå¤–éƒ¨ç½‘ç»œä¸­çš„ä¸»æœºçš„IPåœ°å€ï¼Œé€šå¸¸æ¥è‡ªå…¨å±€å¯è·¯ç”±çš„åœ°å€ç©ºé—´ã€‚</li></ul><h4 id="9-1-2-NATåˆ†ç±»"><a href="#9-1-2-NATåˆ†ç±»" class="headerlink" title="9.1.2 NATåˆ†ç±»"></a>9.1.2 NATåˆ†ç±»</h4><ul><li>é™æ€NATï¼šä¸€å¯¹ä¸€æ˜ å°„ï¼Œå°†ä¸€ä¸ªå†…éƒ¨IPåœ°å€æ˜ å°„åˆ°ä¸€ä¸ªå¤–éƒ¨IPåœ°å€ã€‚</li><li>åŠ¨æ€NATï¼šå°†å†…éƒ¨IPåœ°å€åŠ¨æ€è½¬æ¢ä¸ºä¸€ç»„å¤–éƒ¨IPåœ°å€ï¼ˆIPåœ°å€æ± ï¼‰ä¸­çš„ä¸€ä¸ªã€‚<ul><li>è¶…è½½NATï¼šåŠ¨æ€NATçš„ä¸€ç§å®ç°å½¢å¼ï¼Œåˆ©ç”¨ä¸åŒç«¯å£å·å°†å¤šä¸ªå†…éƒ¨IPåœ°å€è½¬æ¢ä¸ºä¸€ä¸ªå¤–éƒ¨IPåœ°å€ï¼Œä¹Ÿç§°ä¸ºPATã€NAPTæˆ–ç«¯å£å¤ç”¨NATã€‚</li></ul></li></ul><h3 id="9-2-NATé…ç½®"><a href="#9-2-NATé…ç½®" class="headerlink" title="9.2 NATé…ç½®"></a>9.2 NATé…ç½®</h3><h4 id="9-2-1-ç½‘è·¯æ‹“æ‰‘å›¾"><a href="#9-2-1-ç½‘è·¯æ‹“æ‰‘å›¾" class="headerlink" title="9.2.1 ç½‘è·¯æ‹“æ‰‘å›¾"></a>9.2.1 ç½‘è·¯æ‹“æ‰‘å›¾</h4><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="ç½‘ç»œæ‹“æ‰‘å›¾">/9_0.png)</p><p>å®ŒæˆPCæœºå’ŒæœåŠ¡å™¨çš„TCP/IPé…ç½®</p><h4 id="9-2-2-è·¯ç”±å™¨åŸºç¡€é…ç½®"><a href="#9-2-2-è·¯ç”±å™¨åŸºç¡€é…ç½®" class="headerlink" title="9.2.2 è·¯ç”±å™¨åŸºç¡€é…ç½®"></a>9.2.2 è·¯ç”±å™¨åŸºç¡€é…ç½®</h4><ol><li>Router1é…ç½®<ul><li>Router1(config)#interface fa0/0</li><li>Router1(config-if)#no shutdown</li><li>Router1(config-if)#ip address 10.1.1.1 255.255.255.0</li><li>Router1(config-if)#ip nat inside //å†…ç½‘æ¥å£</li><li>Router1(config-if)#exit</li><li>Router1(config)#interface fa0/1</li><li>Router1(config-if)#no shutdown</li><li>Router1(config-if)#ip address 2.2.2.1 255.255.255.0</li><li>Router1(config-if)#ip nat outside //å¤–ç½‘æ¥å£</li><li>Router1(config-if)#exit</li><li>Router1(config)#ip route 0.0.0.0 0.0.0.0 2.2.2.2 //è®¾ç½®é™æ€è·¯ç”±ï¼šå†…ç½‘ä¸»æœºå¯ä»¥é€šè¿‡Router1è®¿é—®å¤–ç½‘</li></ul></li><li>Router2é…ç½®<ul><li>fa0/0: 2.2.2.2/24</li><li>fa0/1: 1.1.1.1/24</li><li>å¤–ç½‘ä¸å…è®¸è®¿é—®å†…ç½‘ï¼Œæ— éœ€é…ç½®é™æ€è·¯ç”±</li></ul></li></ol><h4 id="9-2-3-é™æ€NAT"><a href="#9-2-3-é™æ€NAT" class="headerlink" title="9.2.3 é™æ€NAT"></a>9.2.3 é™æ€NAT</h4><p>åœ¨Router1ä¸Šè®¾ç½®é™æ€NATï¼Œä½¿å¤–ç½‘PCå¯ä»¥ä½¿ç”¨å¤–ç½‘åœ°å€2.2.2.10è®¿é—®å†…éƒ¨æœåŠ¡å™¨Server0çš„WebæœåŠ¡ï¼ˆä»…80ç«¯å£ï¼‰</p><h5 id="é…ç½®é™æ€NAT"><a href="#é…ç½®é™æ€NAT" class="headerlink" title="é…ç½®é™æ€NAT"></a>é…ç½®é™æ€NAT</h5><ul><li>Router1(config)#ip nat inside source static tcp 10.1.1.20 80 2.2.2.10 80 //è®¾ç½®é™æ€NATï¼šå†…ç½‘æœåŠ¡å™¨çš„80ç«¯å£æ˜ å°„åˆ°å¤–ç½‘åœ°å€çš„80ç«¯å£</li></ul><h5 id="éªŒè¯é™æ€NAT"><a href="#éªŒè¯é™æ€NAT" class="headerlink" title="éªŒè¯é™æ€NAT"></a>éªŒè¯é™æ€NAT</h5><ol><li>å¤–ç½‘PCä½¿ç”¨å¤–ç½‘åœ°å€2.2.2.10è®¿é—®å†…éƒ¨æœåŠ¡å™¨Server0çš„WebæœåŠ¡<ul><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="è®¿é—®WebæœåŠ¡">/9_1_2.png)</li></ul></li><li>æ˜¾ç¤ºNATè½¬æ¢è¡¨<ul><li>Router1#show ip nat translations</li><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="NATè½¬æ¢è¡¨">/9_1_1.png)</li></ul></li></ol><h4 id="9-2-4-åŠ¨æ€NAT"><a href="#9-2-4-åŠ¨æ€NAT" class="headerlink" title="9.2.4 åŠ¨æ€NAT"></a>9.2.4 åŠ¨æ€NAT</h4><p>åœ¨Router1ä¸Šè®¾ç½®åŠ¨æ€NATï¼Œä½¿å†…ç½‘PCå¯ä»¥é€šè¿‡å¤–ç½‘åœ°å€2.2.2.11-2.2.2.12è®¿é—®å¤–ç½‘æœåŠ¡å™¨Server1çš„WebæœåŠ¡ï¼ˆä»…80ç«¯å£ï¼‰</p><h5 id="é…ç½®åŠ¨æ€NAT"><a href="#é…ç½®åŠ¨æ€NAT" class="headerlink" title="é…ç½®åŠ¨æ€NAT"></a>é…ç½®åŠ¨æ€NAT</h5><ul><li>Router1(config)#access-list 1 permit any //åˆ›å»ºè®¿é—®æ§åˆ¶åˆ—è¡¨ 1</li><li>Router1(config)#ip nat pool pool1 2.2.2.11 2.2.2.12 netmask 255.255.255.0 //åˆ›å»ºIPåœ°å€æ± ï¼šip nat pool &lt;åç§°&gt; &lt;èµ·å§‹åœ°å€&gt; &lt;ç»“æŸåœ°å€&gt; netmask &lt;å­ç½‘æ©ç &gt;</li><li>Router1(config)#ip nat inside source list 1 pool pool1 //è®¾ç½®åŠ¨æ€NATï¼šip nat inside source list &lt;è®¿é—®æ§åˆ¶åˆ—è¡¨&gt; pool <IPåœ°å€æ± ></li></ul><h5 id="éªŒè¯åŠ¨æ€NAT"><a href="#éªŒè¯åŠ¨æ€NAT" class="headerlink" title="éªŒè¯åŠ¨æ€NAT"></a>éªŒè¯åŠ¨æ€NAT</h5><ol><li>å†…ç½‘PCä½¿ç”¨å¤–ç½‘åœ°å€1.1.1.10è®¿é—®å¤–ç½‘æœåŠ¡å™¨Server1çš„WebæœåŠ¡<ul><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="è®¿é—®WebæœåŠ¡">/9_2_1.png)</li><li>ç”±äºIPåœ°å€æ± ä¸­åªæœ‰2ä¸ªåœ°å€ï¼Œç¬¬3ä¸ªå†…ç½‘ä¸»æœºæ— æ³•è®¿é—®å¤–ç½‘</li></ul></li><li>æ˜¾ç¤ºNATè½¬æ¢è¡¨<ul><li>Router1#show ip nat translations</li><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="NATè½¬æ¢è¡¨">/9_2_2.png)</li></ul></li></ol><h3 id="9-3-NAPT"><a href="#9-3-NAPT" class="headerlink" title="9.3 NAPT"></a>9.3 NAPT</h3><p>åœ¨Router1ä¸Šè®¾ç½®åŠ¨æ€NAPTã€‚ä½¿å†…ç½‘PCå¯ä»¥é€šè¿‡å¤–ç½‘åœ°å€2.2.2.15è®¿é—®å¤–ç½‘æœåŠ¡å™¨</p><h4 id="é…ç½®NAPT"><a href="#é…ç½®NAPT" class="headerlink" title="é…ç½®NAPT"></a>é…ç½®NAPT</h4><ul><li>Router1(config)#ip nat pool pool2 2.2.2.15 2.2.2.15 netmask 255.255.255.0</li><li>Router1(config)#ip nat inside source list 1 pool pool2 overload //overload: è¶…è½½ï¼Œå³NAPT</li></ul><h4 id="éªŒè¯NAPT"><a href="#éªŒè¯NAPT" class="headerlink" title="éªŒè¯NAPT"></a>éªŒè¯NAPT</h4><ol><li>å†…ç½‘PCä½¿ç”¨å¤–ç½‘åœ°å€1.1.1.10è®¿é—®å¤–ç½‘æœåŠ¡å™¨Server1çš„WebæœåŠ¡<ul><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="è®¿é—®WebæœåŠ¡">/9_3_1.png)</li></ul></li><li>æ˜¾ç¤ºNATè½¬æ¢è¡¨<ul><li>Router1#show ip nat translations</li><li><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="NATè½¬æ¢è¡¨">/9_3_2.png)</li></ul></li></ol><div STYLE="page-break-after: always;"></div><h2 id="å-ARPåè®®åˆ†æ"><a href="#å-ARPåè®®åˆ†æ" class="headerlink" title="å. ARPåè®®åˆ†æ"></a>å. ARPåè®®åˆ†æ</h2><h3 id="10-1-ARPåè®®"><a href="#10-1-ARPåè®®" class="headerlink" title="10.1 ARPåè®®"></a>10.1 ARPåè®®</h3><p>ARPï¼ˆAddress Resolution Protocolï¼Œåœ°å€è§£æåè®®ï¼‰ä¸»è¦ç”¨äºæ ¹æ® IP åœ°å€æ±‚å‡ºä¸»æœºæ‰€å¯¹åº”çš„ç‰©ç†åœ°å€ï¼ˆMAC åœ°å€ï¼‰ã€‚</p><p>åœ¨ç½‘ç»œé€šä¿¡ä¸­ï¼Œä¸»æœºå’Œä¸»æœºä¹‹é—´çš„é€šä¿¡éœ€è¦æ ¹æ® OSI æ¨¡å‹è¿›è¡Œæ•°æ®åŒ…çš„å°è£…å’Œè§£å°è£…ï¼Œè¿™é‡Œé¢ä¸ä»…éœ€è¦å°è£…æºç›®çš„ IP åœ°å€ï¼Œä¹Ÿéœ€è¦æºç›®çš„ MAC åœ°å€ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸Šå±‚åº”ç”¨åªçŸ¥é“ IP åœ°å€ï¼Œè€Œå¹¶ä¸å…³å¿ƒ MAC åœ°å€ï¼Œæ‰€ä»¥å°±éœ€è¦é€šè¿‡ä¸€ä¸ªåè®®æ¥è·çŸ¥ç›®çš„ MAC åœ°å€ï¼Œå®Œæˆæ•°æ®çš„å°è£…ï¼Œè¿™ä¸ªåè®®å°±æ˜¯ ARP åè®®ã€‚</p><h4 id="ARPåè®®å·¥ä½œåŸç†"><a href="#ARPåè®®å·¥ä½œåŸç†" class="headerlink" title="ARPåè®®å·¥ä½œåŸç†"></a>ARPåè®®å·¥ä½œåŸç†</h4><p>ä¸»æœºAå·²çŸ¥ç›®æ ‡ä¸»æœºBçš„IPåœ°å€ï¼Œå‘ä¸»æœºBå‘é€æ•°æ®åŒ…æ—¶ï¼Œéœ€è¦çŸ¥é“ç›®æ ‡ä¸»æœºBçš„MACåœ°å€ã€‚</p><p>ARPåè®®å·¥ä½œåŸç†å¦‚ä¸‹ï¼š</p><ol><li>ä¸»æœºAåœ¨è‡ªå·±çš„ARPç¼“å­˜è¡¨ä¸­æŸ¥æ‰¾ç›®æ ‡ä¸»æœºBçš„MACåœ°å€ï¼Œå¦‚æœæ‰¾åˆ°åˆ™ç›´æ¥å‘é€æ•°æ®åŒ…ã€‚</li><li>å¦‚æœARPç¼“å­˜è¡¨ä¸­æ²¡æœ‰ç›®æ ‡ä¸»æœºBçš„MACåœ°å€ï¼Œåˆ™ä¸»æœºAå‘æœ¬åœ°ç½‘ç»œå¹¿æ’­ARPè¯·æ±‚æŠ¥æ–‡ï¼Œè¯·æ±‚ç›®æ ‡ä¸»æœºBçš„MACåœ°å€ã€‚</li><li>ç›®æ ‡ä¸»æœºBæ”¶åˆ°ARPè¯·æ±‚æŠ¥æ–‡åï¼Œå‘ä¸»æœºAå‘é€ARPå“åº”æŠ¥æ–‡ï¼ŒåŒ…å«è‡ªå·±çš„MACåœ°å€ã€‚</li><li>ä¸»æœºAæ”¶åˆ°ARPå“åº”æŠ¥æ–‡åï¼Œå°†ç›®æ ‡ä¸»æœºBçš„MACåœ°å€å­˜å…¥ARPç¼“å­˜è¡¨ï¼Œå¹¶å‘é€æ•°æ®åŒ…ã€‚</li></ol><h3 id="10-2-ARPåè®®åˆ†æ"><a href="#10-2-ARPåè®®åˆ†æ" class="headerlink" title="10.2 ARPåè®®åˆ†æ"></a>10.2 ARPåè®®åˆ†æ</h3><p>ä»¥ç®¡ç†å‘˜èº«ä»½å¯åŠ¨cmdï¼š</p><ul><li>æŸ¥çœ‹ARPç¼“å­˜è¡¨ï¼šarp -a</li><li>æ¸…ç©ºARPç¼“å­˜è¡¨ï¼šarp -d</li><li>åˆ é™¤æŒ‡å®šARPç¼“å­˜ï¼šarp -d <IPåœ°å€></li></ul><ol><li>æ‰“å¼€Wiresharkï¼Œåœ¨æ•è·é€‰é¡¹ä¸­è®¾ç½®è¿‡æ»¤å™¨ä¸ºâ€œarpâ€ã€‚</li><li>å¼€å§‹æŠ“å–æ•°æ®ã€‚</li><li>ä»¥ç®¡ç†å‘˜èº«ä»½å¯åŠ¨cmdï¼Œæ¸…ç©ºARPç¼“å­˜è¡¨å¹¶ç­‰å¾…ä¸€æ®µæ—¶é—´ã€‚</li><li>ç»“æŸæŠ“å–æ•°æ®ã€‚</li><li>é€‰æ‹©ä¸€å¯¹ARPè¯·æ±‚å’Œå“åº”æŠ¥æ–‡ï¼Œè¿›è¡Œåˆ†æã€‚</li></ol><p>ä»¥ARPè¯·æ±‚æŠ¥æ–‡ä¸ºä¾‹ï¼Œå…·ä½“æ•°æ®åŒ…å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="ARPè¯·æ±‚æŠ¥æ–‡">/10_1.png)</p><p>æ•°æ®é“¾è·¯å±‚æ•°æ®å¸§ï¼š</p><div class="table-container"><table><thead><tr><th>å­—æ®µ</th><th>é•¿åº¦(bit)</th><th>è¯´æ˜</th><th>ARP Request</th><th>ARP Reply</th></tr></thead><tbody><tr><td>Destination</td><td>48</td><td>ç›®çš„MACåœ°å€</td><td>ff:ff:ff:ff:ff:ff(å¹¿æ’­åœ°å€)</td><td>08:xx:xx:xx:xx:ae(å‘é€æ–¹MACåœ°å€)</td></tr><tr><td>Source</td><td>48</td><td>æºMACåœ°å€</td><td>08:xx:xx:xx:xx:ae(å‘é€æ–¹MACåœ°å€)</td><td>d8:xx:xx:xx:xx:d5(ç›®æ ‡MACåœ°å€)</td></tr><tr><td>Type</td><td>16</td><td>ç±»å‹</td><td>0x0806(ARP)</td><td>0x0806(ARP)</td></tr></tbody></table></div><p>ARPæ•°æ®å¸§ï¼š</p><div class="table-container"><table><thead><tr><th>å­—æ®µ</th><th>é•¿åº¦(bit)</th><th>è¯´æ˜</th><th>ARP Request</th><th>ARP Reply</th></tr></thead><tbody><tr><td>Hardware Type</td><td>16</td><td>ç¡¬ä»¶ç±»å‹ï¼Œæ ‡è¯†é“¾è·¯å±‚åè®®</td><td>0x0001(ä»¥å¤ªç½‘)</td><td>0x0001(ä»¥å¤ªç½‘)</td></tr><tr><td>Protocol Type</td><td>16</td><td>åè®®ç±»å‹ï¼Œæ ‡è¯†ç½‘ç»œå±‚åè®®</td><td>0x0800(IPv4)</td><td>0x0800(IPv4)</td></tr><tr><td>Hardware Size</td><td>8</td><td>ç¡¬ä»¶åœ°å€å¤§å°ï¼Œæ ‡è¯†MACåœ°å€é•¿åº¦</td><td>0x06(6B=48bit)</td><td>0x06(6B=48bit)</td></tr><tr><td>Protocol Size</td><td>8</td><td>åè®®åœ°å€å¤§å°ï¼Œæ ‡è¯†IPåœ°å€é•¿åº¦</td><td>0x04(4B=32bit)</td><td>0x04(4B=32bit)</td></tr><tr><td>Opcode</td><td>16</td><td>æ“ä½œç ï¼Œæ ‡è¯†ARPè¯·æ±‚æˆ–å“åº”</td><td>0x0001(ARP Request)</td><td>0x0002(ARP Reply)</td></tr><tr><td>Sender MAC Address</td><td>48</td><td>å‘é€æ–¹MACåœ°å€</td><td>08:xx:xx:xx:xx:ae</td><td>d8:xx:xx:xx:xx:d5(ç›®æ ‡MACåœ°å€)</td></tr><tr><td>Sender IP Address</td><td>32</td><td>å‘é€æ–¹IPåœ°å€</td><td>10.234.172.214</td><td>10.234.0.1</td></tr><tr><td>Target MAC Address</td><td>48</td><td>ç›®æ ‡MACåœ°å€</td><td>00:00:00:00:00:00(å¾…å¡«å……)</td><td>08:xx:xx:xx:xx:ae(å‘é€æ–¹MACåœ°å€)</td></tr><tr><td>Target IP Address</td><td>32</td><td>ç›®æ ‡IPåœ°å€</td><td>10.234.0.1</td><td>10.234.172.214</td></tr></tbody></table></div><div STYLE="page-break-after: always;"></div><h2 id="åä¸€-TCPåè®®åˆ†æ"><a href="#åä¸€-TCPåè®®åˆ†æ" class="headerlink" title="åä¸€. TCPåè®®åˆ†æ"></a>åä¸€. TCPåè®®åˆ†æ</h2><h3 id="11-1-TCPåè®®"><a href="#11-1-TCPåè®®" class="headerlink" title="11.1 TCPåè®®"></a>11.1 TCPåè®®</h3><p>TCPï¼ˆTransmission Control Protocolï¼Œä¼ è¾“æ§åˆ¶åè®®ï¼‰æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ã€‚</p><p>UDPï¼ˆUser Datagram Protocolï¼Œç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰æ˜¯ä¸€ç§æ— è¿æ¥çš„ã€ä¸å¯é çš„ã€åŸºäºæ•°æ®æŠ¥çš„ä¼ è¾“å±‚é€šä¿¡åè®®ã€‚</p><div class="table-container"><table><thead><tr><th>ç‰¹æ€§</th><th>TCP</th><th>UDP</th></tr></thead><tbody><tr><td>è¿æ¥</td><td>é¢å‘è¿æ¥</td><td>æ— è¿æ¥</td></tr><tr><td>å¯é æ€§</td><td>å¯é ä¼ è¾“ï¼Œä½¿ç”¨æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶</td><td>ä¸å¯é ä¼ è¾“ï¼Œä¸ä½¿ç”¨æ‹¥å¡æ§åˆ¶</td></tr><tr><td>è¿æ¥å¯¹è±¡ä¸ªæ•°</td><td>ä¸€å¯¹ä¸€</td><td>ä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹å¤š</td></tr><tr><td>ä¼ è¾“æ–¹å¼</td><td>é¢å‘å­—èŠ‚æµ</td><td>é¢å‘æŠ¥æ–‡</td></tr><tr><td>é¦–éƒ¨å¼€é”€</td><td>20å­—èŠ‚~60å­—èŠ‚</td><td>8å­—èŠ‚</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>éœ€è¦å¯é ä¼ è¾“çš„åœºæ™¯ï¼Œä¾‹å¦‚æ–‡ä»¶ä¼ è¾“</td><td>ä¼ è¾“é€Ÿåº¦ã€å®æ—¶æ€§è¦æ±‚é«˜çš„åœºæ™¯</td></tr></tbody></table></div><p>TCPåè®®å·¥ä½œæµç¨‹ï¼š</p><ol><li>å»ºç«‹è¿æ¥ï¼šä¸‰æ¬¡æ¡æ‰‹<ol><li>å‘èµ·æ–¹å‘æ¥æ”¶æ–¹å‘é€SYNæŠ¥æ–‡ï¼Œè¯·æ±‚å»ºç«‹è¿æ¥</li><li>æ¥æ”¶æ–¹æ”¶åˆ°SYNæŠ¥æ–‡åï¼Œå›å¤SYN+ACKæŠ¥æ–‡ï¼Œè¡¨ç¤ºåŒæ„å»ºç«‹è¿æ¥</li><li>å‘èµ·æ–¹æ”¶åˆ°SYN+ACKæŠ¥æ–‡åï¼Œå›å¤ACKæŠ¥æ–‡ï¼Œè¡¨ç¤ºè¿æ¥å»ºç«‹æˆåŠŸ</li><li>ä¸‰æ¬¡æ¡æ‰‹å®Œæˆï¼Œè¿æ¥å»ºç«‹æˆåŠŸ</li></ol></li><li>æ•°æ®ä¼ è¾“ï¼šæ•°æ®ä¼ è¾“é˜¶æ®µ</li><li>æ–­å¼€è¿æ¥ï¼šå››æ¬¡æŒ¥æ‰‹<ol><li>å‘èµ·æ–¹å‘æ¥æ”¶æ–¹å‘é€FINæŠ¥æ–‡ï¼Œè¯·æ±‚æ–­å¼€è¿æ¥</li><li>æ¥æ”¶æ–¹æ”¶åˆ°FINæŠ¥æ–‡åï¼Œå›å¤ACKæŠ¥æ–‡ï¼Œè¡¨ç¤ºæ”¶åˆ°æ–­å¼€è¯·æ±‚</li><li>æ¥æ”¶æ–¹å‘å‘èµ·æ–¹å‘é€FINæŠ¥æ–‡ï¼Œè¯·æ±‚æ–­å¼€è¿æ¥</li><li>å‘èµ·æ–¹æ”¶åˆ°FINæŠ¥æ–‡åï¼Œå›å¤ACKæŠ¥æ–‡ï¼Œè¡¨ç¤ºæ”¶åˆ°æ–­å¼€è¯·æ±‚</li><li>å››æ¬¡æŒ¥æ‰‹å®Œæˆï¼Œè¿æ¥æ–­å¼€æˆåŠŸ</li></ol></li></ol><ul><li>è°æƒ³å»ºç«‹æˆ–æ–­å¼€è¿æ¥ï¼Œè°å°±æ˜¯å‘èµ·æ–¹ã€‚å‘èµ·æ–¹å¯ä»¥æ˜¯å®¢æˆ·ç«¯ï¼Œä¹Ÿå¯ä»¥æ˜¯æœåŠ¡å™¨ç«¯ï¼Œ</li></ul><h3 id="11-2-TCPåè®®åˆ†æ"><a href="#11-2-TCPåè®®åˆ†æ" class="headerlink" title="11.2 TCPåè®®åˆ†æ"></a>11.2 TCPåè®®åˆ†æ</h3><p>ä»¥è®¿é—®10.21.11.21ä¸ºä¾‹ï¼Œåˆ†æTCPåè®®çš„å·¥ä½œæµç¨‹ã€‚</p><ol><li>æ‰“å¼€Wiresharkï¼Œåœ¨æ•è·é€‰é¡¹ä¸­è®¾ç½®è¿‡æ»¤å™¨ä¸ºâ€œhttp and ip.addr==10.21.11.21â€ã€‚</li><li>å¼€å§‹æŠ“å–æ•°æ®ã€‚</li><li>æ‰“å¼€æµè§ˆå™¨ï¼Œåœ¨åœ°å€æ ä¸­è¾“å…¥â€œ10.21.11.21â€ï¼Œå›è½¦è®¿é—®ï¼Œç­‰å¾…åŠ è½½å®Œæˆåå…³é—­æµè§ˆå™¨ã€‚</li><li>ç»“æŸæŠ“å–æ•°æ®ã€‚</li><li>é€‰ä¸­ä¸€æ¡è®¿é—®10.21.11.21çš„HTTPè®°å½•ï¼Œå³é”®ï¼Œè¿½è¸ªTPCæµã€‚</li><li>è§‚å¯ŸTPCæµæ˜¯å¦åŒ…å«å®Œæ•´çš„TPCè®¿é—®è¿‡ç¨‹ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼Œå››æ¬¡æŒ¥æ‰‹ï¼‰ã€‚</li></ol><p>TCPæ•°æ®åŒ…ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><p><img src="https://source.cclmsy.cc/Images/Posts/Computer_Networks_and_Communications(Lab" alt="TCPæ•°æ®åŒ…">/11_1.png)</p><h4 id="TCPæŠ¥æ–‡æ ¼å¼"><a href="#TCPæŠ¥æ–‡æ ¼å¼" class="headerlink" title="TCPæŠ¥æ–‡æ ¼å¼"></a>TCPæŠ¥æ–‡æ ¼å¼</h4><div class="table-container"><table><thead><tr><th>å­—æ®µ</th><th>é•¿åº¦(bit)</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Source Port</td><td>16</td><td>æºç«¯å£å·</td></tr><tr><td>Destination Port</td><td>16</td><td>ç›®çš„ç«¯å£å·</td></tr><tr><td>Sequence Number</td><td>32</td><td>æœ¬æŠ¥æ–‡æ®µå‘é€çš„æ•°æ®ç»„çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·</td></tr><tr><td>ACK Number</td><td>32</td><td>ç¡®è®¤å·ï¼ŒæœŸæœ›æ”¶åˆ°å¯¹æ–¹ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·ï¼Œè¡¨æ˜è¯¥åºå·ä¹‹å‰çš„æ‰€æœ‰æ•°æ®å·²ç»æ­£ç¡®æ— è¯¯çš„æ”¶åˆ°</td></tr><tr><td>Header Length</td><td>4</td><td>æŠ¥æ–‡å¤´é•¿åº¦ï¼ŒæŒ‡ç¤ºTCPå¤´éƒ¨çš„é•¿åº¦ï¼Œå³æ•°æ®åŒºåœ¨æŠ¥æ–‡æ®µä¸­çš„èµ·å§‹åç§»å€¼ï¼ˆå­—èŠ‚ï¼‰ã€‚åç§»å€¼=4*Header Length</td></tr><tr><td>Reserved</td><td>6</td><td>ä¿ç•™å­—æ®µï¼Œæœªä½¿ç”¨</td></tr><tr><td>Flags</td><td>6</td><td>æ ‡å¿—ä½ï¼ŒæŒ‰é¡ºåºä¸ºï¼šURGã€ACKã€PSHã€RSTã€SYNã€FIN</td></tr><tr><td>Window Size</td><td>16</td><td>çª—å£å¤§å°ï¼Œç”¨æ¥å‘ŠçŸ¥å‘é€ç«¯æ¥å—ç«¯çš„ç¼“å­˜å¤§å°ï¼Œä»¥æ­¤æ§åˆ¶å‘é€ç«¯å‘é€æ•°æ®çš„é€Ÿç‡ï¼Œä»è€Œè¾¾åˆ°æµé‡æ§åˆ¶</td></tr><tr><td>TCP Checksum</td><td>16</td><td>æ ¡éªŒå’Œï¼Œç”¨äºæ£€éªŒTCPå¤´éƒ¨å’Œæ•°æ®çš„å®Œæ•´æ€§</td></tr><tr><td>Urgent Pointer</td><td>16</td><td>ç´§æ€¥æŒ‡é’ˆï¼ŒTCP çš„ç´§æ€¥æ–¹å¼æ˜¯å‘é€ç«¯å‘å¦ä¸€ç«¯å‘é€ç´§æ€¥æ•°æ®çš„ä¸€ç§æ–¹å¼</td></tr><tr><td>Options</td><td>0-320</td><td>å¯é€‰å­—æ®µï¼Œç”¨äºæ‰©å±•TCPå¤´éƒ¨ã€‚æœ€å¸¸è§çš„å¯é€‰å­—æ®µæ˜¯æœ€é•¿æŠ¥æ–‡å¤§å°ï¼Œåˆç§°ä¸ºMSSï¼ˆMaximum Segment Sizeï¼‰ï¼ˆåœ¨ç¬¬ä¸€ä¸ªTCPæŠ¥æ–‡ï¼‰ã€‚é€‰é¡¹é•¿åº¦ä¸ä¸€å®šæ˜¯32ä½çš„æ•´æ•°å€ï¼Œæ‰€ä»¥è¦åŠ å¡«å……ä½</td></tr></tbody></table></div><h4 id="TCPä¸‰æ¬¡æ¡æ‰‹"><a href="#TCPä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="TCPä¸‰æ¬¡æ¡æ‰‹"></a>TCPä¸‰æ¬¡æ¡æ‰‹</h4><div class="table-container"><table><thead><tr><th>å­—æ®µ</th><th>ç¬¬ä¸€æ¬¡æ¡æ‰‹[SYN]</th><th>ç¬¬äºŒæ¬¡æ¡æ‰‹[SYN, ACK]</th><th>ç¬¬ä¸‰æ¬¡æ¡æ‰‹[ACK]</th></tr></thead><tbody><tr><td>Source Port</td><td>0xcf75(53109)</td><td>0x0050(80)</td><td>0xcf75(53109)</td></tr><tr><td>Destination Port</td><td>0x0050(80)</td><td>0xcf75(53109)</td><td>0x0050(80)</td></tr><tr><td>Sequence Number</td><td>0xc01d24d3(0)</td><td>0xabbe9051(0)</td><td>0xc01d24d4(1)</td></tr><tr><td>ACK Number</td><td>0x00000000(0)</td><td>0xc01d24d4(1)</td><td>0xabbe9052(1)</td></tr><tr><td>Header Length</td><td>0x8(32)</td><td>0x8(32)</td><td>0x5(20)</td></tr><tr><td>Reserved</td><td>0x00</td><td>0x00</td><td>0x00</td></tr><tr><td>Flags</td><td>0x002(SYN)</td><td>0x012(SYN, ACK)</td><td>0x010(ACK)</td></tr><tr><td>Window Size</td><td>0xfaf0(64240)</td><td>0x4000(16384)</td><td>0x0201(513)</td></tr></tbody></table></div><h4 id="TCPå››æ¬¡æŒ¥æ‰‹"><a href="#TCPå››æ¬¡æŒ¥æ‰‹" class="headerlink" title="TCPå››æ¬¡æŒ¥æ‰‹"></a>TCPå››æ¬¡æŒ¥æ‰‹</h4><div class="table-container"><table><thead><tr><th>å­—æ®µ</th><th>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹[FIN, ACK]</th><th>ç¬¬äºŒæ¬¡æŒ¥æ‰‹[ACK]</th><th>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹[FIN, ACK]</th><th>ç¬¬å››æ¬¡æŒ¥æ‰‹[ACK]</th></tr></thead><tbody><tr><td>Source Port</td><td>0x0050(80)</td><td>0xcf75(53109)</td><td>0x0050(80)</td><td>0xcf75(53109)</td></tr><tr><td>Destination Port</td><td>0xcf75(53109)</td><td>0x0050(80)</td><td>0xcf75(53109)</td><td>0x0050(80)</td></tr><tr><td>Sequence Number</td><td>0xabbe9194(323)</td><td>0xc01d26e6(531)</td><td>0xc01d26e6(531)</td><td>0xabbe9195(324)</td></tr><tr><td>ACK Number</td><td>0xc01d26e6(531)</td><td>0xabbe9195(324)</td><td>0xabbe9195(324)</td><td>0xc01d26e7(532)</td></tr><tr><td>Header Length</td><td>0x5(20)</td><td>0x5(20)</td><td>0x5(20)</td><td>0x5(20)</td></tr><tr><td>Reserved</td><td>0x00</td><td>0x00</td><td>0x00</td><td>0x00</td></tr><tr><td>Flags</td><td>0x011(FIN, ACK)</td><td>0x010(ACK)</td><td>0x011(FIN, ACK)</td><td>0x010(ACK)</td></tr><tr><td>Window Size</td><td>0xfeed(65005)</td><td>0x0200(513)</td><td>0x0200(513)</td><td>0xfeed(65005)</td></tr></tbody></table></div><div STYLE="page-break-after: always;"></div><h2 id="é™„å½•-å®éªŒæ¶‰åŠå‘½ä»¤è¡Œæ±‡æ€»"><a href="#é™„å½•-å®éªŒæ¶‰åŠå‘½ä»¤è¡Œæ±‡æ€»" class="headerlink" title="é™„å½•. å®éªŒæ¶‰åŠå‘½ä»¤è¡Œæ±‡æ€»"></a>é™„å½•. å®éªŒæ¶‰åŠå‘½ä»¤è¡Œæ±‡æ€»</h2><h3 id="1-PCæœº-ç»ˆç«¯"><a href="#1-PCæœº-ç»ˆç«¯" class="headerlink" title="1. PCæœº ç»ˆç«¯"></a>1. PCæœº ç»ˆç«¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ipconfig /all # æŸ¥çœ‹IPé…ç½®</span><br><span class="line">ping &lt;IPåœ°å€&gt; # æµ‹è¯•è¿é€šæ€§</span><br></pre></td></tr></table></figure><h3 id="2-äº¤æ¢æœºSwitch-å‘½ä»¤è¡Œ"><a href="#2-äº¤æ¢æœºSwitch-å‘½ä»¤è¡Œ" class="headerlink" title="2. äº¤æ¢æœºSwitch å‘½ä»¤è¡Œ"></a>2. äº¤æ¢æœºSwitch å‘½ä»¤è¡Œ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Switch&gt;enable # è¿›å…¥ç‰¹æƒæ¨¡å¼</span><br><span class="line">Switch#configure terminal # è¿›å…¥å…¨å±€é…ç½®æ¨¡å¼</span><br><span class="line">Switch(config)#hostname Switch # è®¾ç½®äº¤æ¢æœºä¸»æœºå</span><br><span class="line">Switch(config)#exit # é€€å›ä¸Šä¸€çº§æ¨¡å¼</span><br><span class="line">Switch(config)#end # é€€å›ç‰¹æƒæ¨¡å¼</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤º</span><br><span class="line">Switch#show vlan brief # æ˜¾ç¤ºVLANä¿¡æ¯</span><br><span class="line">Switch#show interfaces # æ˜¾ç¤ºæ¥å£ä¿¡æ¯</span><br><span class="line">Switch#show interfaces trunk # æ˜¾ç¤ºtrunkæ¥å£ä¿¡æ¯</span><br><span class="line"></span><br><span class="line"># VLAN</span><br><span class="line">Switch(config)#vlan &lt;VLANå·&gt; # åˆ›å»ºVLANå¹¶è¿›å…¥VLANé…ç½®æ¨¡å¼</span><br><span class="line">Switch(config)#interface vlan &lt;VLANå·&gt; # è¿›å…¥VLANé…ç½®æ¨¡å¼</span><br><span class="line"></span><br><span class="line"># æ¥å£</span><br><span class="line">Switch(config)#interface &lt;æ¥å£å·&gt; # è¿›å…¥æ¥å£é…ç½®æ¨¡å¼</span><br><span class="line">Switch(config)#interface &lt;æ¥å£å·&gt;-&lt;æ¥å£å·&gt; # è¿›å…¥æ¥å£èŒƒå›´é…ç½®æ¨¡å¼</span><br><span class="line">Switch(config-if)#switchport mode access # è®¾ç½®æ¥å£ä¸ºaccess</span><br><span class="line">Switch(config-if)#switchport access vlan &lt;VLANå·&gt; # è®¾ç½®accessæ¥å£æ‰€å±VLAN</span><br><span class="line">Switch(config-if)#switchport mode trunk # è®¾ç½®æ¥å£ä¸ºtrunk</span><br><span class="line"></span><br><span class="line"># MACåœ°å€ç»‘å®š</span><br><span class="line">Switch#show mac-address-table # æŸ¥çœ‹MACåœ°å€è¡¨</span><br><span class="line">Switch#show mac-address-table aging-time # æŸ¥çœ‹MACåœ°å€è¡¨è€åŒ–æ—¶é—´</span><br><span class="line">Switch(config-if)#mac-address-table static &lt;MACåœ°å€&gt; vlan &lt;VLANå·&gt; interface &lt;æ¥å£å·&gt; # è®¾ç½®é™æ€MACåœ°å€ç»‘å®š</span><br><span class="line">Switch(config-if)#no mac-address-table static &lt;MACåœ°å€&gt; vlan &lt;VLANå·&gt; interface &lt;æ¥å£å·&gt; # åˆ é™¤é™æ€MACåœ°å€ç»‘å®š</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-è·¯ç”±å™¨Router-å‘½ä»¤è¡Œ"><a href="#3-è·¯ç”±å™¨Router-å‘½ä»¤è¡Œ" class="headerlink" title="3. è·¯ç”±å™¨Router å‘½ä»¤è¡Œ"></a>3. è·¯ç”±å™¨Router å‘½ä»¤è¡Œ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Router&gt;enable # è¿›å…¥ç‰¹æƒæ¨¡å¼</span><br><span class="line">Router#configure terminal # è¿›å…¥å…¨å±€é…ç½®æ¨¡å¼</span><br><span class="line">Router(config)#hostname Router # è®¾ç½®è·¯ç”±å™¨ä¸»æœºå</span><br><span class="line">Router(config)#exit # é€€å›ä¸Šä¸€çº§æ¨¡å¼</span><br><span class="line">Router(config)#end # é€€å›ç‰¹æƒæ¨¡å¼</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤º</span><br><span class="line">Router#show ip route # æ˜¾ç¤ºè·¯ç”±è¡¨</span><br><span class="line">Router#show ip interface brief # æ˜¾ç¤ºæ¥å£IPä¿¡æ¯</span><br><span class="line">Router#show ip interface &lt;æ¥å£å·&gt; # æ˜¾ç¤ºæŒ‡å®šæ¥å£ä¿¡æ¯</span><br><span class="line">Router#show ip nat translations # æ˜¾ç¤ºNATè½¬æ¢è¡¨</span><br><span class="line"></span><br><span class="line"># æ¥å£</span><br><span class="line">Router(config)#interface &lt;æ¥å£å·&gt; # è¿›å…¥æ¥å£é…ç½®æ¨¡å¼</span><br><span class="line">Router(config-if)#no shutdown # æ¿€æ´»æ¥å£</span><br><span class="line">Router(config-if)#ip address &lt;IPåœ°å€&gt; &lt;å­ç½‘æ©ç &gt; # è®¾ç½®æ¥å£IPåœ°å€</span><br><span class="line"></span><br><span class="line"># VLAN</span><br><span class="line">Router(config)#interface &lt;æ¥å£å·&gt;.&lt;å­æ¥å£å·&gt; # è¿›å…¥å­æ¥å£é…ç½®æ¨¡å¼ï¼ˆæ¥å£éœ€æ¿€æ´»ï¼‰</span><br><span class="line">Router(config-subif)#encapsulation dot1Q &lt;VLANå·&gt; # å°è£…VLANåè®®ï¼ˆ802.1Qï¼‰ï¼Œè®¾ç½®å­æ¥å£æ‰€å±VLAN</span><br><span class="line">Router(config-subif)#ip address &lt;IPåœ°å€&gt; &lt;å­ç½‘æ©ç &gt; # è®¾ç½®å­æ¥å£IPåœ°å€</span><br><span class="line"></span><br><span class="line"># è·¯ç”±</span><br><span class="line">Router(config)#ip route &lt;ç›®çš„ç½‘ç»œ&gt; &lt;å­ç½‘æ©ç &gt; &lt;ä¸‹ä¸€è·³åœ°å€&gt; # è®¾ç½®é™æ€è·¯ç”±</span><br><span class="line"></span><br><span class="line">Router(config)#router rip # è¿›å…¥RIPåè®®é…ç½®æ¨¡å¼</span><br><span class="line">Router(config-router)#version &lt;ç‰ˆæœ¬å·&gt; # è®¾ç½®RIPç‰ˆæœ¬</span><br><span class="line">Router(config-router)#network &lt;ç½‘ç»œåœ°å€&gt; # è®¾ç½®RIPåè®®çš„ç½‘ç»œåœ°å€</span><br><span class="line"></span><br><span class="line"># NAT</span><br><span class="line">Router(config)#ip nat inside source static tcp &lt;å†…ç½‘IPåœ°å€&gt; &lt;å†…ç½‘ç«¯å£&gt; &lt;å¤–ç½‘IPåœ°å€&gt; &lt;å¤–ç½‘ç«¯å£&gt; # è®¾ç½®é™æ€NAT</span><br><span class="line"></span><br><span class="line">Router(config)#access-list &lt;è®¿é—®æ§åˆ¶åˆ—è¡¨å·&gt; permit any # åˆ›å»ºè®¿é—®æ§åˆ¶åˆ—è¡¨</span><br><span class="line">Router(config)#ip nat pool &lt;IPåœ°å€æ± åç§°&gt; &lt;èµ·å§‹åœ°å€&gt; &lt;ç»“æŸåœ°å€&gt; netmask &lt;å­ç½‘æ©ç &gt; # åˆ›å»ºIPåœ°å€æ± </span><br><span class="line">Router(config)#ip nat inside source list &lt;è®¿é—®æ§åˆ¶åˆ—è¡¨å·&gt; pool &lt;IPåœ°å€æ± åç§°&gt; # è®¾ç½®åŠ¨æ€NAT</span><br><span class="line">Router(config)#ip nat inside source list &lt;è®¿é—®æ§åˆ¶åˆ—è¡¨å·&gt; pool &lt;IPåœ°å€æ± åç§°&gt; overload # è®¾ç½®NAPT</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">äº¤æ¢æœºä¸è·¯ç”±å™¨çš„çˆ±æ¨æƒ…ä»‡ï¼ˆï¼Ÿ</summary>
    
    
    
    <category term="è¯¾ç¨‹ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="è¯¾ç¨‹ç¬”è®°" scheme="https://www.cclmsy.cc/tags/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£|2024æš‘æœŸæ­ç”µå¤šæ ¡10</title>
    <link href="https://www.cclmsy.cc/posts/ACM_2024Summer_HDU10.html"/>
    <id>https://www.cclmsy.cc/posts/ACM_2024Summer_HDU10.html</id>
    <published>2024-08-17T16:00:00.000Z</published>
    <updated>2025-03-09T02:54:24.916Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯”èµ›é¢˜å•ï¼š<a href="https://acm.hdu.edu.cn/search.php?field=problem&amp;key=2024%A1%B0%B6%A4%B0%D2%B1%E0%B3%CC%A1%B1%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%CB%E3%B7%A8%C9%E8%BC%C6%B3%AC%BC%B6%C1%AA%C8%FC%A3%A810%A3%A9&amp;source=1&amp;searchmode=source">2024â€œé’‰è€™ç¼–ç¨‹â€ä¸­å›½å¤§å­¦ç”Ÿç®—æ³•è®¾è®¡è¶…çº§è”èµ›ï¼ˆ10ï¼‰</a></p><h1 id="1008-HDU7548-SunBian"><a href="#1008-HDU7548-SunBian" class="headerlink" title="(1008)HDU7548.SunBian"></a>(1008)HDU7548.SunBian</h1><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>æœ‰æ’æˆç¯å½¢çš„ $n$ ä¸ªæ¨ªç€çš„ç¬‹ï¼ŒAlice å’Œ Bob è½®æµæ‰§è¡Œå¦‚ä¸‹æ“ä½œï¼ŒAlice å…ˆæ‰‹ï¼š</p><ul><li>é€‰æ‹© [1,k] ä¸ªè¿ç»­çš„æ¨ªç€çš„ç¬‹ï¼ŒæŠŠå®ƒä»¬å˜æˆç«–ç€çš„</li></ul><p>ä¸èƒ½æ“ä½œè€…è¾“ã€‚</p><p>ç»™å®š $n,k$ ï¼Œæ±‚è°ä¼šèµ¢ã€‚</p><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><ul><li>å½“ $k=1$ æ—¶ï¼Œæ ¹æ®å¥‡å¶æ€§åˆ¤æ–­èµ¢å®¶</li><li>å½“ $k\ge n$ æ—¶ï¼Œå…ˆæ‰‹ç›´æ¥å°†ç¬‹å…¨éƒ¨ç«–ç½®ï¼Œå¿…èƒœ</li><li>å…¶ä½™æƒ…å†µä¸‹ï¼Œåæ‰‹æ¯æ¬¡éƒ½å¯ä»¥å°½å¯èƒ½ä¿è¯å‰©ä½™åŒºåŸŸæ•°ä¸ºå¶æ•°ï¼Œæœ€ç»ˆå¿…èƒœ</li></ul><h2 id="å‚è€ƒä»£ç "><a href="#å‚è€ƒä»£ç " class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n,k;cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    <span class="keyword">if</span>(n&lt;=k) cout &lt;&lt; <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(k==<span class="number">1</span>) cout &lt;&lt; (n%<span class="number">2</span>?<span class="string">&#x27;A&#x27;</span>:<span class="string">&#x27;B&#x27;</span>);</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="1009-HDU7549-ä¸åŸºæœ¬å­ä¸²ç»“æ„"><a href="#1009-HDU7549-ä¸åŸºæœ¬å­ä¸²ç»“æ„" class="headerlink" title="(1009)HDU7549.ä¸åŸºæœ¬å­ä¸²ç»“æ„"></a>(1009)HDU7549.ä¸åŸºæœ¬å­ä¸²ç»“æ„</h1><h2 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®š2ä¸ªå­—ç¬¦ä¸² $a,b$ ï¼Œæ‰¾åˆ°ä¸€ä¸ªæœ€å°é•¿åº¦çš„å­—ç¬¦ä¸² $c$ ï¼Œä½¿å¾— $a$ å’Œ $b$ åœ¨ $c$ ä¸­å‡ºç°çš„æ¬¡æ•°ç›¸ç­‰ä¸”ä¸ä¸º0ï¼Œè¾“å‡ºæœ€å°é•¿åº¦ã€‚</p><h2 id="è§£é¢˜æ€è·¯-1"><a href="#è§£é¢˜æ€è·¯-1" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>åˆ†ç±»è®¨è®ºï¼Œä¸å¦¨å‡è®¾ $len(a)\le len(b)$</p><ul><li>è‹¥ $a$ åœ¨ $b$ ä¸­å‡ºç°çš„æ¬¡æ•°å¤§äº $1$ ï¼Œåˆ™ä¸å­˜åœ¨æ»¡è¶³æ¡ä»¶çš„ $c$</li><li>è‹¥ $a$ åœ¨ $b$ ä¸­å‡ºç°çš„æ¬¡æ•°ä¸º $1$ ï¼Œåˆ™ $c=b$ ï¼Œè¾“å‡º $len(b)$</li><li>è‹¥ $a$ åœ¨ $b$ ä¸­æ²¡æœ‰å‡ºç°ï¼š<ul><li>è®° $l_1$ ä¸º æœ€å¤§æ»¡è¶³ $a[0:l]=b[len(b)-l:len(b)]$ çš„ $l$</li><li>è®° $l_2$ ä¸º æœ€å¤§æ»¡è¶³ $a[len(a)-l:len(a)]=b[0:l]$ çš„ $l$</li><li>ç­”æ¡ˆä¸º $len(a)+len(b)-max(l_1,l_2)$</li></ul></li></ul><p>å¯ä»¥ç”¨å­—ç¬¦ä¸²å“ˆå¸Œè¿›è¡Œæ£€æŸ¥å’Œè®¡æ•°ã€‚</p><h2 id="å‚è€ƒä»£ç -1"><a href="#å‚è€ƒä»£ç -1" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string s1,s2;</span><br><span class="line">    cin &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">    <span class="keyword">if</span>(s1.<span class="built_in">length</span>()&lt;s2.<span class="built_in">length</span>()) <span class="built_in">swap</span>(s1,s2);</span><br><span class="line">    <span class="function">strHash <span class="title">h1</span><span class="params">(s1)</span>,<span class="title">h2</span><span class="params">(s2)</span></span>;</span><br><span class="line">    ll n=s1.<span class="built_in">length</span>(),m=s2.<span class="built_in">length</span>();</span><br><span class="line">    ll cnt=h1.<span class="built_in">count</span>(h2);</span><br><span class="line">    <span class="keyword">if</span>(cnt&gt;<span class="number">1</span>)&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;-1&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(cnt==<span class="number">1</span>)&#123;</span><br><span class="line">        cout &lt;&lt; n &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans=m+n;</span><br><span class="line">    <span class="built_in">FORLL_rev</span>(len,m<span class="number">-1</span>,<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(h1.<span class="built_in">findz</span>(n-len+<span class="number">1</span>,n)==h2.<span class="built_in">findz</span>(<span class="number">1</span>,len))&#123;</span><br><span class="line">            <span class="built_in">chmin</span>(ans,n+m-len);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">FORLL_rev</span>(len,m<span class="number">-1</span>,<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(h1.<span class="built_in">findf</span>(<span class="number">1</span>,len)==h2.<span class="built_in">findf</span>(m-len+<span class="number">1</span>,m))&#123;</span><br><span class="line">            <span class="built_in">chmin</span>(ans,n+m-len);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ï¼ˆ1011ï¼‰HDU7551-NOI2024"><a href="#ï¼ˆ1011ï¼‰HDU7551-NOI2024" class="headerlink" title="ï¼ˆ1011ï¼‰HDU7551.NOI2024"></a>ï¼ˆ1011ï¼‰HDU7551.NOI2024</h1><h2 id="é¢˜æ„-2"><a href="#é¢˜æ„-2" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>$m$ åé€‰æ‰‹è¿›è¡Œ $n$ åœºæ¯”èµ›ï¼Œæ’åå®šä¹‰ä¸ºåˆ†æ•°ä¸¥æ ¼å¤§äºä½ çš„äººæ•°+1ã€‚<br>ç¬¬ $i$ åœºæ¯”èµ›çš„åˆ†æ•°ä¸Šé™ä¸º $b_i$ ï¼Œä½ çš„æ’åä¸º $a_i$ ã€‚<br>æœ€ç»ˆæŒ‰ç…§æ¯åœºæ¯”èµ›çš„æ€»åˆ†æ’åï¼Œå‰ $k$ åé€‰æ‰‹å°†è·å¾—é‡‘ç‰Œã€‚<br>é—®åœ¨ç»™å®šæ¡ä»¶ä¸‹ä¸ç®¡æ€ä¹ˆæ¯”èµ›ï¼Œæ˜¯å¦ä¸€å®šèƒ½è·å¾—é‡‘ç‰Œã€‚</p><h2 id="è§£é¢˜æ€è·¯-2"><a href="#è§£é¢˜æ€è·¯-2" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>ç”¨æœ€åæƒ…å†µè€ƒè™‘ï¼šä½ å§‹ç»ˆä¸º $0$ åˆ†ï¼Œåœ¨ä½ å‰é¢çš„é€‰æ‰‹éƒ½æœ‰åˆ†æ•°ã€‚<br>æœ€ç»ˆæœ€åæ’åä¸º $\min(\sum_{i=1}^{n}a_i,m)$ ã€‚</p><h2 id="å‚è€ƒä»£ç -2"><a href="#å‚è€ƒä»£ç -2" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n,m,k;cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">    <span class="built_in">create_vec</span>(a,n);</span><br><span class="line">    <span class="built_in">create_vec</span>(b,n);</span><br><span class="line">    ll cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">0</span>,n<span class="number">-1</span>) cnt+=<span class="built_in">max</span>(<span class="number">0ll</span>,a[i]<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">chmin</span>(cnt,m<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">if</span>(cnt&gt;=k) cout &lt;&lt; <span class="string">&quot;NO&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;YES&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">é¢˜è§£|2024æš‘æœŸæ­ç”µå¤šæ ¡10</summary>
    
    
    
    <category term="ç«èµ›ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E7%AB%9E%E8%B5%9B%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="2024æš‘æœŸæ­ç”µå¤šæ ¡" scheme="https://www.cclmsy.cc/tags/2024%E6%9A%91%E6%9C%9F%E6%9D%AD%E7%94%B5%E5%A4%9A%E6%A0%A1/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£|2024æš‘æœŸæ­ç”µå¤šæ ¡09</title>
    <link href="https://www.cclmsy.cc/posts/ACM_2024Summer_HDU09.html"/>
    <id>https://www.cclmsy.cc/posts/ACM_2024Summer_HDU09.html</id>
    <published>2024-08-15T16:00:00.000Z</published>
    <updated>2025-03-09T02:54:24.906Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯”èµ›é¢˜å•ï¼š<a href="https://acm.hdu.edu.cn/search.php?field=problem&amp;key=2024%A1%B0%B6%A4%B0%D2%B1%E0%B3%CC%A1%B1%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%CB%E3%B7%A8%C9%E8%BC%C6%B3%AC%BC%B6%C1%AA%C8%FC%A3%A89%A3%A9&amp;source=1&amp;searchmode=source">2024â€œé’‰è€™ç¼–ç¨‹â€ä¸­å›½å¤§å­¦ç”Ÿç®—æ³•è®¾è®¡è¶…çº§è”èµ›ï¼ˆ9ï¼‰</a></p><h1 id="1005-HDU7533-æ€ªç‰©çŒäºº"><a href="#1005-HDU7533-æ€ªç‰©çŒäºº" class="headerlink" title="(1005)HDU7533.æ€ªç‰©çŒäºº"></a>(1005)HDU7533.æ€ªç‰©çŒäºº</h1><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>æ”»å‡»ç”Ÿå‘½å€¼ä¸º $k$ çš„æ€ªç‰©ï¼Œæ¯å›åˆå¯é€‰æ‹©é€ æˆ $x$ æˆ– $y$ ç‚¹ä¼¤å®³ã€‚<br>åˆ†åˆ«å›ç­”æ˜¯å¦æœ‰ä¸€ç§æ”»å‡»åºåˆ—ï¼Œå¯ä»¥æ°å¥½åœ¨ç¬¬å¥‡æ•°å›åˆ/ç¬¬å¶æ•°å›åˆå‡»æ€æ€ªç‰©ã€‚</p><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>æœ€è¾¹ç¼˜çš„æƒ…å†µå³ä¸ºå…¨ç”¨ $x$ å’Œ å…¨ç”¨ $y$ ï¼Œåˆ†åˆ«éœ€è¦ $\lceil \frac{k}{x}\rceil$ å’Œ $\lceil \frac{k}{y}\rceil$ å›åˆã€‚</p><p>è¿™ä¸¤ä¸ªå›åˆæ•°ç›¸ç­‰ï¼Œåªæœ‰ä¸€ç§å¯èƒ½ï¼Œå¦åˆ™éƒ½å¯ä»¥ã€‚</p><h2 id="å‚è€ƒä»£ç "><a href="#å‚è€ƒä»£ç " class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n,a,b;cin &gt;&gt; n &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    ll ta,tb;</span><br><span class="line">    ta=(n+a<span class="number">-1</span>)/a;</span><br><span class="line">    tb=(n+b<span class="number">-1</span>)/b;</span><br><span class="line">    <span class="keyword">if</span>(ta==tb)&#123;</span><br><span class="line">        <span class="keyword">if</span>(ta%<span class="number">2</span>) cout &lt;&lt; <span class="string">&quot;Yes&quot;</span> &lt;&lt; endl &lt;&lt; <span class="string">&quot;No&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;No&quot;</span> &lt;&lt; endl &lt;&lt; <span class="string">&quot;Yes&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Yes&quot;</span> &lt;&lt; endl &lt;&lt; <span class="string">&quot;Yes&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="1007-HDU7535-å°çŒ«é’“é±¼"><a href="#1007-HDU7535-å°çŒ«é’“é±¼" class="headerlink" title="(1007)HDU7535.å°çŒ«é’“é±¼"></a>(1007)HDU7535.å°çŒ«é’“é±¼</h1><h2 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>æœ‰ $2n$ å¼ ç‰Œï¼Œç‚¹æ•° $1\sim n$ å„å‡ºç°2æ¬¡ã€‚<br>ä¸¤äººå„åˆ†åˆ° $n$ å¼ ç‰Œï¼Œå·²çŸ¥æ¯ä¸ªäººæ‰‹ä¸­ç‰Œçš„ç‚¹æ•°ã€‚<br>ä¸¤äººè½®æµæ”¾ç‰Œåˆ°ç‰Œå †é¡¶ï¼Œè‹¥ç‰Œå †ä¸­æ­¤å‰å·²ç»æœ‰ç›¸åŒç‚¹æ•°çš„ç‰Œï¼Œåˆ™å°†è¿™ä¸¤å¼ ç‰Œä»¥åŠä¸­é—´çš„æ‰€æœ‰ç‰Œæ‹¿å›æ‰‹ä¸­ã€‚<br>å…ˆæ‰“å®Œçš„äººè¾“ã€‚</p><h2 id="è§£é¢˜æ€è·¯-1"><a href="#è§£é¢˜æ€è·¯-1" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>ç§°æ‰‹ç‰Œä¸­æˆå¯¹çš„ç‰Œä¸ºåŒç‰Œï¼Œå•ç‹¬çš„ç‰Œä¸ºå•ç‰Œã€‚</p><p>å½“è‡ªå·±æ‰“å‡ºå•ç‰Œæ—¶ï¼Œå¯¹æ–¹å¿…å®šèƒ½æ‰“å‡ºä¸€æ ·çš„å•ç‰Œæ”¶å›ï¼Œä¸”å…ˆåæ‰‹ä¸å˜ï¼Œè¿™æ ·æ˜¯ä¸ä¼˜çš„ã€‚<br>å› æ­¤ï¼Œè´ªå¿ƒçš„æ‰“æ³•æ˜¯å…ˆæ‰‹æ‰“åŒç‰Œï¼Œåæ‰‹æ‰“åŒç‰Œï¼Œå…ˆæ‰‹æ‰“ä¸Šæ¬¡æ‰“çš„åŒç‰Œã€‚<br>è¿™æ ·çš„ç»“æœæ˜¯ï¼šåæ‰‹å¤±å»ä¸€ä¸ªåŒç‰Œï¼Œäº¤æ¢å…ˆåæ‰‹ã€‚</p><p>è§‚å¯Ÿåˆ°ä¸¤äººæ‰‹ç‰Œä¸­çš„åŒç‰Œçš„æ•°é‡ç›¸åŒï¼Œå› æ­¤æœ‰åŒç‰Œçš„æƒ…å†µä¸‹ï¼Œåæ‰‹å…ˆå¤±å»æ‰€æœ‰åŒç‰Œï¼Œå…ˆæ‰‹è·èƒœã€‚<br>å¦åˆ™ï¼Œåæ‰‹å¯ä»¥ç¨³å®šæ”¶å–å…ˆæ‰‹æ‰“å‡ºçš„ç‰Œï¼Œåæ‰‹è·èƒœã€‚</p><h2 id="å‚è€ƒä»£ç -1"><a href="#å‚è€ƒä»£ç -1" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n;cin &gt;&gt; n;</span><br><span class="line">    map&lt;ll,<span class="type">int</span>&gt; mp;</span><br><span class="line">    ll t;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">        cin &gt;&gt; t;</span><br><span class="line">        mp[t]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,n) cin &gt;&gt; t;</span><br><span class="line">    <span class="keyword">if</span>(mp.<span class="built_in">size</span>()&lt;n) cout &lt;&lt; <span class="string">&quot;shuishui&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;sha7dow&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">é¢˜è§£|2024æš‘æœŸæ­ç”µå¤šæ ¡09</summary>
    
    
    
    <category term="ç«èµ›ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E7%AB%9E%E8%B5%9B%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="2024æš‘æœŸæ­ç”µå¤šæ ¡" scheme="https://www.cclmsy.cc/tags/2024%E6%9A%91%E6%9C%9F%E6%9D%AD%E7%94%B5%E5%A4%9A%E6%A0%A1/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£|2024æš‘æœŸç‰›å®¢å¤šæ ¡10</title>
    <link href="https://www.cclmsy.cc/posts/ACM_2024Summer_NCD10.html"/>
    <id>https://www.cclmsy.cc/posts/ACM_2024Summer_NCD10.html</id>
    <published>2024-08-14T16:00:00.000Z</published>
    <updated>2025-03-09T02:54:24.906Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯”èµ›é“¾æ¥ï¼š<a href="https://ac.nowcoder.com/acm/contest/81605">2024ç‰›å®¢æš‘æœŸå¤šæ ¡è®­ç»ƒè¥10</a></p><h1 id="A-Surrender-to-My-Will"><a href="#A-Surrender-to-My-Will" class="headerlink" title="A.Surrender to My Will"></a>A.Surrender to My Will</h1><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $5$ çš„å­—ç¬¦ä¸²ï¼Œ<code>Y</code>ä»£è¡¨æŠ•é™ï¼Œ<code>N</code>ä»£è¡¨ä¸æŠ•é™ï¼Œ<code>-</code>ä»£è¡¨æœªæŠ•ç¥¨ã€‚<br>æŠ•é™äººæ•°ä¸å°äº4äººå³å¯æŠ•é™ã€‚<br>é—®å­—ç¬¦ä¸²è¡¨ç¤ºçš„æŠ•é™ç»“æœã€‚</p><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>è®¡æ•°åˆ¤æ–­</p><h2 id="å‚è€ƒä»£ç "><a href="#å‚è€ƒä»£ç " class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string s;cin &gt;&gt; s;</span><br><span class="line">    map&lt;<span class="type">char</span>,<span class="type">int</span>&gt; mp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> c:s) mp[c]++;</span><br><span class="line">    <span class="keyword">if</span>(mp[<span class="string">&#x27;Y&#x27;</span>]&gt;=<span class="number">4</span>) &#123;cout &lt;&lt; <span class="number">1</span> &lt;&lt; endl;<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="keyword">if</span>(mp[<span class="string">&#x27;N&#x27;</span>]&gt;=<span class="number">2</span>) &#123;cout &lt;&lt; <span class="number">-1</span> &lt;&lt; endl;<span class="keyword">return</span>;&#125;</span><br><span class="line">    cout &lt;&lt; <span class="number">0</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="B-std-pair"><a href="#B-std-pair" class="headerlink" title="B.std::pair"></a>B.std::pair</h1><h2 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>åŸºç¡€åˆæ³•ç±»å‹<code>int</code>å’Œ<code>double</code>ã€‚<br>å¯¹äºä»»æ„2ä¸ªåˆæ³•ç±»å‹<code>A</code>å’Œ<code>B</code>ï¼Œ<code>pair&lt;A,B&gt;</code>æ˜¯åˆæ³•çš„ï¼Œå¯ä»¥é€šè¿‡<code>.first</code>å’Œ<code>.second</code>åˆ†åˆ«è®¿é—®<code>A</code>å’Œ<code>B</code>æˆå‘˜ã€‚<br>å£°æ˜å˜é‡çš„æ ¼å¼ä¸º<code>pair&lt;A,B&gt; å˜é‡å;</code>ã€‚</p><p>ç»™å®š $n$ ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºå˜é‡å£°æ˜ï¼Œå˜é‡åä¸é‡å¤ã€‚<br>å†ç»™å®š $q$ ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºè®¿é—®å˜é‡ï¼Œè¿”å›è¢«æŸ¥è¯¢çš„æˆå‘˜ç±»å‹ã€‚</p><h2 id="è§£é¢˜æ€è·¯-1"><a href="#è§£é¢˜æ€è·¯-1" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>æ¨¡æ‹Ÿé¢˜ï¼Œå¯¹æ¯ä¸ªå˜é‡ç±»å‹æ„å»ºäºŒå‰æ ‘ï¼ŒæŸ¥è¯¢åœ¨äºŒå‰æ ‘ä¸Šè¿›è¡Œã€‚<br>å…·ä½“å®ç°æ–¹å¼å¯ä»¥å‚è€ƒä»£ç ã€‚</p><h2 id="å‚è€ƒä»£ç -1"><a href="#å‚è€ƒä»£ç -1" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">pll v[N]; <span class="comment">//pairçš„æ ‘ï¼Œxè¡¨ç¤ºå·¦å­æ ‘ï¼Œyè¡¨ç¤ºå³å­æ ‘</span></span><br><span class="line">map&lt;string,ll&gt; dict; <span class="comment">//å˜é‡äºŒå‰æ ‘çš„æ ¹æ‰€åœ¨ä¸‹æ ‡</span></span><br><span class="line">ll cnt=<span class="number">0</span>;</span><br><span class="line"><span class="function">pll <span class="title">parse_type</span><span class="params">(string s)</span></span>&#123; <span class="comment">//è§£æç±»å‹ï¼Œæ„å»ºæ ‘</span></span><br><span class="line">    <span class="keyword">if</span>(s==<span class="string">&quot;int&quot;</span>) <span class="keyword">return</span> &#123;<span class="number">-1</span>,<span class="number">-1</span>&#125;; <span class="comment">//int</span></span><br><span class="line">    <span class="keyword">if</span>(s==<span class="string">&quot;double&quot;</span>) <span class="keyword">return</span> &#123;<span class="number">-2</span>,<span class="number">-2</span>&#125;; <span class="comment">//double</span></span><br><span class="line">    s=s.<span class="built_in">substr</span>(<span class="number">5</span>,s.<span class="built_in">length</span>()<span class="number">-6</span>); </span><br><span class="line">    ll cntp=<span class="number">0</span>,cntd=<span class="number">0</span>,pos;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">0</span>,s.<span class="built_in">length</span>()<span class="number">-1</span>)&#123; <span class="comment">//æ‰¾åˆ°å½“å‰pairå¯¹åº”çš„é€—å·ä½ç½®pos</span></span><br><span class="line">        <span class="keyword">if</span>(s[i]==<span class="string">&#x27;p&#x27;</span>) cntp++;</span><br><span class="line">        <span class="keyword">if</span>(s[i]==<span class="string">&#x27;,&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(cntp==cntd) &#123;pos=i;<span class="keyword">break</span>;&#125; </span><br><span class="line">            cntd++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    string ltype=s.<span class="built_in">substr</span>(<span class="number">0</span>,pos),rtype=s.<span class="built_in">substr</span>(pos+<span class="number">1</span>,s.<span class="built_in">length</span>()-pos<span class="number">-1</span>);</span><br><span class="line">    ll lidx=cnt++,ridx=cnt++;</span><br><span class="line">    v[lidx]=<span class="built_in">parse_type</span>(ltype);</span><br><span class="line">    v[ridx]=<span class="built_in">parse_type</span>(rtype);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">make_pair</span>(lidx,ridx);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">string <span class="title">get_type</span><span class="params">(ll idx)</span></span>&#123; <span class="comment">//é‡ç»„ç±»å‹å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">if</span>(v[idx].x==<span class="number">-1</span>) <span class="keyword">return</span> <span class="string">&quot;int&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(v[idx].x==<span class="number">-2</span>) <span class="keyword">return</span> <span class="string">&quot;double&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;pair&lt;&quot;</span>+<span class="built_in">get_type</span>(v[idx].x)+<span class="string">&quot;,&quot;</span>+<span class="built_in">get_type</span>(v[idx].y)+<span class="string">&quot;&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n,q;cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">    string type,name;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">        cin &gt;&gt; type &gt;&gt; name;</span><br><span class="line">        name.<span class="built_in">pop_back</span>();</span><br><span class="line">        dict[name]=cnt++;</span><br><span class="line">        v[dict[name]]=<span class="built_in">parse_type</span>(type);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,q)&#123;</span><br><span class="line">        cin &gt;&gt; name;</span><br><span class="line">        ll j=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(j&lt;name.<span class="built_in">length</span>()&amp;&amp;name[j]!=<span class="string">&#x27;.&#x27;</span>) j++;</span><br><span class="line">        string main_name=name.<span class="built_in">substr</span>(<span class="number">0</span>,j); j++;</span><br><span class="line">        ll idx=dict[main_name];</span><br><span class="line">        <span class="keyword">while</span>(j&lt;name.<span class="built_in">length</span>())&#123;</span><br><span class="line">            <span class="keyword">if</span>(name[j]==<span class="string">&#x27;f&#x27;</span>)&#123; <span class="comment">//first</span></span><br><span class="line">                idx=v[idx].x;</span><br><span class="line">                j+=<span class="number">6</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(name[j]==<span class="string">&#x27;s&#x27;</span>)&#123; <span class="comment">//second</span></span><br><span class="line">                idx=v[idx].y;</span><br><span class="line">                j+=<span class="number">7</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">get_type</span>(idx) &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="F-Collinear-Exception"><a href="#F-Collinear-Exception" class="headerlink" title="F.Collinear Exception"></a>F.Collinear Exception</h1><h2 id="é¢˜æ„-2"><a href="#é¢˜æ„-2" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>æœ‰ä¸€ $n\times n$ çš„ç‚¹é˜µåˆ—ï¼Œæ¯ä¸ªç‚¹çš„åæ ‡ä¸º $(i,j)$ ï¼Œ$1\leq i,j\leq n$ ã€‚<br>æŒ‰ç»™å®šåºåˆ—å¯¹ç‚¹è¿›è¡Œæ ‡è®°ï¼Œè¦æ±‚æ ‡è®°åä¸èƒ½å­˜åœ¨ä¸‰ä¸ªè¢«æ ‡è®°ç‚¹å…±çº¿ï¼Œå¦åˆ™æ ‡è®°å¤±è´¥ã€‚<br>æŒ‰ç»™å®šåºåˆ—é¡ºåºè¾“å‡ºæ¯ä¸ªç‚¹æ˜¯å¦æ ‡è®°æˆåŠŸã€‚</p><h2 id="è§£é¢˜æ€è·¯-2"><a href="#è§£é¢˜æ€è·¯-2" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>æ¯å½“åŠ å…¥ä¸€ä¸ªæ–°çš„ç‚¹æ—¶ï¼Œå’Œå·²æœ‰çš„ç‚¹è¿çº¿ï¼Œæ ‡è®°çº¿ä¸Šçš„æ‰€æœ‰ç‚¹ã€‚<br>è¢«æ ‡è®°çš„ç‚¹ä¸èƒ½å†è¢«åŠ å…¥ã€‚</p><h2 id="å‚è€ƒä»£ç -2"><a href="#å‚è€ƒä»£ç -2" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n;cin &gt;&gt; n;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">vis</span>(n+<span class="number">1</span>,<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(n+<span class="number">1</span>,<span class="number">0</span>));</span><br><span class="line">    vector&lt;pll&gt; points;</span><br><span class="line">    ll ub=n*n,xx,yy,ans=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,ub)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; xx &gt;&gt; yy;</span><br><span class="line">        <span class="keyword">if</span>(vis[xx][yy])&#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span>[tx,ty]:points)&#123; <span class="comment">//æ ‡è®°çº¿ä¸Šçš„ç‚¹</span></span><br><span class="line">            <span class="keyword">if</span>(xx==tx)&#123;</span><br><span class="line">                <span class="built_in">FORLL</span>(j,<span class="number">1</span>,n) vis[xx][j]=<span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                ll dx=xx-tx,dy=yy-ty;</span><br><span class="line">                ll g=__gcd(dx,dy);</span><br><span class="line">                dx/=g;dy/=g;</span><br><span class="line">                ll ttx=tx,tty=ty;</span><br><span class="line">                <span class="keyword">while</span>(ttx&lt;=n&amp;&amp;ttx&gt;=<span class="number">1</span>&amp;&amp;tty&lt;=n&amp;&amp;tty&gt;=<span class="number">1</span>)&#123;</span><br><span class="line">                    vis[ttx][tty]=<span class="number">1</span>;</span><br><span class="line">                    ttx+=dx; tty+=dy;</span><br><span class="line">                &#125;</span><br><span class="line">                ttx=tx; tty=ty;</span><br><span class="line">                <span class="keyword">while</span>(ttx&lt;=n&amp;&amp;ttx&gt;=<span class="number">1</span>&amp;&amp;tty&lt;=n&amp;&amp;tty&gt;=<span class="number">1</span>)&#123;</span><br><span class="line">                    vis[ttx][tty]=<span class="number">1</span>;</span><br><span class="line">                    ttx-=dx; tty-=dy;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        points.<span class="built_in">emplace_back</span>(xx,yy);</span><br><span class="line">        vis[xx][yy]=<span class="number">1</span>;</span><br><span class="line">        cout &lt;&lt; <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">    &#125;cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="H-All-in-at-the-Pre-flop"><a href="#H-All-in-at-the-Pre-flop" class="headerlink" title="H.All-in at the Pre-flop"></a>H.All-in at the Pre-flop</h1><h2 id="é¢˜æ„-3"><a href="#é¢˜æ„-3" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ä¸¤åç©å®¶åˆå§‹åˆ†åˆ«æœ‰ $a,b$ çš„ç­¹ç ï¼Œæ¯è½®æ¸¸æˆå„æœ‰ $\frac{1}{2}$ çš„æ¦‚ç‡è·èƒœã€‚<br>å‡è®¾å½“å‰è½®ä¸¤åç©å®¶åˆ†åˆ«æœ‰ $x,y$ çš„ç­¹ç ï¼Œé‚£ä¹ˆè¾“å®¶éœ€è¦ä»˜ç»™èµ¢å®¶ $\min(x,y)$ çš„ç­¹ç ã€‚<br>é—®ä¸¤åç©å®¶è·èƒœçš„æ¦‚ç‡ã€‚</p><h2 id="è§£é¢˜æ€è·¯-3"><a href="#è§£é¢˜æ€è·¯-3" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>æ‰“ä¸ªè¡¨ï¼Œè§‚å¯Ÿåˆ°ç­”æ¡ˆæ˜¯ $\frac{a}{a+b},\frac{b}{a+b}$ ã€‚</p><h2 id="å‚è€ƒä»£ç -3"><a href="#å‚è€ƒä»£ç -3" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll a,b;cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    ll c=<span class="built_in">inv</span>(<span class="built_in">add</span>(a,b));</span><br><span class="line">    cout &lt;&lt; <span class="built_in">mul</span>(a,c) &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; <span class="built_in">mul</span>(b,c) &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">é¢˜è§£|2024æš‘æœŸç‰›å®¢å¤šæ ¡10</summary>
    
    
    
    <category term="ç«èµ›ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E7%AB%9E%E8%B5%9B%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="2024æš‘æœŸç‰›å®¢å¤šæ ¡" scheme="https://www.cclmsy.cc/tags/2024%E6%9A%91%E6%9C%9F%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£|2024æš‘æœŸç‰›å®¢å¤šæ ¡09</title>
    <link href="https://www.cclmsy.cc/posts/ACM_2024Summer_NCD09.html"/>
    <id>https://www.cclmsy.cc/posts/ACM_2024Summer_NCD09.html</id>
    <published>2024-08-12T16:00:00.000Z</published>
    <updated>2025-03-09T02:54:24.892Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯”èµ›é“¾æ¥ï¼š<a href="https://ac.nowcoder.com/acm/contest/81604">2024ç‰›å®¢æš‘æœŸå¤šæ ¡è®­ç»ƒè¥9</a></p><h1 id="A-Image-Scaling"><a href="#A-Image-Scaling" class="headerlink" title="A.Image Scaling"></a>A.Image Scaling</h1><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®šç”± <code>.</code> å’Œ <code>x</code> ç»„æˆçš„ $n\times m$ çš„ $n\times m$ çŸ©é˜µï¼Œ$x$ éƒ¨åˆ†æ˜¯ä¸€ä¸ªå­çŸ©é˜µã€‚<br>æå–å¹¶åœ¨é•¿å®½æ¯”ä¸å˜çš„æƒ…å†µä¸‹ï¼Œå°†å­çŸ©é˜µå°½å¯èƒ½ç¼©å°å¹¶è¾“å‡ºã€‚</p><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>æ¨¡æ‹Ÿï¼Œç¼©å°åˆ° $1/gcd$</p><h2 id="å‚è€ƒä»£ç "><a href="#å‚è€ƒä»£ç " class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n,m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    ll fl=<span class="number">0</span>,st=<span class="number">-1</span>;</span><br><span class="line">    ll nn=<span class="number">-1</span>,mm,idx;</span><br><span class="line">    string s;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">0</span>,n<span class="number">-1</span>)&#123;</span><br><span class="line">        cin &gt;&gt; s;</span><br><span class="line">        <span class="keyword">if</span>(fl) <span class="keyword">if</span>(s[idx]!=<span class="string">&#x27;x&#x27;</span>) &#123;nn=i-st;<span class="keyword">break</span>;&#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">FORLL</span>(j,<span class="number">0</span>,m<span class="number">-1</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(s[j]==<span class="string">&#x27;x&#x27;</span>)&#123;</span><br><span class="line">                    fl=<span class="number">1</span>; st=i; idx=j;</span><br><span class="line">                    ll t=j;</span><br><span class="line">                    <span class="keyword">while</span>(t&lt;m&amp;&amp;s[t]==<span class="string">&#x27;x&#x27;</span>) t++;</span><br><span class="line">                    mm=t-j;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(nn==<span class="number">-1</span>) nn=n-st;</span><br><span class="line">    ll g=__gcd(nn,mm);</span><br><span class="line">    nn/=g; mm/=g;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">0</span>,nn<span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="built_in">FORLL</span>(j,<span class="number">0</span>,mm<span class="number">-1</span>)&#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&#x27;x&#x27;</span>;</span><br><span class="line">        &#125;cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="K-Kill-The-Monsters"><a href="#K-Kill-The-Monsters" class="headerlink" title="K.Kill The Monsters"></a>K.Kill The Monsters</h1><h2 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>$n$ ä¸ªæ€ªå…½ï¼Œç¬¬ $i$ ä¸ªæ€ªå…½çš„ä½“åŠ›ä¸º $a_i$ ã€‚</p><p>æ¯æ¬¡å¯ä»¥è¿›è¡Œä¸€ç§æ“ä½œï¼š</p><ol><li>æ‰€æœ‰æ€ªå…½ä½“åŠ› $-1$</li><li>é€‰æ‹©ä¸€ä¸ªæ€ªå…½ $i$ ä½¿å¾— $a_i\leftarrow \lfloor \dfrac{a_i}{k} \rfloor$</li></ol><p>é—®æœ€å°‘å¤šå°‘æ¬¡æ“ä½œå¯ä»¥ä½¿æ‰€æœ‰æ€ªå…½çš„ä½“åŠ›éƒ½ä¸º $0$ ã€‚</p><h2 id="è§£é¢˜æ€è·¯-1"><a href="#è§£é¢˜æ€è·¯-1" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>è´ªå¿ƒçš„ï¼Œå…ˆè¿ç»­å¯¹æœ€å¤§ä½“åŠ›çš„æ€ªå…½è¿›è¡Œç¬¬äºŒç§æ“ä½œï¼Œå†è¿›è¡Œç¬¬ä¸€ç§æ“ä½œã€‚<br>ç”¨ä¼˜å…ˆé˜Ÿåˆ—ç»´æŠ¤æœ€å¤§ä½“åŠ›ã€‚<br>è®°å½“å‰å·²ç»æ“ä½œäº† $cnt$ æ¬¡ï¼Œç”¨ $a_{max}+cnt$ ç»´æŠ¤æœ€å°æ“ä½œæ¬¡æ•°ã€‚</p><h2 id="å‚è€ƒä»£ç -1"><a href="#å‚è€ƒä»£ç -1" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n,k,t;cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    priority_queue&lt;ll&gt; pq;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,n) &#123;cin &gt;&gt; t;pq.<span class="built_in">push</span>(t);&#125;</span><br><span class="line">    ll cur=<span class="number">0</span>,ans=pq.<span class="built_in">top</span>();</span><br><span class="line">    <span class="keyword">if</span>(k==<span class="number">1</span>) &#123;cout &lt;&lt; ans &lt;&lt; endl;<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="keyword">while</span>(pq.<span class="built_in">top</span>()&gt;<span class="number">1</span>)&#123;</span><br><span class="line">        t=pq.<span class="built_in">top</span>();pq.<span class="built_in">pop</span>();</span><br><span class="line">        t/=k; cur++;</span><br><span class="line">        pq.<span class="built_in">push</span>(t);</span><br><span class="line">        <span class="built_in">chmin</span>(ans,pq.<span class="built_in">top</span>()+cur);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans  &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">é¢˜è§£|2024æš‘æœŸç‰›å®¢å¤šæ ¡09</summary>
    
    
    
    <category term="ç«èµ›ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E7%AB%9E%E8%B5%9B%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="2024æš‘æœŸç‰›å®¢å¤šæ ¡" scheme="https://www.cclmsy.cc/tags/2024%E6%9A%91%E6%9C%9F%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£|2024æš‘æœŸæ­ç”µå¤šæ ¡08</title>
    <link href="https://www.cclmsy.cc/posts/ACM_2024Summer_HDU08.html"/>
    <id>https://www.cclmsy.cc/posts/ACM_2024Summer_HDU08.html</id>
    <published>2024-08-11T16:00:00.000Z</published>
    <updated>2025-03-09T02:54:24.916Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯”èµ›é¢˜å•ï¼š<a href="https://acm.hdu.edu.cn/search.php?field=problem&amp;key=2024%A1%B0%B6%A4%B0%D2%B1%E0%B3%CC%A1%B1%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%CB%E3%B7%A8%C9%E8%BC%C6%B3%AC%BC%B6%C1%AA%C8%FC%A3%A88%A3%A9&amp;source=1&amp;searchmode=source">2024â€œé’‰è€™ç¼–ç¨‹â€ä¸­å›½å¤§å­¦ç”Ÿç®—æ³•è®¾è®¡è¶…çº§è”èµ›ï¼ˆ8ï¼‰</a></p><h1 id="1004-HDU7520-cats-çš„é‡åŠ›æ‹¼å›¾"><a href="#1004-HDU7520-cats-çš„é‡åŠ›æ‹¼å›¾" class="headerlink" title="(1004)HDU7520.cats çš„é‡åŠ›æ‹¼å›¾"></a>(1004)HDU7520.cats çš„é‡åŠ›æ‹¼å›¾</h1><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>æœ‰ä¸€ä¸ª $n\times m$ çš„æ–¹æ ¼é˜µåˆ—ï¼Œç‰©å—åˆå§‹ä½äº $(x,y),1\le x\le n,1\le y\le m$ã€‚<br>æ¯æ¬¡æ“ä½œå¯ä»¥æ”¹å˜é‡åŠ›æ–¹å‘ï¼šå‘ä¸Šã€å‘ä¸‹ã€å‘å·¦ã€å‘å³ï¼Œç‰©å—ä¼šæ²¿é‡åŠ›æ–¹å‘ç§»åŠ¨ï¼Œç›´åˆ°ç¢°åˆ°è¾¹ç•Œã€‚<br>æ±‚ä»»æ„æ“ä½œä¸‹ç‰©å—æœ€å¤šç»è¿‡çš„æ ¼å­æ•°ã€‚</p><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>æœ‰2ç§æœ€è´ªå¿ƒçš„æ“ä½œåºåˆ—ï¼š</p><ol><li>å‘å·¦ã€å‘å³ã€å†æ²¿è¾¹ç¼˜ä¸€å‘¨</li><li>å‘ä¸Šã€å‘ä¸‹ã€å†æ²¿è¾¹ç¼˜ä¸€å‘¨</li></ol><p>ç‰¹åˆ¤ $n=1$ æˆ– $m=1$ æˆ–åˆå§‹åœ¨è¾¹ç¼˜çš„æƒ…å†µã€‚</p><h2 id="å‚è€ƒä»£ç "><a href="#å‚è€ƒä»£ç " class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n,m,a,b;cin &gt;&gt; n &gt;&gt; m &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="keyword">if</span>(n&lt;=<span class="number">2</span>||m&lt;=<span class="number">2</span>)&#123; cout &lt;&lt; n*m &lt;&lt; endl; <span class="keyword">return</span> ; &#125;</span><br><span class="line">    ll ans=<span class="number">2</span>*(n+m<span class="number">-2</span>);</span><br><span class="line">    <span class="keyword">if</span>(a==<span class="number">1</span>||a==n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b==<span class="number">1</span>||b==m) cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">else</span> cout &lt;&lt; ans+n<span class="number">-2</span> &lt;&lt; endl;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(b==<span class="number">1</span>||b==m) cout &lt;&lt; ans+m<span class="number">-2</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; ans+<span class="built_in">max</span>(&#123;<span class="number">0ll</span>,n<span class="number">-2</span>,m<span class="number">-2</span>&#125;) &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ï¼ˆ1006ï¼‰HDU7522-cats-çš„æœ€å°ç”Ÿæˆæ ‘"><a href="#ï¼ˆ1006ï¼‰HDU7522-cats-çš„æœ€å°ç”Ÿæˆæ ‘" class="headerlink" title="ï¼ˆ1006ï¼‰HDU7522.cats çš„æœ€å°ç”Ÿæˆæ ‘"></a>ï¼ˆ1006ï¼‰HDU7522.cats çš„æœ€å°ç”Ÿæˆæ ‘</h1><h2 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®šä¸€ä¸ªæœ‰ $n$ ä¸ªèŠ‚ç‚¹ï¼Œå¯èƒ½å«é‡è¾¹çš„å¸¦æƒæ— å‘å›¾ï¼Œ $m$ æ¡è¾¹æŒ‰é¡ºåºç»™å‡ºï¼Œç¬¬ $i$ æ¡è¾¹çš„æƒå€¼ä¸º $i$ã€‚<br>æ¯æ¬¡åˆ å»å½“å‰å›¾çš„æœ€å°ç”Ÿæˆæ ‘çš„æ‰€æœ‰è¾¹ï¼Œç›´åˆ°å›¾ä¸è¿é€šã€‚</p><p>æ±‚æ¯æ¡è¾¹æ˜¯åœ¨ç¬¬å‡ æ¬¡è¢«åˆ é™¤å»çš„ã€‚</p><h2 id="è§£é¢˜æ€è·¯-1"><a href="#è§£é¢˜æ€è·¯-1" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>æ ¹æ®Kruskalç®—æ³•æ€æƒ³ï¼Œæœ€å°ç”Ÿæˆæ ‘åŠ è¾¹æ˜¯ä»å°åˆ°å¤§åŠ å…¥çš„ã€‚<br>å¼€è‹¥å¹²ä¸ªå¹¶æŸ¥é›†ï¼Œéå†è¾¹ï¼Œæ¯æ¬¡äºŒåˆ†æŸ¥æ‰¾å½“å‰è¾¹æœ€æ—©å¯ä»¥åŠ å…¥ç¬¬å‡ ä¸ªå¹¶æŸ¥é›†ã€‚</p><h2 id="å‚è€ƒä»£ç -1"><a href="#å‚è€ƒä»£ç -1" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n,m;cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    ll ub=m/(n<span class="number">-1</span>);</span><br><span class="line">    <span class="function">vector&lt;DSU&gt; <span class="title">dsu</span><span class="params">(ub+<span class="number">2</span>,DSU(n))</span></span>;</span><br><span class="line">    <span class="function">vector&lt;ll&gt; <span class="title">cnt</span><span class="params">(ub+<span class="number">2</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;ll&gt; <span class="title">ans</span><span class="params">(m+<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">    ll u,v;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,m)&#123;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        ll l=<span class="number">1</span>,r=ub+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;r)&#123;</span><br><span class="line">            ll mid=(l+r+<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">            <span class="type">bool</span> fl=(dsu[mid].<span class="built_in">find</span>(u)==dsu[mid].<span class="built_in">find</span>(v));</span><br><span class="line">            <span class="keyword">if</span>(fl) l=mid;</span><br><span class="line">            <span class="keyword">else</span> r=mid<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ll tar=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">FORLL</span>(i,<span class="built_in">max</span>(<span class="number">1ll</span>,l<span class="number">-3</span>),<span class="built_in">min</span>(ub+<span class="number">1</span>,l+<span class="number">3</span>))&#123;</span><br><span class="line">            <span class="keyword">if</span>(dsu[i].<span class="built_in">find</span>(u)!=dsu[i].<span class="built_in">find</span>(v))&#123;</span><br><span class="line">                tar=i;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(tar==ub+<span class="number">1</span>) &#123; ans[i]=<span class="number">-1</span>; <span class="keyword">continue</span>; &#125;</span><br><span class="line">        dsu[tar].<span class="built_in">merge</span>(u,v);</span><br><span class="line">        cnt[tar]++; ans[i]=tar;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,m)&#123;</span><br><span class="line">        <span class="keyword">if</span>(ans[i]!=<span class="number">-1</span>&amp;&amp;cnt[ans[i]]==n<span class="number">-1</span>) cout &lt;&lt; ans[i];</span><br><span class="line">        <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;-1&quot;</span>;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">Presentation</span>(i,m);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="1007-HDU7523-cats-çš„-k-xor"><a href="#1007-HDU7523-cats-çš„-k-xor" class="headerlink" title="(1007)HDU7523.cats çš„ k-xor"></a>(1007)HDU7523.cats çš„ k-xor</h1><h2 id="é¢˜æ„-2"><a href="#é¢˜æ„-2" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®š2ä¸ªåè¿›åˆ¶æ•´æ•° $a,b,c$ ï¼Œ $a,b$ è¿›è¡Œ $k(k\ge 2)$ è¿›åˆ¶ä¸è¿›ä½åŠ æ³•åçš„ç»“æœæ˜¯ $c$ã€‚<br>æ±‚ $k$ æœ‰å¤šå°‘ç§å¯èƒ½ã€‚</p><h2 id="è§£é¢˜æ€è·¯-2"><a href="#è§£é¢˜æ€è·¯-2" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>ä¸è¿›ä½åŠ æ³•ä¸‹ï¼Œä¸¢å¤±çš„è¿›ä½ä¿¡æ¯ $a+b-c$ æ˜¯ $k$ çš„å€æ•°ã€‚<br>æšä¸¾ $a+b-c$ çš„å› å­ä½œä¸º $k$ ï¼Œcheckæ˜¯å¦æ»¡è¶³æ¡ä»¶ã€‚</p><h2 id="å‚è€ƒä»£ç -2"><a href="#å‚è€ƒä»£ç -2" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(ll a,ll b,ll c,ll k)</span></span>&#123;</span><br><span class="line">    ll dif=a+b-c;</span><br><span class="line">    ll cur=<span class="number">1</span>,nxt=k,s=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(a/cur||b/cur)&#123;</span><br><span class="line">        ll ta=a/cur%k,tb=b/cur%k;</span><br><span class="line">        s+=(ta+tb)/k*nxt;</span><br><span class="line">        cur*=k; nxt*=k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s==dif;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll a,b,c;cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">    ll dif=a+b-c;</span><br><span class="line">    <span class="keyword">if</span>(dif==<span class="number">0</span>)&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;-1&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    ll cnt=<span class="number">0</span>,ub=<span class="built_in">sqrt</span>(dif)+<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">2</span>,ub) <span class="keyword">if</span>(dif%i==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i*i&gt;dif) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">check</span>(a,b,c,i)) cnt++;</span><br><span class="line">        <span class="keyword">if</span>(i*i!=dif&amp;&amp;<span class="built_in">check</span>(a,b,c,dif/i)) cnt++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">check</span>(a,b,c,dif)) cnt++;</span><br><span class="line">    cout &lt;&lt; cnt &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ï¼ˆ1012ï¼‰HDU7528-cats-çš„ç”µè„‘ä¸­æ¯’"><a href="#ï¼ˆ1012ï¼‰HDU7528-cats-çš„ç”µè„‘ä¸­æ¯’" class="headerlink" title="ï¼ˆ1012ï¼‰HDU7528.cats çš„ç”µè„‘ä¸­æ¯’"></a>ï¼ˆ1012ï¼‰HDU7528.cats çš„ç”µè„‘ä¸­æ¯’</h1><h2 id="é¢˜æ„-3"><a href="#é¢˜æ„-3" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®š $3$ ä¸ªé•¿åº¦ä¸º $n$ çš„äºŒè¿›åˆ¶ä¸² $a,b,c$ ï¼Œ è¡¨ç¤ºç—…æ¯’çš„åˆå§‹ä½ç½®ã€‚<br>æ¯è¿‡ä¸€ç§’ï¼Œç—…æ¯’ä¼šæ„ŸæŸ“ç›¸é‚»çš„æ‰€æœ‰äºŒè¿›åˆ¶ç¼–ç ã€‚ï¼ˆå½“ä¸”ä»…å½“ä¸¤ä¸ªäºŒè¿›åˆ¶ç¼–ç ä»…æœ‰ä¸€ä¸ªä½ç½®ä¸åŒæ—¶ï¼Œè¿™ä¸¤ä¸ªç¼–ç ä¸ºç›¸é‚»ï¼‰<br>é—®æ‰€æœ‰çš„ $2^n$ ä¸ªäºŒè¿›åˆ¶ç¼–ç éƒ½è¢«æ„ŸæŸ“éœ€è¦å¤šå°‘æ—¶é—´ã€‚</p><h2 id="è§£é¢˜æ€è·¯-3"><a href="#è§£é¢˜æ€è·¯-3" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>è€ƒè™‘æœ€åä¸€ç§’è¢«æ„ŸæŸ“çš„äºŒè¿›åˆ¶ä¸²ï¼Œå®ƒçš„ è·ç¦»ä¸‰ä¸ªåˆå§‹ä½ç½®çš„æœ€å°æ±‰æ˜è·ç¦» æœ€å¤§ï¼Œæ‰¾åˆ°è¿™ä¸ªä¸²ã€‚<br>è®¾è¿™ä¸ªä¸²ä¸º $s$ ï¼Œæšä¸¾æ¯ä¸€ä½ã€‚è‹¥ä¸‰ä¸ªåˆå§‹ä½ç½®çš„è¿™ä¸€ä½ä¸Šï¼Œ1çš„æ•°é‡è¾ƒå¤šï¼Œåˆ™è®¾ä¸º0ï¼›å¦åˆ™è®¾ä¸º1ã€‚<br>ç„¶åè¿›è¡Œå¾®è°ƒï¼Œä½¿å¾— $s$ åˆ°ä¸‰ä¸ªåˆå§‹ä½ç½®çš„æœ€å°æ±‰æ˜è·ç¦» æœ€å¤§ã€‚</p><h2 id="å‚è€ƒä»£ç -3"><a href="#å‚è€ƒä»£ç -3" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">ll n;</span><br><span class="line"><span class="function">ll <span class="title">dis</span><span class="params">(string s1,string s2)</span></span>&#123;</span><br><span class="line">    ll cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">0</span>,n<span class="number">-1</span>) cnt+=(s1[i]!=s2[i]);</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    string s[<span class="number">3</span>],<span class="built_in">ns</span>(n,<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">0</span>,<span class="number">2</span>) cin &gt;&gt; s[i];</span><br><span class="line">    ll cnta=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">0</span>,n<span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="type">int</span> cnt1=<span class="number">0</span>,t=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">FORLL</span>(j,<span class="number">0</span>,<span class="number">2</span>) <span class="keyword">if</span>(s[j][i]==<span class="string">&#x27;1&#x27;</span>) cnt1++;</span><br><span class="line">        ns[i]=(cnt1&gt;=<span class="number">2</span>)?<span class="string">&#x27;0&#x27;</span>:<span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll dis0=<span class="built_in">dis</span>(s[<span class="number">0</span>],ns),dis1=<span class="built_in">dis</span>(s[<span class="number">1</span>],ns),dis2=<span class="built_in">dis</span>(s[<span class="number">2</span>],ns);</span><br><span class="line">    <span class="keyword">while</span>(dis0&lt;dis1<span class="number">-1</span>&amp;&amp;dis0&lt;dis2<span class="number">-1</span>)&#123; dis0++; dis1--; dis2--; &#125;</span><br><span class="line">    <span class="keyword">while</span>(dis1&lt;dis0<span class="number">-1</span>&amp;&amp;dis1&lt;dis2<span class="number">-1</span>)&#123; dis1++; dis0--; dis2--; &#125;</span><br><span class="line">    <span class="keyword">while</span>(dis2&lt;dis0<span class="number">-1</span>&amp;&amp;dis2&lt;dis1<span class="number">-1</span>)&#123; dis2++; dis0--; dis1--; &#125;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">min</span>(&#123;dis0,dis1,dis2&#125;) &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">é¢˜è§£|2024æš‘æœŸæ­ç”µå¤šæ ¡08</summary>
    
    
    
    <category term="ç«èµ›ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E7%AB%9E%E8%B5%9B%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="2024æš‘æœŸæ­ç”µå¤šæ ¡" scheme="https://www.cclmsy.cc/tags/2024%E6%9A%91%E6%9C%9F%E6%9D%AD%E7%94%B5%E5%A4%9A%E6%A0%A1/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£|2024æš‘æœŸæ­ç”µå¤šæ ¡07</title>
    <link href="https://www.cclmsy.cc/posts/ACM_2024Summer_HDU07.html"/>
    <id>https://www.cclmsy.cc/posts/ACM_2024Summer_HDU07.html</id>
    <published>2024-08-08T16:00:00.000Z</published>
    <updated>2025-03-09T02:54:24.916Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯”èµ›é¢˜å•ï¼š<a href="https://acm.hdu.edu.cn/search.php?field=problem&amp;key=2024%A1%B0%B6%A4%B0%D2%B1%E0%B3%CC%A1%B1%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%CB%E3%B7%A8%C9%E8%BC%C6%B3%AC%BC%B6%C1%AA%C8%FC%A3%A87%A3%A9&amp;source=1&amp;searchmode=source">2024â€œé’‰è€™ç¼–ç¨‹â€ä¸­å›½å¤§å­¦ç”Ÿç®—æ³•è®¾è®¡è¶…çº§è”èµ›ï¼ˆ7ï¼‰</a></p><h1 id="1010-HDU7514-æ•…éšœæœºå™¨äººæƒ³æ´»ä¸‹å»"><a href="#1010-HDU7514-æ•…éšœæœºå™¨äººæƒ³æ´»ä¸‹å»" class="headerlink" title="(1010)HDU7514.æ•…éšœæœºå™¨äººæƒ³æ´»ä¸‹å»"></a>(1010)HDU7514.æ•…éšœæœºå™¨äººæƒ³æ´»ä¸‹å»</h1><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>æ•…éšœæœºå™¨äººæœ‰ $x$ ç‚¹è¡€é‡ã€‚<br>ä»–å°†æŒ‰é¡ºåºè¿›è¡Œ $n$ åœºæˆ˜æ–—ï¼Œç¬¬ $i$ åœºæˆ˜æ–—ä¼šå—åˆ° $a_i$ ç‚¹ä¼¤å®³ã€‚<br>æ•…éšœæœºå™¨äººè¿˜æœ‰ $k$ ä¸ªçƒŸé›¾å¼¹ï¼Œæ¯ä¸ªçƒŸé›¾å¼¹å¯ä»¥è®©ä»–è·³è¿‡ä¸€åœºæˆ˜æ–—è€Œä¸å—ä¼¤å®³ã€‚</p><p>é—®æ•…éšœæœºå™¨äººæœ€å¤šèƒ½æ´»åˆ°ç¬¬å‡ åœºæˆ˜æ–—ç»“æŸã€‚</p><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>ç»´æŠ¤å½“å‰æœ€é«˜çš„ $k$ ä¸ªä¼¤å®³ï¼Œä½œä¸ºè¢«è·³è¿‡çš„ä¼¤å®³ã€‚<br>ç»Ÿè®¡å—ä¼¤é‡ï¼Œç›´åˆ°å—ä¼¤é‡è¶…è¿‡ $x$ ä¸ºæ­¢ã€‚</p><h2 id="å‚è€ƒä»£ç "><a href="#å‚è€ƒä»£ç " class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n,x,k;cin &gt;&gt; n &gt;&gt; x &gt;&gt; k;</span><br><span class="line">    <span class="built_in">create_vec</span>(v,n);</span><br><span class="line">    priority_queue&lt;ll,vector&lt;ll&gt;,less&lt;ll&gt;&gt; pq;</span><br><span class="line">    ll S=<span class="number">0</span>,cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">0</span>,n<span class="number">-1</span>)&#123;</span><br><span class="line">        S+=v[i];</span><br><span class="line">        pq.<span class="built_in">push</span>(v[i]);</span><br><span class="line">        <span class="keyword">while</span>(S&gt;=x)&#123;</span><br><span class="line">            <span class="keyword">if</span>(cnt&gt;=k)&#123;</span><br><span class="line">                cout &lt;&lt; pq.<span class="built_in">size</span>()+cnt<span class="number">-1</span> &lt;&lt; endl;</span><br><span class="line">                <span class="keyword">return</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            S-=pq.<span class="built_in">top</span>();</span><br><span class="line">            pq.<span class="built_in">pop</span>();</span><br><span class="line">            cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;cout &lt;&lt; n &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="1011-HDU7515-è›‹ç³•ä¸Šçš„è‰è“æ˜¯è›‹ç³•çš„çµé­‚"><a href="#1011-HDU7515-è›‹ç³•ä¸Šçš„è‰è“æ˜¯è›‹ç³•çš„çµé­‚" class="headerlink" title="(1011)HDU7515.è›‹ç³•ä¸Šçš„è‰è“æ˜¯è›‹ç³•çš„çµé­‚"></a>(1011)HDU7515.è›‹ç³•ä¸Šçš„è‰è“æ˜¯è›‹ç³•çš„çµé­‚</h1><h2 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>æœ‰ $x$ ä¸ªç›¸åŒçš„è‰è“å’Œ $y$ ä¸ªç›¸åŒçš„è›‹ç³•ã€‚<br>æ¯æ¬¡å¯ä»¥å°†å½“å‰æ‰€æœ‰è‰è“æˆ–è›‹ç³•æ”¾åœ¨ä¸€èµ·åˆ‡ $m$ åˆ€ï¼Œå³ä»½æ•°å˜ä¸ºæ­¤å‰çš„ $2m$ å€ã€‚<br>åœ¨æ»¡è¶³æ¡ä»¶çš„æƒ…å†µä¸‹åˆ‡è‰è“çš„æ¬¡æ•°å°½å¯èƒ½å°‘ã€‚<br>æ±‚å‡ºæœ€ç»ˆè‰è“å’Œè›‹ç³•çš„æ•°é‡ã€‚</p><h2 id="è§£é¢˜æ€è·¯-1"><a href="#è§£é¢˜æ€è·¯-1" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>è´ªå¿ƒçš„ï¼Œè§‚å¯Ÿåˆ°è›‹ç³•æ˜¯ä¸ç”¨åˆ‡çš„ï¼Œå°†è‰è“åˆ‡åˆ° $\gcd(x,y)$ ä»½å³å¯ã€‚<br>è‹¥ $\gcd$ æ˜¯ $x$ çš„å¥‡æ•°å€ï¼Œéœ€è¦å¤šæ¥ä¸€åˆ€ã€‚</p><h2 id="å‚è€ƒä»£ç -1"><a href="#å‚è€ƒä»£ç -1" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll x,y;cin &gt;&gt; x &gt;&gt; y;</span><br><span class="line">    ll g=__gcd(x,y);</span><br><span class="line">    <span class="keyword">if</span>(y/g&gt;<span class="number">1</span>&amp;&amp;(y/g)%<span class="number">2</span>) cout &lt;&lt; y &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; x/g*<span class="number">2</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; y &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; x/g &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">é¢˜è§£|2024æš‘æœŸæ­ç”µå¤šæ ¡07</summary>
    
    
    
    <category term="ç«èµ›ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E7%AB%9E%E8%B5%9B%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="2024æš‘æœŸæ­ç”µå¤šæ ¡" scheme="https://www.cclmsy.cc/tags/2024%E6%9A%91%E6%9C%9F%E6%9D%AD%E7%94%B5%E5%A4%9A%E6%A0%A1/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£|2024æš‘æœŸç‰›å®¢å¤šæ ¡08</title>
    <link href="https://www.cclmsy.cc/posts/ACM_2024Summer_NCD08.html"/>
    <id>https://www.cclmsy.cc/posts/ACM_2024Summer_NCD08.html</id>
    <published>2024-08-07T16:00:00.000Z</published>
    <updated>2025-03-09T02:54:24.892Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯”èµ›é“¾æ¥ï¼š<a href="https://ac.nowcoder.com/acm/contest/81603">2024ç‰›å®¢æš‘æœŸå¤šæ ¡è®­ç»ƒè¥8</a></p><h1 id="A-Haitang-and-Game"><a href="#A-Haitang-and-Game" class="headerlink" title="A.Haitang and Game"></a>A.Haitang and Game</h1><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®šä¸€ä¸ªåŒ…å« $n$ ä¸ªæ•°çš„æ­£æ•´æ•°é›†åˆ $S$ ï¼Œæ¯æ¬¡å¯ä»¥ä»ä¸­é€‰æ‹©ä¸¤ä¸ªæ•° $x,y$ æ»¡è¶³ $x,y\in S,\gcd(x,y)\notin S$ï¼Œå°† $\gcd(x,y)$ åŠ å…¥ $S$ ã€‚<br>æœ€å¤šåŠ å…¥æ•°çš„ä¸ªæ•°æ˜¯å¥‡æ•°è¾“å‡º<code>dXqwq</code>ï¼Œå¦åˆ™è¾“å‡º<code>Haitang</code>ã€‚</p><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>è€ƒè™‘æœ€ç»ˆé›†åˆä¸­çš„æ•° $d$ ï¼Œä¸€å®šæ»¡è¶³åŸé›†åˆä¸­ï¼Œå®ƒçš„æ‰€æœ‰å€æ•°çš„ $gcd$ ç­‰äºå®ƒã€‚<br>ä»å°åˆ°å¤§æšä¸¾ $d$ ï¼Œå¦‚æœ $d$ æ»¡è¶³ä¸Šè¿°æ¡ä»¶ä¸”ä¸åœ¨åŸé›†åˆä¸­ï¼Œè®¡æ•°ã€‚</p><h2 id="å‚è€ƒä»£ç "><a href="#å‚è€ƒä»£ç " class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n;cin &gt;&gt; n;</span><br><span class="line">    unordered_set&lt;ll&gt; s;</span><br><span class="line">    ll mx=<span class="number">-1</span>,t;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">        cin &gt;&gt; t;</span><br><span class="line">        s.<span class="built_in">insert</span>(t);</span><br><span class="line">        <span class="built_in">chmax</span>(mx,t);</span><br><span class="line">    &#125;</span><br><span class="line">    ll cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,mx)&#123;</span><br><span class="line">        ll fl=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(ll j=i;j&lt;=mx;j+=i)</span><br><span class="line">            <span class="keyword">if</span>(s.<span class="built_in">count</span>(j)) fl=__gcd(fl,j);</span><br><span class="line">        <span class="keyword">if</span>(fl==i&amp;&amp;!s.<span class="built_in">count</span>(i)) cnt++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(cnt%<span class="number">2</span>) cout &lt;&lt; <span class="string">&quot;dXqwq\n&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;Haitang\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="J-Haitang-and-Triangle"><a href="#J-Haitang-and-Triangle" class="headerlink" title="J.Haitang and Triangle"></a>J.Haitang and Triangle</h1><h2 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>æ„é€ ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ’åˆ—ï¼Œå®ƒæ°æœ‰ $m$ ä¸ªé•¿åº¦ä¸º $3$ çš„å­åŒºé—´æ»¡è¶³å­åŒºé—´çš„ä¸‰ä¸ªæ•°èƒ½æ„æˆéé€€åŒ–ä¸‰è§’å½¢ã€‚</p><h2 id="è§£é¢˜æ€è·¯-1"><a href="#è§£é¢˜æ€è·¯-1" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>æ„é€ ä¸€ä¸ªé•¿åº¦ä¸º $n-m$ çš„æ’åˆ—ï¼Œå®ƒä¸å«èƒ½å¤Ÿæ„æˆéé€€åŒ–ä¸‰è§’å½¢çš„é•¿åº¦ä¸º $3$ çš„å­åŒºé—´ã€‚<br>æˆ‘ä½¿ç”¨çš„æ–¹æ³•æ˜¯æŠŠ $1\sim n-m$ ä»å¤§åˆ°å°å‡åˆ†æˆä¸‰ç»„ï¼Œç¬¬1ç»„é™åºï¼Œå…¶ä»–ç»„å‡åºï¼ŒæŒ‰321çš„é¡ºåºæ”¾ç½®ã€‚<br>å‡è®¾ $n-m=7$ ï¼Œåˆ†æˆ $[2,1],[3,4],[5,6,7]$ ï¼Œæ’åˆ—ä¸º $5,3,2,\ 6,4,1,\ 7$ ã€‚</p><p>å‰©ä¸‹ $m$ ä¸ªæ•°é™åºæ”¾åœ¨æ’åˆ—çš„å‰é¢ï¼Œå’Œä¸Šé¢çš„æ’åˆ—åˆå¹¶å½¢æˆ $m$ ä¸ªåˆæ³•åŒºé—´ã€‚</p><h2 id="å‚è€ƒä»£ç -1"><a href="#å‚è€ƒä»£ç -1" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n,m;cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    ll t = n-m;</span><br><span class="line">    <span class="keyword">if</span>(t&lt;<span class="number">3</span>)&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;-1&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    deque&lt;ll&gt; v[<span class="number">3</span>];</span><br><span class="line">    ll t1=t/<span class="number">3</span>,t2=t%<span class="number">3</span>;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,t1) v[<span class="number">0</span>].<span class="built_in">emplace_back</span>(i);</span><br><span class="line">    <span class="built_in">FORLL</span>(i,t1+<span class="number">1</span>,t1*<span class="number">2</span>+(t2&gt;<span class="number">1</span>)) v[<span class="number">1</span>].<span class="built_in">emplace_front</span>(i);</span><br><span class="line">    <span class="built_in">FORLL</span>(i,t1*<span class="number">2</span>+(t2&gt;<span class="number">1</span>)+<span class="number">1</span>,t) v[<span class="number">2</span>].<span class="built_in">emplace_front</span>(i);</span><br><span class="line">    <span class="comment">// FORLL(i,0,2) print_vec(v[i]);</span></span><br><span class="line">    vector&lt;ll&gt; ans;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">0</span>,t1)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i&lt;v[<span class="number">2</span>].<span class="built_in">size</span>()) ans.<span class="built_in">emplace_back</span>(v[<span class="number">2</span>][i]);</span><br><span class="line">        <span class="keyword">if</span>(i&lt;v[<span class="number">1</span>].<span class="built_in">size</span>()) ans.<span class="built_in">emplace_back</span>(v[<span class="number">1</span>][i]);</span><br><span class="line">        <span class="keyword">if</span>(i&lt;v[<span class="number">0</span>].<span class="built_in">size</span>()) ans.<span class="built_in">emplace_back</span>(v[<span class="number">0</span>][i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">FORLL_rev</span>(i,n,t+<span class="number">1</span>) cout &lt;&lt; i &lt;&lt; <span class="built_in">Presentation</span>(i,<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">0</span>,t<span class="number">-1</span>) cout &lt;&lt; ans[i] &lt;&lt; <span class="built_in">Presentation</span>(i,t<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="K-Haitang-and-Ava"><a href="#K-Haitang-and-Ava" class="headerlink" title="K.Haitang and Ava"></a>K.Haitang and Ava</h1><h2 id="é¢˜æ„-2"><a href="#é¢˜æ„-2" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>åˆ¤æ–­ç»™å®šå­—ç¬¦ä¸²æ˜¯å¦ä»…ç”±è‹¥å¹²ä¸ª <code>ava</code> å’Œ <code>avava</code> ç»„æˆã€‚</p><h2 id="è§£é¢˜æ€è·¯-2"><a href="#è§£é¢˜æ€è·¯-2" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>ä» $i=1$ å¼€å§‹ï¼Œå¯¹äºå½“å‰ä½ç½®å¼€å¤´ï¼Œå…ˆæ£€æŸ¥é•¿åº¦ä¸º $5$ çš„å­ä¸²æ˜¯å¦æ˜¯ <code>avava</code> ï¼Œå†æ£€æŸ¥é•¿åº¦ä¸º $3$ çš„å­ä¸²æ˜¯å¦æ˜¯ <code>ava</code> ï¼Œå¦‚æœæ˜¯ï¼Œå°±è·³è¿‡è¿™ä¸ªå­ä¸²ï¼›å¦åˆ™è¾“å‡º<code>NO</code>ã€‚</p><h2 id="å‚è€ƒä»£ç -2"><a href="#å‚è€ƒä»£ç -2" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pat1 = <span class="string">&#x27;ava&#x27;</span></span><br><span class="line">pat2 = <span class="string">&#x27;avava&#x27;</span></span><br><span class="line"></span><br><span class="line">T = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(T):</span><br><span class="line">    s = <span class="built_in">input</span>()</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(s):</span><br><span class="line">        <span class="keyword">if</span> i+<span class="number">5</span>&lt;=<span class="built_in">len</span>(s) <span class="keyword">and</span> s[i:i+<span class="number">5</span>] == pat2:</span><br><span class="line">            i += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> i+<span class="number">3</span>&lt;=<span class="built_in">len</span>(s) <span class="keyword">and</span> s[i:i+<span class="number">3</span>] == pat1:</span><br><span class="line">            i += <span class="number">3</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;No&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Yes&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">é¢˜è§£|2024æš‘æœŸç‰›å®¢å¤šæ ¡08</summary>
    
    
    
    <category term="ç«èµ›ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E7%AB%9E%E8%B5%9B%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="2024æš‘æœŸç‰›å®¢å¤šæ ¡" scheme="https://www.cclmsy.cc/tags/2024%E6%9A%91%E6%9C%9F%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£|2024æš‘æœŸç‰›å®¢å¤šæ ¡07</title>
    <link href="https://www.cclmsy.cc/posts/ACM_2024Summer_NCD07.html"/>
    <id>https://www.cclmsy.cc/posts/ACM_2024Summer_NCD07.html</id>
    <published>2024-08-05T16:00:00.000Z</published>
    <updated>2025-03-09T02:54:24.890Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯”èµ›é“¾æ¥ï¼š<a href="https://ac.nowcoder.com/acm/contest/81702">2024ç‰›å®¢æš‘æœŸå¤šæ ¡è®­ç»ƒè¥7</a></p><h1 id="I-Fight-Against-the-Monster"><a href="#I-Fight-Against-the-Monster" class="headerlink" title="I.Fight Against the Monster"></a>I.Fight Against the Monster</h1><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç“¶å­æ¢æ°´é—®é¢˜ã€‚ $m$ ä¸ªç©ºç“¶å¯ä»¥æ¢ $k$ ç“¶æ°´ï¼Œ æ±‚ä¸€å…±è¦å– $h$ ç“¶æ°´ï¼Œåˆå§‹æœ€å°‘éœ€è¦å¤šå°‘ç“¶æ°´ã€‚</p><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>äºŒåˆ†checkã€‚</p><p>è®¾åˆå§‹æœ‰ $x$ ç“¶æ°´ï¼Œæ¢æ°´æ¬¡æ•°ä¸º $\dfrac{x-m}{m-k}+1=\dfrac{x-k}{m-k}$ã€‚<br>æ¯æ¬¡æ¢æ°´äº§ç”Ÿ $k$ ç“¶æ°´ï¼Œæ€»å…± $x+k\cdot \dfrac{x-k}{m-k}$ ç“¶æ°´ã€‚</p><h2 id="å‚è€ƒä»£ç "><a href="#å‚è€ƒä»£ç " class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">check</span><span class="params">(ll m,ll k,ll h,ll x)</span></span>&#123;</span><br><span class="line">    ll t=(x-k)/(m-k)*k+x;   </span><br><span class="line">    <span class="keyword">if</span>(t&gt;=h) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll m,k,h;cin &gt;&gt; m &gt;&gt; k &gt;&gt; h;</span><br><span class="line">    <span class="keyword">if</span>(h&lt;=m)&#123;cout &lt;&lt; h &lt;&lt; endl;<span class="keyword">return</span>;&#125; <span class="comment">//ä¸ç”¨æ¢</span></span><br><span class="line">    <span class="keyword">if</span>(m&lt;=k)&#123;cout &lt;&lt; m &lt;&lt; endl;<span class="keyword">return</span>;&#125; <span class="comment">//ç”Ÿç”Ÿä¸æ¯</span></span><br><span class="line">    ll l=<span class="number">0</span>,r=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;r)&#123;</span><br><span class="line">        ll mid=(l+r)/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">check</span>(m,k,h,mid)) r=mid;</span><br><span class="line">        <span class="keyword">else</span> l=mid+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="built_in">max</span>(<span class="number">0ll</span>,l<span class="number">-10</span>),r+<span class="number">10</span>) <span class="keyword">if</span>(<span class="built_in">check</span>(m,k,h,i)) &#123;cout &lt;&lt; i &lt;&lt; endl;<span class="keyword">return</span>;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="J-Ball"><a href="#J-Ball" class="headerlink" title="J.Ball"></a>J.Ball</h1><h2 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®šä¸€æ ¹å·¦ç«¯ç‚¹ä¸º $(0,0)$ å‚ç›´äºyè½´é•¿åº¦ä¸º $l$ çš„æ£å­ã€‚<br>åœ¨ä¸Šé¢æ‰¾ä¸€ä¸ªæ”¯ç‚¹ä½¿å¾—æ£å­ç»•æ”¯ç‚¹æ—‹è½¬å¯ä»¥ç¢°åˆ°ä½äº $(x,y)$ çš„å°çƒã€‚</p><h2 id="è§£é¢˜æ€è·¯-1"><a href="#è§£é¢˜æ€è·¯-1" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>æ”¯ç‚¹ä½äºä¸¤ç«¯æ—¶æ‰«è¿‡çš„é¢ç§¯å¯è¦†ç›–æ‰€æœ‰æƒ…å†µã€‚<br>åˆ¤æ–­å°çƒåˆ°ä¸¤ç«¯çš„è·ç¦»ã€‚</p><h2 id="å‚è€ƒä»£ç -1"><a href="#å‚è€ƒä»£ç -1" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll l,x,y;</span><br><span class="line">    cin &gt;&gt; l &gt;&gt; x &gt;&gt; y;</span><br><span class="line">    ll dis1,dis2;</span><br><span class="line">    dis1=x*x+y*y;</span><br><span class="line">    dis2=(l-x)*(l-x)+y*y;</span><br><span class="line">    <span class="keyword">if</span>(dis1&gt;l*l&amp;&amp;dis2&gt;l*l) &#123; cout &lt;&lt; <span class="string">&quot;No\n&quot;</span>; <span class="keyword">return</span> ;&#125;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;Yes\n&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(dis1&lt;dis2) cout &lt;&lt; <span class="number">0</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; l &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">é¢˜è§£|2024æš‘æœŸç‰›å®¢å¤šæ ¡07</summary>
    
    
    
    <category term="ç«èµ›ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E7%AB%9E%E8%B5%9B%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="2024æš‘æœŸç‰›å®¢å¤šæ ¡" scheme="https://www.cclmsy.cc/tags/2024%E6%9A%91%E6%9C%9F%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£|2024æš‘æœŸæ­ç”µå¤šæ ¡06</title>
    <link href="https://www.cclmsy.cc/posts/ACM_2024Summer_HDU06.html"/>
    <id>https://www.cclmsy.cc/posts/ACM_2024Summer_HDU06.html</id>
    <published>2024-08-04T16:00:00.000Z</published>
    <updated>2025-03-09T02:54:24.916Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯”èµ›é¢˜å•ï¼š<a href="https://acm.hdu.edu.cn/search.php?field=problem&amp;key=2024%A1%B0%B6%A4%B0%D2%B1%E0%B3%CC%A1%B1%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%CB%E3%B7%A8%C9%E8%BC%C6%B3%AC%BC%B6%C1%AA%C8%FC%A3%A86%A3%A9&amp;source=1&amp;searchmode=source">2024â€œé’‰è€™ç¼–ç¨‹â€ä¸­å›½å¤§å­¦ç”Ÿç®—æ³•è®¾è®¡è¶…çº§è”èµ›ï¼ˆ6ï¼‰</a></p><h1 id="1001-HDU7494-é€ èŠ±ï¼ˆç®€å•ç‰ˆï¼‰"><a href="#1001-HDU7494-é€ èŠ±ï¼ˆç®€å•ç‰ˆï¼‰" class="headerlink" title="(1001)HDU7494 é€ èŠ±ï¼ˆç®€å•ç‰ˆï¼‰"></a>(1001)HDU7494 é€ èŠ±ï¼ˆç®€å•ç‰ˆï¼‰</h1><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®šä¸€æ£µ $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œé—®èƒ½å¦é€šè¿‡åˆ å»ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä½¿å¾—å‰©ä¸‹çš„èŠ‚ç‚¹ç»„æˆ2ä¸ªè¿é€šå—ï¼Œä¸”æ¯ä¸ªè¿é€šå—éƒ½æ˜¯ä¸€ä¸ªèŠèŠ±å›¾ã€‚</p><p>èŠèŠ±å›¾æ˜¯ä¸€æ£µæ ‘ï¼Œä¸”å­˜åœ¨å”¯ä¸€ä¸­å¿ƒç‚¹ä¸å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹ä¹‹é—´æœ‰ä¸€æ¡è¾¹ã€‚ç‰¹æ®Šçš„ï¼Œåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„æ ‘ä¹Ÿæ˜¯èŠèŠ±å›¾ã€‚</p><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>ä¸€æ£µæ ‘åˆ å»ä¸€ä¸ªç‚¹å¾—åˆ°ä¸¤ä¸ªè¿é€šå—ï¼Œé‚£ä¹ˆåˆ å»çš„ç‚¹çš„åº¦å¿…å®šä¸º2ã€‚</p><p>è¿™ä¸ªåˆ å»çš„ç‚¹ $u$ å’Œå¾—åˆ°çš„ä¸¤ä¸ªèŠèŠ±å›¾çš„ä¸­å¿ƒç‚¹ $v_1,v_2$ æœ‰ä¸‰ç§æƒ…å†µï¼š</p><ol><li>$u$ å’Œ $v_1,v_2$ ç›´æ¥ç›¸è¿</li><li>$u$ å’Œ $v_1$ ç›´æ¥ç›¸è¿ï¼Œå’Œ $v_2$ çš„è·ç¦»ä¸º2</li><li>$u$ å’Œ $v_1,v_2$ çš„è·ç¦»éƒ½ä¸º2</li></ol><p>è®°å½•åº¦å¤§äº1çš„èŠ‚ç‚¹ï¼Œè¿™äº›ç‚¹æ˜¯å…³é”®èŠ‚ç‚¹ï¼Œå¯èƒ½æ˜¯ä¸­å¿ƒç‚¹ï¼Œä¹Ÿå¯èƒ½æ˜¯åˆ å»çš„ç‚¹ã€‚</p><p>åº¦å¤§äº1çš„èŠ‚ç‚¹æ•°æœ€å¤šçš„æƒ…å†µæ˜¯ç¬¬ä¸‰ç§ï¼Œæœ€å¤šæœ‰5ä¸ªåº¦å¤§äº1çš„èŠ‚ç‚¹ï¼Œå½¢å¦‚ï¼š<br><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  8       9</span><br><span class="line">  |       |</span><br><span class="line">1<span class="string">-2</span><span class="string">-3</span><span class="string">-4</span><span class="string">-5</span><span class="string">-6</span><span class="string">-7</span></span><br><span class="line">  |       |</span><br><span class="line">  10      11</span><br></pre></td></tr></table></figure></p><p>åˆ å»ç‚¹ $u$ åï¼Œå‰©ä½™åº¦å¤§äº1çš„èŠ‚ç‚¹å¿…å®šæ˜¯ä¸­å¿ƒç‚¹ï¼Œä¸ªæ•°ä¸å¤§äº $2-t$ å³æ»¡è¶³ã€‚<br>å…¶ä¸­ï¼Œ $t$ æ˜¯åˆ ç‚¹åä»…ç”±ä¸å¤šäº$2$ä¸ªç‚¹ç»„æˆçš„è¿é€šå—çš„ä¸ªæ•°ã€‚</p><h2 id="å‚è€ƒä»£ç "><a href="#å‚è€ƒä»£ç " class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n;cin &gt;&gt; n;</span><br><span class="line">    vector&lt;vector&lt;ll&gt;&gt; <span class="built_in">G</span>(n+<span class="number">1</span>);</span><br><span class="line">    ll u,v;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,n<span class="number">-1</span>)&#123;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        G[u].<span class="built_in">emplace_back</span>(v);</span><br><span class="line">        G[v].<span class="built_in">emplace_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;ll&gt; crit; <span class="comment">//å…³é”®ç‚¹</span></span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,n) <span class="keyword">if</span>(G[i].<span class="built_in">size</span>()&gt;<span class="number">1</span>) crit.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">    <span class="keyword">if</span>(crit.<span class="built_in">size</span>()&gt;<span class="number">5</span>) &#123;cout &lt;&lt; <span class="string">&quot;No\n&quot;</span>;<span class="keyword">return</span>;&#125; </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> u:crit) <span class="keyword">if</span>(G[u].<span class="built_in">size</span>()==<span class="number">2</span>)&#123; <span class="comment">//æšä¸¾åˆ é™¤çš„ç‚¹</span></span><br><span class="line">        ll cnt2=<span class="number">0</span>,cnt1=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> v:G[u])&#123; <span class="comment">//ç›¸é‚»çš„2ä¸ªç‚¹</span></span><br><span class="line">            <span class="keyword">if</span>(G[v].<span class="built_in">size</span>()==<span class="number">2</span>)&#123; </span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">auto</span> w:G[v])  <span class="comment">//w==u:è¿™ä¸€ç«¯çš„è¿é€šå—åªæœ‰2ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">                <span class="keyword">if</span>(w!=u) <span class="keyword">if</span>(G[w].<span class="built_in">size</span>()&gt;<span class="number">1</span>) cnt2++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(G[v].<span class="built_in">size</span>()==<span class="number">1</span>) cnt1++; <span class="comment">//è¿™ä¸€ç«¯çš„è¿é€šå—åªæœ‰1ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        &#125;</span><br><span class="line">        ll t=crit.<span class="built_in">size</span>()<span class="number">-1</span>-cnt2;</span><br><span class="line">        <span class="keyword">if</span>(t&lt;=<span class="number">2</span>-cnt1) &#123; cout &lt;&lt; <span class="string">&quot;Yes\n&quot;</span>; <span class="keyword">return</span>;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;No\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="1003-HDU7496-é£è½¦ç‹‚é£™"><a href="#1003-HDU7496-é£è½¦ç‹‚é£™" class="headerlink" title="(1003)HDU7496 é£è½¦ç‹‚é£™"></a>(1003)HDU7496 é£è½¦ç‹‚é£™</h1><h2 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„å­—ç¬¦ä¸²ï¼ŒåŒ…å«ï¼š</p><ol><li><code>L</code> ï¼šè¡¨ç¤ºå·¦è½¬çš„æ–¹å—</li><li><code>R</code> ï¼šè¡¨ç¤ºå³è½¬çš„æ–¹å—</li><li><code>S</code> ï¼šè¡¨ç¤ºç›´è¡Œçš„æ–¹å—</li></ol><p>ä»åŸç‚¹å¼€å§‹ï¼ŒæŒ‰ç…§å­—ç¬¦ä¸²ç»™å®šçš„é¡ºåºï¼Œå…ˆæ”¾ç½®ï¼Œå†æŒ‰ç…§ç»™å®šçš„æ–¹å‘ç§»åŠ¨ã€‚</p><p>åˆæ³•çš„å­—ç¬¦ä¸²æ»¡è¶³ï¼š</p><ol><li>ä¸åœ¨åŒä¸€ä½ç½®æ”¾ç½®ä¸¤ä¸ªæ–¹å—</li><li>æ‰€æœ‰æ–¹å—å½¢æˆä¸€ä¸ªç¯</li></ol><p>é—®ç»™å®šçš„å­—ç¬¦ä¸²æ˜¯å¦åˆæ³•ã€‚</p><h2 id="è§£é¢˜æ€è·¯-1"><a href="#è§£é¢˜æ€è·¯-1" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>æ¨¡æ‹Ÿã€‚<br>æ¯èµ°ä¸€æ­¥æ›´æ–°æ²¿é€”æ”¾ç½®äº†æ–¹å—çš„åæ ‡å’Œå½“å‰æ–¹å‘ã€‚<br>ä¸­é€”æ£€æŸ¥æ˜¯å¦æœ‰é‡å¤æ”¾ç½®çš„æ–¹å—ï¼Œæœ€åæ£€æŸ¥æ˜¯å¦å›åˆ°åŸç‚¹ã€æ–¹å‘æ˜¯å¦å›æ­£ã€‚</p><h2 id="å‚è€ƒä»£ç -1"><a href="#å‚è€ƒä»£ç -1" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//        0 1 2 3</span></span><br><span class="line"><span class="type">int</span> dx[]=&#123;<span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">1</span>&#125;;</span><br><span class="line"><span class="type">int</span> dy[]=&#123;<span class="number">1</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    pll cur=&#123;<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> dir=<span class="number">0</span>; <span class="comment">//0:up 1:left 2:down 3:right</span></span><br><span class="line">    ll n;cin &gt;&gt; n;</span><br><span class="line">    string s;cin &gt;&gt; s;</span><br><span class="line">    map&lt;pll,<span class="type">int</span>&gt; mp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> c:s)&#123;</span><br><span class="line">        <span class="keyword">if</span>(mp.<span class="built_in">count</span>(cur))&#123;  cout &lt;&lt; <span class="string">&quot;-1\n&quot;</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">        mp[cur]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(c==<span class="string">&#x27;L&#x27;</span>) dir=(dir+<span class="number">1</span>)%<span class="number">4</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(c==<span class="string">&#x27;R&#x27;</span>) dir=(dir+<span class="number">3</span>)%<span class="number">4</span>;</span><br><span class="line">        cur.first+=dx[dir];</span><br><span class="line">        cur.second+=dy[dir];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(cur.first==<span class="number">0</span>&amp;&amp;cur.second==<span class="number">0</span>&amp;&amp;dir==<span class="number">0</span>) cout &lt;&lt; <span class="string">&quot;1\n&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;0\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="1004-HDU7497-ä¸é†’äººå®¤"><a href="#1004-HDU7497-ä¸é†’äººå®¤" class="headerlink" title="(1004)HDU7497 ä¸é†’äººå®¤"></a>(1004)HDU7497 ä¸é†’äººå®¤</h1><h2 id="é¢˜æ„-2"><a href="#é¢˜æ„-2" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®š $n$ ä¸ªä¸Šè¯¾æ—¶é—´æ®µï¼Œ $m$ ä¸ªç¡è§‰æ—¶é—´æ®µã€‚</p><p>åˆå§‹çŠ¶æ€æ˜¯ä¸æ¸…é†’ã€‚<br>æ¯ä¸ªç¡è§‰æ—¶é—´æ®µ $[s,t]$ èƒ½ä½¿æ¥ä¸‹æ¥ $2(t-s)$ çš„æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯ $[t,t+2(t-s)]$ æ—¶é—´æ®µå†…ä¿æŒæ¸…é†’ã€‚<br>ç¡è§‰æä¾›çš„æ¸…é†’æ—¶é—´æ®µä¸ä¼šå åŠ ï¼Œä»¥æ­¤å‰æœ€åä¸€ä¸ªç¡è§‰æ—¶é—´æ®µä¸ºå‡†ã€‚</p><p>é—®ç»™å®šçš„æ—¶é—´æ®µèƒ½å¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><ol><li>ä¸Šè¯¾æ—¶é—´ä¿æŒæ¸…é†’</li><li>ä¸Šè¯¾æ—¶é—´ä¸èƒ½ç¡è§‰</li></ol><h2 id="è§£é¢˜æ€è·¯-2"><a href="#è§£é¢˜æ€è·¯-2" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>å°†æ‰€æœ‰æ—¶é—´æ®µæ’åºï¼Œä»å·¦å¾€å³éå†ï¼š</p><ol><li>å½“å‰æ˜¯ä¸Šè¯¾æ—¶é—´æ®µï¼Œæ£€æŸ¥ï¼š<ol><li>ä¸Šè¯¾å¼€å§‹æ—¶é—´æ˜¯å¦æ™šäºæœ€åä¸€ä¸ªç¡è§‰æ—¶é—´æ®µçš„ç»“æŸæ—¶é—´</li><li>ä¸Šè¯¾ç»“æŸæ—¶é—´æ˜¯å¦æ—©äºæœ€åä¸€æ¬¡ç¡è§‰æä¾›çš„æ¸…é†’æ—¶é—´æ®µçš„ç»“æŸæ—¶é—´</li></ol></li><li>å½“å‰æ˜¯ç¡è§‰æ—¶é—´æ®µï¼Œæ£€æŸ¥ç¡è§‰æ—¶é—´æ˜¯å¦æ™šäºä¸Šä¸€èŠ‚è¯¾çš„ç»“æŸæ—¶é—´</li></ol><h2 id="å‚è€ƒä»£ç -2"><a href="#å‚è€ƒä»£ç -2" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n,m;cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    vector&lt;pair&lt;pll,<span class="type">int</span>&gt;&gt; <span class="built_in">v</span>(m+n);</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">0</span>,n<span class="number">-1</span>)&#123;</span><br><span class="line">        cin &gt;&gt; v[i].first.first &gt;&gt; v[i].first.second;</span><br><span class="line">        v[i].second = <span class="number">0</span>; <span class="comment">//ä¸Šè¯¾</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,n,n+m<span class="number">-1</span>)&#123;</span><br><span class="line">        cin &gt;&gt; v[i].first.first &gt;&gt; v[i].first.second;</span><br><span class="line">        v[i].second = <span class="number">1</span>; <span class="comment">//ç¡è§‰</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">SORT</span>(v);</span><br><span class="line">    ll b,e,s,t; <span class="comment">//ä¸Šæ¬¡ä¸Šè¯¾æ—¶é—´[b,e]ï¼Œä¸Šæ¬¡ç¡è§‰æ—¶é—´[s,t]</span></span><br><span class="line">    b=e=s=t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> [tp,op]:v)&#123;</span><br><span class="line">        <span class="keyword">auto</span> [x,y] = tp;</span><br><span class="line">        <span class="keyword">if</span>(op==<span class="number">0</span>)&#123; <span class="comment">//ä¸Šè¯¾</span></span><br><span class="line">            <span class="keyword">if</span>(x&lt;t)&#123; cout &lt;&lt; <span class="string">&quot;No\n&quot;</span>;<span class="keyword">return</span>;&#125; <span class="comment">//ä¸Šè¯¾å¼€å§‹è¿˜åœ¨ç¡è§‰</span></span><br><span class="line">            <span class="keyword">if</span>(t+<span class="number">2</span>*(t-s)&lt;y) &#123;cout &lt;&lt; <span class="string">&quot;No\n&quot;</span>;<span class="keyword">return</span>;&#125; <span class="comment">//ä¸Šæ¬¡æ²¡ç¡å¤Ÿæ”¯æ’‘ä¸åˆ°ä¸‹è¯¾</span></span><br><span class="line">            b=x;e=y;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123; </span><br><span class="line">            <span class="keyword">if</span>(x&lt;e)&#123; cout &lt;&lt; <span class="string">&quot;No\n&quot;</span>;<span class="keyword">return</span>;&#125; <span class="comment">//è¿˜æ²¡ä¸‹è¯¾å°±ç¡è§‰</span></span><br><span class="line">            s=x;t=y;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Yes\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="1005-HDU7498-äº¤é€šç®¡æ§"><a href="#1005-HDU7498-äº¤é€šç®¡æ§" class="headerlink" title="(1005)HDU7498 äº¤é€šç®¡æ§"></a>(1005)HDU7498 äº¤é€šç®¡æ§</h1><h2 id="é¢˜æ„-3"><a href="#é¢˜æ„-3" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>æœ‰ $k$ ç›çº¢ç»¿ç¯ï¼Œæ¯ç›ç¯æœ‰ä¸‰ç§çŠ¶æ€ï¼šç»¿è‰²<code>A</code>ã€é»„è‰²<code>B</code>ã€çº¢è‰²<code>C</code>ã€‚</p><p>ä¸€ä¸ªæ“ä½œç”¨ä¸€ä¸ªé•¿åº¦ä¸º $k$ çš„å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œä¸€ä¸ªå­—ç¬¦å¯¹åº”ä¸€ç›ç¯ã€‚<br>å­—ç¬¦ä¸²ä¸­åŒ…å«ï¼š</p><ol><li><code>+</code>ï¼šçº¢å˜ç»¿ã€ç»¿å˜é»„ã€é»„å˜çº¢</li><li><code>-</code>ï¼šç»¿å˜çº¢ã€é»„å˜ç»¿ã€çº¢å˜é»„</li><li><code>0</code>ï¼šä¸å˜</li></ol><p>äº¤è­¦æœ‰ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ“ä½œåºåˆ—ï¼Œä»–å¯ä»¥æŒ‰é¡ºåºå¯¹æ¯ä¸ªæ“ä½œé€‰æ‹©æ‰§è¡Œæˆ–ä¸æ‰§è¡Œã€‚</p><p>é—®æœ€åèƒ½è¾¾åˆ°å“ªäº›çŠ¶æ€ï¼Œä»¥åŠæ¯ç§çŠ¶æ€å¯¹åº”çš„ æ“ä½œåºåˆ—ç§æ•°ã€‚</p><h2 id="è§£é¢˜æ€è·¯-3"><a href="#è§£é¢˜æ€è·¯-3" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>çŠ¶æ€å‹ç¼©DPã€‚</p><p>ç”¨ä¸€ä¸ª $k$ ä½3è¿›åˆ¶æ•°è¡¨ç¤º $k$ ç›ç¯çš„çŠ¶æ€ï¼Œæ¯ä¸€ä½è¡¨ç¤ºä¸€ç›ç¯çš„çŠ¶æ€ï¼š0ç»¿ã€1é»„ã€2çº¢ã€‚<br>è®°ï¼š</p><ul><li>$dp[i][x]$ è¡¨ç¤ºå‰ $i$ ä¸ªæ“ä½œï¼ŒçŠ¶æ€ä¸º $x$ çš„æ–¹æ¡ˆæ•°ã€‚</li><li>$op(x,i)$ è¡¨ç¤ºçŠ¶æ€ $x$ ç»è¿‡ç¬¬ $i$ ä¸ªæ“ä½œåçš„çŠ¶æ€ã€‚</li></ul><p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š$dp[i][x]=dp[i-1][x]+\sum\limits_{j}^{st\in stat[i-1],op(st,i)=j} dp[i-1][st]$<br>å…¶ä¸­ï¼Œ$stat[i-1]$ è¡¨ç¤ºç¬¬ $i-1$ ä¸ªæ“ä½œåçš„æ‰€æœ‰çŠ¶æ€ã€‚</p><p>åˆ©ç”¨æ»šåŠ¨æ•°ç»„å¯ä»¥å®ç°ç©ºé—´ä¼˜åŒ–ã€‚</p><h2 id="å‚è€ƒä»£ç -3"><a href="#å‚è€ƒä»£ç -3" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;ll&gt; pow3;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">prepare</span><span class="params">()</span></span>&#123;</span><br><span class="line">    pow3.<span class="built_in">emplace_back</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,<span class="number">20</span>) pow3.<span class="built_in">emplace_back</span>(pow3.<span class="built_in">back</span>()*<span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line">ll n,k;</span><br><span class="line"><span class="comment">//åœ¨xçš„3è¿›åˆ¶ï¼Œç¬¬idxä½ï¼Œ+då†å¯¹3å–æ¨¡</span></span><br><span class="line"><span class="function">ll <span class="title">opadd</span><span class="params">(ll x,ll idx,ll d)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(d==<span class="number">0</span>) <span class="keyword">return</span> x;</span><br><span class="line">    ll t = x/pow3[idx]%<span class="number">3</span>;</span><br><span class="line">    t = (t+d+<span class="number">3</span>)%<span class="number">3</span>-t;</span><br><span class="line">    <span class="keyword">return</span> x + t*pow3[idx];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//0A1B2C</span></span><br><span class="line"><span class="function">string <span class="title">trans</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    string s;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">0</span>,k<span class="number">-1</span>)&#123;</span><br><span class="line">        s += <span class="built_in">char</span>(<span class="string">&#x27;A&#x27;</span>+x%<span class="number">3</span>);</span><br><span class="line">        x /= <span class="number">3</span>;</span><br><span class="line">    &#125; <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    cin &gt;&gt; MODULE::MOD;</span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">v</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span>&amp; s:v) cin &gt;&gt; s;</span><br><span class="line">    map&lt;ll,ll&gt; dp[<span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> fl=<span class="number">0</span>;</span><br><span class="line">    dp[fl].<span class="built_in">insert</span>(&#123;<span class="number">0</span>,<span class="number">1</span>&#125;); fl^=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span>&amp; s:v)&#123;</span><br><span class="line">        dp[fl]=dp[fl^<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> [v,cnt]:dp[fl^<span class="number">1</span>])&#123;</span><br><span class="line">            ll t=v;</span><br><span class="line">            <span class="built_in">FORLL</span>(i,<span class="number">0</span>,k<span class="number">-1</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(s[i]==<span class="string">&#x27;+&#x27;</span>) t=<span class="built_in">opadd</span>(t,i,<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span>(s[i]==<span class="string">&#x27;-&#x27;</span>) t=<span class="built_in">opadd</span>(t,i,<span class="number">-1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">addto</span>(dp[fl][t],cnt);</span><br><span class="line">        &#125;</span><br><span class="line">        fl^=<span class="number">1</span>;</span><br><span class="line">    &#125;fl^=<span class="number">1</span>;</span><br><span class="line">    map&lt;string,ll&gt; ans;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> [v,cnt]:dp[fl]) ans.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="built_in">trans</span>(v),(ll)cnt));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> [s,cnt]:ans) cout &lt;&lt; s &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; cnt &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">é¢˜è§£|2024æš‘æœŸæ­ç”µå¤šæ ¡06</summary>
    
    
    
    <category term="ç«èµ›ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E7%AB%9E%E8%B5%9B%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="2024æš‘æœŸæ­ç”µå¤šæ ¡" scheme="https://www.cclmsy.cc/tags/2024%E6%9A%91%E6%9C%9F%E6%9D%AD%E7%94%B5%E5%A4%9A%E6%A0%A1/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£|2024æš‘æœŸæ­ç”µå¤šæ ¡05</title>
    <link href="https://www.cclmsy.cc/posts/ACM_2024Summer_HDU05.html"/>
    <id>https://www.cclmsy.cc/posts/ACM_2024Summer_HDU05.html</id>
    <published>2024-08-01T16:00:00.000Z</published>
    <updated>2025-03-09T02:54:24.916Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯”èµ›é¢˜å•ï¼š<a href="https://acm.hdu.edu.cn/search.php?field=problem&amp;key=2024%A1%B0%B6%A4%B0%D2%B1%E0%B3%CC%A1%B1%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%CB%E3%B7%A8%C9%E8%BC%C6%B3%AC%BC%B6%C1%AA%C8%FC%A3%A85%A3%A9&amp;source=1&amp;searchmode=source">2024â€œé’‰è€™ç¼–ç¨‹â€ä¸­å›½å¤§å­¦ç”Ÿç®—æ³•è®¾è®¡è¶…çº§è”èµ›ï¼ˆ5ï¼‰</a></p><h1 id="1002-HDU7482-Array-Gift"><a href="#1002-HDU7482-Array-Gift" class="headerlink" title="(1002)HDU7482 Array-Gift"></a>(1002)HDU7482 Array-Gift</h1><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ­£æ•´æ•°æ•°ç»„ $a$ ï¼Œæä¾›ä»¥ä¸‹2ç§æ“ä½œï¼š</p><ol><li>é€‰æ‹©ä¸¤ä¸ªä¸åŒçš„ä¸‹æ ‡ $i,j$ ï¼Œ$a_i\leftarrow a_i\ mod\ a_j$</li><li>é€‰æ‹©ä¸€ä¸ªä¸‹æ ‡ $i$ å’Œä¸€ä¸ªä»»æ„æ­£æ•´æ•° $x$ ï¼Œ$a_i\leftarrow a_i+x$</li></ol><p>æ±‚ä½¿å¾—æ•°ç»„ä»…æœ‰1ä¸ªé0å…ƒç´ çš„æœ€å°æ“ä½œæ¬¡æ•°ã€‚</p><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>addï¼šåšä¹‹å‰å…ˆå¯¹æ•°ç»„å»é‡ï¼Œå› ä¸ºé‡å¤çš„æ•°å¯ä»¥åœ¨å¼€å§‹å°±é€šè¿‡æ“ä½œ1å˜ä¸º0ã€‚</p><p>è€ƒè™‘æœ€åæƒ…å†µçš„æ“ä½œæ¬¡æ•°ï¼š<br>é€‰å®šä¸¤ä¸ªä¸åŒçš„ä¸‹æ ‡ $i,j$ ï¼Œä¸å¦¨è®¾ $a_i&lt;=a_j$ ã€‚ï¼ˆ1æ¬¡ï¼‰<br>åšæ“ä½œ2ä½¿å¾— $a_i=a_j+1$ ï¼Œå†åšæ“ä½œ1ä½¿å¾— $a_i=1$ ã€‚ï¼ˆ1æ¬¡ï¼‰<br>æœ€åå¯¹æ¯ä¸ª $k\neq i$ åšæ“ä½œ1ï¼š$a_k\leftarrow a_k\ mod\ a_i=0$ ã€‚ï¼ˆ$n-1$æ¬¡ï¼‰<br>æœ€åæƒ…å†µçš„æ“ä½œæ¬¡æ•°ä¸º $n+1$ ã€‚</p><p>æœ€å¥½çš„æƒ…å†µï¼šå­˜åœ¨ä¸€ä¸ªä¸‹æ ‡ $i$ ä½¿å¾— $a_i$ èƒ½å¤Ÿæ•´é™¤æ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ ã€‚<br>æ»¡è¶³è¿™ä¸ªæ¡ä»¶çš„ $a_i$ ä¸€å®šæ˜¯æ•°ç»„ä¸­çš„æœ€å°å€¼ã€‚<br>è¿™ç§æƒ…å†µåªéœ€å¯¹æ¯ä¸ª $k\neq i$ åšæ“ä½œ1ï¼š$a_k\leftarrow a_k\ mod\ a_i=0$ ï¼Œæ“ä½œæ¬¡æ•°ä¸º $n-1$ ã€‚</p><p>ç”±äºæœ€åæƒ…å†µéš¾ä»¥ç¡®å®šï¼Œè€ƒè™‘æ“ä½œæ¬¡æ•°ä¸º $n$ çš„æƒ…å†µï¼š</p><ol><li>æ•°ç»„ $a$ ä¸­çš„æœ€å°å€¼ç»è¿‡æ“ä½œ2 ï¼Œ$\min(a)\leftarrow\min(a)+x$ ï¼Œèƒ½å¤Ÿæ•´é™¤æ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ ã€‚</li><li>æŸä¸ªå…ƒç´ ç»è¿‡æ“ä½œ1ï¼Œèƒ½å¤Ÿæ•´é™¤æ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ ã€‚</li></ol><p>å¯¹äºç¬¬äºŒç§æƒ…å†µï¼Œç»´æŠ¤gcdå‰ç¼€/åç¼€ï¼ˆä¼¼ä¹ä¸ç»´æŠ¤ä¹Ÿèƒ½è¿‡ï¼Ÿï¼‰ã€‚<br>æšä¸¾è¢«ä¿®æ”¹çš„æ•° $a_i$ å’Œæ¨¡æ•° $a_j$ ï¼Œè‹¥ $a_i\ mod\ a_j=\gcd\limits_k^{k\neq i}a_k$ ï¼Œåˆ™æœ€å°‘æ“ä½œæ¬¡æ•°ä¸º $n$ ã€‚</p><h2 id="å‚è€ƒä»£ç "><a href="#å‚è€ƒä»£ç " class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n;cin &gt;&gt; n;</span><br><span class="line">    <span class="built_in">create_vec</span>(v,n);</span><br><span class="line">    <span class="built_in">SORT</span>(v);</span><br><span class="line">    vector&lt;ll&gt; tmp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> x:v)&#123;</span><br><span class="line">        <span class="type">int</span> fl=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> m:tmp) <span class="keyword">if</span>(x%m==<span class="number">0</span>) &#123;fl=<span class="number">0</span>;<span class="keyword">break</span>;&#125;</span><br><span class="line">        <span class="keyword">if</span>(fl) tmp.<span class="built_in">emplace_back</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    ll on=n; v=tmp; n=v.<span class="built_in">size</span>(); <span class="comment">//onæ˜¯åŸæ•°ç»„å¤§å°</span></span><br><span class="line">    v.<span class="built_in">insert</span>(v.<span class="built_in">begin</span>(),<span class="number">0</span>); v.<span class="built_in">insert</span>(v.<span class="built_in">end</span>(),<span class="number">0</span>); <span class="comment">//èµ·å§‹ä¸‹æ ‡æ”¹ä¸º1</span></span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">1</span>) &#123;cout &lt;&lt; on<span class="number">-1</span> &lt;&lt; endl;<span class="keyword">return</span>;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function">vector&lt;ll&gt; <span class="title">preg</span><span class="params">(n+<span class="number">2</span>,<span class="number">0</span>)</span>,<span class="title">sufg</span><span class="params">(n+<span class="number">2</span>,<span class="number">0</span>)</span></span>; </span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,n) preg[i]=__gcd(preg[i<span class="number">-1</span>],v[i]);</span><br><span class="line">    <span class="built_in">FORLL_rev</span>(i,n,<span class="number">1</span>) sufg[i]=__gcd(sufg[i+<span class="number">1</span>],v[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(sufg[<span class="number">2</span>]&gt;v[<span class="number">1</span>]&amp;&amp;sufg[<span class="number">2</span>]&lt;=v[<span class="number">2</span>]) &#123;cout &lt;&lt; on &lt;&lt; endl;<span class="keyword">return</span>;&#125; <span class="comment">//å‰©ä¸‹çš„æ•°æ¨¡ï¼ˆv1+xï¼‰ä¸º0</span></span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,n)&#123; <span class="comment">//è¢«ä¿®æ”¹çš„æ•°</span></span><br><span class="line">        ll g=__gcd(preg[i<span class="number">-1</span>],sufg[i+<span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">FORLL</span>(j,<span class="number">1</span>,i<span class="number">-1</span>)&#123;<span class="comment">//æ¨¡æ•°</span></span><br><span class="line">            ll t=v[i]%v[j];</span><br><span class="line">            <span class="keyword">if</span>(t==<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(g%t==<span class="number">0</span>) &#123;cout &lt;&lt; on &lt;&lt; endl;<span class="keyword">return</span>;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; on+<span class="number">1</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="1006-HDU7486-çŒ«ç½å¤´æ¸¸æˆ"><a href="#1006-HDU7486-çŒ«ç½å¤´æ¸¸æˆ" class="headerlink" title="(1006)HDU7486 çŒ«ç½å¤´æ¸¸æˆ"></a>(1006)HDU7486 çŒ«ç½å¤´æ¸¸æˆ</h1><h2 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>æœ‰ä¸‰å †çŒ«ç½å¤´ï¼Œæ¯å †çŒ«ç½å¤´çš„æ•°é‡åˆ†åˆ«ä¸º $a,b,c$ ã€‚<br>ä¸¤åªçŒ«çŒ«è¿›è¡Œåšå¼ˆï¼Œæ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸€å †çŒ«ç½å¤´å…¨éƒ¨åƒæ‰ï¼Œç„¶åå†ä»å‰©ä¸‹çš„ä¸¤å †ä¸­é€‰æ‹©ä¸€å †çŒ«ç½å¤´åˆ†æˆä¸¤ä»½ï¼ˆæ¯ä»½è‡³å°‘ä¸€ç½ï¼‰ã€‚<br>ä¸èƒ½æ“ä½œçš„çŒ«çŒ«è¾“æ‰æ¸¸æˆã€‚</p><p>é—®å…ˆæ‰‹æ˜¯å¦æœ‰å¿…èƒœç­–ç•¥ã€‚</p><h2 id="è§£é¢˜æ€è·¯-1"><a href="#è§£é¢˜æ€è·¯-1" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>æœ€ç»ˆå¿…è´¥æ€æ˜¯ $a=b=c=1$ ã€‚</p><p>å½“å¼€å±€æœ‰3ä¸ªå¥‡æ•°æ—¶ï¼Œä¸è®ºæ€ä¹ˆæ“ä½œï¼Œç»“æœéƒ½æ˜¯2å¥‡æ•°1å¶æ•°ï¼›<br>å½“å¼€å±€æœ‰1ä¸ªæˆ–2ä¸ªå¶æ•°æ—¶ï¼Œå¯ä»¥æ§åˆ¶ç»“æœä¸º3ä¸ªå¥‡æ•°ã€‚<br>ä¸‰ä¸ªå¥‡æ•°çš„å°½å¤´å°±æ˜¯3ä¸ª1å¿…è´¥ï¼Œå› æ­¤å¼€å±€3å¥‡æ•°å¿…è´¥ï¼Œå¼€å±€1æˆ–2å¶æ•°å¿…èƒœã€‚</p><p>å¼€å±€å…¨å¶æ•°çš„æƒ…å†µï¼Œå¯ä»¥ä»lowbitçš„è§’åº¦è€ƒè™‘ã€‚<br>å½“å¼€å±€ä¸‰ä¸ªæ•°lowbitä½äºåŒä¸€ä½æ—¶ï¼Œä¸è®ºæ€ä¹ˆæ“ä½œéƒ½ä¸èƒ½ä½¿lowbitç›¸ç­‰ã€‚<br>å½“å¼€å±€ä¸‰ä¸ªæ•°lowbitä½äºä¸åŒä½æ—¶ï¼Œå¯ä»¥é€šè¿‡æ“ä½œæ§åˆ¶lowbitç›¸ç­‰ï¼Œæ•´ä¸ªè¿‡ç¨‹lowbitå‡å°ã€‚<br>lowbitç›¸ç­‰çš„å°½å¤´æ˜¯ä¸‰ä¸ªæ•°çš„lowbitéƒ½ç­‰äº$1$ä¹Ÿå°±æ˜¯ä¸‰å¥‡æ•°çš„å¿…è´¥æ€ã€‚</p><p>å› æ­¤ï¼Œå¼€å±€ä¸‰ä¸ªæ•°lowbitç›¸ç­‰å¿…è´¥ã€‚<br>è§‚å¯Ÿåˆ°ä¸‰ä¸ªæ•°ä¸å…¨æ˜¯å¶æ•°çš„æƒ…å†µä¹Ÿå¯ä»¥å½’å¹¶åˆ°è¿™ä¸ªç»“è®ºä¸­ï¼Œ2è¡Œç§’äº†ã€‚</p><h2 id="å‚è€ƒä»£ç -1"><a href="#å‚è€ƒä»£ç -1" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll a,b,c; cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">lowbit</span>(a)==<span class="built_in">lowbit</span>(b)&amp;&amp;<span class="built_in">lowbit</span>(b)==<span class="built_in">lowbit</span>(c))  NO; <span class="keyword">else</span> YES;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="1011-HDU7491-å¼€å…³ç¯"><a href="#1011-HDU7491-å¼€å…³ç¯" class="headerlink" title="(1011)HDU7491 å¼€å…³ç¯"></a>(1011)HDU7491 å¼€å…³ç¯</h1><h2 id="é¢˜æ„-2"><a href="#é¢˜æ„-2" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>æœ‰ $n$ ç›ç¯æ’æˆä¸€æ’ï¼Œç¼–å·ä¸º $1\sim n$ ï¼Œåˆå§‹çŠ¶æ€ä¸ºå…¨ç­ã€‚<br>æ¯æ¬¡æ“ä½œå¯ä»¥é€‰æ‹©ä¸€ç›ç¯ï¼Œåè½¬è¿™ç›ç¯å’Œä¸ä¹‹ç›¸é‚»çš„ç¯çš„çŠ¶æ€ï¼ˆå¼€å˜å…³ï¼Œå…³å˜å¼€ï¼‰ã€‚<br>æ±‚ä»»æ„æ“ä½œåï¼Œè¿™æ’ç¯å¯ä»¥åˆ°è¾¾å¤šå°‘ç§ä¸åŒçš„çŠ¶æ€ã€‚</p><h2 id="è§£é¢˜æ€è·¯-2"><a href="#è§£é¢˜æ€è·¯-2" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>è§‚å¯Ÿæ ·ä¾‹å‘ç°ç­”æ¡ˆæ»¡è¶³ $2^n$ ã€‚<br>æ‰‹ç©å‘ç°åªæœ‰ $n\equiv2(mod\ 3)$ æ—¶è¾¾ä¸åˆ°å…¨äº®çŠ¶æ€ï¼Œæ˜¯ $2^{n-1}$ ã€‚</p><p>å¦‚æœå‘ç°åŠ›ä¸å¤Ÿï¼Œè¿˜å¯ä»¥è€ƒè™‘ä»¥ä¸‹æ–¹æ³•ï¼š<br>å¯¹ä½ç½®1,2åˆ†åˆ«åšä¸€æ¬¡æ“ä½œï¼Œå¯ä»¥å•ç‹¬åè½¬3ï¼›å†å¯¹4,5åˆ†åˆ«åšä¸€æ¬¡æ“ä½œï¼Œå¯ä»¥å•ç‹¬åè½¬6ã€‚<br>ä»¥æ­¤ç±»æ¨ï¼Œæ­£ç€åšå¯ä»¥å•ç‹¬åè½¬æ‰€æœ‰ $i\equiv0(mod\ 3)$ï¼Œåç€åšå¯ä»¥å•ç‹¬åè½¬æ‰€æœ‰ $i\equiv n-2(mod\ 3)$ ã€‚<br>å¦‚æœå¯ä»¥å•ç‹¬ä»»æ„åè½¬è¿ç»­2ä¸ªç¯ï¼Œåˆ™ä¸å®ƒä»¬ç›¸é‚»çš„ç¯ä¹Ÿå¯ä»¥å•ç‹¬ä»»æ„åè½¬ï¼Œä»¥è¾¾åˆ°æ‰€æœ‰ $2^n$ ç§çŠ¶æ€ã€‚</p><p>å½“ä¸”ä»…å½“ $n\equiv2(mod\ 3)$ æ—¶ï¼Œæ­£ç€åšå’Œåç€åšåè½¬çš„éƒ½æ˜¯åŒä¸€æ‰¹ç¯ï¼Œæ— æ³•é€šè¿‡ä»¥ä¸Šæ“ä½œä»»æ„åè½¬æ‰€æœ‰çš„ç¯ã€‚<br>ç”±äºæ— æ³•åˆ°è¾¾å…¨äº®çŠ¶æ€ï¼Œç­”æ¡ˆå°‘ä¸€åŠï¼Œä¸º $2^{n-1}$ ã€‚</p><h2 id="å‚è€ƒä»£ç -2"><a href="#å‚è€ƒä»£ç -2" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n;cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">if</span>(n%<span class="number">3</span>==<span class="number">2</span>) cout &lt;&lt; <span class="built_in">qcpow</span>(<span class="number">2</span>,n<span class="number">-1</span>) &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="built_in">qcpow</span>(<span class="number">2</span>,n) &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="1013-HDU7493-é£è¡Œæ£‹"><a href="#1013-HDU7493-é£è¡Œæ£‹" class="headerlink" title="(1013)HDU7493 é£è¡Œæ£‹"></a>(1013)HDU7493 é£è¡Œæ£‹</h1><h2 id="é¢˜æ„-3"><a href="#é¢˜æ„-3" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>$0\sim n$ å·æ ¼å­æ’æˆä¸€æ’ï¼Œæ£‹å­åˆå§‹åœ¨ $0$ å·æ ¼ï¼Œç›®æ ‡æ˜¯ç²¾ç¡®åˆ°è¾¾ç¬¬ $n$ æ ¼ã€‚<br>æ¯æ¬¡éšæœºä» $1\sim n$ ä¸­å‡åŒ€éšæœºä¸€ä¸ªæ­£æ•´æ•° $x$ ï¼Œç„¶åå‘å‰ç§»åŠ¨ $x$ æ­¥ï¼Œè‹¥ç§»åŠ¨åˆ°ç¬¬ $n$ æ ¼è¿˜æœ‰å‰©ä½™æ­¥æ•°ï¼Œåˆ™ä¼šå¾€å›èµ°ã€‚<br>å¦‚æœéšæœºåˆ° $n$ ä¸”æœ€ç»ˆæ²¡æœ‰ç²¾ç¡®åˆ°è¾¾ç¬¬ $n$ æ ¼ï¼Œåˆ™å¯ä»¥å†ä» $1\sim n-1$ ä¸­å‡åŒ€éšæœºä¸€ä¸ªæ­£æ•´æ•°å¹¶è¡ŒåŠ¨ã€‚</p><p>æ±‚ç²¾ç¡®åˆ°è¾¾ç¬¬ $n$ æ ¼çš„æœŸæœ›æ­¥æ•°ã€‚</p><h2 id="è§£é¢˜æ€è·¯-3"><a href="#è§£é¢˜æ€è·¯-3" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>ä» $0$ å·æ ¼å­ä¸€æ¬¡åˆ°è¾¾ç¬¬ $n$ æ ¼çš„æ¦‚ç‡æ˜¯ $\dfrac{1}{n}$ ã€‚<br>ä» $1\sim n-1$ å·æ ¼å­ä¸€æ¬¡åˆ°è¾¾ç¬¬ $n$ æ ¼çš„æ¦‚ç‡éƒ½æ˜¯ $\dfrac{1}{n}(1+\dfrac{1}{n-1})=\dfrac{1}{n-1}$ ï¼ŒæœŸæœ›ä¸º $n-1$<br>å¦‚æœæ²¡æœ‰åˆ°è¾¾ç»ˆç‚¹ï¼Œæ£‹å­åªä¼šè½åœ¨ $1\sim n-1$ å·æ ¼å­ä¸Šã€‚</p><p>å› æ­¤ç­”æ¡ˆä¸º $\dfrac{1}{n}+\dfrac{n-1}{n}\times ((n-1)+1)=n+1+\dfrac{1}{n}$ ã€‚<br>ï¼ˆå¼å­ä¸­ $(n-1)+1$ æ˜¯åŠ ä¸Šäº†ä»0å¼€å§‹çš„ç¬¬ä¸€æ­¥ï¼‰</p><h2 id="å‚è€ƒä»£ç -3"><a href="#å‚è€ƒä»£ç -3" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n;cin &gt;&gt; n;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">sub</span>(<span class="built_in">add</span>(<span class="built_in">inv</span>(n),n),<span class="number">1</span>) &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">é¢˜è§£|2024æš‘æœŸæ­ç”µå¤šæ ¡05</summary>
    
    
    
    <category term="ç«èµ›ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E7%AB%9E%E8%B5%9B%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="2024æš‘æœŸæ­ç”µå¤šæ ¡" scheme="https://www.cclmsy.cc/tags/2024%E6%9A%91%E6%9C%9F%E6%9D%AD%E7%94%B5%E5%A4%9A%E6%A0%A1/"/>
    
  </entry>
  
  <entry>
    <title>é¢˜è§£|2024æš‘æœŸç‰›å®¢å¤šæ ¡06</title>
    <link href="https://www.cclmsy.cc/posts/ACM_2024Summer_NCD06.html"/>
    <id>https://www.cclmsy.cc/posts/ACM_2024Summer_NCD06.html</id>
    <published>2024-07-31T16:00:00.000Z</published>
    <updated>2025-03-09T02:54:24.890Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯”èµ›é“¾æ¥ï¼š<a href="https://ac.nowcoder.com/acm/contest/81601">2024ç‰›å®¢æš‘æœŸå¤šæ ¡è®­ç»ƒè¥6</a></p><h1 id="A-Cake"><a href="#A-Cake" class="headerlink" title="A.Cake"></a>A.Cake</h1><h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®šä¸€æ£µ $n$ ä¸ªèŠ‚ç‚¹ï¼Œä»¥ $1$ ä¸ºæ ¹çš„æ ‘ï¼Œæ¯æ¡è¾¹æœ‰ä¸€ä¸ªæƒå€¼ 0 æˆ– 1ã€‚<br>æ£‹å­åˆå§‹åœ¨èŠ‚ç‚¹ $1$ ï¼ŒAliceå…ˆæ‰‹ï¼ŒBobåæ‰‹ã€‚<br>æ¯å›åˆï¼Œç©å®¶å¯ä»¥å°†æ£‹å­ç§»åŠ¨åˆ°å½“å‰èŠ‚ç‚¹çš„ä¸€ä¸ªå­èŠ‚ç‚¹ã€‚<br>ç›´åˆ°æ£‹å­è¾¾åˆ°å¶å­èŠ‚ç‚¹ï¼Œæ¸¸æˆç»“æŸã€‚</p><p>æ£‹å­ç»è¿‡çš„è·¯å¾„çš„æƒå€¼æŒ‰é¡ºåºæ„æˆä¸€ä¸ª01åºåˆ—ï¼Œè®°å®ƒçš„é•¿åº¦ä¸º $m$ ã€‚<br>æ¥ä¸‹æ¥ï¼ŒBobå¯ä»¥æŠŠ $1$ å—è›‹ç³•ä»»æ„åˆ†æˆ $m$ ä»½ï¼ˆæŸä»½è›‹ç³•å¯ä»¥ä¸º0//ç©ºç›˜å­ï¼‰ã€‚<br>ç„¶åæ ¹æ®01åºåˆ—å†³å®šå–è›‹ç³•çš„æ¬¡åºï¼š0ä»£è¡¨Bobå–ï¼Œ1ä»£è¡¨Aliceå–ã€‚</p><p>é—®ä¸¤äººéƒ½ä»¥æœ€ä¼˜ç­–ç•¥è¡ŒåŠ¨å’Œåˆ‡è›‹ç³•ï¼Œé—®Aliceæœ€å¤šèƒ½æ‹¿åˆ°å¤šå°‘è›‹ç³•ã€‚</p><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>å…ˆè€ƒè™‘åœ¨è·¯å¾„ç¡®å®šçš„æƒ…å†µä¸‹ï¼ŒBobä¼šæ€ä¹ˆåˆ†è›‹ç³•ï¼š<br>Bobä¼šæ‰¾åˆ°ä¸€ä¸ªå‰ç¼€preï¼Œè¿™ä¸ªå‰ç¼€çš„â€œ0å æ¯”â€æ˜¯æ‰€æœ‰å‰ç¼€ä¸­æœ€å¤§çš„ã€‚<br>preçš„é•¿åº¦è®°ä¸º $t$ï¼Œ0å æ¯”è®°ä¸º $p$ã€‚<br>Bobä¼šå°†è›‹ç³•å¹³å‡åˆ†ä¸º $t$ ä»½ï¼Œå‰©ä¸‹ $m-t$ ä»½ä¸ºç©ºã€‚<br>è¿™æ ·ï¼ŒBobå¯ä»¥ä¿è¯ä»–æ‹¿åˆ°æœ€å¤šçš„ï¼Œå¤§å°ä¸º $p$ çš„è›‹ç³•ã€‚</p><p>å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ $i$ ï¼Œå…ˆDFSä¸€æ¬¡ï¼Œå¤„ç†å‡ºä» $1$ åˆ° $i$ è¿™æ¡è·¯å¾„ä¸Šæ‰€æœ‰å‰ç¼€çš„æœ€å¤§0å æ¯”ã€‚<br>é‚£ä¹ˆåœ¨æ¯ä¸ªç»“ç‚¹å¤„ã€‚</p><p>å†DFSä¸€æ¬¡ï¼Œå‡è®¾æ ¹èŠ‚ç‚¹ $1$ çš„æ·±åº¦æ˜¯1ï¼Œé‚£ä¹ˆï¼š<br>æ·±åº¦ä¸ºå¥‡æ•°çš„èŠ‚ç‚¹æ˜¯Aliceçš„å›åˆï¼ŒAliceä¼šå¸Œæœ›å‰ç¼€çš„â€œ0çš„å æ¯”â€æœ€å°åŒ–ï¼›<br>æ·±åº¦ä¸ºå¶æ•°çš„èŠ‚ç‚¹æ˜¯Bobçš„å›åˆï¼ŒBobä¼šå¸Œæœ›å‰ç¼€çš„â€œ0çš„å æ¯”â€æœ€å¤§åŒ–ã€‚</p><p>ä»å¶å­åˆ°æ ¹æ›´æ–°ï¼Œå¾—åˆ°æœ€ç»ˆ0å æ¯” $p$ ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•åˆ†è›‹ç³•ï¼Œæœ€ç»ˆç­”æ¡ˆä¸º $1-p$ ã€‚</p><h2 id="å‚è€ƒä»£ç "><a href="#å‚è€ƒä»£ç " class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">ll n;</span><br><span class="line">vector&lt;vector&lt;pll&gt;&gt; G;</span><br><span class="line">vector&lt;ld&gt; pref; <span class="comment">//å‰ç¼€ä¸­0çš„æœ€å¤§å æ¯”</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(ll u=<span class="number">1</span>,ll fa=<span class="number">0</span>,ll cnt0=<span class="number">0</span>,ll cnt1=<span class="number">0</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(u!=<span class="number">1</span>) <span class="built_in">chmax</span>(pref[u],(ld)cnt0/(cnt0+cnt1));<span class="comment">//ç”¨å½“å‰èŠ‚ç‚¹çš„0å æ¯”æ›´æ–°å‰ç¼€</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> [v,w]:G[u])</span><br><span class="line">        <span class="keyword">if</span>(v!=fa)&#123;</span><br><span class="line">            pref[v]=pref[u];<span class="comment">//ç»§æ‰¿çˆ¶èŠ‚ç‚¹çš„pref</span></span><br><span class="line">            <span class="built_in">dfs</span>(v,u,cnt0+(w==<span class="number">0</span>),cnt1+(w==<span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">vector&lt;ld&gt; dp; <span class="comment">//èŠ‚ç‚¹å¯¹æ‰§æ£‹æ‰‹çš„æœ€ä¼˜è§£</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs_dp</span><span class="params">(ll u=<span class="number">1</span>,ll fa=<span class="number">0</span>, ll dep=<span class="number">1</span>)</span></span>&#123;</span><br><span class="line">    dp[u]=dep%<span class="number">2</span>; </span><br><span class="line">    <span class="keyword">if</span>(u!=<span class="number">1</span>&amp;&amp;G[u].<span class="built_in">size</span>()==<span class="number">1</span>) dp[u]=pref[u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> [v,w]:G[u]) <span class="keyword">if</span>(v!=fa)&#123;</span><br><span class="line">        <span class="built_in">dfs_dp</span>(v,u,dep+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(dep%<span class="number">2</span>) <span class="built_in">chmin</span>(dp[u],dp[v]); <span class="comment">//å…ˆæ‰‹æ±‚prefå°</span></span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">chmax</span>(dp[u],dp[v]); <span class="comment">//åæ‰‹æ±‚prefå¤§</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    G.<span class="built_in">clear</span>(); G.<span class="built_in">resize</span>(n+<span class="number">1</span>);</span><br><span class="line">    pref.<span class="built_in">clear</span>(); pref.<span class="built_in">resize</span>(n+<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    dp.<span class="built_in">clear</span>(); dp.<span class="built_in">resize</span>(n+<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    ll u,v,w;</span><br><span class="line">    <span class="built_in">FORLL</span>(i,<span class="number">1</span>,n<span class="number">-1</span>)&#123;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">        G[u].<span class="built_in">emplace_back</span>(v,w);</span><br><span class="line">        G[v].<span class="built_in">emplace_back</span>(u,w);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(); <span class="built_in">dfs_dp</span>();</span><br><span class="line">    <span class="built_in">print_float</span>(<span class="number">1.</span>-dp[<span class="number">1</span>],<span class="number">12</span>);</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="B-Cake2"><a href="#B-Cake2" class="headerlink" title="B.Cake2"></a>B.Cake2</h1><h2 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®šæ­£æ•´æ•° $n,k$ ï¼Œè›‹ç³•çš„å½¢çŠ¶æ˜¯æ­£ $n$ è¾¹å½¢ï¼Œé¡¶ç‚¹ç¼–å·ä¸º $0$ åˆ° $n-1$ ã€‚<br>å¯¹äºæ¯ä¸ªé¡¶ç‚¹ $i$ ï¼Œæ²¿ç€ç”± é¡¶ç‚¹ $i$ å’Œ $(i+k)mod\ n$ ç¡®å®šçš„ç›´çº¿åˆ‡ä¸€åˆ€ã€‚<br>æ±‚æœ€åè›‹ç³•çš„å—æ•°ã€‚</p><p>ä»¥$n=6,k=2$ä¸ºä¾‹ï¼Œè›‹ç³•çš„å½¢çŠ¶å¦‚ä¸‹ï¼š<br><img src="https://source.cclmsy.cc/Images/Posts/ACM/2024Summer_NCD06_B.png" alt=""></p><h2 id="è§£é¢˜æ€è·¯-1"><a href="#è§£é¢˜æ€è·¯-1" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>æ‰‹ç”»å‡ ä¸ªå›¾ï¼Œå‘ç°å½“ä¸”ä»…å½“ $n=k\times2$ æ—¶ï¼Œè›‹ç³•çš„å—æ•°ä¸º $n$ ã€‚<br>å…¶ä½™æƒ…å†µä¸‹ï¼Œå‘ç°æ¯ä¸ªäº¤ç‚¹ä»…ç”±2æ¡ç›´çº¿ï¼Œè›‹ç³•çš„å—æ•°ä¸º $n\times k+1$ ã€‚</p><h2 id="å‚è€ƒä»£ç -1"><a href="#å‚è€ƒä»£ç -1" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n,k;cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    <span class="keyword">if</span>(k&gt;n/<span class="number">2</span>) k=n-k;</span><br><span class="line">    <span class="keyword">if</span>(k*<span class="number">2</span>!=n) cout &lt;&lt; k*n+<span class="number">1</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; n &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="H-Genshin-Impactâ€™s-Fault"><a href="#H-Genshin-Impactâ€™s-Fault" class="headerlink" title="H.Genshin Impactâ€™s Fault"></a>H.Genshin Impactâ€™s Fault</h1><h2 id="é¢˜æ„-2"><a href="#é¢˜æ„-2" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒåŒ…å«ä»¥ä¸‹å­—ç¬¦ï¼š</p><ul><li><code>3</code>ï¼šä¸‰æ˜Ÿå¡</li><li><code>4</code>ï¼šå››æ˜Ÿå¡</li><li><code>5</code>ï¼šæ™®é€šäº”æ˜Ÿå¡</li><li><code>U</code>ï¼šç‰¹æ®Šäº”æ˜Ÿå¡</li></ul><p>æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„å­—ç¬¦ä¸²æ˜¯åˆæ³•çš„ï¼š</p><ol><li>æ¯10ä¸ªè¿ç»­çš„å­—ç¬¦ä¸èƒ½éƒ½æ˜¯<code>3</code></li><li>æ¯90ä¸ªè¿ç»­çš„å­—ç¬¦è‡³å°‘æœ‰1ä¸ª<code>U</code>æˆ–<code>5</code></li><li>ç›¸é‚»ä¸¤å¼ äº”æ˜Ÿå¡ä¸èƒ½éƒ½æ˜¯<code>5</code></li></ol><p>åˆ¤æ–­ç»™å®šå­—ç¬¦ä¸²æ˜¯å¦åˆæ³•ã€‚</p><h2 id="è§£é¢˜æ€è·¯-2"><a href="#è§£é¢˜æ€è·¯-2" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>æŒ‰ç…§é¢˜æ„æ¨¡æ‹Ÿåˆ¤æ–­ã€‚</p><h2 id="å‚è€ƒä»£ç -2"><a href="#å‚è€ƒä»£ç -2" class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">string s;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> c:s)&#123;</span><br><span class="line">        <span class="keyword">if</span>(c==<span class="string">&#x27;3&#x27;</span>) cnt++;</span><br><span class="line">        <span class="keyword">else</span> cnt=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(cnt&gt;=<span class="number">10</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> c:s)&#123;</span><br><span class="line">        <span class="keyword">if</span>(c!=<span class="string">&#x27;5&#x27;</span>&amp;&amp;c!=<span class="string">&#x27;U&#x27;</span>) cnt++;</span><br><span class="line">        <span class="keyword">else</span> cnt=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(cnt&gt;=<span class="number">90</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check3</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">char</span> pre=<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> c:s)&#123;</span><br><span class="line">        <span class="keyword">if</span>(c==<span class="string">&#x27;5&#x27;</span>||c==<span class="string">&#x27;U&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(pre==<span class="string">&#x27;0&#x27;</span>) pre=c;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(pre==<span class="string">&#x27;5&#x27;</span>&amp;&amp;c==<span class="string">&#x27;5&#x27;</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">else</span> pre=c;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; s;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">check1</span>()&amp;&amp;<span class="built_in">check2</span>()&amp;&amp;<span class="built_in">check3</span>()) cout &lt;&lt; <span class="string">&quot;valid\n&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;invalid\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">é¢˜è§£|2024æš‘æœŸç‰›å®¢å¤šæ ¡06</summary>
    
    
    
    <category term="ç«èµ›ç¬”è®°" scheme="https://www.cclmsy.cc/categories/%E7%AB%9E%E8%B5%9B%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="2024æš‘æœŸç‰›å®¢å¤šæ ¡" scheme="https://www.cclmsy.cc/tags/2024%E6%9A%91%E6%9C%9F%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1/"/>
    
  </entry>
  
</feed>
